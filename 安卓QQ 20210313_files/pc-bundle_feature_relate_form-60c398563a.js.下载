(window.webpackJsonp=window.webpackJsonp||[]).push([["bundle_feature_relate_form"],{"../node_modules/@tencent/dui-mobile/lib/components/Button/Button.js":function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},i=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n("react")),l=a(n("../node_modules/prop-types/index.js")),u=n("../node_modules/@tencent/dui-mobile/lib/utils/theme.js"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.themedRender=function(e){var n,o=t.props,a=o.prefixCls,l=o.className,u=o.style,c=o.type,d=o.size,f=o.disabled,p=i(o,["prefixCls","className","style","type","size","disabled"]),h=e(a,l,((n={})[a+"-type-"+c]=c,n[a+"-size-"+d]=d,n[a+"-disabled"]=f,n));return s.createElement("button",r({},p,{className:h,style:u,disabled:f}),t.props.children)},t}return o(t,e),t.prototype.render=function(){return u.consumeTheme(this.themedRender)},t}(s.Component);t.default=c,c.defaultProps={prefixCls:"dui-m-button",type:"default",size:"default"},c.propTypes={prefixCls:l.string,style:l.object,className:l.string,type:l.oneOf(["default","primary","warning","hollow","golden","golden-outline","plain"]),size:l.oneOf(["default","small","large"])}},"../node_modules/@tencent/dui-mobile/lib/components/Button/index.js":function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n("../node_modules/@tencent/dui-mobile/lib/components/Button/Button.js"));t.Button=r.default,n("../node_modules/@tencent/dui-mobile/lib/utils/style.js").injectStyle("components/Button/style/index.css",".dui-m-button{outline:none;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;white-space:nowrap;border-radius:4px;font-size:14px;font-weight:500;border:1px solid transparent}.dui-m-button:not(.dui-m-button-type-default):not(.dui-m-button-type-hollow):not(.dui-m-button-type-golden-outline):disabled{color:#fff;background:#cbcdd1;border-color:transparent}.dui-m-button-type-default:disabled,.dui-m-button-type-golden-outline:disabled,.dui-m-button-type-hollow:disabled{color:rgba(0,0,0,.24);border-color:rgba(233,235,237,.4)}.dui-m-button-type-default{background:#fff;color:rgba(0,0,0,.88);border-color:#e9ebed}.dui-m-button-type-default:active{background:#e9ebed;color:rgba(0,0,0,.4)}.dui-m-button-type-plain{background:#e9ebed;color:rgba(0,0,0,.88)}.dui-m-button-type-plain:active{background:#d7d9da;color:rgba(0,0,0,.24)}.dui-m-button-type-primary{background:#1e6fff;color:#fff}.dui-m-button-type-primary:active{background:#1b66eb;color:hsla(0,0%,100%,.64)}.dui-m-button-type-warning{background:#ff7272;color:#fff}.dui-m-button-type-warning:active{opacity:.8}.dui-m-button-type-hollow{background:#fff;color:#1e6fff;border-color:#1e6fff}.dui-m-button-type-hollow:active{opacity:.5}.dui-m-button-type-golden{background:-webkit-linear-gradient(348deg,#f6ddb1,#e4bd80);background:linear-gradient(102deg,#f6ddb1,#e4bd80);border:none;color:#ad6d3c}.dui-m-button-type-golden:active{opacity:.5}.dui-m-button-type-golden-outline{border-color:#db8f1c;color:#db8f1c;background:#fff}.dui-m-button-type-golden-outline:active{opacity:.5}.dui-m-button-type-golden.dui-m-button-size-large{padding:0 31px}.dui-m-button-type-golden.dui-m-button-size-small{padding:2px 9px}.dui-m-button-type-golden.dui-m-button-size-default{padding:0 14px}.dui-m-button-size-large{min-width:160px;height:40px;padding:0 30px;font-size:17px}.dui-m-button-size-small{min-width:52px;height:28px;padding:0 8px;font-size:12px}.dui-m-button-size-default{height:32px;padding:0 13px}"),t.default=r.default},"../node_modules/@tencent/dui-mobile/lib/components/Modal/Modal.js":function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n("react")),l=a(n("react-dom")),u=i(n("../node_modules/prop-types/index.js")),c=n("../node_modules/@tencent/dui-mobile/lib/utils/helper.js"),d=a(n("../node_modules/@tencent/dui-mobile/lib/components/Button/index.js")),f=n("../node_modules/@tencent/dui-mobile/lib/utils/keepDom.js"),p=n("../node_modules/@tencent/dui-mobile/lib/utils/theme.js"),h=n("../node_modules/@tencent/dui-mobile/lib/utils/preventScrollPenetrate.js"),m=n("../node_modules/@tencent/dui-mobile/lib/utils/stylusAdapter.js");t.MODAL_TRANSITION_DURATION=200;var g=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.handleCancel=function(e){n.props.onCancel(e)},n.handleOk=function(e){n.props.onOk(e)},n.handleMaskClick=function(e){var t=n.props,o=t.maskClosable,r=t.onClickMask;!0===o&&n.handleCancel(e),r(e)},n.handleModalClick=function(e){e.stopPropagation()},n.renderFooter=function(e){var t=n.props,o=t.prefixCls,r=t.footer,i=t.okText,a=t.cancelText,l=t.actions,u=t.okStyle,c=t.cancelStyle;return null===r?null:r||(l?s.createElement("div",{className:e(o+"-actions")},l.map((function(e,t){return s.createElement(m.WithStylusClick,{clickHandler:e.onClick,key:t},s.createElement(d.default,null,e.text))}))):s.createElement("div",{className:e(o+"-footer")},a?s.createElement(m.WithStylusClick,{clickHandler:n.handleCancel},s.createElement(d.default,{style:c},a)):null,s.createElement(m.WithStylusClick,{clickHandler:n.handleOk},s.createElement(d.default,{style:u},i))))},n.themedRender=function(e){var o,i,a=n.props,u=a.prefixCls,c=a.className,d=a.style,p=a.title,m=a.content,g=a.visible,b=a.mask,_=a.children,E=a.destroyOnClose,v=a.maskStyle,y=a.zIndex,R=a.titleAlignment,T=e(u,c,((o={})[u+"-hidden"]=!g,o[u+"-no-mask"]=!b,o)),S=e(u+"-mask",((i={})[u+"-mask-display"]=b,i[u+"-mask-hidden"]=!g,i)),w=e(u+"-title",u+"-title-"+R);return E&&!f.decideKeepDom.call(n,t.MODAL_TRANSITION_DURATION,g)?null:l.default.createPortal(s.createElement(h.PreventScrollPenetrateContainer,{className:S,style:r({zIndex:y},v),onClick:n.handleMaskClick},s.createElement("div",{className:T,style:d,onClick:n.handleModalClick},p?s.createElement("div",{className:w},p):null,s.createElement("div",{className:e(u+"-content")},m||_),n.renderFooter(e))),document.body)},n}return o(n,e),n.prototype.render=function(){return p.consumeTheme(this.themedRender)},n}(s.Component);t.default=g,g.defaultProps={prefixCls:"dui-m-modal",title:"",content:"",footer:"",onCancel:c.emptyFn,onOk:c.emptyFn,cancelText:"\u53d6\u6d88",okText:"\u786e\u5b9a",visible:!1,mask:!0,destroyOnClose:!1,onClickMask:c.emptyFn,maskClosable:!1,titleAlignment:"center"},g.propTypes={prefixCls:u.string,style:u.object,className:u.string,title:u.any,content:u.any,footer:u.any,onCancel:u.func,onOk:u.func,cancelText:u.any,okText:u.any,visible:u.bool,mask:u.bool,destroyOnClose:u.bool,maskClosable:u.bool,maskStyle:u.object,onClickMask:u.func,actions:u.array,zIndex:u.number,okStyle:u.object,cancelStyle:u.object,titleAlignment:u.oneOf(["left","center"])}},"../node_modules/@tencent/dui-mobile/lib/components/Modal/confirm.js":function(e,t,n){"use strict";var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n("../node_modules/@tencent/dui-mobile/lib/components/Modal/Modal.js")),i=n("../node_modules/@tencent/dui-mobile/lib/utils/show.js"),a=n("../node_modules/@tencent/dui-mobile/lib/utils/helper.js");t.default=a.wrapWithConfigDefaults((function(e){return i.showWithTransition({Component:r.default,transitionDuration:r.MODAL_TRANSITION_DURATION,autoClose:!1,props:e,forcedProps:{destroyOnClose:!0},injectClosePropNames:["onOk","onCancel"],deepInjectClose:e.actions&&[[e.actions,"onClick"]]})}))},"../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js":function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n("../node_modules/@tencent/dui-mobile/lib/components/Modal/Modal.js"));t.Modal=r.default;var i=o(n("../node_modules/@tencent/dui-mobile/lib/components/Modal/confirm.js"));n("../node_modules/@tencent/dui-mobile/lib/utils/style.js").injectStyle("components/Modal/style/index.css",'@-webkit-keyframes dui-m-modal-fade-in{0%{opacity:0}to{opacity:1}}@keyframes dui-m-modal-fade-in{0%{opacity:0}to{opacity:1}}@-webkit-keyframes dui-m-modal-pop-up{0%{opacity:0;-webkit-transform:scale3d(.95,.95,1);transform:scale3d(.95,.95,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes dui-m-modal-pop-up{0%{opacity:0;-webkit-transform:scale3d(.95,.95,1);transform:scale3d(.95,.95,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}.dui-m-modal{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-align:center;-webkit-align-items:center;align-items:center;width:320px;min-height:160px;padding-top:32px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:8px;overflow:hidden;border:none;background-color:#fff;pointer-events:auto;-webkit-animation:dui-m-modal-pop-up .2s ease-out;animation:dui-m-modal-pop-up .2s ease-out;-webkit-transition:all .2s ease-out;transition:all .2s ease-out;opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}.dui-m-modal-hidden{opacity:0;-webkit-transform:scale3d(.95,.95,1);transform:scale3d(.95,.95,1)}.dui-m-modal-no-mask{-webkit-box-shadow:0 -5px 20px 0 rgba(0,0,0,.14);box-shadow:0 -5px 20px 0 rgba(0,0,0,.14)}.dui-m-modal-mask{position:fixed;z-index:9998;top:0;left:0;right:0;bottom:0;opacity:1;pointer-events:none;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-animation:dui-m-modal-fade-in .2s linear;animation:dui-m-modal-fade-in .2s linear;-webkit-transition:all .2s linear;transition:all .2s linear}.dui-m-modal-mask-display{pointer-events:auto;background-color:rgba(0,0,0,.3)}.dui-m-modal-mask-hidden{opacity:0;visibility:hidden}.dui-m-modal-title{-webkit-box-sizing:border-box;box-sizing:border-box;font-weight:500;font-size:17px;margin-bottom:16px;padding:0 24px;width:100%;height:20px;line-height:20px}.dui-m-modal-title-center{text-align:center}.dui-m-modal-title-left{text-align:left}.dui-m-modal-content{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:stretch;-webkit-align-items:stretch;align-items:stretch;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:17px;padding:0 24px;width:100%;margin-bottom:32px;text-align:center}.dui-m-modal-actions>.dui-m-button,.dui-m-modal-footer>.dui-m-button{position:relative;display:inline-block;border:none;border-radius:0;font-size:17px;font-weight:400}.dui-m-modal-footer{position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:100%}.dui-m-modal-footer:before{content:" ";position:absolute;height:1px;width:100%;background:rgba(0,0,0,.08);-webkit-transform:scaleY(.5);transform:scaleY(.5);top:0;left:0;z-index:1}.dui-m-modal-footer>.dui-m-button{-webkit-box-flex:1;-webkit-flex:1;flex:1;height:56px}.dui-m-modal-footer>.dui-m-button:last-child{font-weight:500}.dui-m-modal-actions{width:100%}.dui-m-modal-actions>.dui-m-button{width:100%;height:44px}.dui-m-modal-actions>.dui-m-button:after{content:" ";position:absolute;height:1px;width:100%;background:rgba(0,0,0,.08);-webkit-transform:scaleY(.5);transform:scaleY(.5);top:0;left:0}'),r.default.confirm=i.default,t.default=r.default},"../node_modules/@tencent/dui-mobile/lib/utils/stylusAdapter.js":function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r,i=o(n("react")),a=o(n("../node_modules/@tencent/docs-user-agent/dist/index.js"));!function(e){e.direct="direct",e.stylus="stylus"}(r||(r={}));var s=function(){function e(){}return e.supportStylus=function(e,t){if(this.isIPadStylusTouch(e))if("touchstart"!==e.nativeEvent.type){if("touchend"===e.nativeEvent.type){var n=[e.changedTouches[0].clientX,e.changedTouches[0].clientY];this.isEqualPos(this.startPos,n)&&t&&t(),e.preventDefault()}}else this.startPos=[e.changedTouches[0].clientX,e.changedTouches[0].clientY]},e.startPos=[0,0],e.isIPadStylusTouch=function(e){return a.default.isIPad&&e.changedTouches[0]&&e.changedTouches[0].touchType===r.stylus},e.isEqualPos=function(e,t){return Math.abs(e[0]-t[0])<10&&Math.abs(e[1]-t[1])<10},e}();t.StylusAdapter=s,t.WithStylusClick=function(e){var t=e.children,n=e.clickHandler;return i.default.cloneElement(t,{onClick:n,onTouchStart:function(e){return s.supportStylus(e,n)},onTouchEnd:function(e){return s.supportStylus(e,n)}})}},"../node_modules/@tencent/dui/lib/components/Button/Button.js":function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n("react")),c=s(n("../node_modules/prop-types/index.js")),d=n("../node_modules/@tencent/dui/lib/utils/theme.js"),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.themedRender=function(e){var n,o=t.props,i=o.prefixCls,a=o.className,s=o.style,c=o.type,d=o.size,f=o.disabled,p=o.icon,h=l(o,["prefixCls","className","style","type","size","disabled","icon"]),m=e(i,a,((n={})[i+"-type-"+c]=c,n[i+"-size-"+d]=d,n[i+"-with-icon"]=p,n[i+"-type-"+c+"-disabled"]=f,n)),g=e(i+"-container"),b=e(i+"-icon");return u.createElement("button",r({},h,{className:m,style:s,disabled:f}),u.createElement("div",{className:g},p?"string"===typeof p?u.createElement("span",{className:b,style:{backgroundImage:"url("+p+")"}}):p:null,t.props.children))},t}return o(t,e),t.prototype.render=function(){return d.consumeTheme(this.themedRender)},t}(u.Component);t.default=f,f.defaultProps={prefixCls:"dui-button",type:"default",size:"default"},f.propTypes={prefixCls:c.string,style:c.object,className:c.string,type:c.oneOf(["default","primary","warning","plain","golden","golden-outline"]),size:c.oneOf(["default","small","large"]),icon:c.node}},"../node_modules/@tencent/dui/lib/components/Button/index.js":function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;var r=o(n("../node_modules/@tencent/dui/lib/components/Button/Button.js"));t.Button=r.default,n("../node_modules/@tencent/dui/lib/utils/style.js").injectStyle("components/Button/style/index.css",".dui-button{outline:none;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;white-space:nowrap;border-radius:2px;border:1px solid transparent;font-size:14px;padding:0 20px;-webkit-tap-highlight-color:transparent}.dui-button-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.dui-button-type-default{background:#fff;color:rgba(0,0,0,.8);border-color:rgba(0,0,0,.12)}.dui-button-type-default:hover{background:rgba(0,0,0,.04)}.dui-button-type-default:active{background:rgba(0,0,0,.08)}.dui-button-type-primary{background:#1e6fff;color:#fff}.dui-button-type-primary:hover{background:#5391ff}.dui-button-type-primary:active{background:#1b66eb}.dui-button-type-warning{background:#fb4d3f;color:#fff}.dui-button-type-warning:hover{background:#fb776c}.dui-button-type-warning:active{background:#e7463a}.dui-button-type-plain{background:#fff}.dui-button-type-plain:hover{background:rgba(0,0,0,.04)}.dui-button-type-plain:active{background:rgba(0,0,0,.08)}.dui-button-type-golden{background:-webkit-linear-gradient(338deg,#f6ddb1,#e4bd80);background:linear-gradient(112deg,#f6ddb1,#e4bd80);border:none;color:#865812}.dui-button-type-golden .dui-button-container{margin:0 1px}.dui-button-type-golden:hover{background:-webkit-linear-gradient(338deg,#f9e8c8,#edd1a7);background:linear-gradient(112deg,#f9e8c8,#edd1a7)}.dui-button-type-golden:active{background:-webkit-linear-gradient(338deg,#f3cf9e,#e2b475);background:linear-gradient(112deg,#f3cf9e,#e2b475)}.dui-button-type-golden-outline{border-color:#db8f1c;color:#db8f1c;background:#fff}.dui-button-type-golden-outline:hover{background:rgba(219,143,28,.1)}.dui-button-type-golden-outline:active{background:rgba(219,143,28,.2)}.dui-button-type-default-disabled,.dui-button-type-golden-disabled,.dui-button-type-golden-outline-disabled,.dui-button-type-primary-disabled,.dui-button-type-warning-disabled{color:rgba(0,0,0,.24);background:rgba(0,0,0,.08);border-color:transparent;cursor:auto}.dui-button-type-default-disabled:active,.dui-button-type-default-disabled:hover,.dui-button-type-golden-disabled:active,.dui-button-type-golden-disabled:hover,.dui-button-type-golden-outline-disabled:active,.dui-button-type-golden-outline-disabled:hover,.dui-button-type-primary-disabled:active,.dui-button-type-primary-disabled:hover,.dui-button-type-warning-disabled:active,.dui-button-type-warning-disabled:hover{background:rgba(0,0,0,.08)}.dui-button-type-default-disabled{border-color:transparent}.dui-button-type-plain-disabled{color:rgba(0,0,0,.24);background:#fff;cursor:auto}.dui-button-type-plain-disabled:active,.dui-button-type-plain-disabled:hover{background:#fff}.dui-button-size-large{height:38px;min-width:160px}.dui-button-size-default{height:28px}.dui-button-size-small{height:24px;padding:0 16px}.dui-button-with-icon{padding:0 9px}.dui-button-icon{display:inline-block;width:18px;height:18px;background-size:contain;background-repeat:no-repeat;background-position:50%;margin-right:4px}"),t.default=r.default},"../node_modules/@tencent/dui/lib/components/Modal/Dragger.js":function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n("react")),l=a(n("../node_modules/prop-types/index.js")),u=n("../node_modules/@tencent/dui/lib/utils/helper.js"),c=n("../node_modules/@tencent/dui/lib/utils/theme.js"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=null,t.minLeft=0,t.minTop=0,t.setRef=function(e){t.ref=e},t.onMouseDown=function(e){if(t.props.draggable&&t.ref&&!t.isFromInnerInput(e)){t.mouse=!0;var n=t.ref.getBoundingClientRect(),o=n.left,r=n.top,i=n.width,a=n.height,s=e.clientX,l=e.clientY;t.startLeft=o,t.startTop=r,t.startX=s,t.startY=l,t.maxLeft=window.innerWidth-i,t.maxTop=window.innerHeight-a,t.ref.style.userSelect="none",t.ref.parentElement.style.pointerEvents="auto"}},t.onMouseMove=function(e){if(t.mouse&&t.ref){var n=e.clientX,o=e.clientY,r=t.startLeft+n-t.startX,i=t.startTop+o-t.startY;r=Math.min(Math.max(t.minLeft,r),t.maxLeft),i=Math.min(Math.max(t.minTop,i),t.maxTop),t.ref.style.position="absolute",t.ref.style.left=r+"px",t.ref.style.top=i+"px"}},t.onMouseUp=function(e){if(t.ref){t.mouse=!1,t.ref.style.userSelect="auto",t.ref.parentElement.style.pointerEvents="";var n=t.props,o=n.onDragEnd;!0===n.draggable&&o(e)}},t.themedRender=function(e){var n=t.props,o=n.children,r=n.className,i=n.onClick,a=n.prefixCls,l=n.style,u=e(a,r);return s.createElement("div",{className:u,style:l,ref:t.setRef,onMouseDown:t.onMouseDown,onClick:i},o)},t}return o(t,e),t.prototype.componentDidMount=function(){document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp)},t.prototype.componentWillUnmount=function(){document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp)},t.prototype.isFromInnerInput=function(e){var t,n=e.target;return Boolean(/input|textarea/i.test(n.tagName)&&(null===(t=this.ref)||void 0===t?void 0:t.contains(n)))},t.prototype.render=function(){return c.consumeTheme(this.themedRender)},t}(s.Component);t.default=d,d.defaultProps={prefixCls:"dui-dragger",onDragEnd:u.emptyFn,onClick:u.emptyFn,draggable:!1},d.propTypes={prefixCls:l.string,className:l.string,style:l.object,draggable:l.bool,onClick:l.func,onDragEnd:l.func}},"../node_modules/@tencent/dui/lib/components/Modal/Modal.js":function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MODAL_LEAVING_TRANSITION_DURATION=void 0;var u=s(n("react")),c=l(n("react-dom")),d=s(n("../node_modules/prop-types/index.js")),f=n("../node_modules/@tencent/dui/lib/utils/helper.js"),p=l(n("../node_modules/@tencent/dui/lib/components/Button/index.js")),h=l(n("../node_modules/@tencent/dui/lib/components/Modal/Dragger.js")),m=n("../node_modules/@tencent/dui/lib/utils/keepDom.js"),g=n("../node_modules/@tencent/dui/lib/components/Snackbar/context.js"),b=n("../node_modules/@tencent/dui/lib/utils/theme.js"),_=n("../node_modules/@tencent/dui/lib/utils/preventScrollPenetrate.js"),E=n("../node_modules/@tencent/dui/lib/utils/stylusAdapter.js");t.MODAL_LEAVING_TRANSITION_DURATION=240;var v=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.draggerRef=u.createRef(),n.handleClose=function(e){var t=n.props,o=t.onClose,r=t.onCancel;(o||r)(e)},n.handleMaskClick=function(e){var t=n.props,o=t.maskClosable,r=t.onClickMask;!0===o&&n.handleClose(e),r(e)},n.handleDraggerClick=function(e){e.stopPropagation()},n.handleKeyDown=function(e){var t,o=n.props,r=o.visible,i=o.onCancel,a=o.onOk,s=o.footer;!r||s||null===s||(null===(t=n.draggerRef.current)||void 0===t?void 0:t.isFromInnerInput(e))||("Enter"===e.key?(document.activeElement&&document.activeElement.blur(),a()):"Escape"===e.key&&i())},n.renderFooter=function(e){var t,o,r=n.props,i=r.prefixCls,a=r.footer,s=r.okText,l=r.cancelText,c=r.action,d=r.onClickAction,f=r.onOk,h=r.onCancel,m=r.okDisabled;return null===a?null:a||(null!==c&&"object"===typeof c?u.isValidElement(c)?t=c:("text"in c&&(t=c.text),"icon"in c&&(o=c.icon)):t=c,u.createElement("div",{className:e(i+"-footer")},c?u.createElement(E.WithStylusClick,{clickHandler:d},u.createElement("div",{className:e(i+"-footer-action")},o?"string"===typeof o?u.createElement("div",{className:e(i+"-footer-action-icon"),style:{backgroundImage:"url("+o+")"}}):o:null,t?u.createElement("div",null,t):null)):null,l?u.createElement(E.WithStylusClick,{clickHandler:h},u.createElement(p.default,null,l)):null,u.createElement(E.WithStylusClick,{clickHandler:f},u.createElement(p.default,{className:e(i+"-footer-ok"),type:"primary",disabled:m},s))))},n.themedRender=function(e){var o,i=n.props,a=i.prefixCls,s=i.className,l=i.style,d=i.title,f=i.visible,p=i.maskStyle,b=i.maskClassName,v=i.mask,y=i.closable,R=i.draggable,T=i.onDragEnd,S=i.destroyOnClose,w=i.zIndex,x=i.containerDom,j=e(a,s,a+"-"+(f?"visible":"hidden")),k=e(a+"-mask",b,a+"-mask-"+(f?"visible":"hidden"),((o={})[a+"-mask-display"]=v,o[a+"-mask-in-container"]=x!==document.body,o));if(!x||S&&!m.decideKeepDom.call(n,t.MODAL_LEAVING_TRANSITION_DURATION,f))return null;var O=n.draggerRef.current&&n.draggerRef.current.ref;return c.default.createPortal(u.createElement(g.ContainerContext.Provider,{value:O},u.createElement(_.PreventScrollPenetrateContainer,{className:k,style:r({zIndex:w},p),onClick:n.handleMaskClick},u.createElement(h.default,{className:j,style:l,draggable:R,onDragEnd:T,onClick:n.handleDraggerClick,ref:n.draggerRef},y?u.createElement(E.WithStylusClick,{clickHandler:n.handleClose},u.createElement("div",{className:e(a+"-close")})):null,null!==d?u.createElement("div",{className:e(a+"-title")},d):null,n.renderContent(e),n.renderFooter(e)))),x)},n}return o(n,e),n.prototype.componentDidMount=function(){var e=this;this.forceUpdate(),setTimeout((function(){document.addEventListener("keydown",e.handleKeyDown)}),1e3)},n.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown)},n.prototype.renderContent=function(e){var t,n=this.props,o=n.prefixCls,r=n.title,i=n.content,a=n.children,s=e(o+"-content",((t={})[o+"-content-empty-title"]=""===r,t)),l=i||a,c=l;return f.isIE()&&"string"===typeof l&&(c=u.createElement("span",{style:{maxWidth:"100%"}},l)),f.isIE()?u.createElement("div",{style:{display:"flex",flexDirection:"column"}},u.createElement("div",{className:s},c)):u.createElement("div",{className:s},c)},n.prototype.render=function(){return b.consumeTheme(this.themedRender)},n}(u.Component);t.default=v,v.defaultProps={prefixCls:"dui-modal",title:"",content:"",footer:"",onCancel:f.emptyFn,onOk:f.emptyFn,cancelText:"\u53d6\u6d88",okText:"\u786e\u8ba4",visible:!1,mask:!0,maskClosable:!1,closable:!0,onDragEnd:f.emptyFn,destroyOnClose:!1,onClickMask:f.emptyFn,action:"",onClickAction:f.emptyFn,containerDom:"undefined"!==typeof document?document.body:void 0,okDisabled:!1},v.propTypes={prefixCls:d.string,style:d.object,className:d.string,title:d.node,content:d.node,footer:d.node,onCancel:d.func,onOk:d.func,cancelText:d.node,okText:d.node,visible:d.bool,mask:d.bool,maskClosable:d.bool,closable:d.bool,draggable:d.bool,onDragEnd:d.func,destroyOnClose:d.bool,maskStyle:d.object,maskClassName:d.string,onClickMask:d.func,action:d.any,onClickAction:d.func,onClose:d.func,zIndex:d.number,containerDom:d.object,okDisabled:d.bool}},"../node_modules/@tencent/dui/lib/components/Modal/confirm.js":function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n("../node_modules/@tencent/dui/lib/components/Modal/Modal.js")),s=n("../node_modules/@tencent/dui/lib/utils/show.js"),l=n("../node_modules/@tencent/dui/lib/utils/helper.js");t.default=l.wrapWithConfigDefaults((function(e){return e.onClose=e.onClose||e.onCancel,s.showWithTransition({Component:a.default,transitionDuration:a.MODAL_LEAVING_TRANSITION_DURATION,autoClose:!1,props:e,forcedProps:{destroyOnClose:!0},injectClosePropNames:["onOk","onCancel","onClickAction","onClose"]})}))},"../node_modules/@tencent/dui/lib/components/Modal/index.js":function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=void 0;var r=o(n("../node_modules/@tencent/dui/lib/components/Modal/Modal.js"));t.Modal=r.default;var i=o(n("../node_modules/@tencent/dui/lib/components/Modal/confirm.js"));n("../node_modules/@tencent/dui/lib/utils/style.js").injectStyle("components/Modal/style/index.css","@-webkit-keyframes dui-modal-fade-in{0%{opacity:0}to{opacity:1}}@keyframes dui-modal-fade-in{0%{opacity:0}to{opacity:1}}@-webkit-keyframes dui-modal-pop-up{0%{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes dui-modal-pop-up{0%{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}.dui-modal{position:relative;width:386px;-webkit-box-sizing:border-box;box-sizing:border-box;padding:20px 23px 24px;border-radius:4px;border:1px solid #eee;-webkit-box-shadow:0 2px 6px 0 rgba(0,0,0,.12);box-shadow:0 2px 6px 0 rgba(0,0,0,.12);background-color:#fff;pointer-events:auto;-webkit-animation:dui-modal-pop-up .3s cubic-bezier(.4,0,.2,1);animation:dui-modal-pop-up .3s cubic-bezier(.4,0,.2,1);-webkit-tap-highlight-color:transparent}.dui-modal-hidden,.dui-modal-visible{-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,transform,visibility;transition-property:opacity,transform,visibility,-webkit-transform}.dui-modal-visible{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1);-webkit-transition-duration:.3s;transition-duration:.3s}.dui-modal-hidden{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1);-webkit-transition-duration:.24s;transition-duration:.24s}.dui-modal-mask{position:fixed;z-index:9998;top:0;left:0;right:0;bottom:0;opacity:1;pointer-events:none;-webkit-animation:dui-modal-fade-in .3s cubic-bezier(.4,0,.2,1);animation:dui-modal-fade-in .3s cubic-bezier(.4,0,.2,1);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.dui-modal-mask-in-container{position:absolute}.dui-modal-mask-display{pointer-events:auto;background-color:hsla(0,0%,100%,.65)}.dui-modal-mask-visible{opacity:1;visibility:visible;-webkit-transition:all .3s cubic-bezier(.4,0,.2,1);transition:all .3s cubic-bezier(.4,0,.2,1)}.dui-modal-mask-hidden{opacity:0;visibility:hidden;-webkit-transition:all .24s cubic-bezier(.4,0,.2,1);transition:all .24s cubic-bezier(.4,0,.2,1)}.dui-modal-close{position:absolute;z-index:1;width:20px;height:20px;right:22px;top:23px;background-size:16px 16px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16'%3E%3Cpath fill-rule='evenodd' d='M8.977 8.047l4.93 4.97-.976.984L8 9.03 3.07 14l-.977-.984 4.93-4.97L2 2.984 2.977 2 8 7.062 13.023 2l.977.984-5.023 5.063z' opacity='.64'/%3E%3C/svg%3E\");background-position:50%;background-repeat:no-repeat;cursor:pointer}.dui-modal-close:hover{background-color:rgba(51,51,51,.1)}.dui-modal-close:active{background-color:rgba(65,70,80,.3)}.dui-modal-title{font-weight:500;font-size:18px;margin-bottom:20px}.dui-modal-content{font-size:14px;color:rgba(0,0,0,.88);height:-webkit-max-content;height:-moz-max-content;height:max-content;min-height:88px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column nowrap;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;word-break:break-word}.dui-modal-content-empty-title{margin-top:28px;min-height:60px}.dui-modal-footer{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;margin-top:24px;position:relative}.dui-modal-footer,.dui-modal-footer-action{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.dui-modal-footer-action{position:absolute;left:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);cursor:pointer;font-size:12px;color:rgba(0,0,0,.64);-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.dui-modal-footer-action-icon{display:inline-block;width:16px;height:16px;margin-right:6px;background-size:contain;background-position:50%;background-repeat:no-repeat}.dui-modal-footer-ok{margin-left:16px}"),r.default.confirm=i.default,t.default=r.default},"../node_modules/@tencent/dui/lib/utils/stylusAdapter.js":function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WithStylusClick=t.StylusAdapter=void 0;var r,i=o(n("react")),a=o(n("../node_modules/@tencent/docs-user-agent/dist/index.js"));!function(e){e.direct="direct",e.stylus="stylus"}(r||(r={}));var s=function(){function e(){}return e.supportStylus=function(e,t){if(this.isIPadStylusTouch(e))if("touchstart"!==e.nativeEvent.type){if("touchend"===e.nativeEvent.type){var n=[e.changedTouches[0].clientX,e.changedTouches[0].clientY];this.isEqualPos(this.startPos,n)&&t&&t(),e.preventDefault()}}else this.startPos=[e.changedTouches[0].clientX,e.changedTouches[0].clientY]},e.startPos=[0,0],e.isIPadStylusTouch=function(e){return a.default.isIPad&&e.changedTouches[0]&&e.changedTouches[0].touchType===r.stylus},e.isEqualPos=function(e,t){return Math.abs(e[0]-t[0])<10&&Math.abs(e[1]-t[1])<10},e}();t.StylusAdapter=s,t.WithStylusClick=function(e){var t=e.children,n=e.clickHandler;return i.default.cloneElement(t,{onClick:n,onTouchStart:function(e){return s.supportStylus(e,n)},onTouchEnd:function(e){return s.supportStylus(e,n)}})}},"../node_modules/@tencent/netcheck/lib/index.js":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o,r=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),i=n.n(r),a=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(t){i(t)}}function s(e){try{l(o.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},s=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};!function(e){e.OFF_LINE="offline",e.ON_LINE="online"}(o||(o={}));window.__offlinetest=!1;var l=function(){function e(){this.duration=15e3,this.status=navigator.onLine?o.ON_LINE:o.OFF_LINE,this.callbacks=[],this.handleVisibility=this.handleVisibility.bind(this),this.bindVisibility()}return e.prototype.bindVisibility=function(){var e;"undefined"!==typeof document.hidden?e="visibilitychange":"undefined"!==typeof document.mozHidden?e="mozvisibilitychange":"undefined"!==typeof document.msHidden?e="msvisibilitychange":"undefined"!==typeof document.webkitHidden&&(e="webkitvisibilitychange"),window.mqq&&i.a.isAndroid&&(i.a.isTencentDocsApp||i.a.isTimOrQQ)&&!i.a.isQQMiniProgram?window.mqq.addEventListener("qbrowserVisibilityChange",this.handleVisibility):document.addEventListener(e,this.handleVisibility)},e.prototype.handleVisibility=function(){document.hidden||document.webkitHidden||document.msHidden||document.mozHidden?this.pause():this.startChect()},e.prototype.pause=function(){clearTimeout(this.Timer),this.Timer=null},e.prototype.init=function(){var e=this;return this.netcheck().then((function(t){e.status=t})),window.addEventListener("online",this.handleNetstatus.bind(this)),window.addEventListener("offline",this.handleNetstatus.bind(this)),this.startChect(),this},e.prototype.startChect=function(){this.Timer||(this.Timer=setInterval(this.polling.bind(this),this.duration))},e.prototype.polling=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,this.netcheck()];case 1:return e=t.sent(),this.status!==e&&(this.status=e,this.handleCalback()),[2]}}))}))},e.prototype.netcheck=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return this.netcheckImage||(this.netcheckImage=new Image),this.netcheckImage.src="https://pub.idqqimg.com/pc/misc/files/20200114/390bc96befed3c9fe3aa1d013695fb41.gif?t="+Date.now(),[2,new Promise((function(t){e.netcheckImage.onload=function(){t(o.ON_LINE)},e.netcheckImage.onerror=function(){t(o.OFF_LINE)}}))]}))}))},Object.defineProperty(e.prototype,"isOnline",{get:function(){return!window.__offlinetest&&this.status===o.ON_LINE},enumerable:!0,configurable:!0}),e.prototype.handleNetstatus=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return e=this,[4,this.netcheck()];case 1:return e.status=t.sent(),this.handleCalback(),[2]}}))}))},e.prototype.handleCalback=function(){var e=this;this.callbacks.forEach((function(t){t(e.status)}))},e.prototype.changeEnd=function(e){this.callbacks.push(e)},e.prototype.remove=function(e){for(var t=this.callbacks.slice(0,this.callbacks.length),n=0;n<t.length;n++)t[n]===e&&(t.splice(n,1),this.callbacks=t)},e}(),u=(new l).init()},"../node_modules/lodash/throttle.js":function(e,t,n){var o=n("../node_modules/lodash/debounce.js"),r=n("../node_modules/lodash/isObject.js");e.exports=function(e,t,n){var i=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return r(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),o(e,t,{leading:i,maxWait:t,trailing:a})}},"./src/base/dynamicImport/config.ts":function(e,t,n){"use strict";var o;!function(e){e[e.CORE_SHEET=0]="CORE_SHEET",e[e.CORE_SHEET_LAZY=1]="CORE_SHEET_LAZY",e[e.SPREADSHEET_APP_EDIT=2]="SPREADSHEET_APP_EDIT",e[e.VIEW_TABLECONTENT_LAZY=3]="VIEW_TABLECONTENT_LAZY",e[e.SPREADSHEET_APP_TOOL_LAZY=4]="SPREADSHEET_APP_TOOL_LAZY",e[e.ERROR_CODE=5]="ERROR_CODE",e[e.ERROR_CODE_MODAL=6]="ERROR_CODE_MODAL",e[e.REPORT=7]="REPORT",e[e.MESSAGE_CENTER=8]="MESSAGE_CENTER",e[e.SOCKET=9]="SOCKET",e[e.REQUEST_API=10]="REQUEST_API",e[e.CALCCONTROLLER=11]="CALCCONTROLLER",e[e.PC_SIDE_CANVAS=12]="PC_SIDE_CANVAS",e[e.PAD_SIDE_CANVAS=13]="PAD_SIDE_CANVAS",e[e.MOBILE_SIDE_CANVAS=14]="MOBILE_SIDE_CANVAS",e[e.EXCEL_PLUGIN_PC=15]="EXCEL_PLUGIN_PC",e[e.EXCEL_PLUGIN_MOBILE=16]="EXCEL_PLUGIN_MOBILE",e[e.EXCEL_PLUGIN_PAD=17]="EXCEL_PLUGIN_PAD",e[e.FEATURE=18]="FEATURE",e[e.PC_HEADER=19]="PC_HEADER",e[e.MOBILE_HEADER=20]="MOBILE_HEADER",e[e.PC_TOOL_BAR=21]="PC_TOOL_BAR",e[e.MOBILE_TOOL_BAR=22]="MOBILE_TOOL_BAR",e[e.PC_SHEET_BAR=23]="PC_SHEET_BAR",e[e.MOBILE_SHEET_BAR=24]="MOBILE_SHEET_BAR",e[e.PAD_SHEET_BAR=25]="PAD_SHEET_BAR",e[e.READONLY_SHEETSBAR=26]="READONLY_SHEETSBAR",e[e.SHEETSBAR_MANAGE=27]="SHEETSBAR_MANAGE",e[e.PC_DISCUSS=28]="PC_DISCUSS",e[e.MOBILE_DISCUSS=29]="MOBILE_DISCUSS",e[e.PREVIEW=30]="PREVIEW",e[e.FILE=31]="FILE",e[e.WORKBENCH=32]="WORKBENCH",e[e.OFFLINE_EDIT=33]="OFFLINE_EDIT",e[e.UI_MANAGER=34]="UI_MANAGER",e[e.PC_RANGE_AUTH=35]="PC_RANGE_AUTH",e[e.MOBILE_RANGE_AUTH=36]="MOBILE_RANGE_AUTH",e[e.WATERMARK=37]="WATERMARK",e[e.TITLE_SYNC=38]="TITLE_SYNC",e[e.DOCUMENT_SYNC=39]="DOCUMENT_SYNC",e[e.FULL_MEMBER=40]="FULL_MEMBER",e[e.RECORD_MODAL=41]="RECORD_MODAL",e[e.USER_GUIDE=42]="USER_GUIDE",e[e.RESET_LOCATION=43]="RESET_LOCATION",e[e.SERRCH_REPLACE=44]="SERRCH_REPLACE",e[e.SHARE=45]="SHARE",e[e.MENTION=46]="MENTION"}(o||(o={})),t.a=o},"./src/core/behavior/index.ts":function(e,t,n){"use strict";var o,r=n("../packages/mutation/src/api.ts"),i=n("../packages/mutation/src/MutationId.ts"),a=n("../packages/mutation/src/MutationOperationType.ts"),s=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),l=n("../packages/mutation/src/cell/SetRangeMutation.ts"),u=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts");!function(e){e[e.ReverseOrder=0]="ReverseOrder",e[e.PositiveSequence=1]="PositiveSequence"}(o||(o={}));var c,d,f,p,h=o,m=n("./src/core/behavior/request/workbook/filterUtils/searchCloseDataArea.ts"),g=n("./src/core/behavior/request/Type.ts");(p=c||(c={})).MutationBehavior=r.a,(f=p.Mutation||(p.Mutation={})).MUTATION_ID=i.b,f.MUTATION_OPERATION_TYPE=a.a,f.SetRangeMutation=l.a,f.SetCellPropertiesMutation=u.a,(p.Request||(p.Request={})).REQUEST_ID=g.a,(d=p.Interface||(p.Interface={})).ReorderType=h,d.DIMENSION_PROPERTIES_SLOT=s.a,(p.Utils||(p.Utils={})).searchCloseDataArea=m.a;t.a=c},"./src/core/behavior/request/Type.ts":function(e,t,n){"use strict";var o;!function(e){e[e.INSERT_DIMENSION_REQUEST=0]="INSERT_DIMENSION_REQUEST",e[e.DELETE_DIMENSION_REQUEST=1]="DELETE_DIMENSION_REQUEST",e[e.MOVE_DIMENSION_REQUEST=2]="MOVE_DIMENSION_REQUEST",e[e.SET_DIMENSION_SIZE_REQUEST=3]="SET_DIMENSION_SIZE_REQUEST",e[e.SET_DIMENSION_HIDE_REQUEST=4]="SET_DIMENSION_HIDE_REQUEST",e[e.SET_DIMENSION_SHOW_REQUEST=5]="SET_DIMENSION_SHOW_REQUEST",e[e.ADD_IMAGE_REQUEST=6]="ADD_IMAGE_REQUEST",e[e.DELETE_IMAGE_REQUEST=7]="DELETE_IMAGE_REQUEST",e[e.UPDATE_IMAGE_REQUEST=8]="UPDATE_IMAGE_REQUEST",e[e.MERGE_CELLS_REQUEST=9]="MERGE_CELLS_REQUEST",e[e.UNMERGE_CELLS_REQUEST=10]="UNMERGE_CELLS_REQUEST",e[e.SET_SHEETS_REQUEST=11]="SET_SHEETS_REQUEST",e[e.SET_FORMAT_REQUEST=12]="SET_FORMAT_REQUEST",e[e.REORDER_RANGE_REQUEST=13]="REORDER_RANGE_REQUEST",e[e.FREEZE_REQUEST=14]="FREEZE_REQUEST",e[e.SET_SINGLE_VALUE_REQUEST=15]="SET_SINGLE_VALUE_REQUEST",e[e.SET_BORDERS_REQUEST=16]="SET_BORDERS_REQUEST",e[e.COPY_PASTE_REQUEST=17]="COPY_PASTE_REQUEST",e[e.CUT_PASTE_REQUEST=18]="CUT_PASTE_REQUEST",e[e.PASTE_DATA_REQUEST=19]="PASTE_DATA_REQUEST",e[e.CLEAR_FORMAT_REQUEST=20]="CLEAR_FORMAT_REQUEST",e[e.REPLACE_ALL_REQUEST=21]="REPLACE_ALL_REQUEST",e[e.SET_LINK_REQUEST=22]="SET_LINK_REQUEST",e[e.CLEAR_LINK_REQUEST=23]="CLEAR_LINK_REQUEST",e[e.CLEAR_RANGE_REQUEST=24]="CLEAR_RANGE_REQUEST",e[e.SET_NUMBER_FORMAT_REQUEST=25]="SET_NUMBER_FORMAT_REQUEST",e[e.ADJUST_DECIMALS_REQUEST=26]="ADJUST_DECIMALS_REQUEST",e[e.AUTO_FILL_REQUEST=27]="AUTO_FILL_REQUEST",e[e.SET_BASIC_FILTER_REQUEST=28]="SET_BASIC_FILTER_REQUEST",e[e.CLEAR_BASIC_FILTER_REQUEST=29]="CLEAR_BASIC_FILTER_REQUEST",e[e.EXPAND_DIMENSION_REQUEST=30]="EXPAND_DIMENSION_REQUEST",e[e.UPDATE_FILTER_CRITERIA_REQUEST=31]="UPDATE_FILTER_CRITERIA_REQUEST",e[e.SET_RANGE_VALUE_REQUEST=32]="SET_RANGE_VALUE_REQUEST",e[e.MULTI_REQUEST=33]="MULTI_REQUEST",e[e.CLEAR_COMMENT_REQUEST=34]="CLEAR_COMMENT_REQUEST",e[e.UPDATE_COMMENT_REQUEST=35]="UPDATE_COMMENT_REQUEST",e[e.DEFINE_COMMENT_RANGE_REQUEST=36]="DEFINE_COMMENT_RANGE_REQUEST",e[e.DELETE_COMMENT_RANGE_REQUEST=37]="DELETE_COMMENT_RANGE_REQUEST",e[e.SET_DIMENSION_FORMDATA_REQUEST=38]="SET_DIMENSION_FORMDATA_REQUEST",e[e.SET_DATA_VALIDATION_REQUEST=39]="SET_DATA_VALIDATION_REQUEST",e[e.REORDER_FILTER_REQUEST=40]="REORDER_FILTER_REQUEST",e[e.SET_HIDE_GRIDLINES_REQUEST=41]="SET_HIDE_GRIDLINES_REQUEST",e[e.ADD_CONDITIONAL_FORMAT_REQUEST=42]="ADD_CONDITIONAL_FORMAT_REQUEST",e[e.UPDATE_CONDITIONAL_FORMAT_REQUEST=43]="UPDATE_CONDITIONAL_FORMAT_REQUEST",e[e.DELETE_CONDITIONAL_FORMAT_REQUEST=44]="DELETE_CONDITIONAL_FORMAT_REQUEST",e[e.INSERT_SHEET_REQUEST=45]="INSERT_SHEET_REQUEST",e[e.DELETE_SHEET_REQUEST=46]="DELETE_SHEET_REQUEST",e[e.MOVE_SHEET_REQUEST=47]="MOVE_SHEET_REQUEST",e[e.HIDE_SHEET_REQUEST=48]="HIDE_SHEET_REQUEST",e[e.RENAME_SHEET_REQUEST=50]="RENAME_SHEET_REQUEST",e[e.COPY_SHEET_REQUEST=51]="COPY_SHEET_REQUEST",e[e.ADD_PROTECTED_RANGE_REQUEST=52]="ADD_PROTECTED_RANGE_REQUEST",e[e.UPDATE_PROTECTED_RANGE_REQUEST=53]="UPDATE_PROTECTED_RANGE_REQUEST",e[e.DELETE_PROTECTED_RANGE_REQUEST=54]="DELETE_PROTECTED_RANGE_REQUEST",e[e.ADD_EMBEDDED_OBJECT=55]="ADD_EMBEDDED_OBJECT",e[e.UPDATE_EMBEDDED_OBJECT=56]="UPDATE_EMBEDDED_OBJECT",e[e.DELETE_EMBEDDED_OBJECT=57]="DELETE_EMBEDDED_OBJECT",e[e.MOVE_EMBEDDED_OBJECT_TO_SHEET=58]="MOVE_EMBEDDED_OBJECT_TO_SHEET",e[e.SWITCH_FILTER_SYNC_REQUEST=59]="SWITCH_FILTER_SYNC_REQUEST",e[e.SET_IGNORED_ERROR_FLAGS=60]="SET_IGNORED_ERROR_FLAGS",e[e.ADD_LINKED_RANGE_REQUEST=61]="ADD_LINKED_RANGE_REQUEST",e[e.SET_HYPERLINK_RUNS_REQUEST=62]="SET_HYPERLINK_RUNS_REQUEST",e[e.SET_METADATA=63]="SET_METADATA",e[e.SET_REF_IDS=64]="SET_REF_IDS"}(o||(o={})),t.a=o},"./src/core/feature/relateForm/api.ts":function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return c}));n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js");var o=n("./src/core/data/configService/spreadConfig.ts"),r=n("../packages/utils/src/safe.ts"),i=(window.CoreSheet,25),a=100,s=function(e,t){e.length>i&&(e=e.slice(0,i));var n,r=Date.now(),s=!e.length,l=o.a.getConfig("isUserChangeTitle")?o.a.getConfig("title"):"",u={formName:"\u65e0\u6807\u9898\u6536\u96c6\u8868",updateTime:r,title:l,subtitle:"",author:o.a.getConfig("userName"),themeClass:"default",padId:o.a.getConfig("padId"),isDirty:!0,rightBarClicked:!1,globalPadId:o.a.getConfig("globalPadId")};return n=s?function(e){return[{id:"blank-1",section:0,title:"\u672a\u547d\u540d\u7684\u95ee\u9898",subtitle:"",placeholder:"\u8f93\u5165\u95ee\u9898\uff0c\u4f8b\u5982\u201c\u4f60\u7684\u59d3\u540d\u201d",isDirty:!1,createTime:e,updateTime:e,type:"SIMPLE",qdata:{placeholder:"\u8bf7\u586b\u5199"},validate:[{type:12,rules:{max:100,open:!1},message:"\u8f93\u5165\u5185\u5bb9\u9700\u4e0d\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002"}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}},{id:"blank-2",section:0,title:"\u672a\u547d\u540d\u7684\u95ee\u9898",subtitle:"",placeholder:"\u8f93\u5165\u95ee\u9898\uff0c\u4f8b\u5982\u201c\u4f60\u7684\u6027\u522b\u201d",isDirty:!1,createTime:e,updateTime:e,type:"RADIO",qdata:{options:[{id:111,title:"\u9009\u9879 1"},{id:222,title:"\u9009\u9879 2"}]},validate:null,toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1}}]}(r):e.map((function(e,t){return function(e,t,n){return{id:"blank-".concat(e),section:0,title:t.length>a?t.substr(0,a):t,subtitle:"",placeholder:"\u8f93\u5165\u95ee\u9898\uff0c\u4f8b\u5982\u201c\u4f60\u7684\u59d3\u540d\u201d",isDirty:!0,createTime:n,updateTime:n,type:"SIMPLE",qdata:{placeholder:"\u8bf7\u586b\u5199"},validate:[{type:12,rules:{max:100,open:!1},message:"\u8f93\u5165\u5185\u5bb9\u4e0d\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002"}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}}}(t,e,r)})),s&&!t||(u.questions=n,u.sections=[{sid:0,title:"",qlist:n.map((function(e){return null===e||void 0===e?void 0:e.id}))}]),u};function l(e,t,n,i){var a={sheet_id:{doc_id:o.a.getConfig("globalPadId"),sub_id:e},form_text:"",form_title:t||"",need_create_sub_sheet:!0,sub_sheet_name:t},l=s(n||[],i);return l.title=a.form_title,a.form_text=JSON.stringify(l),new Promise((function(e,t){$.ajax({url:"//".concat(location.host,"/form/collect/from_sheet"),type:"POST",xhrFields:{withCredentials:!0},data:{data:JSON.stringify(a),xsrf:Object(r.b)()},success:function(t){e(t)},error:function(e){t(e)}})}))}function u(e){var t={global_padid:e};return new Promise((function(e,n){$.ajax({url:"https://".concat(location.host,"/form/collect/recordcnt"),type:"POST",xhrFields:{withCredentials:!0},data:{data:JSON.stringify(t),xsrf:Object(r.b)()},success:function(t){e(t)},error:function(e){n(e)}})}))}function c(e){var t={bind:!1,sheet_id:{doc_id:o.a.getConfig("globalPadId")}};return new Promise((function(e,n){$.ajax({url:"//".concat(location.host,"/form/collect/bind_sheet"),type:"POST",xhrFields:{withCredentials:!0},data:{data:JSON.stringify(t),xsrf:Object(r.b)()},success:function(t){e(t)},error:function(e){n(e)}})}))}},"./src/core/feature/relateForm/helper.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");function o(e,t){var n=new RegExp("(.*)\\((\\d*)\\)"),o="",r=0;if(n.test(t)){var i=t.match(n);i&&(o=i[1])}else o=t;return e.forEach((function(e){var t=e.match(n);if(t&&o===t[1]){var i=t[2];if(i){var a=Number(i);a>=r&&(r=a+1)}else r=r||1}})),r?"".concat(o,"(").concat(r,")"):t}},"./src/core/feature/relateForm/index.ts":function(e,t,n){"use strict";n.r(t),function(e){n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/regenerator-runtime/runtime.js");var o=n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=n("../packages/model/src/index.ts"),l=n("./src/base/index.ts"),u=n("./src/core/ui/index.ts"),c=n("./src/core/utils/index.ts"),d=n("./src/core/behavior/index.ts"),f=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),p=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),h=n.n(p),m=n("./src/core/feature/relateForm/api.ts"),g=n("./src/core/feature/relateForm/toastContent.tsx"),b=n("./src/core/data/configService/spreadConfig.ts"),_=n("./src/core/ui/toast/toast.tsx"),E=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),v=n.n(E),y=n("../packages/model/src/sheet/sheetUtils.ts"),R=n("./src/core/feature/relateForm/helper.ts"),T=n("../packages/model/src/sheet/index.ts"),S=n("./src/core/feature/relateForm/seeker.ts"),w=n("../packages/report/src/index.ts");function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=e,O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w.b.tdwReport(j({opername:"doc_form",module:"excel",action:e},t))},A=!1,I=function(e){var t,n=k.mqq;if(v.a.isQQMiniProgram){var o=e;e.indexOf("//")>=0&&-1===e.indexOf("https")&&(o="https:".concat(e));var r="/pages/detail/detail?url=".concat(encodeURIComponent(o));k.wx.miniProgram.redirectTo({url:"/pages/jump/jump?url=".concat(encodeURIComponent(r))})}else if(v.a.isWxMiniProgram)k.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url=".concat(encodeURIComponent(e))});else{if(!v.a.isIPad||!v.a.isTencentDocsApp)return(null===n||void 0===n||null===(t=n.ui)||void 0===t?void 0:t.openUrl)?(n.ui.openUrl({url:e,target:0,style:3}),!0):!!k.open(e);Object(f.tencentDocOpenUrl)(e)}},C=null,N=function(){function e(t){Object(r.a)(this,e),t&&this.init(t)}return Object(i.a)(e,[{key:"init",value:function(e){this.app=e,this.initRelation(),this.initToolbarEntry(),this.afterHandleCallbacks=[],this.seeker=new S.a(e)}},{key:"handle",value:function(e,t,n){switch(e){case"new_to_form":this.handleNewToForm();break;case"convert_to_form":this.handleConvertToForm();break;case"check_form":this.handleCheckForm(t);break;case"cancel_form":this.handleCancelForm(t,!!n);break;case"cancel_form_sheetbar":this.handleCancelForm(t,!!n,!0);break;case"share_form":this.handleShareForm(t);break;case"result_form":this.handleResultForm(t);break;case"change_header":this.updateToolbar()}n&&this.afterHandleCallbacks.push(n)}},{key:"checkReleaseCell",value:function(e,t,n){var o=n||this.app.spreadsheet.activeSheet,r=o.data.colMetadata,i=o.data.rowMetadata,a=null===r||void 0===r?void 0:r[t],s=null===i||void 0===i?void 0:i[e],l=null===a||void 0===a?void 0:a.formData,u=null===s||void 0===s?void 0:s.formData;if(l&&u){if("question"===u.formDataId)return 1;if(u.formDataId.indexOf("record")>=0)return 2}return 0}},{key:"checkReleaseRange",value:function(e,t,n,o){for(var r=e.startColIndex,i=e.startRowIndex,a=e.endColIndex,s=e.endRowIndex,l=0,u=i;u<=s;u++)for(var c=r;c<=a;c++){var d=null===n||void 0===n?void 0:n[c],f=null===t||void 0===t?void 0:t[u],p=null===d||void 0===d?void 0:d.formData,h=null===f||void 0===f?void 0:f.formData;if(p&&h){if("question"===h.formDataId?l=1:h.formDataId.indexOf("record")>=0&&(l=2),l===o||l&&3===o)return 3===o?3:l;if(l&&4===o)return 4}}return l=0}},{key:"isRelated",value:function(e){return e in this.relateMap}},{key:"isLoading",value:function(){return this.needShowLoading}},{key:"getRelatedSheetId",value:function(){return Object.keys(this.relateMap)[0]}},{key:"getRelatedNumber",value:function(){return Object.keys(this.relateMap).length}},{key:"updateFromSheetHeaderSync",value:function(e,t){var n=this.isRelated(e),o=t===s.Sheet.SHEET_TYPE.FORM;o&&!n?(this.updateRelateMap(e,{}),this.updateUI()):!o&&n&&(this.updateRelateMap(e,null),this.updateUI())}},{key:"updateFromSyncMutations",value:function(e,t){for(var n=!1,o=0;o<e.length&&!n;o++){var r=e[o];if(!Array.isArray(r))break;for(var i=0;i<r.length;i++){var a=this.app.mutationBehavior.deserializeMutation(r[i]),s=d.a.Mutation.MUTATION_ID.DELETE_SHEET_RANGE_MUTATION,l=["<author>","<time>"].indexOf(a.workbookRangeId)>-1;if((null===a||void 0===a?void 0:a.workbookRangeId)&&a.id===s&&l){n=!0;break}}}n&&(this.updateRelateMap(t,null),this.updateUI())}},{key:"checkFormSyncExceptions",value:function(){return!1}},{key:"continueCheck",value:function(){}},{key:"stopCheckSync",value:function(){l.a.util.timer.erase(this.checkTimeFlag)}},{key:"isOpenDialog",value:function(){return!!C}},{key:"updateSelectedData",value:function(){var e;null===(e=C)||void 0===e||e.onSheetUpdate(this.getSheetTitle())}},{key:"hideSelectQuestionDailog",value:function(){var e;null===(e=C)||void 0===e||e.hide()}},{key:"initRelation",value:function(){var e=this;this.relateMap=Object.create(null);var t=b.a.getConfig("isOwner"),n=b.a.getConfig("relative")||[],o=this.app.spreadsheet.sheetManager.sheetList.map((function(e){return e.getSheetId()}));this.globalId=n[0]?"".concat(n[0].doc_id.domain_id,"$").concat(n[0].doc_id.pad_id):"";var r="",i="";n.forEach((function(t){var n=(null===t||void 0===t?void 0:t.sub_id)&&t.doc_url;t.doc_id&&(r="".concat(t.doc_id.domain_id,"$").concat(t.doc_id.pad_id),i=t.doc_url),n&&o.indexOf(t.sub_id)>-1&&(e.relateMap[t.sub_id]={formUrl:t.doc_url})})),""!==r&&!A&&t&&(A=!0,this.checkLimitTips(r,i)),this.getRelatedNumber()&&w.b.tdwReport({opername:"doc_core",module:"visit",action:"detail_page",ver6:1})}},{key:"initToolbarEntry",value:function(){var e=this;k.addEventListener("load",(function(){e.updateToolbar()}),!1),this.updateToolbar()}},{key:"checkLimitTips",value:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.c)(t).then((function(e){var t=e.del_cnt,o=e.total_cnt-t>=7e3;if(0===e.code&&o){var r="\u6536\u96c6\u7ed3\u679c\u5df2\u8d85\u8fc77000\u884c\uff0c\u8bf7\u5230\u539f\u6536\u96c6\u8868\u4e0b\u8f7d\u672c\u5730\u6587\u4ef6\u67e5\u770b\u5b8c\u6574\u7ed3\u679c\u3002",i="\u8df3\u8f6c\u539f\u6536\u96c6\u8868",a={message:r,type:"info",autoClose:!1,closable:!0,action:i,zIndex:10002,onClickAction:function(){I(n)}};(v.a.isMobilePhone||v.a.isAndroidPad)&&(a={message:r="\u5df2\u8d857000\u884c\uff0c\u5230\u6536\u96c6\u8868\u4e0b\u8f7d\u67e5\u770b\u3002",type:"info",autoClose:!0,closable:!0,duration:3e3,action:i="\u8df3\u8f6c",zIndex:10002,onClickAction:function(){I(n)}}),h.a.show(a)}})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getRelation",value:function(e){return this.relateMap[e]||null}},{key:"getToolbarEntryElement",value:function(){var e=this.toolbarEntryElement;return e||(e=document.querySelector("#toolbar-form-dropdown-group"),this.toolbarEntryElement=e),e}},{key:"showToolbarEntry",value:function(){var e=this.getToolbarEntryElement();e&&(e.style.display="")}},{key:"hideToolbarEntry",value:function(){var e=this.getToolbarEntryElement();e&&(e.style.display="none")}},{key:"getSheetName",value:function(e){var t=e||this.getTitle();return Object(R.a)(this.app.spreadsheet.sheetManager.getSheetTitleList(),t)}},{key:"createNewSheet",value:function(e){var t=this;return new Promise((function(n,o){var r=t.getCurrentSheet(),i=e||t.getTitle(),a=Object(y.generateSheetId)();t.app.requestApi.insertSheet({sheetId:a,sheetType:T.SHEET_TYPE.FORM,sheetIndex:t.app.spreadsheet.activeSheet.getIndex()+1,sheetName:"".concat(Object(R.a)(t.app.spreadsheet.sheetManager.getSheetTitleList(),i))}).then((function(){n({sheetId:a,sheetName:r?r.getTitle():i})})).catch((function(e){console.error(e),o(e)}))}))}},{key:"switchToRelatedSheet",value:function(e){l.a.event.sheetsBar.trigger("switchSheet",e||this.getRelatedSheetId(),this.getCurrentSheetId())}},{key:"getSheetTitle",value:function(){return b.a.getConfig("isUserChangeTitle")?b.a.getConfig("title"):""}},{key:"getTitle",value:function(){var e=this.getSheetTitle()||"\u65e0\u6807\u9898\u6536\u96c6\u8868";return e.length>32?e.substr(0,32):e}},{key:"getCurrentSheet",value:function(){var e=this.app.spreadsheet.activeSheetId;return this.app.spreadsheet.sheetManager.getSheetBySheetId(e)}},{key:"getCurrentSheetId",value:function(){var e=this.getCurrentSheet();return(null===e||void 0===e?void 0:e.getSheetId())||""}},{key:"createSuccess",value:function(e,t,n){(null===t||void 0===t?void 0:t.url)?(this.updateRelateMap(e,t),this.updateUI(),this.gotoFormEditPage(t.url,!0),this.handleDone(),O("expo_formbar",{ver5:n?1:2}),v.a.isMobilePhone||v.a.isAndroidPad?w.b.monitor(33647158):w.b.monitor(33647157)):this.createFail(e,t)}},{key:"createFail",value:function(e,t){var n=t&&(t.msg||t.errmsg);this.showToolToast(n?"\u521b\u5efa\u5173\u8054\u6536\u96c6\u8868\u5931\u8d25\uff1a".concat(n,"\u3002"):"\u7f51\u7edc\u5f02\u5e38\uff0c\u521b\u5efa\u5931\u8d25\u3002"),l.a.event.sheetsBar.trigger("deleteSheet",e)}},{key:"handleDone",value:function(){for(;this.afterHandleCallbacks.length;){var e=this.afterHandleCallbacks.shift();e&&e()}}},{key:"resetSheetType",value:function(e){var t=this.app.spreadsheet.sheetManager.getSheetBySheetId(e);if(t){t.setSheetType(s.Sheet.SHEET_TYPE.GRID);var n=this.app.spreadsheet.sheetManager.sheetList,o=c.a.sheet.getAllSheets(n);this.app.requestApi.setSheet({opt:{sheetId:e,behaviors:o,oSubId:!1,withKeyData:!1}})}}},{key:"updateUI",value:function(){this.updateToolbar(),this.updateSheetbar()}},{key:"updateSheetbar",value:function(){l.a.event.sheetsBar.trigger("bindStatusChange")}},{key:"updateToolbar",value:function(){var e=this.getRelatedNumber();b.a.getConfig("isCreator")&&e?this.showToolbarEntry():this.hideToolbarEntry()}},{key:"updateRelateMap",value:function(e,t){t?this.relateMap[e]={formUrl:t.url}:delete this.relateMap[e]}},{key:"getFormUrl",value:function(e,t){return this.getRelation(e).formUrl+(t||"")}},{key:"getRealUrl",value:function(e){var t=e.split("#");return e.includes("?")?"https:".concat(e):2===t.length?"https:".concat(t[0],"?form=sheet#").concat(t[1]):"https:".concat(e,"?form=sheet#/edit")}},{key:"gotoFormEditPage",value:function(e,t){var n=this,o=this.getRealUrl(e),r=I(o);if(t)if(r)this.switchToRelatedSheet();else{var i=Object(g.a)(e);Object(_.showToast)(i,void 0,{showCloseBtn:!0});var a=document.querySelector("#relate-form-url");a&&a.addEventListener("click",(function(){n.switchToRelatedSheet(),u.a.toast.hideToast()}))}}},{key:"loadSheetSlient",value:function(e){var t=this.app.spreadsheet.sheetManager.getSheetBySheetId(e);t&&(t.isLoaded||this.app.dataCenter.loadSheetData({sheetId:e,ignoreLoader:!0,onSuccess:function(){}}))}},{key:"handleNewToForm",value:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n,o,r,i,a,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.getRelatedNumber()>0)){e.next=2;break}return e.abrupt("return");case 2:t=this.getSheetTitle(),n=this.seeker.getHeader(),o=v.a.isMobile?n.headDatas:[],r=o.map((function(e){return e.value})),i=this.getSheetName(t),a=Object(y.generateSheetId)(),Object(m.b)(a,i,r,!0).then((function(e){s.afterCreateForm(a,e,!0)})).catch((function(e){s.createFail(a,e)})),O("clk_toolbar_create");case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleConvertToForm",value:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){var t,o,r,i,a,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.getRelatedNumber()>0)){e.next=2;break}return e.abrupt("return");case 2:if(t=this.seeker.getHeader()){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,n.e("bundle_relate_form_question_dialog").then(n.bind(null,"./src/core/feature/relateForm/questionDialog/index.tsx"));case 7:o=e.sent,r=this.getCurrentSheet(),i=(null===r||void 0===r?void 0:r.getTitle())||"",a=this.getSheetTitle(),C=o.default(this.app,t,i,(function(e){s.afterQuestionListSelected(a,e)}),(function(){C=null})),O("clk_sheetcon_create");case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"afterQuestionListSelected",value:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t,n){var o,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=this.getSheetName(t),r=Object(y.generateSheetId)(),this.loadSheetSlient(r),Object(m.b)(r,o,n).then((function(e){i.afterCreateForm(r,e,!1)})).catch((function(e){i.createFail(r,e)})),O("clk_sheet_create");case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"afterCreateForm",value:function(e,t,n){this.createSuccess(e,t,n)}},{key:"handleCheckForm",value:function(e){var t=e||this.getCurrentSheetId();if(this.isRelated(t)){var n=this.getFormUrl(t,"?openfrom=sheet_check");this.gotoFormEditPage(n),O("clk_formbar_view")}}},{key:"handleCancelForm",value:function(e,t,n){var o=this,r=e||this.getCurrentSheetId();if(this.isRelated(r)){var i=function(){return Object(m.a)(r).then((function(e){o.cancelSuccess(r,e,n)})).catch((function(e){o.showToolToast("\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}))};if(t)i();else{u.a.dialog.dialog.confirm({title:"\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868",content:"\u786e\u5b9a\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868\u5417\uff1f\u53d6\u6d88\u5173\u8054\u540e\uff0c\u6536\u96c6\u7684\u7ed3\u679c\u5c06\u4e0d\u518d\u81ea\u52a8\u66f4\u65b0\u5230\u5f53\u524d\u8868\u683c\u3002",onOk:function(){i(),O(n?"clk_sheet_cancel":"clk_formbar_cancel")}})}}}},{key:"cancelSuccess",value:function(e,t,n){t&&0===t.retcode?(this.updateRelateMap(e,null),this.updateUI(),this.resetSheetType(e),this.handleDone(),n||this.showToolToast("\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868\u6210\u529f\u3002")):this.showToolToast("\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}},{key:"showToolToast",value:function(e){Object(_.showToast)(e,{},{toolToastCloseTime:3e3})}},{key:"handleShareForm",value:function(e){var t=e||this.getCurrentSheetId();if(this.isRelated(t)){var n=this.getFormUrl(t,"?openfrom=sheet_share");this.gotoFormEditPage(n),O("clk_formbar_share")}}},{key:"handleResultForm",value:function(e){var t=e||this.getCurrentSheetId();if(this.isRelated(t)){var n=this.getFormUrl(t,"#/result");this.gotoFormEditPage(n),O("clk_formbar_result")}}}]),e}();t.default=N}.call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/feature/relateForm/seeker-util.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return _})),n.d(t,"c",(function(){return E}));n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.every.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.some.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),r=n("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),i=n("../packages/model/src/range/GridRange.ts"),a=n("../node_modules/lodash/throttle.js");function s(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var u=/(\u5e8f\u53f7|\u7f16\u53f7|\u59d3\u540d|\u540d\u5b57|\u540d\u79f0|\u4eba\u5458|\u6210\u5458|\u5546\u54c1\u540d\u79f0|\u8d1f\u8d23\u4eba|\u5c97\u4f4d|\u804c\u4f4d|\u6027\u522b|\u7535\u8bdd|\u8054\u7cfb\u65b9\u5f0f|\u53f7\u7801|\u624b\u673a\u53f7|\u6c11\u65cf|\u7c4d\u8d2f|\u6bd5\u4e1a\u9662\u6821|\u4e13\u4e1a|\u5b66\u4f4d|\u5b66\u5386|\u8eab\u4efd\u8bc1|\u8eab\u4efd\u8bc1\u53f7\u7801|\u6237\u53e3\u6240\u5728\u5730|\u91d1\u989d|\u7c7b\u578b|\u5de5\u4f5c\u5355\u4f4d|\u5e74\u9f84|\u9879\u76ee|\u7c7b\u522b|\u5206\u7c7b|\u4e8b\u9879|\u4ea7\u54c1|\u65e5\u671f|\u65f6\u95f4|\u65e5\u671f\u65f6\u95f4|\u661f\u671f|\u751f\u65e5|\u51fa\u751f\u6708\u65e5|\u8fdb\u5c55|\u9636\u6bb5\u8fdb\u5c55|\u9636\u6bb5\u6210\u679c|\u9879\u76ee\u8fdb\u5c55|\u9879\u76ee\u6210\u679c|\u72b6\u6001|\u4e0b\u5468\u8ba1\u5212|\u76ee\u6807|\u4efb\u52a1|KPI|OKR|\u5907\u6ce8|\u8bf4\u660e|\u4ef7\u683c|\u552e\u4ef7|\u5355\u4ef7|\u90e8\u95e8|\u8bed\u6587|\u6570\u5b66|\u82f1\u8bed|\u653f\u6cbb|\u5386\u53f2|\u5730\u7406|\u7269\u7406|\u5316\u5b66|\u751f\u7269)/i;function c(e,t){return t.map((function(t){return e[t].values.map((function(e){var t;if(null===(t=e.getMetadata())||void 0===t?void 0:t.customDataType)return null;var n=null===e||void 0===e?void 0:e.getEditValue(),o=null===e||void 0===e?void 0:e.getFormattedValue();return(null===o||void 0===o?void 0:o.value)||n}))}))}function d(e,t){return t.map((function(t){return e[t].values.map((function(e){return null===e||void 0===e?void 0:e.getMergeReference()}))}))}var f=function(e,t){for(var n=t;n>=0;n--)if(e[n])return e[n];return null},p=function(e){for(var t=e[e.length-1];!t;)e.pop(),t=e[e.length-1]};var h=function(e,t){for(var n=[],o=0;o<t.length;o++){var r=t[o];n.push({col:o,row:e,value:r||"-"})}return n};function m(e,t){var n=e.slice(0);if(t.length>1)for(var o=1;o<t.length;o++)for(var r=t[o],i=0;i<e.length;i++){var a=r[i],s=e[i]?e[i]:f(e,i);a&&s&&(n[i]="".concat(s," - ").concat(a))}return n}function g(e,t){var n=t.slice(0);n=function(e,t){var n=c(e,t),o=d(e,t),r=[];return n.forEach((function(e,n){var i=!o[n].every((function(e){return null===e})),a="",s=new Map;e.forEach((function(e){var t=e||"";s.set(t,1),a+=t}));for(var l=0,u=a.length,c=0;c<u;c++)a.charCodeAt(c)>128&&(l+=1);if(!i&&l/u<.2||s.size<2){var d=t[n];r.push(d)}})),r.forEach((function(e){var n=t.indexOf(e);t.splice(n,1)})),t}(e,n);for(var o=c(e,n),i=d(e,n),a=new Map,l=[],u=function(e){var t=o[e],n=i[e],r=i[e-1],s=[],u=function(e,t){if(t){var n="".concat(t.startRowIndex,",").concat(t.endRowIndex);e.includes(n)||e.push(n)}};n.forEach((function(e){return u(l,e)})),r&&r.forEach((function(e){return u(s,e)}));var c=!!l.length,d=!!s.length,f=a.get(e-1);c&&d&&l.some((function(e){return s.includes(e)}))&&f?(f.push(t),a.set(e-1,f)):a.set(e,[t])},f=0;f<o.length;f++)u(f);var h,g=new Map,b=s(a);try{for(b.s();!(h=b.n()).done;){var _=Object(r.a)(h.value,2),E=_[0],v=_[1],y=m(v[0].slice(0),v);p(y),g.set(E,y)}}catch(R){b.e(R)}finally{b.f()}return{cellIndexMap:g,indexs:n,mergeRanges:l}}function b(e,t){for(var n=[],o=0;o<10;o++){if(e[o]){var r=t[o];r&&r.hiddenByUser||n.push(o)}}for(var i=[],a=0;a<n.length;a++){for(var s=n[a],l=e[s].values,u=0,c=0,d=0;d<l.length;d++){var f=l[d];(null===f||void 0===f?void 0:f.getEditValue())?(c+=1)>=2&&(u+=1):c=0}u&&i.push(s)}return i}function _(e,t,n){var o,i=t.cellIndexMap,a=t.indexs,l=t.mergeRanges.map((function(e){return e.split(",").map((function(e){return Number(e)}))})),c=new Map,h=s(i);try{for(h.s();!(o=h.n()).done;){var m=Object(r.a)(o.value,2),g=m[0],b=m[1],_={emptys:0,solids:0,keywords:0,total:0},E=b.slice(0);p(E);for(var v=0;v<E.length;v++){var y=E[v];y||0===v?_.solids+=1:_.emptys-=1,u.test(y)&&(_.keywords+=2)}_.total=_.emptys+_.solids+_.keywords,c.set(g,_)}}catch(I){h.e(I)}finally{h.f()}var R,T=[],S=s(c.values());try{for(S.s();!(R=S.n()).done;){var w=R.value;T.push(w.total)}}catch(I){S.e(I)}finally{S.f()}var x=T.indexOf(Math.max.apply(null,T)),j=Array.from(c.keys())[x],k=a[j];l=l.filter((function(e){var t=Object(r.a)(e,2),n=t[0],o=t[1];return k>=n&&k<=o}));var O=i.get(j)||[];if(l.length&&l.some((function(e){return e[0]===e[1]&&e[0]===k}))){var A=d(e,[k]);Object(r.a)(A,1)[0].forEach((function(e,t){if(e&&t<O.length&&null===O[t]){var o=f(O,t);o&&n?O.splice(t,1,o):O.splice(t,1)}}))}return{headData:O,hitLine:k,merges:l}}function E(e){try{var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.data;if(!n||!n.rowData||!n.rowMetadata)return null;var o=n.rowData,r=n.rowMetadata,i=b(o,r),a=g(o,i),s=_(o,a,t),l=s.headData,u=s.merges,c=s.hitLine;return c>=0?{headDatas:h(c,l),merges:u}:null}(e,!0);if(!t||0===t.headDatas.length)return null;var n=t.headDatas,r=t.merges,a=n[0],s=a.row,l=a.col,u=n[n.length-1].col,c=0===r.length?s:Math.max.apply(Math,Object(o.a)(r.map((function(e){return e[e.length-1]}))));return new i.b(e.getSheetId(),s,c,l,u)}catch(d){return console.error(d),null}}n.n(a)()(E,15)},"./src/core/feature/relateForm/seeker.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.every.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../packages/model/src/range/GridRange.ts"),s=n("./src/base/dynamicImport/config.ts"),l=n("./src/external/rangeAuth/range-auth-plugin-base.ts"),u=n("./src/core/feature/relateForm/seeker-util.ts"),c=n("../packages/model/src/cell/metadata/CustomDataType.ts"),d=function(){function e(t){var n=this;Object(r.a)(this,e),this.onMutationChange=function(){n.panelUpdateFn&&n.panelUpdateFn()},this.onCooperationAddNewRangeDone=function(){n.onMutationChange()},this.app=t}return Object(i.a)(e,[{key:"getHeaderRange",value:function(){return Object(u.c)(this.app.spreadsheet.activeSheet)}},{key:"isFillAble",value:function(){var e=this;if(this.getHeader(),!this.isHit()||this.activeRow<0)return!1;if(Object(o.a)(this.merges,1)[0]){if(!this.merges.every((function(t){var n=t[1];return e.activeRow>n})))return!1}else if(this.activeRow<=this.hitLine)return!1;return!0}},{key:"getHeader",value:function(e){this.activeCol=-1,this.activeRow=-1,this.hitLine=-1,this.merges=[],this.isQuickFill=!!e;try{return this.find()}catch(t){return console.error(t),this.getResult()}}},{key:"addListener",value:function(e){this.panelUpdateFn=e,this.app.mutationBehavior.emitter.addListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.listen(l.a.EVENT.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)}},{key:"removeListener",value:function(){this.panelUpdateFn=null,this.app.mutationBehavior.emitter.removeListener(this.app.mutationBehavior.EVENT.AFTER_MUTATION_RUN,this.onMutationChange),this.app.event.rangeAuthEvent.remove(l.a.EVENT.COOERATION_ADD_NEW_RANGE_DONE,this.onCooperationAddNewRangeDone)}},{key:"isHit",value:function(){return this.hitLine>=0}},{key:"getResult",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{headDatas:e,line:this.hitLine,merges:this.merges,activeCol:this.activeCol,activeRow:this.activeRow,activeRowDatas:this.activeRowDatas||[]}}},{key:"find",value:function(){var e=this.app.spreadsheet.activeSheet.data;if(!e||!e.rowData||!e.rowMetadata)return this.getResult();var t=this.app.view.getSelection();this.activeRow=t.activeCell.rowIndex,this.activeCol=t.activeCell.colIndex;var n=e.rowData,o=e.rowMetadata,r=Object(u.e)(n,o),i=Object(u.b)(n,r),l=Object(u.d)(n,i,this.isQuickFill),d=l.headData,f=l.hitLine,p=l.merges;return this.hitLine=f,this.merges=p,this.isQuickFill&&-1!==this.activeRow?this.activeRowDatas=function(e,t,n,o){for(var r,i,l=[],u=n[t],d=(null===u||void 0===u?void 0:u.values)||[],f=e.spreadsheet.activeSheetId,p=null===(r=e.serviceCollection.services.get(s.a.MOBILE_RANGE_AUTH))||void 0===r?void 0:r.instance,h=null===p||void 0===p||null===(i=p.rangeAuthUtil.getActiveSheetRangeIds())||void 0===i?void 0:i.rangeIds,m=0;m<o;m++){var g=d[m],b=(null===g||void 0===g?void 0:g.getEditValue())||"",_=null===g||void 0===g?void 0:g.getFormula(),E=null===g||void 0===g?void 0:g.getMergeReference(),v=null===g||void 0===g?void 0:g.getUserEnteredFormat(),y=null===v||void 0===v?void 0:v.getDataValidation(),R=null===g||void 0===g?void 0:g.getMetadata();if(!b&&E){var T,S=E.startRowIndex,w=E.startColIndex,x=(E.endColIndex,E.endRowIndex,null===(T=n[S])||void 0===T?void 0:T.values[w]);x&&(b=x.getEditValue()||"")}var j=!0,k=null;if(null===h||void 0===h?void 0:h.length)if(E){var O=E.startRowIndex,A=E.startColIndex,I=E.endColIndex,C=E.endRowIndex;j=e.sheetStatus.getRangeCanEdit(new a.b(f,O,C,A,I))}else j=e.sheetStatus.getRangeCanEdit(new a.b(f,t,t,m,m));(null===R||void 0===R?void 0:R.customDataType)===c.o.IMAGE&&(k={url:e.spreadsheet.activeSheet.imageManager.getImage(g.getRefIds()[0]).url}),l.push({col:m,row:t,value:b,isFormula:!!_,isMerge:!!E,dvRule:(null===y||void 0===y?void 0:y.ruleType)||null,isRangeAuth:j,cellImage:k})}return l}(this.app,this.activeRow,n,d.length):this.activeRowDatas=[],this.isHit()?this.getResult(Object(u.a)(this.hitLine,d)):this.getResult()}}]),e}();t.a=d},"./src/core/feature/relateForm/toastContent.tsx":function(e,t,n){"use strict";var o=n("react");t.a=function(e){return o.createElement("span",null,"\u6536\u96c6\u8868\u5df2\u521b\u5efa\u3002",o.createElement("a",{id:"relate-form-url",href:e,style:{color:"#0086ff"},target:"_blank"},"\u7f16\u8f91\u6536\u96c6\u8868"))}},"./src/core/ui/index.ts":function(e,t,n){"use strict";var o={};n.r(o),n.d(o,"showModal",(function(){return s})),n.d(o,"hideModal",(function(){return l})),n.d(o,"showAuthChangeModal",(function(){return u}));var r=n("./src/core/ui/dialog/index.ts"),i=n("./src/core/ui/alert/index.ts"),a=n("./src/core/ui/lazyLoad.ts"),s=function(e,t,n){Object(a.c)().then((function(o){o.default.showModal(e,t,n)}))},l=function(e,t){Object(a.c)().then((function(n){n.default.hideModal(e,t)}))},u=function(){Object(a.c)().then((function(e){e.default.showAuthChangeModal()}))},c={dialog:r,alert:i,modal:o,toast:n("./src/core/ui/toast/index.ts"),tooltip:n("./src/core/ui/tooltip/index.ts")};t.a=c},"./src/core/ui/tooltip/index.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"toolTip",(function(){return r})),n.d(t,"showTooltip",(function(){return i})),n.d(t,"hideTooltip",(function(){return a})),n.d(t,"changeTooltipText",(function(){return s})),n.d(t,"horizontalTooltip",(function(){return l}));var o=n("./src/core/ui/lazyLoad.ts"),r=function(e,t){Object(o.e)().then((function(n){n.tooltip(e,t)}))},i=function(e,t){Object(o.e)().then((function(n){n.tooltip(e,t)}))},a=function(){Object(o.e)().then((function(e){e.hideTooltip()}))},s=function(e){Object(o.e)().then((function(t){t.changeTooltipText(e)}))},l=function(e,t,n){Object(o.e)().then((function(o){o.horizontalTooltip(e,t,n)}))}},"./src/external/rangeAuth/config/auth-constant.ts":function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return l}));var o,r,i,a,s=[[!1,!1,!1],[!1,!1,!0]];!function(e){e[e.ONLY_I_CAN_EDIT=1]="ONLY_I_CAN_EDIT",e[e.SOME_CAN_EDIT=2]="SOME_CAN_EDIT"}(o||(o={})),function(e){e[e.NO_SET=0]="NO_SET",e[e.CAN_READ=1]="CAN_READ",e[e.CAN_EDIT=2]="CAN_EDIT"}(r||(r={})),function(e){e[e.ONLY_RANGE_AUTH=1]="ONLY_RANGE_AUTH",e[e.SHEET_AUTH_AND_RANGE_AUTH=2]="SHEET_AUTH_AND_RANGE_AUTH"}(i||(i={})),function(e){e[e.SELF=0]="SELF",e[e.COOPERATION=1]="COOPERATION",e[e.VIEWABLE=2]="VIEWABLE",e[e.EDITBLE=3]="EDITBLE"}(a||(a={}));var l={USER_ONLY_VIEW:1,USER_CAN_EDIT:2}},"./src/external/rangeAuth/loader/Loader.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=function e(){Object(o.a)(this,e)}},"./src/external/rangeAuth/loader/OfflineLoader.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/regenerator-runtime/runtime.js");var o=n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=n("./src/external/rangeAuth/loader/Loader.ts"),c=n("../node_modules/@tencent/docs_offline/lib/index.js"),d=n("./src/core/data/configService/spreadConfig.ts"),f=n("./src/external/rangeAuth/util/util.ts");function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(s.a)(this,n)}}var h=function(e){Object(a.a)(n,e);var t=p(n);function n(e){var o;return Object(r.a)(this,n),(o=t.call(this)).app=e,o}return Object(i.a)(n,[{key:"getUserRangePrivilege",value:function(e){var t=this;return new Promise(function(){var n=Object(o.a)(regeneratorRuntime.mark((function n(o,r){var i,a,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,null===(i=t.app.offlineEdit)||void 0===i?void 0:i.offlineDataManager.getHelper(c.FILE_TYPE.EXCEL).getRangePrivilege(d.a.getConfig("globalPadId"),e);case 2:(a=n.sent).error&&r(a.error),s=Object(f.convertToServerRangePrivilege)(a.data.data),o({data:{isOwner:!1,rangeCheckResList:s}});case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}}]),n}(u.a)},"./src/external/rangeAuth/loader/RangeAuthManager.ts":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return b}));n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/regenerator-runtime/runtime.js");var o=n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),r=n("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),i=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=n("./src/external/rangeAuth/loader/ServerLoader.ts"),l=n("./src/external/rangeAuth/loader/OfflineLoader.ts"),u=n("../node_modules/@tencent/netcheck/lib/index.js"),c=n("./src/external/rangeAuth/config/auth-constant.ts"),d=n("./src/external/rangeAuth/util/util.ts"),f=n("./src/core/app/tool.ts"),p=n("../node_modules/@tencent/docs_offline/lib/index.js"),h=n("./src/core/data/configService/spreadConfig.ts");function m(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var b=function(){function t(e){var n=this;if(Object(i.a)(this,t),this.updateLocalUserRangePrivilege=function(e){var t,o,i=[],a=m(Object(d.getProtectedMap)().entries());try{for(a.s();!(o=a.n()).done;){var s=Object(r.a)(o.value,2),l=s[0];s[1];i.push(l)}}catch(u){a.e(u)}finally{a.f()}null===(t=n.app.offlineEdit)||void 0===t||t.offlineDataManager.getHelper(p.FILE_TYPE.EXCEL).cacheRangePrivilege(h.a.getConfig("globalPadId"),Object(d.convertToLocalRangePrivilege)(e),i)},this.app=e,t.instance)return t.instance;this.serverLoader=new s.a,this.offlineLoader=new l.a(e),t.instance=this}return Object(a.a)(t,[{key:"getUserRangePrivilege",value:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){var t,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:[],o.length>1?o[1]:void 0,!window.__SUPPORT_FULL_OFFLINE_MODE||u.a.isOnline){e.next=6;break}return e.next=5,this.offlineLoader.getUserRangePrivilege(t);case 5:return e.abrupt("return",e.sent);case 6:return e.next=8,this.serverLoader.getUserRangePrivilege(t);case 8:return n=e.sent,this.updateLocalUserRangePrivilege(n.data.rangeCheckResList),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteRangeAuth",value:function(e){var t;null===(t=this.app.offlineEdit)||void 0===t||t.offlineDataManager.getHelper(p.FILE_TYPE.EXCEL).deleteRangeAuth(h.a.getConfig("globalPadId"),e)}},{key:"isSheetRangeCanEdit",value:function(t){var n=this;return new Promise((function(o){var r=n.app.sheetStatus.workbookStatus.canEdit,i=Object(d.getExistSheetRangeIdItem)(t);i||o(r),4&f.a.window.clientVars.rightFlag&&o(r),n.getUserRangePrivilege([i]).then((function(e){var t,n,r=(null===(t=e.data)||void 0===t||null===(n=t.rangeCheckResList)||void 0===n?void 0:n[0])?e.data.rangeCheckResList[0]:{},i=Number(r.rangePolicy||1),a=Number(r.rangePrivilege||0),s=c.f[i-1][a];o(s)})).catch((function(t){var n;null===(n=e.log)||void 0===n||n.error("rangeAuth.util.util.isSheetRangeCanEdit",null===t||void 0===t?void 0:t.stack),o(r)}))}))}}]),t}()}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/rangeAuth/loader/ServerLoader.ts":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/regenerator-runtime/runtime.js");var o=n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=n("./src/external/rangeAuth/loader/Loader.ts"),c=n("./src/external/rangeAuth/util/range-auth-request-util.ts"),d=n("./src/core/app/tool.ts");function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(s.a)(this,n)}}var p=function(t){Object(a.a)(s,t);var n=f(s);function s(){return Object(r.a)(this,s),n.apply(this,arguments)}return Object(i.a)(s,[{key:"getUserRangePrivilege",value:function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=d.a.window.rangeAuthVars?d.a.window.rangeAuthVars.rangeRev:"",t.abrupt("return",new Promise((function(t,r){$.ajax({url:"//".concat(location.host,"/cgi-go/range_priv/get_user_range_privilege"),type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:window.clientVars.localPadId,type:1,domain:Object(c.a)(),rangeIdList:JSON.stringify(n),rangeRev:o,xsrf:d.a.getXsrf()},success:function(n){var o;if("string"===typeof n)try{o=JSON.parse(n)}catch(i){var r;null===(r=e.log)||void 0===r||r.error("rangeAuthRequestUtil.tempData.parse",null===i||void 0===i?void 0:i.stack),o={}}else o=n;t(o)},error:function(e){r(e)}})})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),s}(u.a)}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/rangeAuth/range-auth-plugin-base.ts":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return _}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var o=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=n("./src/core/app/tool.ts"),a=n("./src/external/rangeAuth/util/util.ts"),s=n("./src/external/rangeAuth/config/auth-constant.ts"),l=n("./src/external/rangeAuth/util/data-api.ts"),u=n("./src/core/app/sheetStatus/ranges.ts"),c=n("./src/external/rangeAuth/util/range-auth-error-util.ts"),d=n("../packages/model/src/range/GridRange.ts"),f=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),p=n.n(f),h=n("./src/external/rangeAuth/util/range-auth-report-util.ts"),m=n("./src/external/rangeAuth/util/range-auth-request-util.ts"),g=n("./src/external/rangeAuth/loader/RangeAuthManager.ts"),b=n("./src/core/data/configService/spreadConfig.ts"),_=function(){function t(e){var n=this;Object(o.a)(this,t),this.initEvent=function(){i.a.event.rangeAuthEvent.listen(t.EVENT.PROTECT_RANGE,n.protectRange),i.a.event.rangeAuthEvent.listen(t.EVENT.PROTECT_SHEET,n.protectSheet),i.a.event.rangeAuthEvent.listen(t.EVENT.CHECK_ALL_RANGE_AUTH,n.checkAllRangeAuth),i.a.event.rangeAuthEvent.listen(t.EVENT.SHOW_EXIT_RANGE_SELECTOR,n.showExitRangeSelector),i.a.event.rangeAuthEvent.listen(t.EVENT.SHOW_RANGE_AUTH,n.showRangeAuth),i.a.event.rangeAuthEvent.listen(t.EVENT.HIDE_RANGE_AUTH,n.hideRangeAuth),i.a.event.rangeAuthEvent.listen(t.EVENT.SWITCH_SHEET_AND_CHANGE_RANGED_ID,n.switchSheetAndChangeRangeId),i.a.event.sheetsBar.listen("rangeAuthListenSwitchSheetEnd",n.handleSwitchSheetEnd),n.app.emitter.on(n.app.EVENT.PAGE_LOAD_FINISHED,n.initSheetRangeAuthStatus)},this.protectRange=function(e){if(!Object(a.isRangeCountExceedMaxValue)()){var t=Object(a.getNewRangeId)(),o=Object(a.parseSelectDataForRangeAuth)().gridRange;n.app.view.plugins.rangeAuthPanel.selector.show({isNewRangeId:!0,gridRange:o.clone()},t),Object(h.e)(e,o)}},this.protectSheet=function(e){var t=n.app.spreadsheet.activeSheetId;if(Object(h.e)(e,new d.b(t)),!Object(a.isRangeCountExceedMaxValue)())if(Object(a.getExistSheetRangeIdItem)(t))p.a.confirm({title:"\u4fdd\u62a4\u5de5\u4f5c\u8868\u63d0\u793a",content:"\u6b64\u5de5\u4f5c\u8868\u5df2\u88ab\u4fdd\u62a4\u3002",cancelText:null});else{var o=Object(a.getNewRangeId)();n.app.view.plugins.rangeAuthPanel.selector.show({isNewRangeId:!0,gridRange:new d.b(t)},o)}},this.checkAllRangeAuth=function(e,t){Object(h.i)(e),n.app.view.plugins.rangeAuthPanel.allList.show(t)},this.showExitRangeSelector=function(e){var t=Object(a.getProtectedMap)();if(null===t||void 0===t?void 0:t.get(e)){var o=Object(a.getGridRangeByRangeId)(e),r=o.sheetId;if(r!==n.app.spreadsheet.activeSheetId)return n.switchRangeId=e,void i.a.event.sheetsBar.trigger("switchSheet",r,n.app.spreadsheet.activeSheetId);n.app.view.plugins.rangeAuthPanel.selector.show({isNewRangeId:!1,gridRange:o},e)}},this.switchSheetAndChangeRangeId=function(e,t){n.switchRangeId=t,i.a.event.sheetsBar.trigger("switchSheet",e,n.app.spreadsheet.activeSheetId)},this.handleSwitchSheetEnd=function(){n.app.sheetStatus.tempStatus.status.isHistory||(n.initSheetRangeAuthStatus(),n.checkIfNeedToggleRangeAuth())},this.initSheetRangeAuthStatus=function(){n.isOwner?n.initOwnerRangeAuth():b.a.getConfig("isLogin")&&n.initCooperationRangeAuth()},this.showRangeAuth=function(){n.checkAllRangeAuth("oldversion")},this.hideRangeAuth=function(){n.app.view.plugins.rangeAuthPanel.allList.hide()},this.checkIfNeedToggleRangeAuth=function(){if(n.isOwner&&n.switchRangeId){var e=Object(a.getGridRangeByRangeId)(n.switchRangeId);n.app.view.plugins.rangeAuthPanel.selector.show({isNewRangeId:!1,gridRange:e},n.switchRangeId),n.switchRangeId=""}},this.reportFirstOpen=function(){n.isFirstOpenReportAlready||Object(a.getProtectedMap)()&&Object(a.getProtectedMap)().size>0&&(n.isFirstOpenReportAlready=!0,Object(h.a)(i.a.window.clientVars.padId,i.a.window.clientVars.padTitle),n.isOwner||Object(h.b)())},this.app=e,this.hasRangeAuth=!1,this.isFirstOpenReportAlready=!1,this.rangeAuthUtil=a,this.dataApi=l,this.isInitComplete=!1}return Object(r.a)(t,[{key:"initDefault",value:function(){this.isOwner=!!(4&i.a.window.clientVars.rightFlag),this.initEvent(),this.reportFirstOpen(),this.initOwnerNick(),this.initRangeAuthManager()}},{key:"initRangeAuthManager",value:function(){new g.a(this.app)}},{key:"initOwnerNick",value:function(){this.isOwner||Object(m.b)()}},{key:"initOwnerRangeAuth",value:function(){var e=this,t=this.app.spreadsheet.activeSheetId;this.app.permissions.resetRangeStatusBySheetId(t),Object(a.getProtectedMap)().forEach((function(t,n){e.app.permissions.addRangeAuth(n,t.range.clone(),u.a.EDITABLE)})),this.isInitComplete=!0}},{key:"initCooperationRangeAuth",value:function(){var n=this,o=this.app.spreadsheet.activeSheetId;this.app.permissions.resetRangeStatusBySheetId(o),this.app.permissions.resetSheetsStatusCanEdit(o);var r=Object(a.getActiveSheetRangeIds)(),l=r.rangeIds,f=r.sheetRangeId;if(!!f||l.length>0){this.app.permissions.setRangeStatusCanEdit(!1),this.hasRangeAuth=!0;var p=l.concat(f).filter((function(e){return!!e}));g.a.instance.getUserRangePrivilege(p,o).then((function(e){var r,l=(null===(r=e.data)||void 0===r?void 0:r.rangeCheckResList)?e.data.rangeCheckResList:[];0===l.length&&-1!==p.indexOf(f)?n.app.permissions.setSheetsStatusCanEdit(o,!1):l.forEach((function(e){var t=e.rangeId,r=e.rangePolicy,i=e.rangePrivilege,l=s.f[r-1][i];t===f&&n.app.permissions.setSheetsStatusCanEdit(o,l);var c=Object(a.getProtectedMap)().get(t),p=c?c.range:new d.b(o),h=l?u.a.EDITABLE:u.a.READ_ONLY;n.app.permissions.addRangeAuth(t,p,h)})),n.isInitComplete=!0,i.a.event.rangeAuthEvent.trigger(t.EVENT.COOPERATION_INITED)})).catch((function(t){var n;null===(n=e.log)||void 0===n||n.error("rangeAuthPluginBase.initCooperationRangeAuth",null===t||void 0===t?void 0:t.stack),Object(c.a)("\u521d\u59cb\u5316\u534f\u4f5c\u8005\u6743\u9650\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\uff5e")}))}else this.app.permissions.resetSheetsStatusCanEdit(o),this.isInitComplete=!0}}]),t}();_.EVENT={PROTECT_RANGE:"protectRange",PROTECT_SHEET:"protectSheet",CHECK_ALL_RANGE_AUTH:"checkAllRangeAuth",SHOW_EXIT_RANGE_SELECTOR:"showExitRangeSelector",SHOW_RANGE_AUTH:"showRangeAuth",HIDE_RANGE_AUTH:"hideRangeAuth",SWITCH_SHEET_AND_CHANGE_RANGED_ID:"switchSheetAndChangeRangedId",ADD_NEW_RANGE_AUTH:"addNewRangeAuth",DIMENSION_CHANGE:"dimensionChange",DELETE_RANGE_AUTH:"deleteRangeAuth",UPDATE_RANGE_AUTH:"updateRangeAuth",COOERATION_ADD_NEW_RANGE_DONE:"cooperationAddNewRangeDone",RANGE_AUTH_CHANGE:"rangeAuthChange",COOPERATION_INITED:"cooperation_inited",SHOW_RANGE_AUTH_SELECT_AREA:"showRangeAuthSelectArea"}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/rangeAuth/util/data-api.ts":function(e,t,n){"use strict";n.r(t),n.d(t,"updateRangeAuthOnSheet",(function(){return l})),n.d(t,"addRangeAuth",(function(){return i})),n.d(t,"updateRangeAuth",(function(){return a})),n.d(t,"deleteRangeAuth",(function(){return s})),n.d(t,"autoTest",(function(){return u}));var o=n("../packages/model/src/range/GridRange.ts"),r=n("../packages/utils/src/index.ts");function i(e,t,n){e.addProtectionRange({workbookRangeId:t,range:n,description:""})}function a(e,t,n){e.updateProtectionRange({workbookRangeId:t,range:n,description:""})}function s(e,t){e.deleteProtectionRange({workbookRangeIds:t instanceof Array?t:[t]})}function l(e,t,n,o){t&&a(e,t,o.clone()),n&&s(e,n)}var u={addRangeAuth:function(e,t){var n=t.sheetId,a=t.startRowIndex,s=t.endRowIndex,l=t.startColIndex,u=t.endColIndex,c=r.a.getRandomId();return i(e,c,new o.b(n,a,s,l,u)),c},deleteRangeAuth:s,updateRangeAuth:function(e,t,n){var r=n.sheetId,i=n.startRowIndex,s=n.endRowIndex,l=n.startColIndex,u=n.endColIndex;a(e,t,new o.b(r,i,s,l,u))}}},"./src/external/rangeAuth/util/range-auth-error-util.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return h}));var o=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),r=n.n(o),i=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),a=n.n(i),s=n("../node_modules/@tencent/dui-mobile/lib/components/Modal/index.js"),l=n.n(s),u=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),c=n.n(u),d=n("../node_modules/lodash/throttle.js"),f=n.n(d),p=c.a.isMobile?l.a:a.a;function h(e){r.a.show({type:"error",message:e,autoClose:!0,style:{zIndex:10004}})}var m=f()((function(){p.confirm({title:"\u4fdd\u62a4\u8303\u56f4\u63d0\u793a",content:"\u6b64\u8303\u56f4\u5df2\u88ab\u4fdd\u62a4\u3002\u5982\u9700\u7f16\u8f91\uff0c\u8bf7\u8054\u7cfb\u521b\u5efa\u8005\u300c".concat(window.clientVars.ownerNick,"\u300d\u6388\u4e88\u6743\u9650\u3002"),cancelText:null,okText:"\u786e\u5b9a"})}),300,{leading:!0,trailing:!1})},"./src/external/rangeAuth/util/range-auth-parse-util.ts":function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return a}));n("../node_modules/core-js/modules/es.array.concat.js");var o=n("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),r=n("../packages/model/src/range/hexRangeUtils.ts"),i=n("../packages/model/src/range/GridRange.ts");function a(t){if(t.isSheet){var n=e.SpreadsheetApp.spreadsheet.sheetManager.getSheetTitleBySheetId(t.sheetId);return"\u300c".concat(n,"\u300d")}var o=t.startRowIndex,i=t.endRowIndex,a=t.startColIndex,s=t.endColIndex,l=t.isCol,u=t.isRow,c=t.isSheet,d=Object(r.colIndex2ColChar)(a),f=Object(r.colIndex2ColChar)(s);return l?d===f?"\uff08\u7b2c".concat(d,"\u5217\uff09"):"\uff08\u7b2c".concat(d,"\u81f3").concat(f,"\u5217\uff09"):u?o===i?"\uff08\u7b2c".concat(o+1,"\u884c\uff09"):"\uff08\u7b2c".concat(o+1,"\u81f3").concat(i+1,"\u884c\uff09"):c?e.SpreadsheetApp.spreadsheet.sheetManager.getSheetTitleBySheetId(t.sheetId):o===i&&d===f?"\uff08".concat(d).concat(o+1,"\uff09"):"\uff08".concat(d).concat(o+1,":").concat(f).concat(i+1,"\uff09")}function s(t){var n={text:"\u8303\u56f4",isSingleSelct:!0,gridRange:new i.b(e.SpreadsheetApp.spreadsheet.activeSheetId)};if(t.length>1||0===t.length)return n.isSingleSelct=!1,n;var r=Object(o.a)(t,1)[0],s=function(t){var n={startRowIndex:0,endRowIndex:0,startColIndex:0,endColIndex:0},o=t.selectRow,r=t.selectAll,i=t.selectCol;return o?(n.startRowIndex=t.yRange[0],n.endRowIndex=t.yRange[1],n):i?(n.startColIndex=t.xRange[0],n.endColIndex=t.xRange[1],n):r?(n.endRowIndex=e.SpreadsheetApp.spreadsheet.activeSheet.getRowCount()-1,n.endColIndex=e.SpreadsheetApp.spreadsheet.activeSheet.getColCount()-1,n):(n.startRowIndex=t.yRange[0],n.endRowIndex=t.yRange[1],n.startColIndex=t.xRange[0],n.endColIndex=t.xRange[1],n)}(r),l=s.startRowIndex,u=s.endRowIndex,c=s.startColIndex,d=s.endColIndex;n.gridRange.startRowIndex=l,n.gridRange.endRowIndex=u,n.gridRange.startColIndex=c,n.gridRange.endColIndex=d;var f=r.selectRow,p=r.selectCol;return f?(n.gridRange.startColIndex=i.a,n.gridRange.endColIndex=i.a):p&&(n.gridRange.startRowIndex=i.a,n.gridRange.endRowIndex=i.a),n.text+=a(n.gridRange),n}function l(){return s(e.SpreadsheetApp.view.canvas.normalSelectData.selectQueue)}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/rangeAuth/util/range-auth-report-util.ts":function(e,t,n){"use strict";n.d(t,"l",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"g",(function(){return m})),n.d(t,"f",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return _})),n.d(t,"c",(function(){return E}));var o=n("../packages/report/src/index.ts"),r=n("./src/external/rangeAuth/config/auth-constant.ts");function i(e){return e.isSheet?"sheet":e.isCol?"line":e.isRow?"row":"range"}function a(e){return e===r.b.ONLY_I_CAN_EDIT?"me":"cooperation"}function s(e){return e===r.e.COOPERATION?"onlyfriend":e===r.e.VIEWABLE?"allsee":e===r.e.EDITBLE?"alledit":"onlyme"}function l(e){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"view_range_protection",ver10:e})}function u(e,t){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"click_range_protection",ver10:e,ver11:i(t)})}function c(e,t,n,r){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"range_protection_set",ver10:a(e),ver11:i(n),ver12:s(t),ver13:r})}function d(){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"click_invite_friends"})}function f(e){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"range_protection_list",ver10:e})}function p(e){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"click_organize",ver11:i(e)})}function h(e){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"click_cancel",ver11:i(e)})}function m(){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"cowoker_view"})}function g(){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"click_lock"})}function b(e,t){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"range_protection_activedoc",ver11:e,ver12:t})}function _(){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"cowoker_number"})}function E(){o.b.tdwReport({opername:"doc_excel_editor",module:"range_authority",action:"cowoker_click"})}},"./src/external/rangeAuth/util/range-auth-request-filter.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],n="";return e.forEach((function(e){var o=[];e.addmemlist&&(o=e.addmemlist.map((function(e){return e.corp_id&&(n=e.corp_id),{uin:"".concat(e.uin),rangePrivilegeType:e.rangePrivilegeType,isNew:e.isNew,workId:e.work_id||"",uintype:e.uintype||0,corpId:e.corp_id||""}})));var r=[];e.submemlist&&(r=e.submemlist.map((function(e){return e.corp_id&&(n=e.corp_id),{uin:"".concat(e.uin),uintype:e.uintype||0}}))),t.push({rangeId:e.rangeId,rangePolicy:e.rangePolicy||0,addmemlist:o,submemlist:r,clear:e.clear})})),{filteredList:t,corpId:n}}},"./src/external/rangeAuth/util/range-auth-request-util.ts":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return _})),n.d(t,"b",(function(){return E})),n.d(t,"d",(function(){return f}));n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.replace.js");var o=n("./src/core/app/tool.ts"),r=n("./src/external/rangeAuth/config/auth-constant.ts"),i=n("./src/external/rangeAuth/util/range-auth-request-filter.ts"),a=n("./src/base/util/object.ts"),s=n("../node_modules/axios/index.js"),l=n.n(s),u=n("./src/core/data/configService/spreadConfig.ts"),c=n("../packages/utils/src/safe.ts");function d(){var e=o.a.window.clientVars.globalPadId,t=e.indexOf("$");return e.slice(0,t)}function f(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}function p(t){var n;if("string"===typeof t)try{n=JSON.parse(t)}catch(r){var o;null===(o=e.log)||void 0===o||o.error("rangeAuthRequestUtil.transitionData",null===r||void 0===r?void 0:r.stack),n={}}else n=t;return n}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.a.ONLY_RANGE_AUTH;return 0===e.length?Promise.resolve({data:{protectedRangeList:[{isNeverSetPolicyOnlyBefore:!0,isNeverSetPolicyDesignatedBefore:!0,rangePolicy:0,memlist:[]}]}}):new Promise((function(n,r){$.ajax({url:"//".concat(location.host,"/cgi-go/range_priv/get_range_privilege"),type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:o.a.window.clientVars.padId,type:t,domain:d(),rangeIdList:JSON.stringify(e),xsrf:o.a.getXsrf()},success:function(e){var t;(t="string"===typeof e?JSON.parse(e):e).data.protectedRangeList&&0!==t.data.protectedRangeList.length||(t.data.protectedRangeList=[{rangePolicy:0,memlist:[]}]),n(t)},error:function(e){r(e)}})}))}var m=!1;function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!Array.isArray(e))return Promise.reject({msg:"\u53c2\u6570\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5"});if(m)return Promise.reject({msg:"\u6b63\u5728\u8bbe\u7f6e\u4e2d\uff0c\u8bf7\u7a0d\u540e\uff5e"});m=!0;var n=Object(i.a)(e),r=n.filteredList,s=n.corpId,l=e.map((function(e){return e.rangeId})),u={rangeSeq:f(),rangeAction:{rangeIdList:l}};return new Promise((function(e,n){$.ajax({url:"//".concat(location.host,"/cgi-go/range_priv/set_range_privilege"),type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:o.a.window.clientVars.padId,data:JSON.stringify(r),corpId:s,domain:d(),message:t?JSON.stringify(t):JSON.stringify(u),xsrf:o.a.getXsrf()},success:function(t){var o=p(t);0===o.retcode?e(o):n(o),m=!1},error:function(e){var t=Object(a.deepClone)(e);m=!1;var o="";switch(t.retcode){case 10013:o="\u6dfb\u52a0\u7684\u4eba\u4e0d\u662f\u597d\u53cb";break;case 10014:o="\u6210\u5458\u5217\u8868\u8d85\u8fc7\u9650\u5236\u6570\u91cf";break;case 10015:o="\u5355\u6b21\u6dfb\u52a0\u7684\u6210\u5458\u6570\u91cf\u8d85\u8fc7\u9650\u5236";break;case 10016:o="\u5927\u8868\u6210\u5458\u5217\u8868\u8d85\u8fc7\u9650\u5236";break;case 10018:o="\u6dfb\u52a0\u7684\u4eba\u4e0d\u662f\u597d\u53cb"}t.msg||(t.msg=o),n(t)}})}))}function b(){return new Promise((function(e,t){$.ajax({url:"//".concat(location.host,"/cgi-bin/online_docs/auth_info/get"),type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:o.a.window.clientVars.padId,domain:d(),type:1,ver:2,folderId:"",dataType:"",xsrf:o.a.getXsrf()},success:function(n){var o=p(n);0===o.retcode?e(o):t(o)},error:function(e){t(e)}})}))}function _(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a={seq:f(),action:1};try{"undefined"===typeof window.clientVars&&(window.clientVars={}),"undefined"===typeof window.clientVars.msgFilterData&&(window.clientVars.msgFilterData={}),window.clientVars.msgFilterData[a.seq]=a.action}catch(u){var s;null===(s=e.log)||void 0===s||s.error("rangeAuthRequestUtil.setWorkbookAuth",null===u||void 0===u?void 0:u.stack)}var l=JSON.stringify({policy:t,addmemlist:n,submemlist:i});return new Promise((function(e,n){$.ajax({url:"//".concat(location.host,"/cgi-bin/online_docs/auth_info/set"),type:"POST",xhrFields:{withCredentials:!0},data:{localPadId:o.a.window.clientVars.padId,type:1,data:l,message:JSON.stringify(a),domain:d(),dataType:"",clear:t===r.e.SELF?1:0,xsrf:o.a.getXsrf()},success:function(t){var o=p(t);0===o.retcode?e(o):n(o)},error:function(e){n(e)}})}))}function E(t){if(o.a.window.clientVars.ownerNick&&t)t(o.a.window.clientVars.ownerNick);else{var n="//".concat(location.host,"/cgi-bin/online_docs/doc_info"),r={domainId:u.a.getConfig("domainId"),localPadId:u.a.getConfig("padId"),xsrf:Object(c.b)()};l.a.get(n,{params:r,withCredentials:!0}).then((function(e){var n=e.data;if(0===n.retcode){var r=n.owner_nick;o.a.window.clientVars.ownerNick=r,null===t||void 0===t||t(r)}})).catch((function(n){var r;null===(r=e.log)||void 0===r||r.error("rangeAuthRequestUtil.getOwnerNick",null===n||void 0===n?void 0:n.stack),null===t||void 0===t||t(o.a.window.clientVars.ownerNick)}))}}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/rangeAuth/util/util.ts":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"getNewRangeId",(function(){return p})),n.d(t,"getProtectedMap",(function(){return h})),n.d(t,"getRangeIdByGridRange",(function(){return _})),n.d(t,"getGridRangeByRangeId",(function(){return E})),n.d(t,"isGridRangeSetAuth",(function(){return v})),n.d(t,"isRangeCountExceedMaxValue",(function(){return R})),n.d(t,"isSheetRangeSetAuth",(function(){return b})),n.d(t,"getActiveSheetRangeIds",(function(){return g})),n.d(t,"getExistSheetRangeIdItem",(function(){return m})),n.d(t,"getRangeAuthListCrossSelectArea",(function(){return y})),n.d(t,"convertToLocalRangePrivilege",(function(){return T})),n.d(t,"convertToServerRangePrivilege",(function(){return S}));n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),r=n("./src/core/app/tool.ts"),i=n("../packages/utils/src/index.ts"),a=n("../packages/model/src/range/GridRange.ts"),s=n("./src/external/rangeAuth/util/range-auth-request-util.ts");n.d(t,"getRangeAuthInfo",(function(){return s.c})),n.d(t,"setRangeAuthInfo",(function(){return s.f})),n.d(t,"getWorkbookAuth",(function(){return s.e})),n.d(t,"setWorkbookAuth",(function(){return s.g}));var l=n("./src/external/rangeAuth/util/range-auth-parse-util.ts");n.d(t,"parseSelectDataForRangeAuth",(function(){return l.b})),n.d(t,"parseGridRangeText",(function(){return l.a}));var u=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),c=n.n(u);function d(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function p(){return i.a.getRandomId()}function h(){var t,n=e.SpreadsheetApp.spreadsheet;return(null===(t=e.SpreadsheetApp.preview)||void 0===t?void 0:t.isActive)&&(n=e.SpreadsheetApp.preview.previewsheet),n.workbookRangeManager.protectedRangeMap}function m(e){var t,n="",r=d(h().entries());try{for(r.s();!(t=r.n()).done;){var i=Object(o.a)(t.value,2),a=i[0],s=i[1];if(s.range.isSheet&&s.range.sheetId===e){n=a;break}}}catch(l){r.e(l)}finally{r.f()}return n}function g(){return function(e){var t=[],n="";return h().forEach((function(o,r){o.range.sheetId===e&&(o.range.isSheet?n=r:t.push(r))})),{rangeIds:t,sheetRangeId:n}}(r.a.window.SpreadsheetApp.spreadsheet.activeSheetId)}function b(e){return!!m(e)}function _(e){var t,n="",r=d(h().entries());try{for(r.s();!(t=r.n()).done;){var i=Object(o.a)(t.value,2),a=i[0];if(i[1].range.contain(e)){n=a;break}}}catch(s){r.e(s)}finally{r.f()}return n}function E(e){var t=new a.b(r.a.window.SpreadsheetApp.spreadsheet.activeSheetId),n=h().get(e);return void 0!==n&&(t=n.range.clone()),t}function v(e){return-1!==function(e){var t=[];return h().forEach((function(n){n.range.sheetId===e&&t.push(n.range.clone())})),t}(e.sheetId).findIndex((function(t){return t.isCross(e)}))}function y(){var e=Object(l.b)(),t=e.gridRange,n=e.isSingleSelct;return t.isSheet||!n?[]:function(e){var t=[];return h().forEach((function(n,o){n.range.isCross(e)&&t.push({rangeId:o,modifyTime:n.properties.modifyTime||0,gridRange:n.range.clone()})})),t}(t)}function R(){var e=h().size>=2e3;return e&&c.a.show({type:"info",message:"\u53d7\u4fdd\u62a4\u8303\u56f4\u5df2\u8d85\u8fc72000\u4e2a\u4e0a\u9650\uff0c\u8bf7\u53d6\u6d88\u90e8\u5206\u4fdd\u62a4\u8303\u56f4\u540e\u91cd\u8bd5\u3002",autoClose:!0,style:{zIndex:10004}}),e}function T(e){var t={};return e.length&&e.forEach((function(e){t[e.rangeId]=[e.rangePolicy,e.rangePrivilege]})),t}function S(e){var t=[];return Object.keys(e).forEach((function(n){t.push({rangeId:n,rangePolicy:e[n][0],rangePrivilege:e[n][1]})})),t}}.call(this,n("../node_modules/webpack/buildin/global.js"))}}]);
//# sourceMappingURL=pc-bundle_feature_relate_form-60c398563a.js.map