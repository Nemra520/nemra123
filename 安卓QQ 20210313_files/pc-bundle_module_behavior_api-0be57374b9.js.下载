(window.webpackJsonp=window.webpackJsonp||[]).push([["bundle_module_behavior_api","bundle_spreadsheet_tool_lazy"],{"../node_modules/@tencent/dui/lib/components/Button/Button.js":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n("react")),u=i(n("../node_modules/prop-types/index.js")),d=n("../node_modules/@tencent/dui/lib/utils/theme.js"),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.themedRender=function(e){var n,r=t.props,o=r.prefixCls,s=r.className,i=r.style,u=r.type,d=r.size,f=r.disabled,h=r.icon,p=l(r,["prefixCls","className","style","type","size","disabled","icon"]),g=e(o,s,((n={})[o+"-type-"+u]=u,n[o+"-size-"+d]=d,n[o+"-with-icon"]=h,n[o+"-type-"+u+"-disabled"]=f,n)),m=e(o+"-container"),b=e(o+"-icon");return c.createElement("button",a({},p,{className:g,style:i,disabled:f}),c.createElement("div",{className:m},h?"string"===typeof h?c.createElement("span",{className:b,style:{backgroundImage:"url("+h+")"}}):h:null,t.props.children))},t}return r(t,e),t.prototype.render=function(){return d.consumeTheme(this.themedRender)},t}(c.Component);t.default=f,f.defaultProps={prefixCls:"dui-button",type:"default",size:"default"},f.propTypes={prefixCls:u.string,style:u.object,className:u.string,type:u.oneOf(["default","primary","warning","plain","golden","golden-outline"]),size:u.oneOf(["default","small","large"]),icon:u.node}},"../node_modules/@tencent/dui/lib/components/Button/index.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;var a=r(n("../node_modules/@tencent/dui/lib/components/Button/Button.js"));t.Button=a.default,n("../node_modules/@tencent/dui/lib/utils/style.js").injectStyle("components/Button/style/index.css",".dui-button{outline:none;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;white-space:nowrap;border-radius:2px;border:1px solid transparent;font-size:14px;padding:0 20px;-webkit-tap-highlight-color:transparent}.dui-button-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.dui-button-type-default{background:#fff;color:rgba(0,0,0,.8);border-color:rgba(0,0,0,.12)}.dui-button-type-default:hover{background:rgba(0,0,0,.04)}.dui-button-type-default:active{background:rgba(0,0,0,.08)}.dui-button-type-primary{background:#1e6fff;color:#fff}.dui-button-type-primary:hover{background:#5391ff}.dui-button-type-primary:active{background:#1b66eb}.dui-button-type-warning{background:#fb4d3f;color:#fff}.dui-button-type-warning:hover{background:#fb776c}.dui-button-type-warning:active{background:#e7463a}.dui-button-type-plain{background:#fff}.dui-button-type-plain:hover{background:rgba(0,0,0,.04)}.dui-button-type-plain:active{background:rgba(0,0,0,.08)}.dui-button-type-golden{background:-webkit-linear-gradient(338deg,#f6ddb1,#e4bd80);background:linear-gradient(112deg,#f6ddb1,#e4bd80);border:none;color:#865812}.dui-button-type-golden .dui-button-container{margin:0 1px}.dui-button-type-golden:hover{background:-webkit-linear-gradient(338deg,#f9e8c8,#edd1a7);background:linear-gradient(112deg,#f9e8c8,#edd1a7)}.dui-button-type-golden:active{background:-webkit-linear-gradient(338deg,#f3cf9e,#e2b475);background:linear-gradient(112deg,#f3cf9e,#e2b475)}.dui-button-type-golden-outline{border-color:#db8f1c;color:#db8f1c;background:#fff}.dui-button-type-golden-outline:hover{background:rgba(219,143,28,.1)}.dui-button-type-golden-outline:active{background:rgba(219,143,28,.2)}.dui-button-type-default-disabled,.dui-button-type-golden-disabled,.dui-button-type-golden-outline-disabled,.dui-button-type-primary-disabled,.dui-button-type-warning-disabled{color:rgba(0,0,0,.24);background:rgba(0,0,0,.08);border-color:transparent;cursor:auto}.dui-button-type-default-disabled:active,.dui-button-type-default-disabled:hover,.dui-button-type-golden-disabled:active,.dui-button-type-golden-disabled:hover,.dui-button-type-golden-outline-disabled:active,.dui-button-type-golden-outline-disabled:hover,.dui-button-type-primary-disabled:active,.dui-button-type-primary-disabled:hover,.dui-button-type-warning-disabled:active,.dui-button-type-warning-disabled:hover{background:rgba(0,0,0,.08)}.dui-button-type-default-disabled{border-color:transparent}.dui-button-type-plain-disabled{color:rgba(0,0,0,.24);background:#fff;cursor:auto}.dui-button-type-plain-disabled:active,.dui-button-type-plain-disabled:hover{background:#fff}.dui-button-size-large{height:38px;min-width:160px}.dui-button-size-default{height:28px}.dui-button-size-small{height:24px;padding:0 16px}.dui-button-with-icon{padding:0 9px}.dui-button-icon{display:inline-block;width:18px;height:18px;background-size:contain;background-repeat:no-repeat;background-position:50%;margin-right:4px}"),t.default=a.default},"../node_modules/@tencent/dui/lib/components/Modal/Dragger.js":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&a(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var i=s(n("react")),l=s(n("../node_modules/prop-types/index.js")),c=n("../node_modules/@tencent/dui/lib/utils/helper.js"),u=n("../node_modules/@tencent/dui/lib/utils/theme.js"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ref=null,t.minLeft=0,t.minTop=0,t.setRef=function(e){t.ref=e},t.onMouseDown=function(e){if(t.props.draggable&&t.ref&&!t.isFromInnerInput(e)){t.mouse=!0;var n=t.ref.getBoundingClientRect(),r=n.left,a=n.top,o=n.width,s=n.height,i=e.clientX,l=e.clientY;t.startLeft=r,t.startTop=a,t.startX=i,t.startY=l,t.maxLeft=window.innerWidth-o,t.maxTop=window.innerHeight-s,t.ref.style.userSelect="none",t.ref.parentElement.style.pointerEvents="auto"}},t.onMouseMove=function(e){if(t.mouse&&t.ref){var n=e.clientX,r=e.clientY,a=t.startLeft+n-t.startX,o=t.startTop+r-t.startY;a=Math.min(Math.max(t.minLeft,a),t.maxLeft),o=Math.min(Math.max(t.minTop,o),t.maxTop),t.ref.style.position="absolute",t.ref.style.left=a+"px",t.ref.style.top=o+"px"}},t.onMouseUp=function(e){if(t.ref){t.mouse=!1,t.ref.style.userSelect="auto",t.ref.parentElement.style.pointerEvents="";var n=t.props,r=n.onDragEnd;!0===n.draggable&&r(e)}},t.themedRender=function(e){var n=t.props,r=n.children,a=n.className,o=n.onClick,s=n.prefixCls,l=n.style,c=e(s,a);return i.createElement("div",{className:c,style:l,ref:t.setRef,onMouseDown:t.onMouseDown,onClick:o},r)},t}return r(t,e),t.prototype.componentDidMount=function(){document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp)},t.prototype.componentWillUnmount=function(){document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp)},t.prototype.isFromInnerInput=function(e){var t,n=e.target;return Boolean(/input|textarea/i.test(n.tagName)&&(null===(t=this.ref)||void 0===t?void 0:t.contains(n)))},t.prototype.render=function(){return u.consumeTheme(this.themedRender)},t}(i.Component);t.default=d,d.defaultProps={prefixCls:"dui-dragger",onDragEnd:c.emptyFn,onClick:c.emptyFn,draggable:!1},d.propTypes={prefixCls:l.string,className:l.string,style:l.object,draggable:l.bool,onClick:l.func,onDragEnd:l.func}},"../node_modules/@tencent/dui/lib/components/Modal/Modal.js":function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MODAL_LEAVING_TRANSITION_DURATION=void 0;var c=i(n("react")),u=l(n("react-dom")),d=i(n("../node_modules/prop-types/index.js")),f=n("../node_modules/@tencent/dui/lib/utils/helper.js"),h=l(n("../node_modules/@tencent/dui/lib/components/Button/index.js")),p=l(n("../node_modules/@tencent/dui/lib/components/Modal/Dragger.js")),g=n("../node_modules/@tencent/dui/lib/utils/keepDom.js"),m=n("../node_modules/@tencent/dui/lib/components/Snackbar/context.js"),b=n("../node_modules/@tencent/dui/lib/utils/theme.js"),v=n("../node_modules/@tencent/dui/lib/utils/preventScrollPenetrate.js"),I=n("../node_modules/@tencent/dui/lib/utils/stylusAdapter.js");t.MODAL_LEAVING_TRANSITION_DURATION=240;var _=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.draggerRef=c.createRef(),n.handleClose=function(e){var t=n.props,r=t.onClose,a=t.onCancel;(r||a)(e)},n.handleMaskClick=function(e){var t=n.props,r=t.maskClosable,a=t.onClickMask;!0===r&&n.handleClose(e),a(e)},n.handleDraggerClick=function(e){e.stopPropagation()},n.handleKeyDown=function(e){var t,r=n.props,a=r.visible,o=r.onCancel,s=r.onOk,i=r.footer;!a||i||null===i||(null===(t=n.draggerRef.current)||void 0===t?void 0:t.isFromInnerInput(e))||("Enter"===e.key?(document.activeElement&&document.activeElement.blur(),s()):"Escape"===e.key&&o())},n.renderFooter=function(e){var t,r,a=n.props,o=a.prefixCls,s=a.footer,i=a.okText,l=a.cancelText,u=a.action,d=a.onClickAction,f=a.onOk,p=a.onCancel,g=a.okDisabled;return null===s?null:s||(null!==u&&"object"===typeof u?c.isValidElement(u)?t=u:("text"in u&&(t=u.text),"icon"in u&&(r=u.icon)):t=u,c.createElement("div",{className:e(o+"-footer")},u?c.createElement(I.WithStylusClick,{clickHandler:d},c.createElement("div",{className:e(o+"-footer-action")},r?"string"===typeof r?c.createElement("div",{className:e(o+"-footer-action-icon"),style:{backgroundImage:"url("+r+")"}}):r:null,t?c.createElement("div",null,t):null)):null,l?c.createElement(I.WithStylusClick,{clickHandler:p},c.createElement(h.default,null,l)):null,c.createElement(I.WithStylusClick,{clickHandler:f},c.createElement(h.default,{className:e(o+"-footer-ok"),type:"primary",disabled:g},i))))},n.themedRender=function(e){var r,o=n.props,s=o.prefixCls,i=o.className,l=o.style,d=o.title,f=o.visible,h=o.maskStyle,b=o.maskClassName,_=o.mask,y=o.closable,R=o.draggable,E=o.onDragEnd,O=o.destroyOnClose,S=o.zIndex,T=o.containerDom,w=e(s,i,s+"-"+(f?"visible":"hidden")),k=e(s+"-mask",b,s+"-mask-"+(f?"visible":"hidden"),((r={})[s+"-mask-display"]=_,r[s+"-mask-in-container"]=T!==document.body,r));if(!T||O&&!g.decideKeepDom.call(n,t.MODAL_LEAVING_TRANSITION_DURATION,f))return null;var j=n.draggerRef.current&&n.draggerRef.current.ref;return u.default.createPortal(c.createElement(m.ContainerContext.Provider,{value:j},c.createElement(v.PreventScrollPenetrateContainer,{className:k,style:a({zIndex:S},h),onClick:n.handleMaskClick},c.createElement(p.default,{className:w,style:l,draggable:R,onDragEnd:E,onClick:n.handleDraggerClick,ref:n.draggerRef},y?c.createElement(I.WithStylusClick,{clickHandler:n.handleClose},c.createElement("div",{className:e(s+"-close")})):null,null!==d?c.createElement("div",{className:e(s+"-title")},d):null,n.renderContent(e),n.renderFooter(e)))),T)},n}return r(n,e),n.prototype.componentDidMount=function(){var e=this;this.forceUpdate(),setTimeout((function(){document.addEventListener("keydown",e.handleKeyDown)}),1e3)},n.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown)},n.prototype.renderContent=function(e){var t,n=this.props,r=n.prefixCls,a=n.title,o=n.content,s=n.children,i=e(r+"-content",((t={})[r+"-content-empty-title"]=""===a,t)),l=o||s,u=l;return f.isIE()&&"string"===typeof l&&(u=c.createElement("span",{style:{maxWidth:"100%"}},l)),f.isIE()?c.createElement("div",{style:{display:"flex",flexDirection:"column"}},c.createElement("div",{className:i},u)):c.createElement("div",{className:i},u)},n.prototype.render=function(){return b.consumeTheme(this.themedRender)},n}(c.Component);t.default=_,_.defaultProps={prefixCls:"dui-modal",title:"",content:"",footer:"",onCancel:f.emptyFn,onOk:f.emptyFn,cancelText:"\u53d6\u6d88",okText:"\u786e\u8ba4",visible:!1,mask:!0,maskClosable:!1,closable:!0,onDragEnd:f.emptyFn,destroyOnClose:!1,onClickMask:f.emptyFn,action:"",onClickAction:f.emptyFn,containerDom:"undefined"!==typeof document?document.body:void 0,okDisabled:!1},_.propTypes={prefixCls:d.string,style:d.object,className:d.string,title:d.node,content:d.node,footer:d.node,onCancel:d.func,onOk:d.func,cancelText:d.node,okText:d.node,visible:d.bool,mask:d.bool,maskClosable:d.bool,closable:d.bool,draggable:d.bool,onDragEnd:d.func,destroyOnClose:d.bool,maskStyle:d.object,maskClassName:d.string,onClickMask:d.func,action:d.any,onClickAction:d.func,onClose:d.func,zIndex:d.number,containerDom:d.object,okDisabled:d.bool}},"../node_modules/@tencent/dui/lib/components/Modal/confirm.js":function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n("../node_modules/@tencent/dui/lib/components/Modal/Modal.js")),i=n("../node_modules/@tencent/dui/lib/utils/show.js"),l=n("../node_modules/@tencent/dui/lib/utils/helper.js");t.default=l.wrapWithConfigDefaults((function(e){return e.onClose=e.onClose||e.onCancel,i.showWithTransition({Component:s.default,transitionDuration:s.MODAL_LEAVING_TRANSITION_DURATION,autoClose:!1,props:e,forcedProps:{destroyOnClose:!0},injectClosePropNames:["onOk","onCancel","onClickAction","onClose"]})}))},"../node_modules/@tencent/dui/lib/components/Modal/index.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Modal=void 0;var a=r(n("../node_modules/@tencent/dui/lib/components/Modal/Modal.js"));t.Modal=a.default;var o=r(n("../node_modules/@tencent/dui/lib/components/Modal/confirm.js"));n("../node_modules/@tencent/dui/lib/utils/style.js").injectStyle("components/Modal/style/index.css","@-webkit-keyframes dui-modal-fade-in{0%{opacity:0}to{opacity:1}}@keyframes dui-modal-fade-in{0%{opacity:0}to{opacity:1}}@-webkit-keyframes dui-modal-pop-up{0%{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes dui-modal-pop-up{0%{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1)}to{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1)}}.dui-modal{position:relative;width:386px;-webkit-box-sizing:border-box;box-sizing:border-box;padding:20px 23px 24px;border-radius:4px;border:1px solid #eee;-webkit-box-shadow:0 2px 6px 0 rgba(0,0,0,.12);box-shadow:0 2px 6px 0 rgba(0,0,0,.12);background-color:#fff;pointer-events:auto;-webkit-animation:dui-modal-pop-up .3s cubic-bezier(.4,0,.2,1);animation:dui-modal-pop-up .3s cubic-bezier(.4,0,.2,1);-webkit-tap-highlight-color:transparent}.dui-modal-hidden,.dui-modal-visible{-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,transform,visibility;transition-property:opacity,transform,visibility,-webkit-transform}.dui-modal-visible{opacity:1;-webkit-transform:scaleX(1);transform:scaleX(1);-webkit-transition-duration:.3s;transition-duration:.3s}.dui-modal-hidden{opacity:0;-webkit-transform:scale3d(.9,.9,1);transform:scale3d(.9,.9,1);-webkit-transition-duration:.24s;transition-duration:.24s}.dui-modal-mask{position:fixed;z-index:9998;top:0;left:0;right:0;bottom:0;opacity:1;pointer-events:none;-webkit-animation:dui-modal-fade-in .3s cubic-bezier(.4,0,.2,1);animation:dui-modal-fade-in .3s cubic-bezier(.4,0,.2,1);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.dui-modal-mask-in-container{position:absolute}.dui-modal-mask-display{pointer-events:auto;background-color:hsla(0,0%,100%,.65)}.dui-modal-mask-visible{opacity:1;visibility:visible;-webkit-transition:all .3s cubic-bezier(.4,0,.2,1);transition:all .3s cubic-bezier(.4,0,.2,1)}.dui-modal-mask-hidden{opacity:0;visibility:hidden;-webkit-transition:all .24s cubic-bezier(.4,0,.2,1);transition:all .24s cubic-bezier(.4,0,.2,1)}.dui-modal-close{position:absolute;z-index:1;width:20px;height:20px;right:22px;top:23px;background-size:16px 16px;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16'%3E%3Cpath fill-rule='evenodd' d='M8.977 8.047l4.93 4.97-.976.984L8 9.03 3.07 14l-.977-.984 4.93-4.97L2 2.984 2.977 2 8 7.062 13.023 2l.977.984-5.023 5.063z' opacity='.64'/%3E%3C/svg%3E\");background-position:50%;background-repeat:no-repeat;cursor:pointer}.dui-modal-close:hover{background-color:rgba(51,51,51,.1)}.dui-modal-close:active{background-color:rgba(65,70,80,.3)}.dui-modal-title{font-weight:500;font-size:18px;margin-bottom:20px}.dui-modal-content{font-size:14px;color:rgba(0,0,0,.88);height:-webkit-max-content;height:-moz-max-content;height:max-content;min-height:88px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-flow:column nowrap;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;word-break:break-word}.dui-modal-content-empty-title{margin-top:28px;min-height:60px}.dui-modal-footer{-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;margin-top:24px;position:relative}.dui-modal-footer,.dui-modal-footer-action{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.dui-modal-footer-action{position:absolute;left:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);cursor:pointer;font-size:12px;color:rgba(0,0,0,.64);-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.dui-modal-footer-action-icon{display:inline-block;width:16px;height:16px;margin-right:6px;background-size:contain;background-position:50%;background-repeat:no-repeat}.dui-modal-footer-ok{margin-left:16px}"),a.default.confirm=o.default,t.default=a.default},"../node_modules/@tencent/dui/lib/utils/stylusAdapter.js":function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WithStylusClick=t.StylusAdapter=void 0;var a,o=r(n("react")),s=r(n("../node_modules/@tencent/docs-user-agent/dist/index.js"));!function(e){e.direct="direct",e.stylus="stylus"}(a||(a={}));var i=function(){function e(){}return e.supportStylus=function(e,t){if(this.isIPadStylusTouch(e))if("touchstart"!==e.nativeEvent.type){if("touchend"===e.nativeEvent.type){var n=[e.changedTouches[0].clientX,e.changedTouches[0].clientY];this.isEqualPos(this.startPos,n)&&t&&t(),e.preventDefault()}}else this.startPos=[e.changedTouches[0].clientX,e.changedTouches[0].clientY]},e.startPos=[0,0],e.isIPadStylusTouch=function(e){return s.default.isIPad&&e.changedTouches[0]&&e.changedTouches[0].touchType===a.stylus},e.isEqualPos=function(e,t){return Math.abs(e[0]-t[0])<10&&Math.abs(e[1]-t[1])<10},e}();t.StylusAdapter=i,t.WithStylusClick=function(e){var t=e.children,n=e.clickHandler;return o.default.cloneElement(t,{onClick:n,onTouchStart:function(e){return i.supportStylus(e,n)},onTouchEnd:function(e){return i.supportStylus(e,n)}})}},"../node_modules/@tencent/jank-sdk/lib/default.json":function(e){e.exports=JSON.parse('{"HeartbeatConfig":{"jankLimit":1000,"TriggerLimit":10,"StopOnPageHidden":true},"PageActiveConfig":{"Limit":180000}}')},"../node_modules/@tencent/jank-sdk/lib/index.js":function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b}));var r,a,o=n("../node_modules/@tencent/jank-sdk/lib/default.json"),s=function(){function e(){this._listeners={}}return e.prototype._hasEventListener=function(e,t){return void 0!==this._listeners[e]&&this._listeners[e].indexOf(t)>-1},e.prototype.addEventListener=function(e,t){this._hasEventListener(e,t)||(void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push(t))},e.prototype.removeEventListener=function(e,t){if(this._hasEventListener(e,t)){var n=this._listeners[e].indexOf(t);this._listeners[e].splice(n,1)}},e.prototype.dispatchEvent=function(e,t){if(void 0!==this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},e}(),i=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(e){function t(t){var n=e.call(this)||this;return n._handleVisibilityChange=function(){var e=document[r];"hidden"===e?n.stop():n.start(),n.dispatchEvent("pageVisiableChange",e)},n._tick=function(){n._timeoutTimer=null;var e=Date.now()-n._preHeartBeatTime;e>n._app.config.HeartbeatConfig.jankLimit?(n._triggerTimes++,n.dispatchEvent("jank",e)):n.dispatchEvent("heart",e),null===n._timeoutTimer&&n._checkNextTick()},n._app=t,n._status="uninit",n._preHeartBeatTime=0,n._timeoutTimer=null,n._triggerTimes=0,n}return i(t,e),t.prototype._init=function(){if(this._app.config.HeartbeatConfig.StopOnPageHidden){if("undefined"!==typeof document.hidden)a="visibilitychange",r="visibilityState";else if("undefined"!==typeof document.mozHidden)a="mozvisibilitychange",r="mozVisibilityState";else if("undefined"!==typeof document.msHidden)a="msvisibilitychange",r="msVisibilityState";else{if("undefined"===typeof document.webkitHidden)return;a="webkitvisibilitychange",r="webkitVisibilityState"}document.addEventListener(a,this._handleVisibilityChange)}},t.prototype._checkNextTick=function(){0!==this._app.config.HeartbeatConfig.TriggerLimit&&this._triggerTimes>=this._app.config.HeartbeatConfig.TriggerLimit?this._status="finish":(this._preHeartBeatTime=Date.now(),this._timeoutTimer=globalThis.requestAnimationFrame(this._tick))},t.prototype.start=function(){this._app.config.HeartbeatConfig.StopOnPageHidden&&document.hidden||("uninit"===this._status&&this._init(),"finish"!==this._status&&"run"!==this._status&&(this._timeoutTimer?console.warn("[jank] timeout exist"):(this._status="run",this._checkNextTick())))},t.prototype.stop=function(){"finish"!==this._status&&"stop"!==this._status&&(clearTimeout(this._timeoutTimer),this._timeoutTimer=null,this._status="stop")},t}(s),c=navigator.userAgent.toLowerCase(),u="pc"===(/(android)/.test(c)?"android":/(iphone|ipad|ipod)/.test(c)?"ios":"pc"),d=function(){function e(e){var t=this;this._timer=0,this._lastActive=0,this._check=function(){u?document.body.addEventListener("mousemove",t._handle):document.body.addEventListener("touchstart",t._handle)},this._handle=function(){u?document.body.removeEventListener("mousemove",t._handle):document.body.removeEventListener("touchstart",t._handle),t.start()},this._app=e,this._timeInterval=this._app.config.PageActiveConfig.Limit}return e.prototype.start=function(){this._lastActive=Date.now(),this._timer=setTimeout(this._check,this._timeInterval)},e.prototype.stop=function(){clearTimeout(this._timer)},e.prototype.lastActive=function(){return this._lastActive},e}(),f=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var h=new(function(e){function t(){var t=e.call(this)||this;return t._queue=[],t._taskStack=[],t._count=0,t}return f(t,e),t.prototype._runTask=function(){this.dispatchEvent("runTask")},t.prototype._overTask=function(){this._queue.push(this._parse()),this._taskStack=[],this._count=0,this._queue.length>5&&(this._queue=this._queue.slice(-5)),this.dispatchEvent("overTask")},t.prototype._parse=function(){for(var e,t=[],n=[],r=0;r<this._taskStack.length;r++)if((e=this._taskStack[r]).sub=[],void 0===t[0]||t[0].id!==e.id||t[0].type===e.type)(t[0]?t[0].sub:n).push(e),t.unshift(e);else{var a=t.shift();a.time=e.end-a.start,a.start=a.start,delete a.type}return n},Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"task",{get:function(){return this._queue[this._queue.length-1]},enumerable:!0,configurable:!0}),t.prototype.start=function(e){0===this._count&&this._runTask(),this._count++,this._taskStack.push({id:e,start:Date.now(),type:0})},t.prototype.end=function(e){this._taskStack.push({id:e,end:Date.now(),type:1}),this._count--,0===this._count&&this._overTask()},t.prototype.clear=function(){0===this._count?this._queue.length=0:console.warn("\u5806\u6808\u8bb0\u5f55\u6267\u884c\u8fc7\u7a0b\u4e2d\u65e0\u6cd5\u6e05\u9664")},t}(s));var p=function(e){return function(t,n,r){!function(e,t,n,r){var a;try{if(a=e.toString().match(/^(class|function)\s(\w+)[\(\s]/),"[object Array]"!==Object.prototype.toString.apply(a))return console.warn("proxy function error",a),r}catch(s){return console.warn("proxy function error",s),r}var o=a[2];if("string"!==typeof o)return r;e.prototype[n+"-decorators"]=r.value,r.value=function(){h.start(o+"-"+n);var t=e.prototype[n+"-decorators"].apply(this,arguments);return h.end(o+"-"+n),t}}(e,0,n,r)}};var g,m,b=function(e,t){if(!t){var n=void 0;try{if(n=e.toString().match(/^(function)\s(\w+)[\(\s]/),"[object Array]"!==Object.prototype.toString.apply(n))return console.warn("proxy function error"),e}catch(r){return console.warn("proxy function error",r),e}if(null===n)return e;t=n[2]}return"string"!==typeof t?e:function(){h.start(""+t);var n=e.apply(this,arguments);return h.end(""+t),n}};!function(e){e.REGISTER="jank_register",e.HEARTBEAT="jank_heartbeat",e.ASK_AMOUNT="jank_ask_amount",e.UNREGISTER="jank_unregister"}(g||(g={})),function(e){e.CONFIRM="jank_confirm",e.HEARTBEAT="jank_heartbeat",e.REPLY_AMOUNT="jank_reply_amount"}(m||(m={}));var v,I=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){e[e.UNINIT=0]="UNINIT",e[e.RUNNING=1]="RUNNING",e[e.FINISH=2]="FINISH"}(v||(v={}));var _=function(e){function t(){var t=e.call(this)||this;return t._status=v.UNINIT,t._controller=null,t._resolve=null,t._reject=null,t._handleMessage=function(e){var n=e.data;switch(n.type){case m.CONFIRM:break;case m.HEARTBEAT:t._heartbeat();break;case m.REPLY_AMOUNT:t._replyAmount(n.data);break;default:console.error("unknown response message in tabs amount")}},t._handleBeforeunload=function(){t._unregister()},t}return I(t,e),t.prototype._sendMessage=function(e){this._controller&&this._controller.postMessage&&this._controller.postMessage(e)},t.prototype._replyAmount=function(e){void 0===e&&this._reject("unknown error"),0===e.retcode?this._resolve(e.result):this._reject(e.result),this._resolve=null,this._reject=null},t.prototype._register=function(){this._sendMessage({type:g.REGISTER})},t.prototype._unregister=function(){this._sendMessage({type:g.UNREGISTER})},t.prototype._heartbeat=function(){this._sendMessage({type:g.HEARTBEAT})},t.prototype._askAmount=function(){this._sendMessage({type:g.ASK_AMOUNT})},t.prototype._addEventListener=function(){navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",this._handleMessage),window.addEventListener("beforeunload",this._handleBeforeunload)},t.prototype.start=function(){this._status==v.UNINIT?navigator.serviceWorker?navigator.serviceWorker.controller?(this._controller=navigator.serviceWorker.controller,this._status=v.RUNNING,this._register(),this._addEventListener()):console.error("please register service by business code"):console.error("can't use service-worker in this client"):console.error("only can start tabs amount once")},t.prototype.end=function(){this._status=v.FINISH,this._unregister()},t.prototype.amount=function(){var e=this;return null!==this._resolve||null!==this._reject?Promise.reject("repeat request"):(this._askAmount(),new Promise((function(t,n){e._resolve=t,e._reject=n})))},t}(s),y=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),R=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return t.HeartbeatConfig&&Object.assign(o.HeartbeatConfig,t.HeartbeatConfig),t.PageActiveConfig&&Object.assign(o.PageActiveConfig,t.PageActiveConfig),n._config=Object.assign(o,t),n._initHeartbeatMonitor(),n._initPageActiveMonitor(),n._initTabsAmountMonitor(),n._traceStack=h,n}return y(t,e),t.prototype._initHeartbeatMonitor=function(){this._heartbeatMonitor=new l(this)},t.prototype._initPageActiveMonitor=function(){this._pageActiveMonitor=new d(this)},t.prototype._initTabsAmountMonitor=function(){this._tabsAmountMonitor=new _},Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"heartbeatMonitor",{get:function(){return this._heartbeatMonitor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageActiveMonitor",{get:function(){return this._pageActiveMonitor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabsAmountMonitor",{get:function(){return this._tabsAmountMonitor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"traceStack",{get:function(){return this._traceStack},enumerable:!0,configurable:!0}),t}(s);t.a=R},"../node_modules/atob/browser-atob.js":function(e,t,n){(function(e,t){!function(n){"use strict";var r,a="function"===typeof(r=n.atob)?r:"function"===typeof e?function(t){return new e(t,"base64").toString("binary")}:"object"===typeof n.base64js?function(e){var t=n.base64js.b64ToByteArray(e);return Array.prototype.map.call(t,(function(e){return String.fromCharCode(e)})).join("")}:function(){throw new Error("You're probably in an old browser or an iOS webworker. It might help to include beatgammit's base64-js.")};n.atob=a,t&&t.exports&&(t.exports=a)}(window)}).call(this,n("../node_modules/buffer/index.js").Buffer,n("../node_modules/webpack/buildin/module.js")(e))},"../node_modules/core-js/internals/math-sign.js":function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},"../node_modules/core-js/modules/es.math.sign.js":function(e,t,n){n("../node_modules/core-js/internals/export.js")({target:"Math",stat:!0},{sign:n("../node_modules/core-js/internals/math-sign.js")})},"../node_modules/lodash/throttle.js":function(e,t,n){var r=n("../node_modules/lodash/debounce.js"),a=n("../node_modules/lodash/isObject.js");e.exports=function(e,t,n){var o=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return a(n)&&(o="leading"in n?!!n.leading:o,s="trailing"in n?!!n.trailing:s),r(e,t,{leading:o,maxWait:t,trailing:s})}},"../node_modules/pako/index.js":function(e,t,n){"use strict";var r={};(0,n("../node_modules/pako/lib/utils/common.js").assign)(r,n("../node_modules/pako/lib/deflate.js"),n("../node_modules/pako/lib/inflate.js"),n("../node_modules/pako/lib/zlib/constants.js")),e.exports=r},"../node_modules/pako/lib/deflate.js":function(e,t,n){"use strict";var r=n("../node_modules/pako/lib/zlib/deflate.js"),a=n("../node_modules/pako/lib/utils/common.js"),o=n("../node_modules/pako/lib/utils/strings.js"),s=n("../node_modules/pako/lib/zlib/messages.js"),i=n("../node_modules/pako/lib/zlib/zstream.js"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=a.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(s[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"===typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=r.deflateSetDictionary(this.strm,u)))throw new Error(s[n]);this._dict_set=!0}}function u(e,t){var n=new c(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}c.prototype.push=function(e,t){var n,s,i=this.strm,c=this.options.chunkSize;if(this.ended)return!1;s=t===~~t?t:!0===t?4:0,"string"===typeof e?i.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new a.Buf8(c),i.next_out=0,i.avail_out=c),1!==(n=r.deflate(i,s))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==i.avail_out&&(0!==i.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(o.buf2binstring(a.shrinkBuf(i.output,i.next_out))):this.onData(a.shrinkBuf(i.output,i.next_out)))}while((i.avail_in>0||0===i.avail_out)&&1!==n);return 4===s?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==s||(this.onEnd(0),i.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=c,t.deflate=u,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},"../node_modules/pako/lib/inflate.js":function(e,t,n){"use strict";var r=n("../node_modules/pako/lib/zlib/inflate.js"),a=n("../node_modules/pako/lib/utils/common.js"),o=n("../node_modules/pako/lib/utils/strings.js"),s=n("../node_modules/pako/lib/zlib/constants.js"),i=n("../node_modules/pako/lib/zlib/messages.js"),l=n("../node_modules/pako/lib/zlib/zstream.js"),c=n("../node_modules/pako/lib/zlib/gzheader.js"),u=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==s.Z_OK)throw new Error(i[n]);if(this.header=new c,r.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=r.inflateSetDictionary(this.strm,t.dictionary))!==s.Z_OK))throw new Error(i[n])}function f(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||i[n.err];return n.result}d.prototype.push=function(e,t){var n,i,l,c,d,f=this.strm,h=this.options.chunkSize,p=this.options.dictionary,g=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"===typeof e?f.input=o.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new a.Buf8(h),f.next_out=0,f.avail_out=h),(n=r.inflate(f,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(n=r.inflateSetDictionary(this.strm,p)),n===s.Z_BUF_ERROR&&!0===g&&(n=s.Z_OK,g=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&n!==s.Z_STREAM_END&&(0!==f.avail_in||i!==s.Z_FINISH&&i!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(f.output,f.next_out),c=f.next_out-l,d=o.buf2string(f.output,l),f.next_out=c,f.avail_out=h-c,c&&a.arraySet(f.output,f.output,l,c,0),this.onData(d)):this.onData(a.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((f.avail_in>0||0===f.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(i=s.Z_FINISH),i===s.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):i!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),f.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=d,t.inflate=f,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},t.ungzip=f},"../node_modules/pako/lib/utils/common.js":function(e,t,n){"use strict";var r="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Int32Array;function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!==typeof n)throw new TypeError(n+"must be non-object");for(var r in n)a(n,r)&&(e[r]=n[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,n,r,a){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),a);else for(var o=0;o<r;o++)e[a+o]=t[n+o]},flattenChunks:function(e){var t,n,r,a,o,s;for(r=0,t=0,n=e.length;t<n;t++)r+=e[t].length;for(s=new Uint8Array(r),a=0,t=0,n=e.length;t<n;t++)o=e[t],s.set(o,a),a+=o.length;return s}},s={arraySet:function(e,t,n,r,a){for(var o=0;o<r;o++)e[a+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(r)},"../node_modules/pako/lib/utils/strings.js":function(e,t,n){"use strict";var r=n("../node_modules/pako/lib/utils/common.js"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(c){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){o=!1}for(var s=new r.Buf8(256),i=0;i<256;i++)s[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&a))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",s=0;s<t;s++)n+=String.fromCharCode(e[s]);return n}s[254]=s[254]=1,t.string2buf=function(e){var t,n,a,o,s,i=e.length,l=0;for(o=0;o<i;o++)55296===(64512&(n=e.charCodeAt(o)))&&o+1<i&&56320===(64512&(a=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(a-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),s=0,o=0;s<l;o++)55296===(64512&(n=e.charCodeAt(o)))&&o+1<i&&56320===(64512&(a=e.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(a-56320),o++),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,a=t.length;n<a;n++)t[n]=e.charCodeAt(n);return t},t.buf2string=function(e,t){var n,r,a,o,i=t||e.length,c=new Array(2*i);for(r=0,n=0;n<i;)if((a=e[n++])<128)c[r++]=a;else if((o=s[a])>4)c[r++]=65533,n+=o-1;else{for(a&=2===o?31:3===o?15:7;o>1&&n<i;)a=a<<6|63&e[n++],o--;o>1?c[r++]=65533:a<65536?c[r++]=a:(a-=65536,c[r++]=55296|a>>10&1023,c[r++]=56320|1023&a)}return l(c,r)},t.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128===(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}},"../node_modules/pako/lib/zlib/adler32.js":function(e,t,n){"use strict";e.exports=function(e,t,n,r){for(var a=65535&e|0,o=e>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{o=o+(a=a+t[r++]|0)|0}while(--s);a%=65521,o%=65521}return a|o<<16|0}},"../node_modules/pako/lib/zlib/constants.js":function(e,t,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"../node_modules/pako/lib/zlib/crc32.js":function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,a){var o=r,s=a+n;e^=-1;for(var i=a;i<s;i++)e=e>>>8^o[255&(e^t[i])];return-1^e}},"../node_modules/pako/lib/zlib/deflate.js":function(e,t,n){"use strict";var r,a=n("../node_modules/pako/lib/utils/common.js"),o=n("../node_modules/pako/lib/zlib/trees.js"),s=n("../node_modules/pako/lib/zlib/adler32.js"),i=n("../node_modules/pako/lib/zlib/crc32.js"),l=n("../node_modules/pako/lib/zlib/messages.js");function c(e,t){return e.msg=l[t],t}function u(e){return(e<<1)-(e>4?9:0)}function d(e){for(var t=e.length;--t>=0;)e[t]=0}function f(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(a.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function h(e,t){o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,f(e.strm)}function p(e,t){e.pending_buf[e.pending++]=t}function g(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function m(e,t,n,r){var o=e.avail_in;return o>r&&(o=r),0===o?0:(e.avail_in-=o,a.arraySet(t,e.input,e.next_in,o,n),1===e.state.wrap?e.adler=s(e.adler,t,o,n):2===e.state.wrap&&(e.adler=i(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)}function b(e,t){var n,r,a=e.max_chain_length,o=e.strstart,s=e.prev_length,i=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,u=e.w_mask,d=e.prev,f=e.strstart+258,h=c[o+s-1],p=c[o+s];e.prev_length>=e.good_match&&(a>>=2),i>e.lookahead&&(i=e.lookahead);do{if(c[(n=t)+s]===p&&c[n+s-1]===h&&c[n]===c[o]&&c[++n]===c[o+1]){o+=2,n++;do{}while(c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<f);if(r=258-(f-o),o=f-258,r>s){if(e.match_start=t,s=r,r>=i)break;h=c[o+s-1],p=c[o+s]}}}while((t=d[t&u])>l&&0!==--a);return s<=e.lookahead?s:e.lookahead}function v(e){var t,n,r,o,s,i=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=i+(i-262)){a.arraySet(e.window,e.window,i,i,0),e.match_start-=i,e.strstart-=i,e.block_start-=i,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=i?r-i:0}while(--n);t=n=i;do{r=e.prev[--t],e.prev[t]=r>=i?r-i:0}while(--n);o+=i}if(0===e.strm.avail_in)break;if(n=m(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=n,e.lookahead+e.insert>=3)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+3-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function I(e,t){for(var n,r;;){if(e.lookahead<262){if(v(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=b(e,n)),e.match_length>=3)if(r=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}function _(e,t){for(var n,r,a;;){if(e.lookahead<262){if(v(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=b(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,r=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(h(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=o._tr_tally(e,0,e.window[e.strstart-1]))&&h(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}function y(e,t,n,r,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=a}function R(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(1146),this.dyn_dtree=new a.Buf16(122),this.bl_tree=new a.Buf16(78),d(this.dyn_ltree),d(this.dyn_dtree),d(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(16),this.heap=new a.Buf16(573),d(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(573),d(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function E(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):c(e,-2)}function O(e){var t,n=E(e);return 0===n&&((t=e.state).window_size=2*t.w_size,d(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function S(e,t,n,r,o,s){if(!e)return-2;var i=1;if(-1===t&&(t=6),r<0?(i=0,r=-r):r>15&&(i=2,r-=16),o<1||o>9||8!==n||r<8||r>15||t<0||t>9||s<0||s>4)return c(e,-2);8===r&&(r=9);var l=new R;return e.state=l,l.strm=e,l.wrap=i,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new a.Buf8(2*l.w_size),l.head=new a.Buf16(l.hash_size),l.prev=new a.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new a.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=s,l.method=n,O(e)}r=[new y(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(v(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,h(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(h(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(h(e,!1),e.strm.avail_out),1)})),new y(4,4,8,4,I),new y(4,5,16,8,I),new y(4,6,32,32,I),new y(4,4,16,16,_),new y(8,16,32,32,_),new y(8,16,128,128,_),new y(8,32,128,256,_),new y(32,128,258,1024,_),new y(32,258,258,4096,_)],t.deflateInit=function(e,t){return S(e,t,8,15,8,0)},t.deflateInit2=S,t.deflateReset=O,t.deflateResetKeep=E,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},t.deflate=function(e,t){var n,a,s,l;if(!e||!e.state||t>5||t<0)return e?c(e,-2):-2;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||666===a.status&&4!==t)return c(e,0===e.avail_out?-5:-2);if(a.strm=e,n=a.last_flush,a.last_flush=t,42===a.status)if(2===a.wrap)e.adler=0,p(a,31),p(a,139),p(a,8),a.gzhead?(p(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),p(a,255&a.gzhead.time),p(a,a.gzhead.time>>8&255),p(a,a.gzhead.time>>16&255),p(a,a.gzhead.time>>24&255),p(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),p(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(p(a,255&a.gzhead.extra.length),p(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=i(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(p(a,0),p(a,0),p(a,0),p(a,0),p(a,0),p(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),p(a,3),a.status=113);else{var m=8+(a.w_bits-8<<4)<<8;m|=(a.strategy>=2||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(m|=32),m+=31-m%31,a.status=113,g(a,m),0!==a.strstart&&(g(a,e.adler>>>16),g(a,65535&e.adler)),e.adler=1}if(69===a.status)if(a.gzhead.extra){for(s=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>s&&(e.adler=i(e.adler,a.pending_buf,a.pending-s,s)),f(e),s=a.pending,a.pending!==a.pending_buf_size));)p(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>s&&(e.adler=i(e.adler,a.pending_buf,a.pending-s,s)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=i(e.adler,a.pending_buf,a.pending-s,s)),f(e),s=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,p(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>s&&(e.adler=i(e.adler,a.pending_buf,a.pending-s,s)),0===l&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){s=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>s&&(e.adler=i(e.adler,a.pending_buf,a.pending-s,s)),f(e),s=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,p(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>s&&(e.adler=i(e.adler,a.pending_buf,a.pending-s,s)),0===l&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&f(e),a.pending+2<=a.pending_buf_size&&(p(a,255&e.adler),p(a,e.adler>>8&255),e.adler=0,a.status=113)):a.status=113),0!==a.pending){if(f(e),0===e.avail_out)return a.last_flush=-1,0}else if(0===e.avail_in&&u(t)<=u(n)&&4!==t)return c(e,-5);if(666===a.status&&0!==e.avail_in)return c(e,-5);if(0!==e.avail_in||0!==a.lookahead||0!==t&&666!==a.status){var b=2===a.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(v(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}(a,t):3===a.strategy?function(e,t){for(var n,r,a,s,i=e.window;;){if(e.lookahead<=258){if(v(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=i[a=e.strstart-1])===i[++a]&&r===i[++a]&&r===i[++a]){s=e.strstart+258;do{}while(r===i[++a]&&r===i[++a]&&r===i[++a]&&r===i[++a]&&r===i[++a]&&r===i[++a]&&r===i[++a]&&r===i[++a]&&a<s);e.match_length=258-(s-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(h(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(h(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(h(e,!1),0===e.strm.avail_out)?1:2}(a,t):r[a.level].func(a,t);if(3!==b&&4!==b||(a.status=666),1===b||3===b)return 0===e.avail_out&&(a.last_flush=-1),0;if(2===b&&(1===t?o._tr_align(a):5!==t&&(o._tr_stored_block(a,0,0,!1),3===t&&(d(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),f(e),0===e.avail_out))return a.last_flush=-1,0}return 4!==t?0:a.wrap<=0?1:(2===a.wrap?(p(a,255&e.adler),p(a,e.adler>>8&255),p(a,e.adler>>16&255),p(a,e.adler>>24&255),p(a,255&e.total_in),p(a,e.total_in>>8&255),p(a,e.total_in>>16&255),p(a,e.total_in>>24&255)):(g(a,e.adler>>>16),g(a,65535&e.adler)),f(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?c(e,-2):(e.state=null,113===t?c(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var n,r,o,i,l,c,u,f,h=t.length;if(!e||!e.state)return-2;if(2===(i=(n=e.state).wrap)||1===i&&42!==n.status||n.lookahead)return-2;for(1===i&&(e.adler=s(e.adler,t,h,0)),n.wrap=0,h>=n.w_size&&(0===i&&(d(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new a.Buf8(n.w_size),a.arraySet(f,t,h-n.w_size,n.w_size,0),t=f,h=n.w_size),l=e.avail_in,c=e.next_in,u=e.input,e.avail_in=h,e.next_in=0,e.input=t,v(n);n.lookahead>=3;){r=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--o);n.strstart=r,n.lookahead=2,v(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=c,e.input=u,e.avail_in=l,n.wrap=i,0},t.deflateInfo="pako deflate (from Nodeca project)"},"../node_modules/pako/lib/zlib/gzheader.js":function(e,t,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},"../node_modules/pako/lib/zlib/inffast.js":function(e,t,n){"use strict";e.exports=function(e,t){var n,r,a,o,s,i,l,c,u,d,f,h,p,g,m,b,v,I,_,y,R,E,O,S,T;n=e.state,r=e.next_in,S=e.input,a=r+(e.avail_in-5),o=e.next_out,T=e.output,s=o-(t-e.avail_out),i=o+(e.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,d=n.wnext,f=n.window,h=n.hold,p=n.bits,g=n.lencode,m=n.distcode,b=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{p<15&&(h+=S[r++]<<p,p+=8,h+=S[r++]<<p,p+=8),I=g[h&b];t:for(;;){if(h>>>=_=I>>>24,p-=_,0===(_=I>>>16&255))T[o++]=65535&I;else{if(!(16&_)){if(0===(64&_)){I=g[(65535&I)+(h&(1<<_)-1)];continue t}if(32&_){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}y=65535&I,(_&=15)&&(p<_&&(h+=S[r++]<<p,p+=8),y+=h&(1<<_)-1,h>>>=_,p-=_),p<15&&(h+=S[r++]<<p,p+=8,h+=S[r++]<<p,p+=8),I=m[h&v];n:for(;;){if(h>>>=_=I>>>24,p-=_,!(16&(_=I>>>16&255))){if(0===(64&_)){I=m[(65535&I)+(h&(1<<_)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(R=65535&I,p<(_&=15)&&(h+=S[r++]<<p,(p+=8)<_&&(h+=S[r++]<<p,p+=8)),(R+=h&(1<<_)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=_,p-=_,R>(_=o-s)){if((_=R-_)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,O=f,0===d){if(E+=c-_,_<y){y-=_;do{T[o++]=f[E++]}while(--_);E=o-R,O=T}}else if(d<_){if(E+=c+d-_,(_-=d)<y){y-=_;do{T[o++]=f[E++]}while(--_);if(E=0,d<y){y-=_=d;do{T[o++]=f[E++]}while(--_);E=o-R,O=T}}}else if(E+=d-_,_<y){y-=_;do{T[o++]=f[E++]}while(--_);E=o-R,O=T}for(;y>2;)T[o++]=O[E++],T[o++]=O[E++],T[o++]=O[E++],y-=3;y&&(T[o++]=O[E++],y>1&&(T[o++]=O[E++]))}else{E=o-R;do{T[o++]=T[E++],T[o++]=T[E++],T[o++]=T[E++],y-=3}while(y>2);y&&(T[o++]=T[E++],y>1&&(T[o++]=T[E++]))}break}}break}}while(r<a&&o<i);r-=y=p>>3,h&=(1<<(p-=y<<3))-1,e.next_in=r,e.next_out=o,e.avail_in=r<a?a-r+5:5-(r-a),e.avail_out=o<i?i-o+257:257-(o-i),n.hold=h,n.bits=p}},"../node_modules/pako/lib/zlib/inflate.js":function(e,t,n){"use strict";var r=n("../node_modules/pako/lib/utils/common.js"),a=n("../node_modules/pako/lib/zlib/adler32.js"),o=n("../node_modules/pako/lib/zlib/crc32.js"),s=n("../node_modules/pako/lib/zlib/inffast.js"),i=n("../node_modules/pako/lib/zlib/inftrees.js");function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):-2}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,u(e)):-2}function f(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,d(e))):-2}function h(e,t){var n,r;return e?(r=new c,e.state=r,r.window=null,0!==(n=f(e,t))&&(e.state=null),n):-2}var p,g,m=!0;function b(e){if(m){var t;for(p=new r.Buf32(512),g=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(i(1,e.lens,0,288,p,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;i(2,e.lens,0,32,g,0,e.work,{bits:5}),m=!1}e.lencode=p,e.lenbits=9,e.distcode=g,e.distbits=5}function v(e,t,n,a){var o,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),a>=s.wsize?(r.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((o=s.wsize-s.wnext)>a&&(o=a),r.arraySet(s.window,t,n-a,o,s.wnext),(a-=o)?(r.arraySet(s.window,t,n-a,a,0),s.wnext=a,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}t.inflateReset=d,t.inflateReset2=f,t.inflateResetKeep=u,t.inflateInit=function(e){return h(e,15)},t.inflateInit2=h,t.inflate=function(e,t){var n,c,u,d,f,h,p,g,m,I,_,y,R,E,O,S,T,w,k,j,x,C,D,A,M=0,L=new r.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),f=e.next_out,u=e.output,p=e.avail_out,d=e.next_in,c=e.input,h=e.avail_in,g=n.hold,m=n.bits,I=h,_=p,C=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;m<16;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if(2&n.wrap&&35615===g){n.check=0,L[0]=255&g,L[1]=g>>>8&255,n.check=o(n.check,L,2,0),g=0,m=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!==(15&g)){e.msg="unknown compression method",n.mode=30;break}if(m-=4,x=8+(15&(g>>>=4)),0===n.wbits)n.wbits=x;else if(x>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<x,e.adler=n.check=1,n.mode=512&g?10:12,g=0,m=0;break;case 2:for(;m<16;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if(n.flags=g,8!==(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=g>>8&1),512&n.flags&&(L[0]=255&g,L[1]=g>>>8&255,n.check=o(n.check,L,2,0)),g=0,m=0,n.mode=3;case 3:for(;m<32;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}n.head&&(n.head.time=g),512&n.flags&&(L[0]=255&g,L[1]=g>>>8&255,L[2]=g>>>16&255,L[3]=g>>>24&255,n.check=o(n.check,L,4,0)),g=0,m=0,n.mode=4;case 4:for(;m<16;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}n.head&&(n.head.xflags=255&g,n.head.os=g>>8),512&n.flags&&(L[0]=255&g,L[1]=g>>>8&255,n.check=o(n.check,L,2,0)),g=0,m=0,n.mode=5;case 5:if(1024&n.flags){for(;m<16;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}n.length=g,n.head&&(n.head.extra_len=g),512&n.flags&&(L[0]=255&g,L[1]=g>>>8&255,n.check=o(n.check,L,2,0)),g=0,m=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((y=n.length)>h&&(y=h),y&&(n.head&&(x=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,c,d,y,x)),512&n.flags&&(n.check=o(n.check,c,y,d)),h-=y,d+=y,n.length-=y),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===h)break e;y=0;do{x=c[d+y++],n.head&&x&&n.length<65536&&(n.head.name+=String.fromCharCode(x))}while(x&&y<h);if(512&n.flags&&(n.check=o(n.check,c,y,d)),h-=y,d+=y,x)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===h)break e;y=0;do{x=c[d+y++],n.head&&x&&n.length<65536&&(n.head.comment+=String.fromCharCode(x))}while(x&&y<h);if(512&n.flags&&(n.check=o(n.check,c,y,d)),h-=y,d+=y,x)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;m<16;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if(g!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}g=0,m=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;m<32;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}e.adler=n.check=l(g),g=0,m=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=f,e.avail_out=p,e.next_in=d,e.avail_in=h,n.hold=g,n.bits=m,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){g>>>=7&m,m-=7&m,n.mode=27;break}for(;m<3;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}switch(n.last=1&g,m-=1,3&(g>>>=1)){case 0:n.mode=14;break;case 1:if(b(n),n.mode=20,6===t){g>>>=2,m-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}g>>>=2,m-=2;break;case 14:for(g>>>=7&m,m-=7&m;m<32;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if((65535&g)!==(g>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&g,g=0,m=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(y=n.length){if(y>h&&(y=h),y>p&&(y=p),0===y)break e;r.arraySet(u,c,d,y,f),h-=y,d+=y,p-=y,f+=y,n.length-=y;break}n.mode=12;break;case 17:for(;m<14;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if(n.nlen=257+(31&g),g>>>=5,m-=5,n.ndist=1+(31&g),g>>>=5,m-=5,n.ncode=4+(15&g),g>>>=4,m-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;m<3;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}n.lens[N[n.have++]]=7&g,g>>>=3,m-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,D={bits:n.lenbits},C=i(0,n.lens,0,19,n.lencode,0,n.work,D),n.lenbits=D.bits,C){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;S=(M=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,T=65535&M,!((O=M>>>24)<=m);){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if(T<16)g>>>=O,m-=O,n.lens[n.have++]=T;else{if(16===T){for(A=O+2;m<A;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if(g>>>=O,m-=O,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}x=n.lens[n.have-1],y=3+(3&g),g>>>=2,m-=2}else if(17===T){for(A=O+3;m<A;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}m-=O,x=0,y=3+(7&(g>>>=O)),g>>>=3,m-=3}else{for(A=O+7;m<A;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}m-=O,x=0,y=11+(127&(g>>>=O)),g>>>=7,m-=7}if(n.have+y>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;y--;)n.lens[n.have++]=x}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,D={bits:n.lenbits},C=i(1,n.lens,0,n.nlen,n.lencode,0,n.work,D),n.lenbits=D.bits,C){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,D={bits:n.distbits},C=i(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D),n.distbits=D.bits,C){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(h>=6&&p>=258){e.next_out=f,e.avail_out=p,e.next_in=d,e.avail_in=h,n.hold=g,n.bits=m,s(e,_),f=e.next_out,u=e.output,p=e.avail_out,d=e.next_in,c=e.input,h=e.avail_in,g=n.hold,m=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;S=(M=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,T=65535&M,!((O=M>>>24)<=m);){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if(S&&0===(240&S)){for(w=O,k=S,j=T;S=(M=n.lencode[j+((g&(1<<w+k)-1)>>w)])>>>16&255,T=65535&M,!(w+(O=M>>>24)<=m);){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}g>>>=w,m-=w,n.back+=w}if(g>>>=O,m-=O,n.back+=O,n.length=T,0===S){n.mode=26;break}if(32&S){n.back=-1,n.mode=12;break}if(64&S){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&S,n.mode=22;case 22:if(n.extra){for(A=n.extra;m<A;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}n.length+=g&(1<<n.extra)-1,g>>>=n.extra,m-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;S=(M=n.distcode[g&(1<<n.distbits)-1])>>>16&255,T=65535&M,!((O=M>>>24)<=m);){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if(0===(240&S)){for(w=O,k=S,j=T;S=(M=n.distcode[j+((g&(1<<w+k)-1)>>w)])>>>16&255,T=65535&M,!(w+(O=M>>>24)<=m);){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}g>>>=w,m-=w,n.back+=w}if(g>>>=O,m-=O,n.back+=O,64&S){e.msg="invalid distance code",n.mode=30;break}n.offset=T,n.extra=15&S,n.mode=24;case 24:if(n.extra){for(A=n.extra;m<A;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}n.offset+=g&(1<<n.extra)-1,g>>>=n.extra,m-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===p)break e;if(y=_-p,n.offset>y){if((y=n.offset-y)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}y>n.wnext?(y-=n.wnext,R=n.wsize-y):R=n.wnext-y,y>n.length&&(y=n.length),E=n.window}else E=u,R=f-n.offset,y=n.length;y>p&&(y=p),p-=y,n.length-=y;do{u[f++]=E[R++]}while(--y);0===n.length&&(n.mode=21);break;case 26:if(0===p)break e;u[f++]=n.length,p--,n.mode=21;break;case 27:if(n.wrap){for(;m<32;){if(0===h)break e;h--,g|=c[d++]<<m,m+=8}if(_-=p,e.total_out+=_,n.total+=_,_&&(e.adler=n.check=n.flags?o(n.check,u,_,f-_):a(n.check,u,_,f-_)),_=p,(n.flags?g:l(g))!==n.check){e.msg="incorrect data check",n.mode=30;break}g=0,m=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;m<32;){if(0===h)break e;h--,g+=c[d++]<<m,m+=8}if(g!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}g=0,m=0}n.mode=29;case 29:C=1;break e;case 30:C=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=f,e.avail_out=p,e.next_in=d,e.avail_in=h,n.hold=g,n.bits=m,(n.wsize||_!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&v(e,e.output,e.next_out,_-e.avail_out)?(n.mode=31,-4):(I-=e.avail_in,_-=e.avail_out,e.total_in+=I,e.total_out+=_,n.total+=_,n.wrap&&_&&(e.adler=n.check=n.flags?o(n.check,u,_,e.next_out-_):a(n.check,u,_,e.next_out-_)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===I&&0===_||4===t)&&0===C&&(C=-5),C)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0===(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&a(1,t,r,0)!==n.check?-3:v(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},"../node_modules/pako/lib/zlib/inftrees.js":function(e,t,n){"use strict";var r=n("../node_modules/pako/lib/utils/common.js"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],i=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,l,c,u,d,f){var h,p,g,m,b,v,I,_,y,R=f.bits,E=0,O=0,S=0,T=0,w=0,k=0,j=0,x=0,C=0,D=0,A=null,M=0,L=new r.Buf16(16),N=new r.Buf16(16),U=null,P=0;for(E=0;E<=15;E++)L[E]=0;for(O=0;O<l;O++)L[t[n+O]]++;for(w=R,T=15;T>=1&&0===L[T];T--);if(w>T&&(w=T),0===T)return c[u++]=20971520,c[u++]=20971520,f.bits=1,0;for(S=1;S<T&&0===L[S];S++);for(w<S&&(w=S),x=1,E=1;E<=15;E++)if(x<<=1,(x-=L[E])<0)return-1;if(x>0&&(0===e||1!==T))return-1;for(N[1]=0,E=1;E<15;E++)N[E+1]=N[E]+L[E];for(O=0;O<l;O++)0!==t[n+O]&&(d[N[t[n+O]]++]=O);if(0===e?(A=U=d,v=19):1===e?(A=a,M-=257,U=o,P-=257,v=256):(A=s,U=i,v=-1),D=0,O=0,E=S,b=u,k=w,j=0,g=-1,m=(C=1<<w)-1,1===e&&C>852||2===e&&C>592)return 1;for(;;){I=E-j,d[O]<v?(_=0,y=d[O]):d[O]>v?(_=U[P+d[O]],y=A[M+d[O]]):(_=96,y=0),h=1<<E-j,S=p=1<<k;do{c[b+(D>>j)+(p-=h)]=I<<24|_<<16|y|0}while(0!==p);for(h=1<<E-1;D&h;)h>>=1;if(0!==h?(D&=h-1,D+=h):D=0,O++,0===--L[E]){if(E===T)break;E=t[n+d[O]]}if(E>w&&(D&m)!==g){for(0===j&&(j=w),b+=S,x=1<<(k=E-j);k+j<T&&!((x-=L[k+j])<=0);)k++,x<<=1;if(C+=1<<k,1===e&&C>852||2===e&&C>592)return 1;c[g=D&m]=w<<24|k<<16|b-u|0}}return 0!==D&&(c[b+D]=E-j<<24|64<<16|0),f.bits=w,0}},"../node_modules/pako/lib/zlib/messages.js":function(e,t,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"../node_modules/pako/lib/zlib/trees.js":function(e,t,n){"use strict";var r=n("../node_modules/pako/lib/utils/common.js");function a(e){for(var t=e.length;--t>=0;)e[t]=0}var o=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=new Array(576);a(c);var u=new Array(60);a(u);var d=new Array(512);a(d);var f=new Array(256);a(f);var h=new Array(29);a(h);var p,g,m,b=new Array(30);function v(e,t,n,r,a){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=a,this.has_stree=e&&e.length}function I(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function _(e){return e<256?d[e]:d[256+(e>>>7)]}function y(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function R(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,y(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function E(e,t,n){R(e,n[2*t],n[2*t+1])}function O(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function S(e,t,n){var r,a,o=new Array(16),s=0;for(r=1;r<=15;r++)o[r]=s=s+n[r-1]<<1;for(a=0;a<=t;a++){var i=e[2*a+1];0!==i&&(e[2*a]=O(o[i]++,i))}}function T(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function w(e){e.bi_valid>8?y(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function k(e,t,n,r){var a=2*t,o=2*n;return e[a]<e[o]||e[a]===e[o]&&r[t]<=r[n]}function j(e,t,n){for(var r=e.heap[n],a=n<<1;a<=e.heap_len&&(a<e.heap_len&&k(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!k(t,r,e.heap[a],e.depth));)e.heap[n]=e.heap[a],n=a,a<<=1;e.heap[n]=r}function x(e,t,n){var r,a,i,l,c=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],a=e.pending_buf[e.l_buf+c],c++,0===r?E(e,a,t):(E(e,(i=f[a])+256+1,t),0!==(l=o[i])&&R(e,a-=h[i],l),E(e,i=_(--r),n),0!==(l=s[i])&&R(e,r-=b[i],l))}while(c<e.last_lit);E(e,256,t)}function C(e,t){var n,r,a,o=t.dyn_tree,s=t.stat_desc.static_tree,i=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==o[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)o[2*(a=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[a]=0,e.opt_len--,i&&(e.static_len-=s[2*a+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)j(e,o,n);a=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],j(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*a]=o[2*n]+o[2*r],e.depth[a]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=a,e.heap[1]=a++,j(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,a,o,s,i,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,p=t.stat_desc.max_length,g=0;for(o=0;o<=15;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(o=l[2*l[2*(r=e.heap[n])+1]+1]+1)>p&&(o=p,g++),l[2*r+1]=o,r>c||(e.bl_count[o]++,s=0,r>=h&&(s=f[r-h]),i=l[2*r],e.opt_len+=i*(o+s),d&&(e.static_len+=i*(u[2*r+1]+s)));if(0!==g){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,g-=2}while(g>0);for(o=p;0!==o;o--)for(r=e.bl_count[o];0!==r;)(a=e.heap[--n])>c||(l[2*a+1]!==o&&(e.opt_len+=(o-l[2*a+1])*l[2*a],l[2*a+1]=o),r--)}}(e,t),S(o,c,e.bl_count)}function D(e,t,n){var r,a,o=-1,s=t[1],i=0,l=7,c=4;for(0===s&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)a=s,s=t[2*(r+1)+1],++i<l&&a===s||(i<c?e.bl_tree[2*a]+=i:0!==a?(a!==o&&e.bl_tree[2*a]++,e.bl_tree[32]++):i<=10?e.bl_tree[34]++:e.bl_tree[36]++,i=0,o=a,0===s?(l=138,c=3):a===s?(l=6,c=3):(l=7,c=4))}function A(e,t,n){var r,a,o=-1,s=t[1],i=0,l=7,c=4;for(0===s&&(l=138,c=3),r=0;r<=n;r++)if(a=s,s=t[2*(r+1)+1],!(++i<l&&a===s)){if(i<c)do{E(e,a,e.bl_tree)}while(0!==--i);else 0!==a?(a!==o&&(E(e,a,e.bl_tree),i--),E(e,16,e.bl_tree),R(e,i-3,2)):i<=10?(E(e,17,e.bl_tree),R(e,i-3,3)):(E(e,18,e.bl_tree),R(e,i-11,7));i=0,o=a,0===s?(l=138,c=3):a===s?(l=6,c=3):(l=7,c=4)}}a(b);var M=!1;function L(e,t,n,a){R(e,0+(a?1:0),3),function(e,t,n,a){w(e),a&&(y(e,n),y(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}t._tr_init=function(e){M||(!function(){var e,t,n,r,a,l=new Array(16);for(n=0,r=0;r<28;r++)for(h[r]=n,e=0;e<1<<o[r];e++)f[n++]=r;for(f[n-1]=r,a=0,r=0;r<16;r++)for(b[r]=a,e=0;e<1<<s[r];e++)d[a++]=r;for(a>>=7;r<30;r++)for(b[r]=a<<7,e=0;e<1<<s[r]-7;e++)d[256+a++]=r;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)c[2*e+1]=8,e++,l[8]++;for(;e<=255;)c[2*e+1]=9,e++,l[9]++;for(;e<=279;)c[2*e+1]=7,e++,l[7]++;for(;e<=287;)c[2*e+1]=8,e++,l[8]++;for(S(c,287,l),e=0;e<30;e++)u[2*e+1]=5,u[2*e]=O(e,5);p=new v(c,o,257,286,15),g=new v(u,s,0,30,15),m=new v(new Array(0),i,0,19,7)}(),M=!0),e.l_desc=new I(e.dyn_ltree,p),e.d_desc=new I(e.dyn_dtree,g),e.bl_desc=new I(e.bl_tree,m),e.bi_buf=0,e.bi_valid=0,T(e)},t._tr_stored_block=L,t._tr_flush_block=function(e,t,n,r){var a,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),C(e,e.l_desc),C(e,e.d_desc),s=function(e){var t;for(D(e,e.dyn_ltree,e.l_desc.max_code),D(e,e.dyn_dtree,e.d_desc.max_code),C(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),a=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=a&&(a=o)):a=o=n+5,n+4<=a&&-1!==t?L(e,t,n,r):4===e.strategy||o===a?(R(e,2+(r?1:0),3),x(e,c,u)):(R(e,4+(r?1:0),3),function(e,t,n,r){var a;for(R(e,t-257,5),R(e,n-1,5),R(e,r-4,4),a=0;a<r;a++)R(e,e.bl_tree[2*l[a]+1],3);A(e,e.dyn_ltree,t-1),A(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),x(e,e.dyn_ltree,e.dyn_dtree)),T(e),r&&w(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(f[n]+256+1)]++,e.dyn_dtree[2*_(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){R(e,2,3),E(e,256,c),function(e){16===e.bi_valid?(y(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},"../node_modules/pako/lib/zlib/zstream.js":function(e,t,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},"../packages/model/src/cell/metadata/date-time/DateTimeTemplateType.ts":function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js");var r,a,o,s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js");function i(e){return[o.YEAR_MONTH_DAY,o.YEAR_MONTH,o.MONTH_DAY].includes(e)}!function(e){e[e.YEAR_MONTH_DAY=1]="YEAR_MONTH_DAY",e[e.YEAR_MONTH=2]="YEAR_MONTH",e[e.MONTH_DAY=3]="MONTH_DAY",e[e.DATE_TIME=4]="DATE_TIME",e[e.HOUR_MINUTE=5]="HOUR_MINUTE"}(o||(o={}));var l=(r={},Object(s.a)(r,o.YEAR_MONTH_DAY,'yyyy"\u5e74"m"\u6708"d"\u65e5";@'),Object(s.a)(r,o.YEAR_MONTH,'yyyy"\u5e74"m"\u6708";@'),Object(s.a)(r,o.MONTH_DAY,'m"\u6708"d"\u65e5";@'),Object(s.a)(r,o.DATE_TIME,"yyyy/m/d h:mm;@"),Object(s.a)(r,o.HOUR_MINUTE,"h:mm;@"),r),c=(a={},Object(s.a)(a,o.YEAR_MONTH_DAY,"YYYY\u5e74M\u6708D\u65e5"),Object(s.a)(a,o.YEAR_MONTH,"YYYY\u5e74M\u6708"),Object(s.a)(a,o.MONTH_DAY,"M\u6708D\u65e5"),Object(s.a)(a,o.DATE_TIME,"YYYY/M/D H:mm"),Object(s.a)(a,o.HOUR_MINUTE,"H:mm"),a)},"../packages/model/src/cell/metadata/select/SelectTemplateType.ts":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.CUSTOM=1]="CUSTOM",e[e.SEX=2]="SEX",e[e.EDUCATION=3]="EDUCATION",e[e.YES_NO=4]="YES_NO",e[e.PRIORITY=5]="PRIORITY",e[e.PROJECT_STATUS=6]="PROJECT_STATUS",e[e.CLOTHING_SIZE=7]="CLOTHING_SIZE"}(r||(r={}));var a={SEX:[{text:"\u7537",bgColor:"#02b1ff29",textColor:"#02b1ff"},{text:"\u5973",bgColor:"#ea2f2f29",textColor:"#ea2f2f"}],EDUCATION:[{text:"\u521d\u4e2d",bgColor:"#02b1ff29",textColor:"#02b1ff"},{text:"\u9ad8\u4e2d",bgColor:"#19bd8f29",textColor:"#19bd8f"},{text:"\u5927\u4e13",bgColor:"#7c5ed829",textColor:"#7c5ed8"},{text:"\u672c\u79d1",bgColor:"#e85bbe29",textColor:"#e85bbe"},{text:"\u7814\u7a76\u751f",bgColor:"#f36f3929",textColor:"#f36f39"},{text:"\u535a\u58eb",bgColor:"#ea2f2f29",textColor:"#ea2f2f"}],YES_NO:[{text:"\u662f",bgColor:"#19bd8f29",textColor:"#19bd8f"},{text:"\u5426",bgColor:"#ea2f2f29",textColor:"#ea2f2f"}],PRIORITY:[{text:"P0",bgColor:"#ea2f2f29",textColor:"#ea2f2f"},{text:"P1",bgColor:"#f36f3929",textColor:"#f36f39"},{text:"P2",bgColor:"#02b1ff29",textColor:"#02b1ff"}],PROJECT_STATUS:[{text:"\u5f85\u542f\u52a8",bgColor:"#02b1ff29",textColor:"#02b1ff"},{text:"\u8fdb\u884c\u4e2d",bgColor:"#f36f3929",textColor:"#f36f39"},{text:"\u5df2\u5b8c\u6210",bgColor:"#19bd8f29",textColor:"#19bd8f"}],CLOTHING_SIZE:[{text:"XS",bgColor:"#02b1ff29",textColor:"#02b1ff"},{text:"S",bgColor:"#19bd8f29",textColor:"#19bd8f"},{text:"M",bgColor:"#7c5ed829",textColor:"#7c5ed8"},{text:"L",bgColor:"#e85bbe29",textColor:"#e85bbe"},{text:"XL",bgColor:"#f36f3929",textColor:"#f36f39"},{text:"2XL",bgColor:"#ea2f2f29",textColor:"#ea2f2f"},{text:"3XL",bgColor:"#f02f4f29",textColor:"#f02f4f"}]}},"./src/core/app/dataCallCore.ts":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return E}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.every.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/regenerator-runtime/runtime.js");var r=n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),a=n("./src/core/behavior/request/Type.ts"),o=n("./src/base/error/errCodeType.ts"),s=n("../packages/report/src/index.ts"),i=n("./src/base/config/report.ts"),l=n("../node_modules/@tencent/jank-sdk/lib/index.js"),c=n("./src/core/network/message-center/utils.ts"),u=n("./src/base/event/eventName.ts"),d=n("../packages/mutation/src/MutationId.ts"),f=n("../packages/model/src/sheet/SheetPropertiesSlotOperation.ts"),h=n("./src/core/app/lazytool/index.ts"),p=n("../packages/model/src/workbookRange/WorkbookRangeType.ts"),g=n("../packages/mutation/src/workbook/workbookRange/DefineWorkbookRangeMutation.ts"),m=n("../packages/model/src/workbookRange/WorkbookRangeDelta.ts"),b=n("../packages/mutation/src/new-embedded/NewAddEmbeddedObjectMutation.ts"),v=n("./src/core/data/configService/spreadConfig.ts"),I=n("../node_modules/@tencent/docs_offline/lib/index.js"),_=n("./src/external/errorUI/client.ts"),y=n("../node_modules/@tencent/tdocs_support_bridge/lib/index.js"),R=n("./src/core/utils/config.ts");var E=Object(l.c)((function(e,t,n,r,a,l){if(l)return w(t,n,r,a,l,!1);var c={};if(n&&0!==n.length){var u=!1;n.forEach((function(n){if(!n.isNonPersistedLocalChange()&&!n.isMultiSheetMutation()){var r=n.getAffectedSheetId();if(!r)throw e.event.errorCode.trigger("errorCode",{type:"front",code:o.a.SHEET_ID_ERROR_2}),new Error("mutation\u5fc5\u987b\u5b9e\u73b0getAffectedSheetId\u63a5\u53e3\u624d\u80fd\u63d0\u4ea4\uff01\uff01\uff01");"WORKBOOK"===r&&(u=!0,r=t),c[r]||(c[r]=[]),c[r].push(n)}}));var d=Object.keys(c);if(-1===d.indexOf(t)&&!d.every((function(e){return"WORKBOOK"===e})))throw e.event.errorCode.trigger("errorCode",{type:"front",code:o.a.SHEET_ID_ERROR_3}),Error("\u81ea\u52a8\u5206\u7ec4\u540e\uff0c\u6570\u636e\u4e32\u8868\u7684\u6821\u9a8c\u4f1a\u653e\u5f00\uff0c\u53ef\u4ee5\u540c\u65f6\u4ea7\u751f\u5bf9\u591a\u4e2asheet\u7684\u5f71\u54cd\uff0c\u4f46\u9700\u8981\u6709\u5f53\u524dsheet\u7684\u4fee\u6539\uff0c\u5426\u5219\u65e0\u6cd5\u901a\u8fc7\u7edf\u4e00\u6821\u9a8c\u3002\u5982\u679c\u4ee5\u540e\u6709workbook\u7684\u9690\u85cfsheet\u4fee\u6539\uff0c\u6700\u597d\u4e0a\u5c42\u4f20\u5165\u5bf9\u5e94\u7684sheetId\u3002");d.forEach((function(e){var n=!1;u&&(n=e===t),w(n?t:e,c[e],r,a,!1,n)}))}else s.b.run(i.CONFIG.COMMIT_EMPTY_MUTATION,[r,t,n,a])}),"commitMutationCore");function O(t,n,r,a){var l,u,d=e.SpreadsheetApp;"SHUTDOWN"===(null===(l=d.socket)||void 0===l||null===(u=l.client)||void 0===u?void 0:u.getRoomState())&&(s.b.run(i.CONFIG.DO_BEHAVIOR_AFTER_SHUTDOWN),Object(_.f)(i.CONFIG.DO_BEHAVIOR_AFTER_SHUTDOWN)||alert("\u8868\u683c\u9047\u5230\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5\u3002"));return!!function(t,n,r){var a=e.SpreadsheetApp;try{for(var o=0;o<n.length;o++){var l=n[o];l&&a.mutationBehavior.serializeMutation(l)}return!0}catch(u){var c="";try{c=JSON.stringify(n)}catch(d){console.error(d)}return s.b.run(i.CONFIG.COMMIT_MUTATION_CATCH_ERROR,[r,t,c],null===u||void 0===u?void 0:u.stack),!1}}(t,n,r)&&(!(!a&&!function(t,n){for(var r=e.SpreadsheetApp,a=0;a<n.length;a++){var l,c,u=n[a];if(u&&!u.isMultiSheetMutation()&&u.getAffectedSheetId()!==t&&"WORKBOOK"!==u.getAffectedSheetId())return s.b.run(i.CONFIG.COMMIT_MUTATION,[t,n]),null===(l=r.socket)||void 0===l||null===(c=l.client)||void 0===c||c.shutDown(o.a.SHEET_ID_ERROR_1),!1}return!0}(t,n))&&(Object(c.b)(d),!0))}function S(e,t,n,r,a){return{sheetId:e,taskId:0,data:t,requestId:n,head:!1,isWorkbook:a,oSubId:null,withKeyData:!1,isOfflineMessage:!1,allowAutoMerge:!1,keyframe:null,createTime:Date.now()}}function T(t,n,r,a){var o=e.SpreadsheetApp,s=o.spreadsheet,i=t,l=null,c=!1,u=null,v=[];n[0].id===d.b.INSERT_SHEET_MUTATION&&(c=!0,n[0].sheetDelta.deltas[0].slotOperation===f.a.COPY_SHEET&&(i=a[0].newSheetId,c=!0,l=Object(h.createZipKeyframe)(a[0].newSheetId),u=t,s.workbookRangeManager.each((function(e){if(i===e.range.sheetId){var t=s.embeddedObjectManager.getEmbeddedObject(e.embeddedObjectId);switch(e.type){case p.a.CHART:if(t){var n=new m.a;n.setEmbeddedObjectId(t.objectId),v.push(o.mutationBehavior.serializeMutation(new g.a({workbookRangeId:e.id,workbookRangeType:e.type,gridRange:e.range,workbookRangePropertiesDelta:n}))),v.push(o.mutationBehavior.serializeMutation(new b.a({object:t})))}}}})),v.length>0&&(l+="\n".concat(JSON.stringify([v])))));return{sheetId:i,taskId:0,data:n,requestId:r,head:c,oSubId:u,withKeyData:!1,isOfflineMessage:!1,allowAutoMerge:!1,keyframe:l,createTime:Date.now()}}function w(e,t,n,r,a,o){return k.apply(this,arguments)}function k(){return(k=Object(r.a)(regeneratorRuntime.mark((function t(n,r,o,l,c,u){var d,f,h,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(d=e.SpreadsheetApp,f=d.spreadsheet,h=d.messageCenter,O(n,r,o,c)){t.next=5;break}return t.abrupt("return");case 5:s.b.run(i.CONFIG.CACHE_DATA_FLOW_COMMIT_MUTATION,[o,n]),y.a.sendEvent("sheet","sheet_e_edit_".concat(o)),p=c?T(n,r,o,l):S(n,r,o,0,u),o!==a.a.SET_SINGLE_VALUE_REQUEST&&o!==a.a.PASTE_DATA_REQUEST||0!==v.a.getConfig("isUserChangeTitle")&&!Object(R.a)()||A(f,j),h.sendMessageCenter.addUserChange(p);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(e){return x.apply(this,arguments)}function x(){return(x=Object(r.a)(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(v.a.getConfig("ver")<5)&&n){t.next=2;break}return t.abrupt("return");case 2:return r=v.a.getConfig("isUserChangeTitle"),t.next=5,C(n);case 5:Object(R.a)()||e.SpreadsheetApp.spreadsheet.setTitle(n),0===r&&e.SpreadsheetApp.event.spreadsheetEvent.trigger(u.a.TITLE_AUTO_CHANGE);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function C(e){return D.apply(this,arguments)}function D(){return(D=Object(r.a)(regeneratorRuntime.mark((function t(n){var r,a,o,s,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,Object(R.a)()){t.next=3;break}return t.abrupt("return");case 3:if(o=e.SpreadsheetApp,!(null===(r=o.offlineEdit)||void 0===r?void 0:r.isFullOffline())||!(null===(a=o.offlineEdit)||void 0===a?void 0:a.isDBAvaliable())){t.next=13;break}return t.next=7,o.offlineEdit.offlineDataManager.getHelper().updatePadInfo(o.offlineEdit.globalPadId,{title:n,last_modify_ts:Date.now()});case 7:return v.a.setConfig({isUserChangeTitle:1,title:n}),s=o.offlineEdit.offlineDataManager.getHelper().clientVars2OfflineData(v.a.getConfig("globalPadId"),e.clientVars,!0),t.next=11,o.offlineEdit.offlineDataManager.getDatabase().update(I.TableName.DOCUMENT_DATA,s);case 11:return t.next=13,o.offlineEdit.tryToCreateFile();case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),null===(i=e.log)||void 0===i||i.error("\u6807\u9898\u540c\u6b65\u6570\u636e\u5e93\u5931\u8d25",t.t0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))).apply(this,arguments)}function A(e,t){var n=/^[^\u4e00-\u9fa5a-zA-Z\d]+/,r=/[^\u4e00-\u9fa5a-zA-Z\d]+$/,a=function(e){var t="";if(e){var a=(t=e.replace(n,"").replace(r,"").trim()).split(/\s{10}/),o=a[a.length-1];o&&a.length>1&&(o=o.replace(/^\s*/,""),t="".concat(a[0],"          ").concat(o))}return t},o=function(e){if(e){for(var t="",r=0;r<e.data.rowData.length;r++)if(e.data.rowData[r]){for(var o=e.data.rowData[r].values,s=0;s<o.length;s++){var i=o[s];if(i){var l=i.getFormattedValue();if(!i.getFormula()&&((c=null===l||void 0===l?void 0:l.value)&&c.replace(n,"").length>0)){t=a(null===l||void 0===l?void 0:l.value);break}}}if("string"===typeof t&&t)break}return t}var c}(e.activeSheet);"function"===typeof t&&t(o)}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/app/lazytool/index.ts":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"createDataKeyframeStr",(function(){return c})),n.d(t,"createZipKeyframe",(function(){return u})),n.d(t,"getKeyframe",(function(){return d})),n.d(t,"createSheetWithKeyframe",(function(){return f}));n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../packages/report/src/index.ts"),a=n("./src/base/config/version.ts"),o=n("./src/base/event/event.ts"),s=n("./src/base/config/report.ts"),i=n("./src/core/data/converter/tencentdoc/keyframeToSheetConverter.ts"),l=n("./src/core/data/converter/keyframe/zip.ts");function c(t){var n;t=t||e.SpreadsheetApp.spreadsheet.activeSheetId;var o=e.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(t);return(null===o||void 0===o?void 0:o.isLoaded)?(n=JSON.stringify(o.serialize()),function(e){try{if(!e)return;for(var t=e.data.rowData,n=!1,a=0,o=t.length;a<o&&!n;a++){var s=t[a];if(s&&s.values)for(var i=0,l=s.values.length;i<l;i++){var c=s.values[i];if(c){var u=c.getFormula();if(u){var d=u.getParts();if(d&&0===d.length){r.b.monitor(33613232),n=!0;break}}}}}}catch(f){}}(o),{type:"k",k:n,startRow:0,startCol:0,ver:a.a.KEYFRAME_VER,sheetId:t}):null}function u(t){console.error("createZipKeyframe \u5df2\u7ecf\u5e9f\u5f03, \u8bf7\u4f7f\u7528 createKeyframe \u4ee3\u66ff."),r.b.jank.stopReport(),r.b.jank.log({moduleValue:"keyframe",actionValue:"createKeyframe"}),r.b.jank.restartReport();var n=c(t);if(!n){r.b.monitor(33711501);var a=e.SpreadsheetApp.spreadsheet.sheetManager.getSheetBySheetId(t);return r.b.run(s.CONFIG.CREATE_ZIPKETFRAME,[t,null===a||void 0===a?void 0:a.isFetching,null===a||void 0===a?void 0:a.isLoaded]),null}var o=Object(l.c)(n);return o||JSON.stringify([n])}function d(){var e,t,n=null===(e=clientVars.collab_client_vars)||void 0===e||null===(t=e.initialAttributedText)||void 0===t?void 0:t.text;return n?n=JSON.stringify(n):(console.error("\u83b7\u53d6\u4e0d\u5230\u5b50\u8868 keyframe."),"")}function f(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BB08J2",r=e.SpreadsheetApp,a=r.spreadsheet.sheetManager.getSheetBySheetId(n);a?(r.spreadsheet.sheetManager.reInitSheetBySheetId(n),a=r.spreadsheet.sheetManager.getSheetBySheetId(n)):(a=r.spreadsheet.sheetManager.createSheet({id:n,name:n}),r.spreadsheet.sheetManager.insertSheet(a)),r.getCurrentMainThreadWorker().sheetData.clearAndReInitOneSheet({sheetId:n}),r.calcController.resetSheet(n),Object(i.a)(r.spreadsheet,n,JSON.parse(t));for(var s=a.getRowCount(),l=a.getColCount(),c=0;c<s;c++)for(var u=0;u<l;u++)r.spreadsheet.autoUpdateCellData(n,c,u);a.isLoaded=!0,r.spreadsheet.activeSheetId=n,o.c.sheetsBar.trigger("switchSheet",n),r.getCurrentMainThreadWorker().loadSheetToWorkerIfNeeded(n)}}.call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/behavior/api.ts":function(e,t,n){"use strict";n.r(t),function(e){n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.reduce.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=n("../node_modules/@babel/runtime/helpers/esm/typeof.js"),i=n("../packages/utils/src/index.ts"),l=n("./src/core/behavior/request/Type.ts"),c=n("../packages/model/src/dimension/DimensionType.ts"),u=n("../packages/model/src/range/DimensionRange.ts"),d=n("./src/core/behavior/request/enum/FormatItem.ts"),f=n("../packages/model/src/range/GridRange.ts"),h=n("../packages/model/src/range/gridRangeUtils.ts"),p=n("../packages/model/src/cell/CellDataSlot.ts"),g=n("./src/core/feature/formula/utils.ts"),m=n("./src/core/feature/formula/autofix.ts"),b=n("../packages/model/src/cell/CellData.ts"),v=n("../packages/model/src/range/SheetRangeType.ts"),I=n("../packages/model/src/config/index.ts"),_=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),y=n("./src/core/app/SpreadsheetApp.interface.ts"),R=n("../packages/report/src/index.ts"),E=n("./src/core/ui/dialog/index.ts"),O=n("../packages/model/src/cell/format/BorderType.ts"),S=n("./src/core/behavior/utils.ts"),T=n("../packages/model/src/cell/index.ts"),w=n("./src/core/ui/toast/toast.tsx"),k=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),j=n.n(k),x=n("./src/core/behavior/request/cell/SetMetadataRequest.ts"),C=n("../packages/model/src/cell/metadata/CustomDataType.ts"),D=n("./src/core/feature/relateForm/seeker-util.ts"),A=n("../node_modules/lodash/flattenDeep.js"),M=n.n(A),L=n("./src/core/behavior/behavior.interface.ts"),N=n("./src/core/behavior/behavior.ts"),U=n("../packages/services/src/extensions.ts"),P=n("../packages/model/src/embedded/index.ts"),F=n("./src/core/view/spreadsheet-view/render-manager/alloy-excel/table/body/cell-renders/impl/ImageCellRender.ts"),B=n("./src/core/behavior/request/embedded/utils.ts"),H=n("../packages/model/src/cell/LinkIconType.ts");function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e,t,n,r){var a,o=arguments.length,i=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(s.a)(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(i=(o<3?a(i):o>3?a(t,n,i):a(t,n))||i);return o>3&&i&&Object.defineProperty(t,n,i),i},V=function(e,t){return function(n,r){t(n,r,e)}};Object(U.b)(L.a,N.a);var Q={cache:null,copyPasteCache:null,aSetSlot:0|1<<p.b.SLOT_USER_ENTERED_FORMAT_DELTA},W=function(){function t(e,n){Object(a.a)(this,t),this.app=e,this.behavior=n}return Object(o.a)(t,[{key:"undo",value:function(){return this.behavior.apply({type:"undo",sheetId:this.app.spreadsheet.activeSheetId,requestId:-1})}},{key:"redo",value:function(){return this.behavior.apply({type:"redo",sheetId:this.app.spreadsheet.activeSheetId,requestId:-1})}},{key:"applyCollab",value:function(e){return this.behavior.apply(z({type:"collab"},e))}},{key:"applyOffline",value:function(e){return this.behavior.apply(z({type:"offline"},e))}},{key:"mergeCells",value:function(e){var t=this.app.view.canvas,n=this.app.spreadsheet.activeSheetId;function r(e,n,r){for(var a=[],o=n;o<=r;o++){var s=t.rowcolAccessor.getRowDisplayHeight(o),i=t.rowcolAccessor.getRowSetHeight(o);(null===i||void 0===i)&&s>I.DEFAULT_ROW_HEIGHT&&a.push({dimensionRange:new u.a(e,o,o,c.a.ROWS),size:s})}return a}var a=[];if(null===e||void 0===e?void 0:e.length)a=e.map((function(e){return r(e.sheetId,e.startRowIndex,e.endRowIndex)})).reduce((function(e,t){return e.concat(t)}));else{var o=this.app.view.getSelection().rangeSelections[0];a=r(n,o.startRowIndex,o.endRowIndex)}var s=[{requestId:l.a.MERGE_CELLS_REQUEST,opt:{sheetId:n,gridRanges:e}}];return a.length&&s.push({requestId:l.a.SET_DIMENSION_SIZE_REQUEST,opt:{sheetId:n,dimensionModifiers:a}}),this.behavior.apply({type:"local",sheetId:n,requestId:l.a.MULTI_REQUEST,opt:{sheetId:n,gridRanges:e,requests:s}})}},{key:"setHyperlinkIconVisibility",value:function(e){var t=e.row,n=e.col,r=e.visibility,a=this.app.spreadsheet.activeSheet.getCellDataAtPosition(t,n),o=null===a||void 0===a?void 0:a.getHyperlink(),s=null===a||void 0===a?void 0:a.getEditValue(),i=null===a||void 0===a?void 0:a.getHyperlinkRuns();null===a||void 0===a||a.getHyperlinkType();if(!o&&!i)throw new Error("\u8d85\u94fe\u63a5\u5730\u5740\u4e3a\u7a7a\uff0c\u65e0\u6cd5\u4fee\u6539\u94fe\u63a5icon\u72b6\u6001");if(!s)throw new Error("\u8d85\u94fe\u63a5\u540d\u79f0\u4e3a\u7a7a\uff0c\u65e0\u6cd5\u4fee\u6539\u94fe\u63a5icon\u72b6\u6001");return o?(R.b.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_set",ver12:r?"word_type":"icon_type"}),this.setDoclinkIconVisibility(t,n,r,s,o)):this.setHyperLinkRunsVisibility(t,n,r,s,i)}},{key:"setDoclinkIconVisibility",value:function(e,t,n,r,a){var o={type:"local",sheetId:this.app.spreadsheet.getActiveSheetId(),requestId:l.a.SET_LINK_REQUEST,opt:{rowIndex:e,colIndex:t,userEnterValue:r,linkUrl:a,linkIconStatus:H.a.PLAIN_TEXT}};return n&&(o.opt.linkIconStatus=H.a.WITH_IMAGE),this.behavior.apply(o)}},{key:"setHyperLinkRunsVisibility",value:function(e,t,n,r,a){var o=this.app.spreadsheet.getActiveSheetId();return R.b.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_set",ver12:n?"word_type":"icon_type"}),this.behavior.apply({type:"local",sheetId:o,requestId:l.a.SET_HYPERLINK_RUNS_REQUEST,opt:{rowIndex:e,colIndex:t,userEnterValue:r,isChanged:!0,linkUrl:null,textFormatRuns:[],isTextFormatRunsChanged:!0,hyperlinkRuns:a,linkIconStatus:n?H.a.WITH_IMAGE:H.a.PLAIN_TEXT}})}},{key:"setHyperlinkRuns",value:function(e){var t=e.row,n=e.col,r=e.linkValue,a=e.range,o=e.linkIconStatus,s=this.app.spreadsheet.getActiveSheetId(),c=i.a.getRandomId(),u={workbookRangeId:c,range:a},d={rowIndex:t,colIndex:n,userEnterValue:r,textFormatRuns:null,isTextFormatRunsChanged:!0,isChanged:!0,hyperlinkRuns:[{startIndex:0,linkUrl:"#rangeid=".concat(c)}],linkIconStatus:o},f=[{requestId:l.a.ADD_LINKED_RANGE_REQUEST,opt:u},{requestId:l.a.SET_HYPERLINK_RUNS_REQUEST,opt:d}];return R.b.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_set",ver10:"cell"}),this.behavior.apply({type:"local",sheetId:s,requestId:l.a.MULTI_REQUEST,opt:{sheetId:s,requests:f}})}},{key:"unmergeCells",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.UNMERGE_CELLS_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId,gridRanges:e}})}},{key:"insertRows",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.INSERT_DIMENSION_REQUEST,opt:{type:c.a.ROWS,sheet:this.app.spreadsheet.activeSheet,insertInfo:e}})}},{key:"insertColumns",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.INSERT_DIMENSION_REQUEST,opt:{type:c.a.COLUMNS,sheet:this.app.spreadsheet.activeSheet,insertInfo:e}})}},{key:"hideRows",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_DIMENSION_HIDE_REQUEST,opt:{type:c.a.ROWS,sheetId:this.app.spreadsheet.activeSheetId,dimensionRanges:e}})}},{key:"hideColumns",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_DIMENSION_HIDE_REQUEST,opt:{type:c.a.COLUMNS,sheetId:this.app.spreadsheet.activeSheetId,dimensionRanges:e}})}},{key:"showRows",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_DIMENSION_SHOW_REQUEST,opt:{type:c.a.ROWS,sheetId:this.app.spreadsheet.activeSheetId,dimensionRanges:e}})}},{key:"showColumns",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_DIMENSION_SHOW_REQUEST,opt:{type:c.a.COLUMNS,sheetId:this.app.spreadsheet.activeSheetId,dimensionRanges:e}})}},{key:"deleteRows",value:function(){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.DELETE_DIMENSION_REQUEST,opt:{type:c.a.ROWS,sheet:this.app.spreadsheet.activeSheet}})}},{key:"deleteColumns",value:function(){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.DELETE_DIMENSION_REQUEST,opt:{type:c.a.COLUMNS,sheet:this.app.spreadsheet.activeSheet}})}},{key:"resizeRows",value:function(e,t){var n=e.map((function(e,n){return{dimensionRange:e,size:function(e){if(t instanceof Array){var n=Math.min(e,t.length-1);return t[n]}return t}(n)}}));return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_DIMENSION_SIZE_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId,dimensionModifiers:n}})}},{key:"resizeColumns",value:function(e,t){var n=this,r=e.map((function(e,n){return{dimensionRange:e,size:function(e){if("number"===typeof t)return t;if(t instanceof Array&&t.length>0){var n=Math.min(e,t.length-1);return t[n]}return I.DEFAULT_COL_WIDTH}(n)}}));return t instanceof Array&&(r=r.filter((function(e){var t=e.dimensionRange.startIndex;return t!==e.dimensionRange.endIndex||e.size!==n.app.view.canvas.rowcolAccessor.getColSetWidth(t)}))),r&&r.length?this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_DIMENSION_SIZE_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId,dimensionModifiers:r}}):Promise.resolve()}},{key:"resizeRowsColumns",value:function(e){return e&&e.length?this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_DIMENSION_SIZE_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId,dimensionModifiers:e}}):Promise.resolve()}},{key:"moveRows",value:function(e,t){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.MOVE_DIMENSION_REQUEST,opt:{type:c.a.ROWS,sheetId:this.app.spreadsheet.activeSheetId,to:t,from:e}})}},{key:"moveColumns",value:function(e,t){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.MOVE_DIMENSION_REQUEST,opt:{type:c.a.COLUMNS,sheetId:this.app.spreadsheet.activeSheetId,to:t,from:e}})}},{key:"setRowFormData",value:function(e,t){var n=this.app.spreadsheet.activeSheetId;return this.behavior.apply({type:"local",sheetId:n,requestId:l.a.SET_DIMENSION_FORMDATA_REQUEST,opt:{type:c.a.ROWS,sheetId:n,dimensionRanges:e,formDatas:t}})}},{key:"setColFormData",value:function(e,t){var n=this.app.spreadsheet.activeSheetId;return this.behavior.apply({type:"local",sheetId:n,requestId:l.a.SET_DIMENSION_FORMDATA_REQUEST,opt:{type:c.a.COLUMNS,sheetId:n,dimensionRanges:e,formDatas:t}})}},{key:"reorder",value:function(e,t,n){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.REORDER_RANGE_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId,hasTitle:t,reorderInfos:e,gridRange:n}})}},{key:"freeze",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.FREEZE_REQUEST,opt:z({sheetId:this.app.spreadsheet.activeSheetId},e)})}},{key:"userEnter",value:function(e){var t=e.colIndex,n=e.rowIndex,r=e.isChanged,a=void 0===r?void 0===e.isTextChanged||e.isTextChanged:r,o=e.isTextFormatRunsChanged,s=void 0===o||o,i=e.textFormatRuns,c=void 0===i?null:i,u=e.mentionDetailsMap,d=e.sheetId,f=void 0===d?this.app.spreadsheet.getActiveSheetId():d,h=e.text;if(!Object(S.a)(t)||!Object(S.a)(n))return R.b.monitor(33651147),Promise.reject();if(Object(g.C)(h)){var p=[].slice.call(this.app.spreadsheet.sheetManager.sheetList,0).map((function(e){return e.getTitle()})),b=this.app.spreadsheet.activeSheet.getIndex();h=Object(m.a)(h,p,b);var v=this.app.spreadsheet.sheetManager.getSheetBySheetId(f),I=null===v||void 0===v?void 0:v.getCellDataAtPosition(n,t),y=null===I||void 0===I?void 0:I.getFormula();if(y&&y.toString(n,t,this.app.spreadsheet.sheetManager)===h){var E=this.app.spreadsheet.activeSheet.getCellDataAtPosition(n,t);if(!E)return Promise.resolve();var O=E.getUserEnteredFormat();if(!O)return Promise.resolve();var T=O.getNumberFormat();if(!T||!Object(_.isTextCell)(T))return Promise.resolve()}}return this.behavior.apply({type:"local",sheetId:f,requestId:l.a.SET_SINGLE_VALUE_REQUEST,opt:{rowIndex:n,colIndex:t,userEnterValue:h,isChanged:a,textFormatRuns:c,isTextFormatRunsChanged:s,sheetId:f,mentionDetailsMap:u}})}},{key:"userEnterToSheetId",value:function(e,t,n,r){return this.userEnter({text:e,colIndex:n,rowIndex:t,isChanged:!0,sheetId:r})}},{key:"userRangeEnter",value:function(e){var t=this.app.spreadsheet.activeSheetId;return this.app.toggle&&(t=this.app.toggle.from),this.behavior.apply({type:"local",sheetId:t,requestId:l.a.SET_RANGE_VALUE_REQUEST,opt:{data:e,sheetId:t}})}},{key:"addImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.id,r=e.url,a=e.width,o=e.height,s=e.sheetId,i=e.x,c=e.y,u={type:t?P.EMBEDDED_OBJECT_TYPE.CELL_IMAGE:P.EMBEDDED_OBJECT_TYPE.IMAGE,id:n,url:r,width:a,height:o,sheetId:s,x:i,y:c,offsetX:0,offsetY:0,clipInfo:e.clipInfo},d=[{requestId:l.a.ADD_IMAGE_REQUEST,opt:u}];if(t){var f=Object(B.a)(this.app.spreadsheet.sheetManager.getSheetBySheetId(s),c);if(f){var h={sheetId:s,dimensionModifiers:[f]};d.push({requestId:l.a.SET_DIMENSION_SIZE_REQUEST,opt:h})}}var p={requests:d};return this.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.a.MULTI_REQUEST,opt:p})}},{key:"updateImage",value:function(e){return this.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.a.UPDATE_IMAGE_REQUEST,opt:e})}},{key:"convertImageType",value:function(e,t){var n=this.app.spreadsheet.activeSheet,r=n.getSheetId(),a=[];if(t===P.EMBEDDED_OBJECT_TYPE.IMAGE){var o=this.app.view.getSelection().rangeSelections,s=this.app.sheetStatus;o.forEach((function(e){e.each((function(e,o){var i=n.getCellImage(e,o),l=Object(F.a)(n,e,o);if(i&&l&&s.getRangeCanEdit(new f.b(r,e,e,o,o))){var c=l.clipInfo,u=l.overlayPosition,d={x:o,y:e,offsetX:u.offsetXpixels,offsetY:u.offsetYpixels,clipInfo:c,width:u.widthPixels,height:u.heightPixels},h=i.toObject();Object.assign(h,d),h.type=t,h.changeType=!0,a.push(h)}}))}))}else{var i=n.imageManager.getImage(e);if(!i)return Promise.resolve();(a=i.toObject()).type=t,a.changeType=!0}return this.behavior.apply({type:"local",sheetId:r,requestId:l.a.UPDATE_IMAGE_REQUEST,opt:a})}},{key:"deleteImage",value:function(e){var t=this.app.spreadsheet.getActiveSheetId();return Array.isArray(e)&&e.length>0&&e[0]&&e[0].sheetId?t=e[0].sheetId:!Array.isArray(e)&&e&&e.sheetId&&(t=e.sheetId),this.behavior.apply({type:"local",sheetId:t,requestId:l.a.DELETE_IMAGE_REQUEST,opt:e})}},{key:"insertLink",value:function(){var e=this,t=this.app.view.canvas.normalSelectData.activeCol,n=this.app.view.canvas.normalSelectData.activeRow;if(isNaN(t)||isNaN(n))throw new Error("\u6ca1\u6709\u5b9a\u4f4d\u5230\u5355\u5143\u683c");return new Promise((function(r,a){r(null),e.app.view.canvas.linkCenter.addLink(n,t)}))}},{key:"fontBold",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.BOLD,formatValue:e}})}},{key:"autoWrap",value:function(e,t){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.WRAP_STRATEGY,formatValue:e,gridRange:t||null}})}},{key:"fontItalics",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.ITALIC,formatValue:e}})}},{key:"fontUnderLine",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.UNDERLINE,formatValue:e}})}},{key:"fontStrike",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.STRIKE_THROUGH,formatValue:e}})}},{key:"setFontFamliy",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.FONT_FAMINY,formatValue:e}})}},{key:"setFontFamily",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.FONT_FAMINY,formatValue:e}})}},{key:"setWrapStrategy",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.getActiveSheetId(),requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.WRAP_STRATEGY,formatValue:e}})}},{key:"setFontSize",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.FONT_SIZE,formatValue:e}})}},{key:"setFontColor",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.COLOR,formatValue:e}})}},{key:"setBorder",value:function(e,t,n){var r={};switch(t){case"all":r[O.a.TOP]=!0,r[O.a.LEFT]=!0,r[O.a.RIGHT]=!0,r[O.a.BOTTOM]=!0,r[O.a.MIDDLE]=!0,r[O.a.CENTER]=!0;break;case"top":r[O.a.TOP]=!0;break;case"left":r[O.a.LEFT]=!0;break;case"bottom":r[O.a.BOTTOM]=!0;break;case"right":r[O.a.RIGHT]=!0;break;case"outer":r[O.a.TOP]=!0,r[O.a.RIGHT]=!0,r[O.a.BOTTOM]=!0,r[O.a.LEFT]=!0;break;case"inner":r[O.a.MIDDLE]=!0,r[O.a.CENTER]=!0;break;case"vertical":r[O.a.CENTER]=!0;break;case"horizontal":r[O.a.MIDDLE]=!0;break;case"clear":case"none":e.color=null,e.style=null,r[O.a.TOP]=!0,r[O.a.RIGHT]=!0,r[O.a.BOTTOM]=!0,r[O.a.LEFT]=!0,r[O.a.MIDDLE]=!0,r[O.a.CENTER]=!0;break;case"custom":n&&Object.keys(n.group).forEach((function(e){r[e]=n.group[e]}))}return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_BORDERS_REQUEST,opt:{type:r,props:e}})}},{key:"setHideGridlines",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_HIDE_GRIDLINES_REQUEST,opt:{hideGridlines:e,sheetId:this.app.spreadsheet.activeSheetId}})}},{key:"setBackgroundColor",value:function(e){var t=this.app.view.getSelection().rangeSelections,n=Object(S.b)(this.app.spreadsheet.activeSheet,T.CELL_FORMAT_SLOT.BACKGROUND_COLOR,t);return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.BACKGROUND_COLOR,formatValue:e}}).then((function(){n&&j.a.isPC&&Object(w.showToast)("\u5f53\u524d\u5355\u5143\u683c\u542b\u6709\u6761\u4ef6\u683c\u5f0f\uff0c\u5c06\u4f1a\u8986\u76d6\u586b\u5145\u989c\u8272\u3002")}))}},{key:"setVerticalAlign",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.VERTICAL_ALIGN,formatValue:e}})}},{key:"setHorizontalAlign",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_FORMAT_REQUEST,opt:{formatItem:d.a.HORIZONTAL_ALIGN,formatValue:e}})}},{key:"clearFormat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.CLEAR_FORMAT_REQUEST,opt:e})}},{key:"clearContent",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return setTimeout((function(){var t;null===(t=e.app.view.canvas.cellImageViewer)||void 0===t||t.updateCursor()}),0),this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.CLEAR_RANGE_REQUEST,opt:t})}},{key:"setLink",value:function(e,t,n,r){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_LINK_REQUEST,opt:{rowIndex:n,colIndex:r,userEnterValue:e,linkUrl:t}})}},{key:"setHyperLink",value:function(e,t,n,r,a,o,s){R.b.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"excel_link_set",ver10:"web"});var i=o?{formatItem:d.a.HORIZONTAL_ALIGN,formatValue:o}:{};return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_LINK_REQUEST,opt:z({rowIndex:r,colIndex:a,userEnterValue:e,linkUrl:t,hyperlinkType:n,linkIconStatus:s},i)})}},{key:"clearLink",value:function(e,t){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.CLEAR_LINK_REQUEST,opt:{rowIndex:e,colIndex:t}})}},{key:"formatPainterSetCache",value:function(e,t){var n=e.startRowIndex,r=e.endRowIndex,a=e.startColIndex,o=e.endColIndex;return Q.copyPasteCache=new t.feature.CopyPasteCache({spreadsheetApp:t,config:{setSlots:Q.aSetSlot,tile:!1,isFormatPainter:!0}}),Q.copyPasteCache.onCopy({from:Object(h.convertGridRangeToIXYRange)(e),copyType:t.feature.copyPasteBase.CopyType.copy,hotInstance:t}),Q.cache=new f.b(this.app.spreadsheet.getActiveSheetId(),n,r,a,o)}},{key:"formatPainterApply",value:function(){if(Q.cache&&Q.copyPasteCache){var e=Q.copyPasteCache.spreadsheetApp,t=Q.copyPasteCache.getCacheData();t.cellMask=Q.aSetSlot;var n=Object(h.convertGridRangeToIXYRange)(e.view.getSelection().rangeSelections[0]);Q.copyPasteCache.onPaste({to:n,hotInstance:e,pasteData:t})}}},{key:"formatPainterClear",value:function(){Q.cache=null}},{key:"numberFormat",value:function(t){var n=this.app.view.getSelection().rangeSelections,r=void 0===n?[]:n;if(r.length>0){var a,o=r.map((function(e){return e.serialize()}));null===(a=e.log)||void 0===a||a.info("behavior::number_format",t,o)}return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_NUMBER_FORMAT_REQUEST,opt:"string"===typeof t?{pattern:t}:t})}},{key:"decreaceDecimal",value:function(){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.ADJUST_DECIMALS_REQUEST,opt:{decimalsDelta:-1}})}},{key:"increaceDecimal",value:function(){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.ADJUST_DECIMALS_REQUEST,opt:{decimalsDelta:1}})}},{key:"replace",value:function(e){var t,n=e.map((function(e){return Object(g.C)(e.value)?z(z({},e),{},{value:Object(m.a)(e.value,[],0)}):e})),r=this.app.spreadsheet.activeSheetId;return(null===n||void 0===n||null===(t=n[0])||void 0===t?void 0:t.sheetId)&&(r=n[0].sheetId),this.behavior.apply({type:"local",sheetId:r,requestId:l.a.REPLACE_ALL_REQUEST,opt:n})}},{key:"smartSelection",value:function(e){var t=e.changes,n=e.mergeCells,r=e.range,a=e.originCell;return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.AUTO_FILL_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId,changes:t,mergeCells:n,range:r,originCell:a}})}},{key:"setBasicFilter",value:function(){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SET_BASIC_FILTER_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId}})}},{key:"clearBasicFilter",value:function(){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.CLEAR_BASIC_FILTER_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId}})}},{key:"updateFilterCriteria",value:function(e){return this.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.a.UPDATE_FILTER_CRITERIA_REQUEST,opt:e})}},{key:"switchFilterSync",value:function(e){return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.SWITCH_FILTER_SYNC_REQUEST,opt:e})}},{key:"applyPasteData",value:function(e){return this.app&&this.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.a.PASTE_DATA_REQUEST,opt:e})}},{key:"reorderWithFilter",value:function(e){return this.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.a.REORDER_FILTER_REQUEST,opt:e})}},{key:"insideSheetCopyPaste",value:function(e){return this.app&&this.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.a.PASTE_DATA_REQUEST,opt:e})}},{key:"defineFormRange",value:function(){var e=this.app.view.canvas.normalSelectData.activeCol,t=this.app.view.canvas.normalSelectData.activeRow;if(isNaN(e)||isNaN(t))throw new Error("\u6ca1\u6709\u5b9a\u4f4d\u5230\u5355\u5143\u683c");var n=this.app.spreadsheet.activeSheet.getCellDataAtPosition(t,e);if(n||(n=new b.a),!n.getSheetRange()){var r=i.a.getRandomId();return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.DEFINE_COMMENT_RANGE_REQUEST,opt:{id:r},canUndoRedo:!1})}}},{key:"insertImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.app.view.canvas.shapeUpload)throw new Error("\u4e0a\u4f20\u6a21\u5757\u5c1a\u672a\u51c6\u5907\u597d");var t=this.app.view.canvas.normalSelectData.activeRow,n=this.app.view.canvas.normalSelectData.activeCol;if(isNaN(t)||isNaN(n)||t<0||n<0)throw new Error("\u6ca1\u6709\u5b9a\u4f4d\u5230\u5355\u5143\u683c");var r=this.app.spreadsheet.activeSheetId;this.app.view.canvas.shapeUpload.insertShape(r,t,n,e)}},{key:"defineCommentRange",value:function(e){var t=this.app.view.canvas.normalSelectData.activeRow,n=this.app.view.canvas.normalSelectData.activeCol;if(isNaN(t)||isNaN(n)||t<0||n<0)throw new Error("\u6ca1\u6709\u5b9a\u4f4d\u5230\u5355\u5143\u683c");if(!e)throw new Error("\u6ca1\u6709\u8f93\u5165 sheetRangeId");var r=this.app.spreadsheet.activeSheet.getCellDataAtPosition(t,n);r||(r=new b.a);for(var a,o=r.getSheetRange()||[],s=0;a=o[s];s++)if(a.type===v.a.COMMENT_RANGE)return;return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.DEFINE_COMMENT_RANGE_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId,sheetRangeId:e,sheetRangeType:v.a.COMMENT_RANGE},canUndoRedo:!1})}},{key:"deleteCommentRange",value:function(){var e=this.app.view.canvas.normalSelectData.activeCol,t=this.app.view.canvas.normalSelectData.activeRow;if(isNaN(e)||isNaN(t))throw new Error("\u6ca1\u6709\u5b9a\u4f4d\u5230\u5355\u5143\u683c");var n=this.app.spreadsheet.activeSheet.getCellDataAtPosition(t,e);if(n)for(var r,a=n.getSheetRange()||[],o=0;r=a[o];o++)if(r.type===v.a.COMMENT_RANGE)return this.behavior.apply({type:"local",sheetId:this.app.spreadsheet.activeSheetId,requestId:l.a.DELETE_COMMENT_RANGE_REQUEST,opt:{sheetId:this.app.spreadsheet.activeSheetId,sheetRangeId:r.id},canUndoRedo:!1})}},{key:"dataValidation",value:function(e){var t=this,n=this.app.feature.dataValidation.getDataValidationConfig(e);if(null===n)return null;try{R.b.tdwReport({opername:"doc_edit",module:"excel",action:"data_validation",obj3:n.ruleType})}catch(o){}var r=e.selection&&[e.selection]||this.app.view.getSelection().rangeSelections,a=[{requestId:l.a.SET_METADATA,opt:{metadata:null,ranges:r}},{requestId:l.a.SET_DATA_VALIDATION_REQUEST,opt:{dataValidation:n,gridRanges:r}}];return this.behavior.apply({type:"local",requestId:l.a.MULTI_REQUEST,sheetId:this.app.spreadsheet.getActiveSheetId(),opt:{requests:a}}).then((function(e){var n;return null===(n=t.app.view.canvas.cellEditorManager)||void 0===n||n.updateActiveCellEditor(),e}))}},{key:"clearDataValidation",value:function(e){var t=[{requestId:l.a.SET_METADATA,opt:{metadata:null,ranges:[e]}},{requestId:l.a.SET_DATA_VALIDATION_REQUEST,opt:{dataValidation:null,gridRanges:[e]}}];return this.behavior.apply({type:"local",requestId:l.a.MULTI_REQUEST,sheetId:this.app.spreadsheet.getActiveSheetId(),opt:{requests:t}})}},{key:"doPaste",value:function(e){this.app.feature.copyPasteBase.apiDoPaste(e)}},{key:"inserRowWithLogic",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.app.spreadsheet.activeSheet.getRowCount(),o=this.app.spreadsheet.activeSheet.getColCount(),s=this.app.view.getSelection(),i=s.rangeSelections[0],l=i.startRowIndex,c=i.endRowIndex,u=this.app.view.canvas.normalSelectData.selectQueue[0].selectRow,d=this.app.spreadsheet.activeSheet,f=d.data,h=f.rowMetadata,p=0;for(n=l;n<l+t;n++)if(void 0===h[n]||null===h[n])p+=1;else{if(h[n]&&(h[n].hiddenByFilter||h[n].hiddenByUser))continue;p+=1}(a+p)*o<I.MAX_CELL_COUNT?r?this.insertRows([{index:l+p,amount:p}]):this.insertRows([{index:l,amount:p}]):E.dialog.confirm({title:"\u63d2\u5165\u884c\u5217\u5931\u8d25",content:"\u5df2\u8fbe\u6700\u5927\u884c\u5217\u9650\u5236\uff0c\u662f\u5426\u4e3a\u4f60\u65b0\u5efa\u4e00\u4e2a\u5de5\u4f5c\u8868\uff1f",onOk:function(){var t,n;return null===(t=(n=e).getPadMultiSheetController)||void 0===t||t.call(n).addNewSheet(),!0}});try{if(u&&c-l===0){var g=p>1?"more":"one";R.b.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"insert_".concat(g,"_row")})}else u&&c-l>0?R.b.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_insert_more_row"}):R.b.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_cell_insert_row"});t!==c-l+1&&R.b.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"type_insert_col"})}catch(m){}}},{key:"insertColWithLogic",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.app.spreadsheet.activeSheet.getRowCount(),o=this.app.spreadsheet.activeSheet.getColCount(),s=this.app.view.getSelection(),i=s.rangeSelections[0],l=i.startColIndex,c=i.endColIndex,u=this.app.view.canvas.normalSelectData.selectQueue[0].selectCol,d=this.app.spreadsheet.activeSheet,f=d.data,h=f.colMetadata,p=0;for(n=l;n<l+t;n++)if(void 0===h[n]||null===h[n])p+=1;else{if(h[n]&&(h[n].hiddenByFilter||h[n].hiddenByUser))continue;p+=1}a*(o+p)<I.MAX_CELL_COUNT?r?this.insertColumns([{index:l+p,amount:p}]):this.insertColumns([{index:l,amount:p}]):E.dialog.confirm({title:"\u63d2\u5165\u884c\u5217\u5931\u8d25",content:"\u5df2\u8fbe\u6700\u5927\u884c\u5217\u9650\u5236\uff0c\u662f\u5426\u4e3a\u4f60\u65b0\u5efa\u4e00\u4e2a\u5de5\u4f5c\u8868\uff1f",onOk:function(){return e.getPadMultiSheetController().addNewSheet(),!0}});try{if(u&&c-l===0){var g=p>1?"more":"one";R.b.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"insert_".concat(g,"_col")})}else u&&c-l>0?R.b.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_insert_more_col"}):R.b.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_cell_insert_col"});t!==c-l+1&&R.b.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"type_insert_row"})}catch(m){}}},{key:"freezePreview",value:function(e){this.app.view.canvas.freezePreview.preview(e)}},{key:"cancelFreezePreview",value:function(){this.app.view.canvas.freezePreview.cancelPreview()}},{key:"addConditionFormat",value:function(e){var t=this.app.spreadsheet.activeSheetId;return this.behavior.apply({type:"local",requestId:l.a.ADD_CONDITIONAL_FORMAT_REQUEST,sheetId:t,opt:e})}},{key:"deleteConditionFormat",value:function(e){var t=this.app.spreadsheet.activeSheetId;return this.behavior.apply({type:"local",requestId:l.a.DELETE_CONDITIONAL_FORMAT_REQUEST,sheetId:t,opt:e})}},{key:"updateConditionFormat",value:function(t){e.SpreadsheetApp;var n=this.app.spreadsheet.activeSheetId;return this.behavior.apply({type:"local",requestId:l.a.UPDATE_CONDITIONAL_FORMAT_REQUEST,sheetId:n,opt:t})}},{key:"setSheet",value:function(e){return this.behavior.apply({type:"local",requestId:l.a.SET_SHEETS_REQUEST,sheetId:e.sheetId,opt:e,canUndoRedo:!1})}},{key:"addProtectionRange",value:function(e){return this.behavior.apply({type:"local",requestId:l.a.ADD_PROTECTED_RANGE_REQUEST,sheetId:e.range.sheetId,opt:e})}},{key:"updateProtectionRange",value:function(e){return this.behavior.apply({type:"local",requestId:l.a.UPDATE_PROTECTED_RANGE_REQUEST,sheetId:e.range.sheetId,opt:e})}},{key:"deleteProtectionRange",value:function(e){return this.behavior.apply({type:"local",requestId:l.a.DELETE_PROTECTED_RANGE_REQUEST,sheetId:this.app.spreadsheet.activeSheetId,opt:e})}},{key:"insertSheet",value:function(e){var t=e.sheetId,n=e.sheetIndex,r=e.sheetName,a=e.sheetType,o=e.isHidden;if("string"!==typeof t)throw new Error("Warning: sheetId must be a string.");if("undefined"!==typeof n&&"number"!==typeof n)throw new Error("Warning: sheetIndex must be a number.");if(r&&"string"!==typeof r)throw new Error("Warning: sheetName must be a string.");if(a&&"string"!==typeof a)throw new Error("Warning: sheetType must be a string.");if("undefined"!==typeof o&&"boolean"!==typeof o)throw new Error("Warning: isHidden must be a boolean.");return this.behavior.apply({type:"local",requestId:l.a.INSERT_SHEET_REQUEST,sheetId:t,opt:[e],canUndoRedo:!1})}},{key:"delSheet",value:function(e){var t=e.sheetId,n=e.sheetIndex;if("string"!==typeof t)throw new Error("Warning: sheetId must be a string.");if("number"!==typeof n)throw new Error("Warning: sheetIndex must be a number.");return this.behavior.apply({type:"local",requestId:l.a.DELETE_SHEET_REQUEST,sheetId:this.app.spreadsheet.activeSheetId,opt:[e],canUndoRedo:!1})}},{key:"moveSheet",value:function(e){var t=e.fromIndex,n=e.toIndex;if("number"!==typeof t)throw new Error("Warning: fromIndex must be a number.");if("number"!==typeof n)throw new Error("Warning: toIndex must be a number.");return this.behavior.apply({type:"local",requestId:l.a.MOVE_SHEET_REQUEST,sheetId:this.app.spreadsheet.activeSheetId,opt:[e]})}},{key:"hideSheet",value:function(e){var t=e.sheetId,n=e.hidden;if("string"!==typeof t)throw new Error("Warning: sheetId must be a string.");if("boolean"!==typeof n)throw new Error("Warning: hidden must ba a boolean.");return this.behavior.apply({type:"local",requestId:l.a.HIDE_SHEET_REQUEST,sheetId:t,opt:[e]})}},{key:"showSheet",value:function(e){var t=e.sheetId,n=e.hidden;if("string"!==typeof t)throw new Error("Warning: sheetId must be a string.");if("boolean"!==typeof n)throw new Error("Warning: hidden must ba a boolean.");return this.behavior.apply({type:"local",requestId:l.a.HIDE_SHEET_REQUEST,sheetId:t,opt:[e]})}},{key:"renameSheet",value:function(e){var t=e.sheetId,n=e.sheetName;if("string"!==typeof t)throw new Error("Warning: sheetId must be a string.");if("string"!==typeof n)throw new Error("Warning: sheetId must be a string.");return this.behavior.apply({type:"local",requestId:l.a.RENAME_SHEET_REQUEST,sheetId:t,opt:[e],canUndoRedo:!1})}},{key:"copySheet",value:function(e){var t=e.sheetId,n=e.newSheetId,r=e.newSheetName;if("string"!==typeof t)throw new Error("Warning: sheetId must be a string.");if("string"!==typeof n)throw new Error("Warning: newSheetId must be a string.");if("string"!==typeof r)throw new Error("Warning: newSheetName must be a string.");return this.behavior.apply({type:"local",requestId:l.a.COPY_SHEET_REQUEST,sheetId:t,opt:[e],canUndoRedo:!1})}},{key:"addEmbeddedObject",value:function(e){return this.behavior.apply({type:"local",requestId:l.a.ADD_EMBEDDED_OBJECT,sheetId:e.objects[0].location.sheetId,opt:[e],canUndoRedo:!0})}},{key:"updateEmbeddedObject",value:function(e){return this.behavior.apply({type:"local",requestId:l.a.UPDATE_EMBEDDED_OBJECT,sheetId:e.objects[0].location.sheetId,opt:[e],canUndoRedo:!0})}},{key:"deleteEmbeddedObject",value:function(e){return this.behavior.apply({type:"local",requestId:l.a.DELETE_EMBEDDED_OBJECT,sheetId:this.app.spreadsheet.activeSheetId,opt:[e],canUndoRedo:!0})}},{key:"moveEmbeddedObjectToSheet",value:function(e){var t=e.sheetId;return this.behavior.apply({type:"local",requestId:l.a.MOVE_EMBEDDED_OBJECT_TO_SHEET,sheetId:t,opt:[e],canUndoRedo:!0})}},{key:"setIgnoredErrorFlags",value:function(e){var t=this.app.spreadsheet.getActiveSheetId();return this.behavior.apply({type:"local",requestId:l.a.SET_IGNORED_ERROR_FLAGS,sheetId:t,opt:e,canUndoRedo:!0})}},{key:"setMetadata",value:function(e){var t=this,n=this.app.spreadsheet.getActiveSheetId(),r=this.app.view.getSelection(),a=r.rangeSelections,o=r.selectQueue,s=e.metadata,i=Object(D.c)(this.app.spreadsheet.activeSheet),c=i&&new f.b(n,0,i.endRowIndex,i.startColIndex,i.endColIndex),u=[],d=M()(a.map((function(e,t){var n=o[t],r=n.selectAll;return n.selectCol&&!r&&(u.push({start:e.startColIndex,end:e.endColIndex}),c&&s)?Object(h.gridRangeExcept)(e,c):e}))),p=[{requestId:l.a.SET_METADATA,opt:{metadata:s,ranges:d,colIndexes:u}}];if(s){if(Object(C.z)(s.customDataType)){var g=Object(x.c)(s);g&&p.push({requestId:l.a.SET_DATA_VALIDATION_REQUEST,opt:{dataValidation:g,gridRanges:d}})}else p.push({requestId:l.a.SET_DATA_VALIDATION_REQUEST,opt:{gridRanges:d,dataValidation:null}});if(s.customDataType===C.o.STAR){var m=Object(x.a)(this.app.spreadsheet.sheetManager.getSheetBySheetId(n),d);if(m){var b={sheetId:n,dimensionModifiers:m};p.push({requestId:l.a.SET_DIMENSION_SIZE_REQUEST,opt:b})}}}else s||p.push({requestId:l.a.SET_DATA_VALIDATION_REQUEST,opt:{dataValidation:null,gridRanges:d}});return this.behavior.apply({type:"local",requestId:l.a.MULTI_REQUEST,sheetId:n,opt:{requests:p},canUndoRedo:!0}).then((function(e){var n;return null===(n=t.app.view.canvas.cellEditorManager)||void 0===n||n.updateActiveCellEditor(),e}))}},{key:"setRefIds",value:function(e){var t=this.app.spreadsheet.getActiveSheetId();return this.behavior.apply({type:"local",requestId:l.a.SET_REF_IDS,sheetId:t,opt:e,canUndoRedo:!0})}}]),t}();W=q([V(0,y.a),V(1,L.a)],W),t.default=W}.call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/behavior/behavior.interface.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("../packages/services/src/instantiation.ts"),a=Object(r.c)("IBehavior")},"./src/core/behavior/behavior.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/es.string.repeat.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/typeof.js"),s=n("./src/core/app/dataCallCore.ts"),i=n("./src/base/event/event.ts"),l=n("./src/core/behavior/requests.ts"),c=n("./src/base/util/timer.ts"),u=n("../packages/report/src/index.ts"),d=n("./src/base/config/report.ts"),f=n("./src/core/ui/dialog/index.ts"),h=n("../node_modules/@tencent/jank-sdk/lib/index.js"),p=n("./src/base/event/eventName.ts"),g=n("./src/base/error/errCodeType.ts"),m=n("../packages/undoRedoStack/src/index.ts"),b=n("./src/core/network/message-center/model/userChange-helper.ts"),v=n("./src/core/app/SpreadsheetApp.interface.ts"),I=n("./src/core/view/layout/pcView.ts"),_=function(e,t,n,r){var a,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(o.a)(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(i=(s<3?a(i):s>3?a(t,n,i):a(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},y=function(e,t){return function(n,r){t(n,r,e)}},R=function(){function t(e,n,a){Object(r.a)(this,t),this.parent=e,this.undoredoStack=n,this.selectionParent=a,this.cacheApplyParams=null}return Object(a.a)(t,[{key:"apply",value:function(e){var t=this;if(this.parent.getDidEditable&&!this.parent.getDidEditable())return this.cacheApplyParams||(this.cacheApplyParams=e,this.parent.emitter.once(this.parent.EVENT.SPREAD_SHEET_EDITABLE,(function(){t.apply(t.cacheApplyParams),t.cacheApplyParams=null}))),Promise.resolve(null);if("undo"!==e.type&&"redo"!==e.type&&"local"!==e.type||u.b.monitor(33638269),!1===this.checkPermission(e))return Promise.reject("checkPermissionFail");var n,r=function(t){return function(n,r){try{t(n,r)}catch(a){u.b.run(d.CONFIG.APPLY_BEHAVIOR_CATCH_SCRIPT_ERROR,[],a,e.type)}}};switch(i.c.spreadsheetEvent.trigger("applyBehaviorStart",e.sheetId),e.type){case"undo":n=new Promise(r((function(n,r){t.applyUndo(e.sheetId,n,r)})));break;case"redo":n=new Promise(r((function(n,r){t.applyRedo(e.sheetId,n,r)})));break;case"collab":n=new Promise(r((function(n,r){t.applyCollabMutations(e.opt,n,r)})));break;case"offline":n=new Promise(r((function(n,r){t.applyOfflineMutations(e.opt,n,r)})));break;case"local":n=new Promise(r((function(n,r){void 0===e.canUndoRedo&&(e.canUndoRedo=!0),t.applyLocalRequest(e.type,e.sheetId,e.requestId,e.opt,e.canUndoRedo,n,r)})));break;default:n=new Promise((function(e,t){t()}))}return n}},{key:"checkPermission",value:function(e){return!!("undo"!==e.type&&"redo"!==e.type&&"local"!==e.type||this.parent.sheetStatus.workbookStatus.canEdit||this.parent.sheetStatus.canComment)}},{key:"applyUndo",value:function(e,t,n){u.b.jank.log({moduleValue:"applyMutation",actionValue:"undo"});var r=this.undoredoStack.undo();this.parent.sheetStatus.workbookStatus.status.setCanUndo(this.undoredoStack.undoStack.length>0),u.b.run(d.CONFIG.APPLY_BEHAVIOR_UNDO,[e,r&&r.sheetId]),r&&(u.b.monitor(33686605),Object(s.a)(this.parent,r.sheetId,r.undo,-1,{},r.fromMultiSheetRequest)),t()}},{key:"applyRedo",value:function(e,t,n){u.b.jank.log({moduleValue:"applyMutation",actionValue:"redo"});var r=this.undoredoStack.redo();this.parent.sheetStatus.workbookStatus.status.setCanRedo(this.undoredoStack.redoStack.length>0),u.b.run(d.CONFIG.APPLY_BEHAVIOR_REDO,[e,r&&r.sheetId]),r&&(u.b.monitor(33686606),Object(s.a)(this.parent,r.sheetId,r.undo,-1,{},r.fromMultiSheetRequest)),t()}},{key:"applyCollabMutations",value:function(e,t,n){try{var r,a,o=JSON.parse(e.changeset),s=-1;o.length>0&&o[0]&&o[0].length>0&&o[0][0]&&(s=o[0][0].r),u.b.jank.log({moduleValue:"applyMutation",actionValue:"collab_".concat(s)});var l=null===(r=this.parent)||void 0===r||null===(a=r.feature)||void 0===a?void 0:a.relateForm;(null===l||void 0===l?void 0:l.isRelated(e.sheetId))&&l.updateFromSyncMutations(o,e.sheetId),o=o.filter((function(e,t){return"revert"===e.type&&!0,!0})),e.revert&&this.parent.socket.handleRevert(),this.parent.messageCenter.receiveMessageCenter.onApplyNewChanges({changeInfo:e,mutations:o}),t(o),i.c.spreadsheetEvent.trigger(p.a.DATA_CHANGE,{type:"syncndoredoStack"})}catch(c){u.b.run(d.CONFIG.APPLY_NEW_CHANGES_ERROR,[null===c||void 0===c?void 0:c.stack]),n()}}},{key:"applyOfflineMutations",value:function(t,n,r){var a;null===(a=e.log)||void 0===a||a.info("applyOfflineMutations",t.mutations.length);try{Object(b.c)(this.parent,t)}catch(s){var o;null===(o=e.log)||void 0===o||o.error("applyOfflineMutations error",s)}n()}},{key:"applyLocalRequest",value:function(e,t,n,r){var a=this,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0,l=arguments.length>6?arguments[6]:void 0;u.b.jank.log({moduleValue:"applyMutation",actionValue:"local_".concat(n)});var h=this.selectionParent.getSelection();if(null!=h){var g;u.b.run(d.CONFIG.LOAD_REQUEST,[n]);try{g=this.loadRequest(n,r,h)}catch(y){return u.b.run(d.CONFIG.APPLY_BEHAVIOR_ERROR,[t],y),void l()}var m=g.getRanges(this.parent.spreadsheet),b=this.checkRangesIsLoaded(m);if(!b)return u.b.run(d.CONFIG.APPLY_BEHAVIOR_NOT_LOADED,[t]),void l();var v=g.check(this.parent.spreadsheet);if(null===v){u.b.run(d.CONFIG.APPLY_BEHAVIOR_LOCAL,[t]);var I=this.applyLocal(t,g,n,o,r);return I&&u.b.monitor(33686607),void s()}if(v.ignore)return u.b.run(d.CONFIG.APPLY_BEHAVIOR_LEVEL_INFO,[t]),void l(v);if(v.isWarningOnly)c.a.wait(300).run((function(){f.dialog.confirm({title:v.warning.title,content:v.warning.content,onOk:function(){if(v.warning.repeat)a.applyLocalRequest(e,t,n,r,o,s,l);else{if(!a.applyLocal(t,g,n,o,r))return void u.b.run(d.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"9");i.c.spreadsheetEvent.trigger(p.a.DATA_CHANGE,{type:"requestcheckConfirm"}),u.b.run(d.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"6"),u.b.run(d.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR),s()}},onCancel:function(){i.c.spreadsheetEvent.trigger(p.a.DATA_CHANGE,{type:"requestcheckCancle"}),u.b.run(d.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"7"),l()},onClose:function(e){""===e&&(i.c.spreadsheetEvent.trigger(p.a.DATA_CHANGE,{type:"requestcheckCancle"}),u.b.run(d.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"8"),l())}})}));else{u.b.run(d.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"4");var _=function(e){e.preventDefault(),e.stopPropagation()};window.addEventListener("mousedown",_),f.dialog.info({title:v.error.title,content:v.error.content,onOk:function(){window.removeEventListener("mousedown",_)}}),i.c.spreadsheetEvent.trigger(p.a.DATA_CHANGE,{type:"requestcheckError"}),l(v)}}}},{key:"applyLocal",value:function(e,t,n,r,a){var o=this,i=this.undoredoStack.createUndoRedoMutations({sheetId:e,local:!0,fromMultiSheetRequest:t.isMultiSheetRequest()});return t.predictRequestSize(this.parent.spreadsheet)>512e3?(this.parent.event.errorCode.trigger("errorCode",{type:"front",code:g.a.REQUEST_SIZE_LIMIT,data:{message:t.requestSizeOverLimitTips()}}),u.b.run(d.CONFIG.REQUEST_SIZE_OVER_LIMIT,[e,n]),!1):(t.run(this.parent.spreadsheet,(function(e){i.add([e]),o.parent.mutationBehavior.applyMutation(e,{isLocal:!0})})),r&&(this.undoredoStack.push(i),this.parent.sheetStatus.workbookStatus.status.setCanUndo(this.undoredoStack.undoStack.length>0)),Object(s.a)(this.parent,e,i.redo,n,a,t.isMultiSheetRequest()),!0)}},{key:"checkRangesIsLoaded",value:function(e){var t,n,r,a;for(t=0,n=e.length;t<n;t++){if(r=e[t],!(a=this.parent.spreadsheet.sheetManager.getSheetBySheetId(r.sheetId)))return!1;if(r.startRowIndex<0)return!1;if(r.endRowIndex>=a.getRowCount())return!1;if(r.startColIndex<0)return!1;if(r.endColIndex>=a.getColCount())return!1}return!0}},{key:"loadRequest",value:function(e,t,n){return Object(l.a)(e,t,n)}}]),t}();_([Object(h.b)(R)],R.prototype,"applyLocalRequest",null),_([Object(h.b)(R)],R.prototype,"applyLocal",null),_([Object(h.b)(R)],R.prototype,"loadRequest",null),R=_([y(0,v.a),y(1,m.a),y(2,I.a)],R),t.a=R}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/behavior/request/Request.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/typeof.js"),s=n("../node_modules/@tencent/jank-sdk/lib/index.js"),i=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js")),l=n("../packages/model/src/cell/cellDataDeltaUtils.ts"),c=n("../packages/mutation/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),d=n("./src/core/behavior/request/Type.ts"),f=n("../node_modules/lodash/flattenDeep.js"),h=n.n(f),p=n("../packages/model/src/cell/metadata/CustomDataType.ts"),g=n("./src/core/behavior/request/dimension/util.ts"),m=n("./src/core/behavior/request/embedded/utils.ts");function b(e){var t,n,r=e.delta;return(null===(t=r.metadata)||void 0===t?void 0:t.customDataType)===p.o.IMAGE?null===(n=r.refIds)||void 0===n?void 0:n[0]:null}function v(e,t){e.id===u.b.SET_RANGE_MUTATION&&e.cellDataDeltaAtPositions.forEach((function(e){var n=e.cellDataDelta,r=e.rowIndex,a=e.colIndex;Object(l.isCellContentModified)(n)&&t(r,a,n)}));if(e.id===u.b.SET_CELL_PROPERTIES_MUTATION){var n=e.cellDataDelta,r=e.gridRange;Object(l.isCellContentModified)(n)&&r.each((function(e,r){return t(e,r,n)}))}}function I(e,t){return[].concat(Object(i.a)(function(e,t){var n=e.activeSheet,r=n.getSheetId(),a=[],o=[d.a.ADD_IMAGE_REQUEST,d.a.UPDATE_IMAGE_REQUEST,d.a.DELETE_IMAGE_REQUEST,d.a.SET_SINGLE_VALUE_REQUEST,d.a.CLEAR_RANGE_REQUEST,d.a.MOVE_DIMENSION_REQUEST,d.a.SET_LINK_REQUEST,d.a.SET_HYPERLINK_RUNS_REQUEST].includes(t.parentRequestId);return t.getAffectedSheetId()!==r||!t.check(n).isValid||o||v(t,(function(e,t,o){var s=n.getCellImage(e,t);s&&s.id!==b(o)&&a.push(new c.c({key:s.id,sheetId:r}))})),a}(e,t)),Object(i.a)(function(e,t){var n=e.activeSheet,r=n.getSheetId(),a=[],o=[d.a.ADD_IMAGE_REQUEST].includes(t.parentRequestId);return t.getAffectedSheetId()!==r||!t.check(n).isValid||o||v(t,(function(t,r,o){if(!n.getCellImage(t,r)&&b(o)){var s=Object(m.a)(n,t);if(!s)return;Object(g.a)(s,e,(function(e){return a.push(e)}))}})),a}(e,t)))}function _(e,t){return h()(function(e,t){var n=e.activeSheetId,r=e.activeSheet;if(t.getAffectedSheetId()!==n)return[];if(t.id===u.b.COPY_PASTE_MUTATION){var a=t.generateSetRangeMutations(r);return h()(a.map((function(t){return I(e,t)})))}return t.id===u.b.SET_RANGE_MUTATION||t.id===u.b.SET_CELL_PROPERTIES_MUTATION?I(e,t):[]}(e,t))}var y=function(e,t,n,r){var a,s=arguments.length,i=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(o.a)(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(i=(s<3?a(i):s>3?a(t,n,i):a(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i},R=function(){function e(t,n){Object(r.a)(this,e),this.behaviors=[],this.canUndoRedo=!0}return Object(a.a)(e,[{key:"isMultiSheetRequest",value:function(){return!1}},{key:"predictRequestSize",value:function(e){return 0}},{key:"requestSizeOverLimitTips",value:function(){}},{key:"getRanges",value:function(e){return[]}},{key:"check",value:function(e){return null}},{key:"run",value:function(e,t){var n=this;this.behaviors&&this.behaviors.length&&this.behaviors.forEach((function(r){n.do(r,e,(function(r){n.id!==d.a.MULTI_REQUEST&&(r.parentRequestId=n.id);var a=_(e,r);t(r),a.forEach((function(e){n.id!==d.a.MULTI_REQUEST&&(e.parentRequestId=n.id),t(e)}))}))}))}},{key:"do",value:function(e,t,n){}}]),e}();y([Object(s.b)(R)],R.prototype,"run",null);t.a=R},"./src/core/behavior/request/Type.ts":function(e,t,n){"use strict";var r;!function(e){e[e.INSERT_DIMENSION_REQUEST=0]="INSERT_DIMENSION_REQUEST",e[e.DELETE_DIMENSION_REQUEST=1]="DELETE_DIMENSION_REQUEST",e[e.MOVE_DIMENSION_REQUEST=2]="MOVE_DIMENSION_REQUEST",e[e.SET_DIMENSION_SIZE_REQUEST=3]="SET_DIMENSION_SIZE_REQUEST",e[e.SET_DIMENSION_HIDE_REQUEST=4]="SET_DIMENSION_HIDE_REQUEST",e[e.SET_DIMENSION_SHOW_REQUEST=5]="SET_DIMENSION_SHOW_REQUEST",e[e.ADD_IMAGE_REQUEST=6]="ADD_IMAGE_REQUEST",e[e.DELETE_IMAGE_REQUEST=7]="DELETE_IMAGE_REQUEST",e[e.UPDATE_IMAGE_REQUEST=8]="UPDATE_IMAGE_REQUEST",e[e.MERGE_CELLS_REQUEST=9]="MERGE_CELLS_REQUEST",e[e.UNMERGE_CELLS_REQUEST=10]="UNMERGE_CELLS_REQUEST",e[e.SET_SHEETS_REQUEST=11]="SET_SHEETS_REQUEST",e[e.SET_FORMAT_REQUEST=12]="SET_FORMAT_REQUEST",e[e.REORDER_RANGE_REQUEST=13]="REORDER_RANGE_REQUEST",e[e.FREEZE_REQUEST=14]="FREEZE_REQUEST",e[e.SET_SINGLE_VALUE_REQUEST=15]="SET_SINGLE_VALUE_REQUEST",e[e.SET_BORDERS_REQUEST=16]="SET_BORDERS_REQUEST",e[e.COPY_PASTE_REQUEST=17]="COPY_PASTE_REQUEST",e[e.CUT_PASTE_REQUEST=18]="CUT_PASTE_REQUEST",e[e.PASTE_DATA_REQUEST=19]="PASTE_DATA_REQUEST",e[e.CLEAR_FORMAT_REQUEST=20]="CLEAR_FORMAT_REQUEST",e[e.REPLACE_ALL_REQUEST=21]="REPLACE_ALL_REQUEST",e[e.SET_LINK_REQUEST=22]="SET_LINK_REQUEST",e[e.CLEAR_LINK_REQUEST=23]="CLEAR_LINK_REQUEST",e[e.CLEAR_RANGE_REQUEST=24]="CLEAR_RANGE_REQUEST",e[e.SET_NUMBER_FORMAT_REQUEST=25]="SET_NUMBER_FORMAT_REQUEST",e[e.ADJUST_DECIMALS_REQUEST=26]="ADJUST_DECIMALS_REQUEST",e[e.AUTO_FILL_REQUEST=27]="AUTO_FILL_REQUEST",e[e.SET_BASIC_FILTER_REQUEST=28]="SET_BASIC_FILTER_REQUEST",e[e.CLEAR_BASIC_FILTER_REQUEST=29]="CLEAR_BASIC_FILTER_REQUEST",e[e.EXPAND_DIMENSION_REQUEST=30]="EXPAND_DIMENSION_REQUEST",e[e.UPDATE_FILTER_CRITERIA_REQUEST=31]="UPDATE_FILTER_CRITERIA_REQUEST",e[e.SET_RANGE_VALUE_REQUEST=32]="SET_RANGE_VALUE_REQUEST",e[e.MULTI_REQUEST=33]="MULTI_REQUEST",e[e.CLEAR_COMMENT_REQUEST=34]="CLEAR_COMMENT_REQUEST",e[e.UPDATE_COMMENT_REQUEST=35]="UPDATE_COMMENT_REQUEST",e[e.DEFINE_COMMENT_RANGE_REQUEST=36]="DEFINE_COMMENT_RANGE_REQUEST",e[e.DELETE_COMMENT_RANGE_REQUEST=37]="DELETE_COMMENT_RANGE_REQUEST",e[e.SET_DIMENSION_FORMDATA_REQUEST=38]="SET_DIMENSION_FORMDATA_REQUEST",e[e.SET_DATA_VALIDATION_REQUEST=39]="SET_DATA_VALIDATION_REQUEST",e[e.REORDER_FILTER_REQUEST=40]="REORDER_FILTER_REQUEST",e[e.SET_HIDE_GRIDLINES_REQUEST=41]="SET_HIDE_GRIDLINES_REQUEST",e[e.ADD_CONDITIONAL_FORMAT_REQUEST=42]="ADD_CONDITIONAL_FORMAT_REQUEST",e[e.UPDATE_CONDITIONAL_FORMAT_REQUEST=43]="UPDATE_CONDITIONAL_FORMAT_REQUEST",e[e.DELETE_CONDITIONAL_FORMAT_REQUEST=44]="DELETE_CONDITIONAL_FORMAT_REQUEST",e[e.INSERT_SHEET_REQUEST=45]="INSERT_SHEET_REQUEST",e[e.DELETE_SHEET_REQUEST=46]="DELETE_SHEET_REQUEST",e[e.MOVE_SHEET_REQUEST=47]="MOVE_SHEET_REQUEST",e[e.HIDE_SHEET_REQUEST=48]="HIDE_SHEET_REQUEST",e[e.RENAME_SHEET_REQUEST=50]="RENAME_SHEET_REQUEST",e[e.COPY_SHEET_REQUEST=51]="COPY_SHEET_REQUEST",e[e.ADD_PROTECTED_RANGE_REQUEST=52]="ADD_PROTECTED_RANGE_REQUEST",e[e.UPDATE_PROTECTED_RANGE_REQUEST=53]="UPDATE_PROTECTED_RANGE_REQUEST",e[e.DELETE_PROTECTED_RANGE_REQUEST=54]="DELETE_PROTECTED_RANGE_REQUEST",e[e.ADD_EMBEDDED_OBJECT=55]="ADD_EMBEDDED_OBJECT",e[e.UPDATE_EMBEDDED_OBJECT=56]="UPDATE_EMBEDDED_OBJECT",e[e.DELETE_EMBEDDED_OBJECT=57]="DELETE_EMBEDDED_OBJECT",e[e.MOVE_EMBEDDED_OBJECT_TO_SHEET=58]="MOVE_EMBEDDED_OBJECT_TO_SHEET",e[e.SWITCH_FILTER_SYNC_REQUEST=59]="SWITCH_FILTER_SYNC_REQUEST",e[e.SET_IGNORED_ERROR_FLAGS=60]="SET_IGNORED_ERROR_FLAGS",e[e.ADD_LINKED_RANGE_REQUEST=61]="ADD_LINKED_RANGE_REQUEST",e[e.SET_HYPERLINK_RUNS_REQUEST=62]="SET_HYPERLINK_RUNS_REQUEST",e[e.SET_METADATA=63]="SET_METADATA",e[e.SET_REF_IDS=64]="SET_REF_IDS"}(r||(r={})),t.a=r},"./src/core/behavior/request/cell/ClearFormatRequest.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"c",(function(){return O}));n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=n("../packages/model/src/range/GridRange.ts"),c=n("./src/core/behavior/request/Request.ts"),u=n("../packages/model/src/cell/CellDataDelta.ts"),d=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),f=n("../packages/model/src/cell/CellDataSlot.ts"),h=n("../packages/model/src/range/gridRangeUtils.ts"),p=n("../packages/model/src/cell/CellFormatDelta.ts"),g=n("../packages/model/src/cell/CellFormatSlot.ts"),m=n("./src/core/behavior/request/Type.ts"),b=n("./src/core/behavior/request/utils/index.ts"),v=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts"),I=n("../packages/mutation/src/index.ts"),_=n("../packages/model/src/cell/metadata/CustomDataType.ts");function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var R=function(e){Object(o.a)(n,e);var t=y(n);function n(e,a){var o;Object(r.a)(this,n),o=t.call(this,e,a);var s=e.gridRanges||(null===a||void 0===a?void 0:a.rangeSelections)||[];return o.behaviors=s.map((function(e){return{gridRange:e}})),o}return Object(a.a)(n,[{key:"do",value:function(e,t,n){var r=O(),a=[e.gridRange],o=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId);if(o){a=Object(h.divideGridRangesByFilter)(a,o.getBasicFilter());for(var s=0,i=(a=Object(h.divideGridRangesByMerges)(a,o.mergeManager.mergeList,{needContainSubCells:!0})).length;s<i;s++){var c=a[s],u=E(o,c);n(new d.a({gridRange:a[s],cellDataDelta:r})),u&&n(u);for(var f=c.startRowIndex;f<=c.endRowIndex;f++)for(var p=c.startColIndex;p<=c.endColIndex;p++){var g=Object(b.c)(o,f,p,r);if(!g.isEmpty())n(new d.a({gridRange:new l.b(e.gridRange.sheetId,f,f,p,p),cellDataDelta:g}))}Object(v.b)(c,o).forEach(n)}}}},{key:"id",get:function(){return n.id}}]),n}(c.a);function E(e,t){var n=[];return t.each((function(t,r){var a,o=e.getCellDataAtPosition(t,r),s=null===o||void 0===o?void 0:o.getMetadata();if(s&&Object(_.v)(s.customDataType)){var i=null===o||void 0===o||null===(a=o.getUserEnteredFormat())||void 0===a?void 0:a.getNumberFormat(),l=new p.a;l.setSlot(g.b.NUMBER_FORMAT,i),n.push({rowIndex:t,colIndex:r,cellDataDelta:(new u.a).setSlot(f.b.SLOT_USER_ENTERED_FORMAT_DELTA,l)})}})),0===n.length?null:new I.j({gridRange:t,cellDataDeltaAtPositions:n})}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new u.a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new p.a,r=t.skipBorder,a=void 0!==r&&r,o=t.skipBackground,s=void 0!==o&&o;return n.clearSlot(g.b.NUMBER_FORMAT),s||n.clearSlot(g.b.BACKGROUND_COLOR),a||(n.clearSlot(g.b.BORDER_TOP),n.clearSlot(g.b.BORDER_RIGHT),n.clearSlot(g.b.BORDER_BOTTOM),n.clearSlot(g.b.BORDER_LEFT)),n.clearSlot(g.b.HORIZONTAL_ALIGN),n.clearSlot(g.b.VERTICAL_ALIGN),n.clearSlot(g.b.WRAP_STRATEGY),n.clearSlot(g.b.FOREGROUND_COLOR),n.clearSlot(g.b.FONT_FAMINY),n.clearSlot(g.b.FONT_SIZE),n.clearSlot(g.b.BOLD),n.clearSlot(g.b.ITALIC),n.clearSlot(g.b.STRIKETHROUGH),n.clearSlot(g.b.UNDERLINE),e.clearSlot(f.b.SLOT_HYPERLINK),e.clearSlot(f.b.SLOT_HYPERLINK_TYPE),e.setSlot(f.b.SLOT_USER_ENTERED_FORMAT_DELTA,n),e}R.id=m.a.CLEAR_FORMAT_REQUEST,t.b=R},"./src/core/behavior/request/cell/ClearRangeRequest.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return v}));n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=n("./src/core/behavior/request/Request.ts"),c=n("../packages/model/src/cell/CellDataDelta.ts"),u=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),d=n("../packages/model/src/cell/CellDataSlot.ts"),f=n("../packages/model/src/range/gridRangeUtils.ts"),h=n("./src/core/behavior/request/Type.ts"),p=n("../packages/mutation/src/index.ts"),g=n("../packages/model/src/cell/metadata/CustomDataType.ts");function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var b=function(e){Object(o.a)(n,e);var t=m(n);function n(e,a){var o;Object(r.a)(this,n),o=t.call(this,e,a);var s=e.gridRanges||(null===a||void 0===a?void 0:a.rangeSelections)||[];return o.behaviors=s.map((function(e){return{gridRange:e}})),o}return Object(a.a)(n,[{key:"do",value:function(e,t,n){var r=this,a=v(),o=[e.gridRange],s=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId);s&&(o=Object(f.divideGridRangesByMerges)(o,s.mergeManager.mergeList),(o=Object(f.divideGridRangesByFilter)(o,s.getBasicFilter())).forEach((function(e){var t=function(e,t){var n=[];if(t.each((function(t,r){var a=e.getCellDataAtPosition(t,r),o=null===a||void 0===a?void 0:a.getMetadata();o&&!Object(g.s)(o.customDataType)&&n.push({rowIndex:t,colIndex:r,cellDataDelta:(new c.a).setSlot(d.b.SLOT_METADATA,o)})})),0===n.length)return null;return new p.j({gridRange:t,cellDataDeltaAtPositions:n})}(s,e);e.each((function(e,t){var r=s.getCellImage(e,t);r&&n(new p.c({key:r.id,sheetId:s.getSheetId()}))})),r.clearLinkedRange(e,s,n),n(new u.a({gridRange:e,cellDataDelta:a})),t&&n(t)})))}},{key:"clearLinkedRange",value:function(e,t,n){}},{key:"id",get:function(){return n.id}}]),n}(l.a);function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c.a;return e.clearSlot(d.b.SLOT_EFFIECTIVE_VALUE),e.clearSlot(d.b.SLOT_HYPERLINK),e.clearSlot(d.b.SLOT_HYPERLINK_TYPE),e.clearSlot(d.b.SLOT_FORMULA),e.clearSlot(d.b.SLOT_MENTION),e.clearSlot(d.b.SLOT_REF_IDS),e.clearSlot(d.b.SLOT_METADATA),e.clearSlot(d.b.SLOT_HYPERLINK_RUN),e}b.id=h.a.CLEAR_RANGE_REQUEST,t.a=b},"./src/core/behavior/request/cell/SetHyperlinkRunsRequest.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=n("./src/core/behavior/request/cell/SetSingleValueRequest.ts"),c=n("./src/core/behavior/request/Type.ts"),u=n("../packages/model/src/cell/HyperlinkType.ts"),d=n("../packages/model/src/cell/HyperlinkRun.ts");function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var h=function(t){Object(o.a)(s,t);var n=f(s);function s(t,a){var o;Object(r.a)(this,s),o=n.call(this,t,a);var i=e.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(t.rowIndex,t.colIndex),l=null===i||void 0===i?void 0:i.getHyperlink(),c=null===i||void 0===i?void 0:i.getHyperlinkType();return o.behaviors.forEach((function(e){e.hyperlinkRuns=t.hyperlinkRuns.map((function(e){return new d.a(e)})),c&&t.hyperlinkType===u.b.IMAGE&&l&&t.hyperlinkRuns&&(e.hyperlinkType=null),e.linkUrl=null})),o}return Object(a.a)(s,[{key:"id",get:function(){return s.id}}]),s}(l.a);h.id=c.a.SET_HYPERLINK_RUNS_REQUEST,t.a=h}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/behavior/request/cell/SetLinkRequest.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=n("./src/core/behavior/request/cell/SetSingleValueRequest.ts"),c=n("./src/base/util/url.ts"),u=n("./src/core/behavior/request/Type.ts"),d=n("../packages/model/src/cell/HyperlinkType.ts"),f=n("../packages/model/src/cell/metadata/CustomDataType.ts");function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var p=function(t){Object(o.a)(i,t);var n=h(i);function i(t,a){var o;Object(r.a)(this,i),o=n.call(this,t,a);var l=e.SpreadsheetApp.spreadsheet.activeSheet,u=l.getCellDataAtPosition(t.rowIndex,t.colIndex);if(Object(f.y)(l,t.rowIndex,t.colIndex))return o.behaviors=[],Object(s.a)(o);var h=null===u||void 0===u?void 0:u.getHyperlink(),p=null===u||void 0===u?void 0:u.getHyperlinkType();return o.behaviors.forEach((function(e){e.linkUrl=t.linkUrl||null,!e.userEnterValue&&e.linkUrl&&(e.userEnterValue=Object(c.d)(e.linkUrl)||""),p&&t.hyperlinkType===d.b.IMAGE&&h&&t.linkUrl!==h&&(e.hyperlinkType=null)})),o}return Object(a.a)(i,[{key:"id",get:function(){return i.id}}]),i}(l.a);p.id=u.a.SET_LINK_REQUEST,t.a=p}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/behavior/request/cell/SetMetadataRequest.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return x}));n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=n("./src/core/behavior/request/Request.ts"),c=n("../packages/model/src/cell/CellDataDelta.ts"),u=n("../packages/model/src/cell/CellDataSlot.ts"),d=n("./src/core/behavior/request/Type.ts"),f=n("../packages/mutation/src/index.ts"),h=n("../packages/model/src/range/index.ts"),p=n("../packages/model/src/dimension/index.ts"),g=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),m=n("../packages/model/src/cell/metadata/CustomDataType.ts"),b=n("./src/core/behavior/request/cell/ClearRangeRequest.ts"),v=n("../packages/model/src/cell/index.ts"),I=n("../packages/model/src/cell/format/index.ts"),_=n("../packages/model/src/sheet/sheetUtils.ts"),y=n("./src/core/behavior/request/cell/ClearFormatRequest.ts"),R=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),E=n("../packages/model/src/cell/metadata/date-time/DateTimeTemplateType.ts"),O=n("./src/core/view/level-2/data-context-menu/config.ts"),S=n("../packages/model/src/utils/numberFormat/index.ts");function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var w=function(e){Object(o.a)(n,e);var t=T(n);function n(e,a){var o;return Object(r.a)(this,n),(o=t.call(this,e,a)).behaviors=[e],o}return Object(a.a)(n,[{key:"do",value:function(e,t,n){var r=this,a=e.metadata,o=e.ranges,s=e.colIndexes;if(o[0]){var i=o[0].sheetId,l=t.sheetManager.getSheetBySheetId(i);l&&(null===s||void 0===s||s.forEach((function(e){var t=e.start,r=e.end;n(new f.i({sheetId:i,ranges:[new h.DimensionRange(i,t,r,p.DIMENSION_TYPE.COLUMNS)],operation:[{slot:g.a.SLOT_COLUMN_TYPE_METADATA,columnTypeMetadata:a}],type:p.DIMENSION_TYPE.COLUMNS}))})),o.forEach((function(e){n(new f.j({gridRange:e,cellDataDeltaAtPositions:r.getCellDataDeltas(l,e,a)}))})))}}},{key:"getCellDataDeltas",value:function(e,t,n){var r=this,a=[];return t.each((function(t,o){var s=e.getCellDataAtPosition(t,o),i=n?r.getSetSingleCellDataDelta(n,s,e):r.getClearSingleCellDataDelta(s);i&&a.push({rowIndex:t,colIndex:o,cellDataDelta:i})})),a}},{key:"getSetSingleCellDataDelta",value:function(e,t,n){var r=new c.a,a=null===t||void 0===t?void 0:t.getMetadata();if(e.customDataType===(null===a||void 0===a?void 0:a.customDataType)){if(!function(e,t,n){if(e.customDataType===m.o.SELECT){var r,a=e.config,o=a.options.map((function(e){return e.id})),s=(null===t||void 0===t||null===(r=t.getRefIds())||void 0===r?void 0:r.filter((function(e){return o.includes(e)})))||[];a.isMultiSelect||(s=s.slice(0,1));var i=new v.ExtendedValue({type:v.EXTENDED_VALUE_TYPE.STRING,value:a.getSelectedTextValue(s)});return n.setSlot(u.b.SLOT_REF_IDS,s),n.setSlot(u.b.SLOT_EFFIECTIVE_VALUE,i),!0}if(e.customDataType===m.o.DATE_TIME)return k(e,n),!0;return!1}(e,t,r))return null}else{!function(e,t,n,r){var a;if(e.customDataType===m.o.DATE_TIME&&S.formatParseEngine.parseDateTimeValue((null===t||void 0===t||null===(a=t.getFormattedValue())||void 0===a?void 0:a.value)||""))return;Object(m.z)(e.customDataType)&&!Object(_.getCellImageByCellData)(n,t)||Object(b.b)(r)}(e,t,n,r),r.clearSlot(u.b.SLOT_REF_IDS);var o=Object(m.q)(e.customDataType);o&&r.setSlot(u.b.SLOT_EFFIECTIVE_VALUE,o),function(e,t){if(e.customDataType===m.o.SELECT){var n;if(Object(y.c)(t,{skipBorder:!0,skipBackground:!0}),null===(n=e.config)||void 0===n?void 0:n.withColor){var r=t.delta.userEnteredFormatDelta;null===r||void 0===r||r.setSlot(v.CELL_FORMAT_SLOT.FONT_SIZE,9),null===r||void 0===r||r.setSlot(v.CELL_FORMAT_SLOT.BOLD,!0)}return}if([m.o.STAR,m.o.CHECKBOX].includes(e.customDataType)){var a=new v.CellFormatDelta;return a.setSlot(v.CELL_FORMAT_SLOT.HORIZONTAL_ALIGN,I.HORIZONTAL_ALIGN.CENTER),a.setSlot(v.CELL_FORMAT_SLOT.VERTICAL_ALIGN,I.VERTICAL_ALIGN.MIDDLE),void t.setSlot(u.b.SLOT_USER_ENTERED_FORMAT_DELTA,a)}if(e.customDataType===m.o.PROGRESS){var o=new v.CellFormatDelta,s=Object(R.getNumberFormatByFormatCode)("0%");return o.setSlot(v.CELL_FORMAT_SLOT.NUMBER_FORMAT,s),o.setSlot(v.CELL_FORMAT_SLOT.HORIZONTAL_ALIGN,I.HORIZONTAL_ALIGN.RIGHT),o.setSlot(v.CELL_FORMAT_SLOT.VERTICAL_ALIGN,I.VERTICAL_ALIGN.MIDDLE),o.setSlot(v.CELL_FORMAT_SLOT.FONT_SIZE,9),void t.setSlot(u.b.SLOT_USER_ENTERED_FORMAT_DELTA,o)}if(e.customDataType===m.o.DATE_TIME)k(e,t,!0)}(e,r)}return r.setSlot(u.b.SLOT_METADATA,e),r}},{key:"getClearSingleCellDataDelta",value:function(e){var t,n=null===e||void 0===e||null===(t=e.getMetadata())||void 0===t?void 0:t.customDataType;if(!n||n===m.o.IMAGE)return null;var r=new c.a;return r.clearSlot(u.b.SLOT_METADATA),r.clearSlot(u.b.SLOT_REF_IDS),Object(m.r)(n)&&r.clearSlot(u.b.SLOT_EFFIECTIVE_VALUE),r}},{key:"id",get:function(){return d.a.SET_METADATA}}]),n}(l.a);function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.customDataType===m.o.DATE_TIME){var r=new v.CellFormatDelta,a=e.config,o=Object(R.getNumberFormatByFormatCode)(E.b[a.templateType]);r.setSlot(v.CELL_FORMAT_SLOT.NUMBER_FORMAT,o),n&&r.setSlot(v.CELL_FORMAT_SLOT.HORIZONTAL_ALIGN,I.HORIZONTAL_ALIGN.LEFT),t.setSlot(u.b.SLOT_USER_ENTERED_FORMAT_DELTA,r)}}function j(e,t){var n=[];return t.forEach((function(t){for(var r=t.startColIndex;r<=t.endColIndex;r++)e.data.getColWidth(r)<m.h&&n.push(r)})),n.length>0?n.map((function(t){return{dimensionRange:new h.DimensionRange(e.getSheetId(),t,t,p.DIMENSION_TYPE.COLUMNS),size:m.h}})):null}function x(e){return Object(m.z)(e.customDataType)?e.customDataType===m.o.PROGRESS?{argTokens:[{userEnteredValue:"0"},{userEnteredValue:"100"}],inputMessage:null,isStrict:!1,operator:I.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,ruleType:I.DATA_VALIDATION_RULE_TYPE.NUMBER_FLOAT_AND_INT,showDropDown:!0}:e.customDataType===m.o.ID||e.customDataType===m.o.PHONE_NUM||e.customDataType===m.o.EMAIL?{operator:I.DATA_VALIDATION_CONDITION_TYPE.EQUAL,ruleType:O.j[e.customDataType],inputMessage:null,isStrict:!1,showDropDown:!0,argTokens:null}:null:null}w.id=d.a.SET_METADATA},"./src/core/behavior/request/cell/SetSingleValueRequest.ts":function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return P}));n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),i=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=n("./src/core/behavior/request/Request.ts"),u=n("../packages/model/src/range/GridRange.ts"),d=n("../packages/model/src/cell/CellDataDelta.ts"),f=n("../packages/model/src/cell/CellDataSlot.ts"),h=n("../packages/model/src/cell/CellFormatDelta.ts"),p=n("../packages/model/src/cell/CellFormatSlot.ts"),g=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),m=n("../packages/model/src/cell/ExtendedValueType.ts"),b=n("../packages/model/src/utils/numberFormat/ParsedValueType.ts"),v=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),I=n("./src/base/util/url.ts"),_=n("../packages/model/src/cell/format/WrapStrategy.ts"),y=n("../packages/model/src/config/index.ts"),R=n("../packages/model/src/cell/format/UnderlineType.ts"),E=n("../node_modules/@tencent/tdocs-format-render/lib/index.js"),O=n("./src/core/behavior/request/workbook/filterUtils/getExtendFilterRangeMutation.ts"),S=n("./src/core/behavior/request/Type.ts"),T=n("../packages/report/src/index.ts"),w=n("../packages/model/src/cell/HyperlinkType.ts"),k=n("./src/core/feature/formula/utils/parseUtil.ts"),j=n("../packages/model/src/factory/index.ts"),x=n("./src/core/behavior/request/embedded/DeleteImageRequest.ts"),C=n("../packages/model/src/cell/LinkIconType.ts");function D(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(l.a)(e);if(t){var a=Object(l.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(i.a)(this,n)}}var U=function(t){Object(s.a)(r,t);var n=N(r);function r(t,o){var s,i;Object(a.a)(this,r),(s=n.call(this,t,o)).isValid=!0,i=t.sheetId?t.sheetId:(null===o||void 0===o?void 0:o.activeCell.sheetId)||"";var l=e.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(t.rowIndex,t.colIndex),c=null===l||void 0===l?void 0:l.getHyperlink(),u=Object(I.d)(t.userEnterValue,!1);return u&&!c&&t.textFormatRuns&&(t.textFormatRuns=t.textFormatRuns.map((function(e){var t;return e?e=j.TextFormatRunFactory.createInstance(L(L({},e.getOptions()),{},{format:j.TextFormatFactory.createInstance(L(L({},null===(t=e.format)||void 0===t?void 0:t.getOptions()),{},{underline:R.a.SINGLE_LINE,color:j.ColorFactory.createInstance(y.HYPERLINK_COLOR)}))})):j.TextFormatRunFactory.createInstance({startIndex:0,format:j.TextFormatFactory.createInstance({underline:R.a.SINGLE_LINE,color:j.ColorFactory.createInstance(y.HYPERLINK_COLOR)})})}))),s.behaviors=[{sheetId:i,rowIndex:t.rowIndex,colIndex:t.colIndex,userEnterValue:t.userEnterValue,isChanged:t.isChanged,isTextFormatRunsChanged:t.isTextFormatRunsChanged,linkUrl:u,textFormatRuns:t.textFormatRuns||null,mentionDetailsMap:t.mentionDetailsMap,hyperlinkType:t.hyperlinkType,formatItem:t.formatItem,formatValue:t.formatValue,linkIconStatus:t.linkIconStatus}],s}return Object(o.a)(r,[{key:"checkOptions",value:function(e,t){if(!t)return!0;var n,r=D(t);try{for(r.s();!(n=r.n()).done;){var a=n.value,o=e.sheetManager.getSheetBySheetId(a.sheetId);if(!o)return!1;var s=o.getCellDataAtPosition(a.rowIndex,a.colIndex);if(!this.checkOptionsWithCurrentCellData(a,s))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}},{key:"checkOptionsWithCurrentCellData",value:function(e,t){var n,r,a=null!==(n=null===t||void 0===t?void 0:t.getUserEnteredFormat())&&void 0!==n?n:null,o=null!==(r=null===a||void 0===a?void 0:a.getNumberFormat())&&void 0!==r?r:null,s=Object(E.isTextCell)(o),i=null===t||void 0===t?void 0:t.getFormula(),l=s&&i,c=null===t||void 0===t?void 0:t.getEffectiveValue();if(!e.isChanged&&!e.linkUrl&&!l&&!e.isTextFormatRunsChanged){if(s&&(null===c||void 0===c?void 0:c.type)===m.a.NUMBER)return!0;if(s||!c||c.type!==m.a.STRING)return!1;var u=Object(v.parseValueWithStyle)(e.userEnterValue,o,{parseMode:v.PARSE_MODE.PARSE_STYLE_FIRST});if(!c||c.type!==m.a.STRING||u.valueType===b.a.STRING)return!1}return!0}},{key:"check",value:function(e){if(this.isValid=this.isValid&&this.checkOptions(e,this.behaviors),!this.isValid){return{ignore:!0,isWarningOnly:!1}}return null}},{key:"do",value:function(e,t,n){var r=e.sheetId,a=e.rowIndex,o=e.colIndex,s=e.userEnterValue,i=e.linkUrl,l=e.hyperlinkRuns,c=t.sheetManager.getSheetBySheetId(r);if(c){var d=c.getCellImage(a,o);if(d){if(""===s)return;var f=d.id;!("\u56fe\u7247"===s&&(i||l&&l.length>0))&&Object(x.b)({sheetId:r,id:f,row:a,col:o},t,n,!0)}var h=c.getCellDataAtPosition(e.rowIndex,e.colIndex),p=this.getCellDataDelta(h,r,e),m=new u.b(e.sheetId,e.rowIndex,e.rowIndex,e.colIndex,e.colIndex);if(n(new g.a({gridRange:m,cellDataDelta:p})),Object(O.b)(c,[m])){var b=Object(O.a)(c);b.length>0&&n(b[0])}(null===h||void 0===h?void 0:h.getHyperlink())&&T.b.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url_cell"})}}},{key:"getCellDataDelta",value:function(e,t,n){return P(L(L({},n),{},{cellData:e}))}},{key:"id",get:function(){return r.id}}]),r}(c.a);function P(e){var t,n,r=e.cellData,a=void 0===r?null:r,o=e.sheetId,s=e.userEnterValue,i=(e.linkUrl,e.rowIndex),l=e.colIndex,c=(e.isChanged,e.isTextFormatRunsChanged,e.mentionDetailsMap),u=e.skipTransformToText,g=void 0!==u&&u,m=new d.a,I=null!==(t=null===a||void 0===a?void 0:a.getUserEnteredFormat())&&void 0!==t?t:null,y=null!==(n=null===I||void 0===I?void 0:I.getNumberFormat())&&void 0!==n?n:null,R=Object(v.parseValueWithStyle)(s,y,{parseMode:v.PARSE_MODE.PARSE_STYLE_FIRST});g||(R=Object(v.twelveNumberToText)(R));var O=new h.a,S=Object(E.isTextCell)(y);return R.valueType!==b.a.FORMULA||S?(m.clearSlot(f.b.SLOT_FORMULA),m.setSlot(f.b.SLOT_EFFIECTIVE_VALUE,j.ExtendedValueFactory.createInstance({type:Number(R.valueType),value:R.value})),O.setSlot(p.b.NUMBER_FORMAT,R.numberFormat)):"string"===typeof R.value&&(m.clearSlot(f.b.SLOT_EFFIECTIVE_VALUE),m.setSlot(f.b.SLOT_FORMULA,Object(k.c)(R.value,i,l,o))),function(e,t,n,r,a){var o=String.fromCharCode(10),s=t?t.getEffectiveValue():null,i=n.valueType===b.a.STRING?n.value:null;i&&i.indexOf(o)>=0?(a.setSlot(p.b.WRAP_STRATEGY,_.a.WRAP),T.b.tdwReport({opername:"doc_excel_editor",module:"excel_wrap",action:"manual_wrap"})):r&&r.getWrapStrategy()===_.a.WRAP&&s&&"string"===typeof s.value&&s.value.indexOf(o)>=0&&null===i&&a.setSlot(p.b.WRAP_STRATEGY,_.a.OVERFLOW_CELL)}(0,a,R,I,O),function(e,t,n,r,a){var o=e.textFormatRuns,s=void 0===o?null:o;if(n.valueType===b.a.STRING)if(s){r.setSlot(f.b.SLOT_RICH_TEXT_STYLE_RUN,s);var i,l,c=function(e){var t,n,r,a={},o=["fontFamily","fontSize","bold","italic","strikethrough","underline","color"];for(t=0;t<e.length;t++){if(null===(r=e[t].format))return{};for(n=0;n<o.length;n++)void 0!==a[o[n]]?a[o[n]]!==r[o[n]]&&(delete a[o[n]],o.splice(n,1),n-=1):a[o[n]]=r[o[n]]}return a}(s);for(l in c)i=c[l],t&&t[l]===i||(a=B(a,l,i))}else r.clearSlot(f.b.SLOT_RICH_TEXT_STYLE_RUN);else r.clearSlot(f.b.SLOT_RICH_TEXT_STYLE_RUN)}(e,I,R,m,O),F(e,m,O,a),O.isEmpty()||m.setSlot(f.b.SLOT_USER_ENTERED_FORMAT_DELTA,O),c?m.setSlot(f.b.SLOT_MENTION,c):m.clearSlot(f.b.SLOT_MENTION),m}function F(e,t,n,r){var a=e.userEnterValue,o=e.linkUrl,s=void 0===o?null:o,i=e.hyperlinkRuns,l=(e.hyperlinkType,e.linkIconStatus);if(""===a)t.clearSlot(f.b.SLOT_HYPERLINK),t.clearSlot(f.b.SLOT_HYPERLINK_TYPE),t.clearSlot(f.b.SLOT_LINK_ICON_TYPE),t.setSlot(f.b.SLOT_USER_ENTERED_FORMAT_DELTA,n);else if(s){if(t.clearSlot(f.b.SLOT_HYPERLINK_RUN),t.setSlot(f.b.SLOT_HYPERLINK,s),"undefined"!==typeof e.hyperlinkType)t.setSlot(f.b.SLOT_HYPERLINK_TYPE,e.hyperlinkType);else if("undefined"!==typeof e.hyperlinkType&&e.hyperlinkType!==w.b.SHEET_LINK)n.setSlot(p.b.HORIZONTAL_ALIGN,e.formatValue);else{var c=Object(I.a)(s);(null===r||void 0===r?void 0:r.getHyperlinkType)!==c&&t.setSlot(f.b.SLOT_HYPERLINK_TYPE,c)}n.removeSlot(p.a.ALL),n.setSlot(p.b.UNDERLINE,R.a.SINGLE_LINE),n.setSlot(p.b.FOREGROUND_COLOR,y.HYPERLINK_COLOR)}else i&&(t.clearSlot(f.b.SLOT_HYPERLINK),t.clearSlot(f.b.SLOT_HYPERLINK_TYPE),t.setSlot(f.b.SLOT_HYPERLINK_RUN,i),n.setSlot(p.b.UNDERLINE,R.a.SINGLE_LINE),n.setSlot(p.b.FOREGROUND_COLOR,y.HYPERLINK_COLOR));void 0!==l?t.setSlot(f.b.SLOT_LINK_ICON_TYPE,void 0!==l?l:C.a.PLAIN_TEXT):s&&Object(I.b)(s)&&t.setSlot(f.b.SLOT_LINK_ICON_TYPE,C.a.WITH_IMAGE)}U.id=S.a.SET_SINGLE_VALUE_REQUEST;var B=function(e,t,n){switch(t){case"fontFamily":e.setSlot(p.b.FONT_FAMINY,n);break;case"fontSize":e.setSlot(p.b.FONT_SIZE,n);break;case"bold":e.setSlot(p.b.BOLD,n);break;case"italic":e.setSlot(p.b.ITALIC,n);break;case"color":e.setSlot(p.b.FOREGROUND_COLOR,(null===n||void 0===n?void 0:n.clone)?n.clone():n);break;case"strikethrough":e.setSlot(p.b.STRIKETHROUGH,n);break;case"underline":e.setSlot(p.b.UNDERLINE,n)}return e};t.a=U}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/behavior/request/dimension/DeleteDimensionRequest.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.array.every.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.reduce.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r,a=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),l=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),c=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=n("./src/core/behavior/request/Type.ts"),d=n("./src/core/behavior/request/Request.ts"),f=n("../packages/mutation/src/dimension/DeleteDimensionMutation.ts"),h=n("../packages/model/src/dimension/DimensionType.ts"),p=n("../packages/model/src/range/DimensionRange.ts"),g=n("../packages/model/src/range/gridRangeUtils.ts"),m=n("../packages/mutation/src/merge/MergeCellsMutation.ts"),b=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),v=n("../packages/model/src/cell/CellDataSlot.ts"),I=n("../packages/model/src/cell/cellDataUtils.ts"),_=n("../packages/mutation/src/filter/DeleteFilterMutation.ts"),y=n("../packages/mutation/src/sheet/SetSheetPropertiesMutation.ts"),R=n("../packages/mutation/src/filter/UpdateFilterMutation.ts"),E=n("../packages/model/src/range/GridRange.ts"),O=n("../packages/mutation/src/conditionalFormat/DeleteConditionalFormatMutation.ts"),S=n("../packages/model/src/rule/ConditionalFormatRule.ts"),T=n("../packages/mutation/src/conditionalFormat/UpdateConditionalFormatMutation.ts"),w=n("../packages/model/src/sheet/SheetPropertiesDelta.ts"),k=n("../packages/model/src/sheet/SheetPropertiesSlotOperation.ts"),j=n("../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts"),x=n("../packages/mutation/src/workbook/workbookRange/UpdateWorkbookRangeMutation.ts"),C=n("../packages/model/src/workbookRange/WorkbookRangeType.ts"),D=n("../packages/model/src/workbookRange/index.ts"),A=n("./src/core/behavior/request/dimension/util.ts");function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var a=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}!function(e){e[e.add=0]="add",e[e.delete=1]="delete"}(r||(r={}));var L=function(t){Object(i.a)(l,t);var n=M(l);function l(e,t){var r;return Object(o.a)(this,l),(r=n.call(this,e,t)).sheetId=e.sheet.getSheetId(),r.type=e.type,e.deleteInfo?r.behaviors=e.deleteInfo:t&&(r.type===h.a.ROWS?r.behaviors=r.getDeleteOption(e.sheet,t.getRows()):r.behaviors=r.getDeleteOption(e.sheet,t.getCols())),r}return Object(s.a)(l,[{key:"do",value:function(e,t,n){var r,a,o,s,i,l=t.sheetManager.getSheetBySheetId(this.sheetId);if(null!==l){var c,u=new p.a(this.sheetId,e.index,e.index+e.amount-1,this.type),d=Object(g.divideDimensionRangeByFilter)([u],l.getBasicFilter()),h=[];for(s=0;s<d.length;s++)c={index:(u=d[s]).startIndex,amount:u.endIndex-u.startIndex+1},h.push(c);for(s=0;s<h.length;s++){for(c=h[s],i=s+1;i<h.length;i++){var m=new p.a(this.sheetId,h[i].index,h[i].index+h[i].amount-1,this.type);m.deleteDimension({sheetId:this.sheetId,index:c.index,amount:c.amount,type:this.type}),h[i].index=m.startIndex,h[i].amount=m.endIndex-m.startIndex+1}var b=!1;for(i=0;i<this.behaviors.length;i++)if(b){var v=new p.a(this.sheetId,this.behaviors[i].index,this.behaviors[i].index+this.behaviors[i].amount-1,this.type);v.deleteDimension({sheetId:this.sheetId,index:c.index,amount:c.amount,type:this.type}),this.behaviors[i].index=v.startIndex,this.behaviors[i].amount=v.endIndex-v.startIndex+1}else this.behaviors[i]===e&&(b=!0);a=(r=this.beforeDeleteDimension(t,{index:c.index,amount:c.amount},this.type)).beforeMutations,o=r.afterMutations,a.forEach((function(e){n(e)})),n(new f.a({index:c.index,amount:c.amount,type:this.type,sheetId:this.sheetId})),o.forEach((function(e){n(e)}))}}}},{key:"check",value:function(t){var n,r=null,a=t.sheetManager.getSheetBySheetId(this.sheetId),o=0;if(null===a)return r;if(!this.behaviors.every((function(e){return e.index>=0&&e.amount>=0})))return r={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u5220\u9664\u7684\u884c\u5217\u4f4d\u7f6e\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u64cd\u4f5c\u3002"}};for(n=0;n<this.behaviors.length;n++)o+=this.behaviors[n].amount;switch(function(t,n,r,a){var o,s=r.sheetManager.getSheetBySheetId(t),i=0,l=e.SpreadsheetApp.feature.relateForm;if(null===s||!l||!l.isRelated(t))return 3;if(!((null===(o=s.data)||void 0===o?void 0:o.rowData)||!1))return 3;var c=s.data.colMetadata,u=s.data.rowMetadata;if(a===h.a.COLUMNS)for(var d=0,f=n.length;d<f;d++){var p=n[d],g=p.index,m=p.amount,b={sheetId:t,startRowIndex:0,endRowIndex:u.length,startColIndex:g,endColIndex:g+m};if(3===(i=l.checkReleaseRange(b,u,c,3)))return 2}else for(var v=0,I=n.length;v<I;v++){var _=n[v],y=_.index,R={sheetId:t,startRowIndex:y,endRowIndex:y+_.amount,startColIndex:0,endColIndex:c.length};if(1===(i=l.checkReleaseRange(R,u,c,1)))return i}return 3}(this.sheetId,this.behaviors,t,this.type)){case 1:r={isWarningOnly:!1,error:{title:"\u5220\u9664\u884c\u5217",content:"\u64cd\u4f5c\u88ab\u7981\u6b62\u3002\u65e0\u6cd5\u5220\u9664\u5305\u542b\u6536\u96c6\u8868\u95ee\u9898\u7684\u884c\u3002",btnTxt:"\u6211\u77e5\u9053\u4e86"}};break;case 2:r={isWarningOnly:!1,error:{title:"\u5220\u9664\u884c\u5217",content:"\u64cd\u4f5c\u88ab\u7981\u6b62\u3002\u65e0\u6cd5\u5220\u9664\u5305\u542b\u6536\u96c6\u8868\u95ee\u9898\u7684\u5217\uff0c\u4f1a\u5bfc\u81f4\u6536\u96c6\u7ed3\u679c\u66f4\u65b0\u5931\u8d25\u3002\u53ef\u4ee5\u9690\u85cf\u5217\u3002",btnTxt:"\u6211\u77e5\u9053\u4e86"}}}return this.type===h.a.ROWS?a.getRowCount()<=o&&(r={isWarningOnly:!1,error:{title:"\u5220\u9664\u884c\u5217",content:"\u62b1\u6b49, \u65e0\u6cd5\u5220\u9664\u5de5\u4f5c\u8868\u4e0a\u7684\u6240\u6709\u884c\u3002"}}):a.getColCount()<=o&&(r={isWarningOnly:!1,error:{title:"\u5220\u9664\u884c\u5217",content:"\u62b1\u6b49, \u65e0\u6cd5\u5220\u9664\u5de5\u4f5c\u8868\u4e0a\u7684\u6240\u6709\u5217\u3002"}}),r}},{key:"getDeleteOption",value:function(e,t){for(var n,r=[],a=1,o=t[0],s=1;a<t.length;a++)t[a]===t[a-1]+1?s+=1:(n={index:o,amount:s},r.push(n),o=t[a],s=1);return n={index:o,amount:s},r.push(n),r}},{key:"beforeDeleteDimension",value:function(e,t,n){t.index,t.amount;var r=[],o=[],s=this.confictMerge(t,e);r.push.apply(r,Object(a.a)(s.beforeMutations)),o.push.apply(o,Object(a.a)(s.afterMutations));var i=this.confictFrozen(t,e);r.push.apply(r,Object(a.a)(i.beforeMutations)),o.push.apply(o,Object(a.a)(i.afterMutations));var l=this.confictFilter(t,e);r.push.apply(r,Object(a.a)(l.beforeMutations)),o.push.apply(o,Object(a.a)(l.afterMutations));var c=this.conflictConditionalFormat(t,e);r.push.apply(r,Object(a.a)(c.beforeMutations)),o.push.apply(o,Object(a.a)(c.afterMutations));var u=this.conflictWorkbookRange(t,e);return r.push.apply(r,Object(a.a)(u.beforeMutations)),o.push.apply(o,Object(a.a)(u.afterMutations)),{beforeMutations:r,afterMutations:o}}},{key:"confictMergeDimenstionIsRow",value:function(e,t,n,r,a){var o;if(e.startRowIndex>=t&&e.startRowIndex<=t+n-1){if((o=e.clone()).deleteDimension({sheetId:o.sheetId,type:h.a.ROWS,index:t,amount:n}),o.endRowIndex>=o.startRowIndex){(o.getColCount()>1||o.getRowCount()>1)&&a.afterMutations.push(new m.a(o));var s=Object(I.createCellDataDelta)({cellData:r.getCellDataAtPosition(t+n,e.startColIndex),rowIndex:t+n,colIndex:e.startColIndex,sheetId:e.sheetId},{cellData:r.getCellDataAtPosition(e.startRowIndex,e.startColIndex),rowIndex:e.startRowIndex,colIndex:e.startColIndex,sheetId:e.sheetId},1<<v.b.SLOT_USER_ENTERED_FORMAT_DELTA);a.afterMutations.push(new b.a({gridRange:new E.b(e.sheetId,t,t,e.startColIndex,e.startColIndex),cellDataDelta:s}))}}else t>e.startRowIndex&&t<=e.endRowIndex&&((o=e.clone()).deleteDimension({sheetId:o.sheetId,type:h.a.ROWS,index:t,amount:n}),(o.getRowCount()>1||o.getColCount()>1)&&a.afterMutations.push(new m.a(o)));return a}},{key:"confictMergeDimenstionIsColumns",value:function(e,t,n,r,a){var o;if(e.startColIndex>=t&&e.startColIndex<=t+n-1){if((o=e.clone()).deleteDimension({sheetId:o.sheetId,type:h.a.COLUMNS,index:t,amount:n}),o.endColIndex>=o.startColIndex){(o.getColCount()>1||o.getRowCount()>1)&&a.afterMutations.push(new m.a(o));var s=Object(I.createCellDataDelta)({cellData:r.getCellDataAtPosition(e.startRowIndex,t+n),rowIndex:e.startRowIndex,colIndex:t+n,sheetId:e.sheetId},{cellData:r.getCellDataAtPosition(e.startRowIndex,e.startColIndex),rowIndex:e.startRowIndex,colIndex:e.startColIndex,sheetId:e.sheetId},1<<v.b.SLOT_USER_ENTERED_FORMAT_DELTA);a.afterMutations.push(new b.a({gridRange:new E.b(e.sheetId,e.startRowIndex,e.startRowIndex,t,t),cellDataDelta:s}))}}else t>e.startColIndex&&t<=e.endColIndex&&((o=e.clone()).deleteDimension({sheetId:o.sheetId,type:h.a.COLUMNS,index:t,amount:n}),(o.getColCount()>1||o.getRowCount()>1)&&a.afterMutations.push(new m.a(o)))}},{key:"confictMerge",value:function(e,t){var n=this,r=e.index,a=e.amount,o=t.sheetManager.getSheetBySheetId(this.sheetId),s={beforeMutations:[],afterMutations:[]};return o.mergeManager.each((function(e){n.type===h.a.ROWS?n.confictMergeDimenstionIsRow(e,r,a,o,s):n.type===h.a.COLUMNS&&n.confictMergeDimenstionIsColumns(e,r,a,o,s)})),s}},{key:"confictFrozen",value:function(e,t){var n=e.index,r=e.amount,a=t.sheetManager.getSheetBySheetId(this.sheetId),o=a.getFrozenRowCount(),s=a.getFrozenColCount(),i={beforeMutations:[],afterMutations:[]};return o>0&&n<o&&this.type===h.a.ROWS&&(o=Math.max(n-1,o-1-r),0===(o+=1)&&i.beforeMutations.push(new y.a({sheetId:this.sheetId,sheetDelta:new w.b({operation:k.a.SET_PROPERTIES,delta:{frozenRowCount:o}})}))),s>0&&n<s&&this.type===h.a.COLUMNS&&(s=Math.max(n-1,s-1-r),0===(s+=1)&&i.beforeMutations.push(new y.a({sheetId:this.sheetId,sheetDelta:new w.b({operation:k.a.SET_PROPERTIES,delta:{frozenColCount:s}})}))),i}},{key:"confictFilter",value:function(e,t){var n=e.index,a=e.amount,o=t.sheetManager.getSheetBySheetId(this.sheetId).getBasicFilter(),s={beforeMutations:[],afterMutations:[]};if(o){var i=o.workbookRangeId,l=o.range,c=l.clone();if(this.type===h.a.ROWS&&(l.startRowIndex>=n&&l.startRowIndex<=n+a-1?s.beforeMutations.push(new _.a({sheetId:this.sheetId,delta:{defaultFilterId:o.workbookRangeId}})):(l.endRowIndex>=n||l.endRowIndex<=n+a-1)&&c.deleteDimension({sheetId:c.sheetId,type:h.a.ROWS,index:n,amount:a})),this.type===h.a.COLUMNS&&(l.startColIndex>=n&&l.endColIndex<=n+a-1?s.beforeMutations.push(new _.a({sheetId:this.sheetId,delta:{defaultFilterId:o.workbookRangeId}})):(l.startColIndex<=n+a-1||l.endColIndex>=n)&&c.deleteDimension({sheetId:c.sheetId,type:h.a.COLUMNS,index:n,amount:a})),(this.type===h.a.ROWS&&(l.endRowIndex>=n||l.endRowIndex<=n+a-1)||this.type===h.a.COLUMNS&&(l.startColIndex<=n+a-1||l.endColIndex>=n))&&(s.beforeMutations.push(new R.b({sheetId:this.sheetId,workbookRangeId:i,updateType:R.a.UPDATE,delta:{range:l,defaultFilterId:i}})),s.afterMutations.push(new R.b({sheetId:this.sheetId,workbookRangeId:i,updateType:R.a.UPDATE,delta:{range:c,defaultFilterId:i}}))),this.type===h.a.COLUMNS)(function(e){var t=e.type,n=e.index,a=e.amount,o=e.sheetId,s=e.workbookRangeId,i=e.criteriaMap,l=e.filter,c=[],u=[];return i.forEach((function(e,i){var l=i+a;if(i>=n){var d={columnIndex:i,clear:!0};if(c.push(new R.b({sheetId:o,workbookRangeId:s,updateType:R.a.UPDATE,delta:{defaultFilterId:s,updateColumnCriteriaDelta:d}})),u.push(d),t===r.add){var f=i+(t===r.add?a:-a),h={columnIndex:f,criteria:e};c.push(new R.b({sheetId:o,workbookRangeId:s,updateType:R.a.UPDATE,delta:{defaultFilterId:s,updateColumnCriteriaDelta:{columnIndex:f,criteria:e}}})),u.push(h)}}else if(i>=l){var p=i+(t===r.add?a:-a);c.push(new R.b({sheetId:o,workbookRangeId:s,updateType:R.a.UPDATE,delta:{defaultFilterId:s,updateColumnCriteriaDelta:{columnIndex:p,criteria:e}}}))}})),c.length>0&&(u.reduce((function(e,t){return Object(R.c)(t,e)}),l.clone()),c.push(new R.b({sheetId:o,workbookRangeId:s,updateType:R.a.RECAL,delta:{defaultFilterId:s}}))),c})({type:r.delete,index:n,amount:a,sheetId:this.sheetId,workbookRangeId:o.workbookRangeId,criteriaMap:o.criteriaMap,filter:o,spreadsheet:t}).forEach((function(e){s.afterMutations.push(e)}))}return s}},{key:"conflictConditionalFormat",value:function(e,t){var n=this,r={beforeMutations:[],afterMutations:[]},a=this.sheetId,o=t.sheetManager.getSheetBySheetId(a),s=o.conditionalFormatRuleManager.rules,i=s.length,l=[];if(i<1)return r;var c,u=e.index,d=e.amount,f=u,p=u+d-1,g=o.getRowCount()-1,m=o.getColCount()-1;c=this.type===h.a.ROWS?new E.b(a,f,p,0,m):new E.b(a,0,g,f,p);for(var b=0;b<i;b++){var v=s[b];if(v.rule.ruleRanges.every((function(e){return c.contain(e)})))l.push(b);else{var I=!1,_=v.rule.ruleRanges.map((function(e){if(c.isCross(e)){I=!0;var t=e.clone();return t.deleteDimension({type:n.type,sheetId:a,index:u,amount:d}),t}return e})).filter((function(e){return e.isValid()}));if(I){var y=new S.a({ruleRanges:_,booleanConditionalFormat:v.rule.booleanConditionalFormat,uid:v.rule.uid});r.beforeMutations.push(new T.a({sheetId:a,ruleIndex:v.index,rule:y,oldRuleRanges:v.rule.ruleRanges}))}}}return l.sort((function(e,t){return t-e})),l.forEach((function(e){var t=s[e];r.beforeMutations.push(new O.a({sheetId:a,ruleIndex:t.index,oldRuleRanges:t.rule.ruleRanges}))})),r}},{key:"conflictWorkbookRange",value:function(e,t){var n=this,r={beforeMutations:[],afterMutations:[]},a=e.index,o=e.amount;return t.workbookRangeManager.each((function(e){if(n.sheetId===e.range.sheetId&&e.type!==C.a.CHART)if(n.type!==h.a.ROWS||e.range.isCol){if(n.type===h.a.COLUMNS&&!e.range.isRow)if(e.range.startColIndex>=a&&e.range.endColIndex<=a+o-1)r.beforeMutations.push(new j.a({workbookRangeId:e.id,workbookRangeType:e.type}));else if(e.range.startColIndex>=a&&e.range.startColIndex<=a+o-1||e.range.endColIndex>=a&&e.range.endColIndex<=a+o-1){var t=e.range.clone(),s=new D.WorkbookRangeDelta;Object(A.b)(e,s),r.beforeMutations.push(new x.a({workbookRangeId:e.id,gridRange:t,workbookRangeType:e.type,workbookRangePropertiesDelta:s}))}}else if(e.range.startRowIndex>=a&&e.range.endRowIndex<=a+o-1)r.beforeMutations.push(new j.a({workbookRangeId:e.id,workbookRangeType:e.type}));else if(e.range.startRowIndex>=a&&e.range.startRowIndex<=a+o-1||e.range.endRowIndex>=a&&e.range.endRowIndex<=a+o-1){var i=e.range.clone(),l=new D.WorkbookRangeDelta;Object(A.b)(e,l),r.beforeMutations.push(new x.a({workbookRangeId:e.id,gridRange:i,workbookRangeType:e.type,workbookRangePropertiesDelta:l}))}})),r}},{key:"id",get:function(){return l.id}}]),l}(d.a);L.id=u.a.DELETE_DIMENSION_REQUEST,t.a=L}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/behavior/request/dimension/util.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/model/src/dimension/index.ts"),a=n("../packages/model/src/range/gridRangeUtils.ts"),o=n("../packages/mutation/src/index.ts"),s=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),i=n("../packages/model/src/workbookRange/index.ts");function l(e,t,n){var i=t.sheetManager.getSheetBySheetId(e.dimensionRange.sheetId);if(i){var l=Object(a.divideDimensionRangeByFilter)([e.dimensionRange],i.getBasicFilter()),c=t.parent.sheetStatus;l.forEach((function(t){t.dimension===r.DIMENSION_TYPE.ROWS&&!c.isCurrentRowCanEdit({startRow:t.startIndex,endRow:t.endIndex})||t.dimension===r.DIMENSION_TYPE.COLUMNS&&!c.isCurrentColCanEdit({startCol:t.startIndex,endCol:t.endIndex})||n(new o.i({ranges:[t],operation:[{slot:s.a.SLOT_SIZE,size:e.size}],sheetId:i.getSheetId(),type:t.dimension}))}))}}function c(e,t){e instanceof i.LinkedRange&&void 0!==e.properties&&t.setLinkedRangeProperties(e.properties),e instanceof i.ProtectedRange&&void 0!==e.properties&&t.setProtectionProperties(e.properties)}},"./src/core/behavior/request/embedded/DeleteImageRequest.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return b}));n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=n("./src/core/behavior/request/Request.ts"),c=n("../packages/mutation/src/embedded/DeleteEmbeddedObjectMutation.ts"),u=n("./src/core/behavior/request/Type.ts"),d=n("../packages/model/src/cell/index.ts"),f=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),h=n("../packages/model/src/range/GridRange.ts");function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var g=function(e){Object(o.a)(n,e);var t=p(n);function n(e,a){var o;return Object(r.a)(this,n),(o=t.call(this,e,a)).behaviors=e instanceof Array?e:[e],o}return Object(a.a)(n,[{key:"do",value:function(e,t,n){b(e,t,n,!0)}},{key:"id",get:function(){return n.id}}]),n}(l.a);function m(e,t){var n=new d.CellDataDelta,r=e.getHyperlink();return r&&t?n.setSlot(d.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE,new d.ExtendedValue({value:r,type:d.EXTENDED_VALUE_TYPE.STRING})):n.clearSlot(d.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE),n.clearSlot(d.CELL_DATA_SLOT.SLOT_METADATA),n.clearSlot(d.CELL_DATA_SLOT.SLOT_REF_IDS),n}function b(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.id,s=e.sheetId,i=e.row,l=e.col,u=t.sheetManager.getSheetBySheetId(s);if(u){if("number"===typeof i&&"number"===typeof l&&(null===(r=u.getCellImage(i,l))||void 0===r?void 0:r.id)===o){var d=u.getCellDataAtPosition(i,l);n(new f.a({gridRange:new h.b(s,i,i,l,l),cellDataDelta:m(d,!a)}))}a&&u.imageManager.getImage(o)&&n(new c.a({key:o,sheetId:s}))}}g.id=u.a.DELETE_IMAGE_REQUEST,t.a=g},"./src/core/behavior/request/embedded/utils.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("../packages/model/src/dimension/index.ts"),a=n("../packages/model/src/range/index.ts"),o=n("./src/core/view/spreadsheet-view/row-col-accessor/RowcolAccessor.ts");function s(e,t){return 48>Object(o.a)(e,t)?{dimensionRange:new a.DimensionRange(e.getSheetId(),t,t,r.DIMENSION_TYPE.ROWS),size:48}:null}},"./src/core/behavior/request/enum/FormatItem.ts":function(e,t,n){"use strict";var r;!function(e){e[e.FONT_FAMINY=0]="FONT_FAMINY",e[e.FONT_SIZE=1]="FONT_SIZE",e[e.BOLD=2]="BOLD",e[e.ITALIC=3]="ITALIC",e[e.WRAP_STRATEGY=4]="WRAP_STRATEGY",e[e.HORIZONTAL_ALIGN=5]="HORIZONTAL_ALIGN",e[e.VERTICAL_ALIGN=6]="VERTICAL_ALIGN",e[e.COLOR=7]="COLOR",e[e.BACKGROUND_COLOR=8]="BACKGROUND_COLOR",e[e.STRIKE_THROUGH=9]="STRIKE_THROUGH",e[e.UNDERLINE=10]="UNDERLINE"}(r||(r={}));Math.pow(2,r.UNDERLINE+1);t.a=r},"./src/core/behavior/request/merge/MergeCellsRequest.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.set.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.set.add-all.js"),n("../node_modules/core-js/modules/esnext.set.delete-all.js"),n("../node_modules/core-js/modules/esnext.set.difference.js"),n("../node_modules/core-js/modules/esnext.set.every.js"),n("../node_modules/core-js/modules/esnext.set.filter.js"),n("../node_modules/core-js/modules/esnext.set.find.js"),n("../node_modules/core-js/modules/esnext.set.intersection.js"),n("../node_modules/core-js/modules/esnext.set.is-disjoint-from.js"),n("../node_modules/core-js/modules/esnext.set.is-subset-of.js"),n("../node_modules/core-js/modules/esnext.set.is-superset-of.js"),n("../node_modules/core-js/modules/esnext.set.join.js"),n("../node_modules/core-js/modules/esnext.set.map.js"),n("../node_modules/core-js/modules/esnext.set.reduce.js"),n("../node_modules/core-js/modules/esnext.set.some.js"),n("../node_modules/core-js/modules/esnext.set.symmetric-difference.js"),n("../node_modules/core-js/modules/esnext.set.union.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=n("./src/core/behavior/request/Request.ts"),c=n("../packages/mutation/src/merge/MergeCellsMutation.ts"),u=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),d=n("../packages/model/src/range/GridRange.ts"),f=n("../packages/model/src/cell/CellDataDelta.ts"),h=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts"),p=n("../packages/model/src/cell/CellDataSlot.ts"),g=n("./src/core/behavior/request/utils/cellDataUtil.ts"),m=n("../packages/mutation/src/cell/SetRangeMutation.ts"),b=n("../packages/model/src/cell/format/BorderType.ts"),v=n("../packages/model/src/cell/CellFormatSlot.ts"),I=n("../packages/model/src/cell/CellFormatDelta.ts"),_=n("./src/core/behavior/request/utils/index.ts"),y=n("./src/core/behavior/request/Type.ts"),R=n("../packages/mutation/src/sheet/DeleteSheetRangeMutation.ts"),E=n("../packages/model/src/factory/index.ts");function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var S=function(t){Object(o.a)(s,t);var n=O(s);function s(e,t){var a;return Object(r.a)(this,s),(a=n.call(this,e,t)).sheetId=e.sheetId,e.gridRanges?a.behaviors=e.gridRanges:t&&(a.behaviors=t.rangeSelections),a}return Object(a.a)(s,[{key:"check",value:function(e){var t=null;return(t=this._checkRangeValid(e))||(t=this._checkCrossFilterHeader(e))||(t=this._checkIntersectAndForm(e))||(t=this._checkCrossMergeRange(e))?t:(t=this._checkMultiContent(e))||t}},{key:"do",value:function(e,t,n){var r=this,a=e.startRowIndex,o=(e.endRowIndex,e.startColIndex),s=(e.endColIndex,e),i=t.sheetManager.getSheetBySheetId(this.sheetId),l={row:0,column:0};if(i){var d=this._findMainCell(i,e),g=d.x,m=d.y;l.row=m,l.column=g;for(var b=Object(h.b)(s,i),v=0;v<b.length;v+=2)n(b[v]);var I=this.checkMergeBorders(l,e,i),_=this._updateMainPosition(l,a,o,t);_&&n(_);for(var y=Object(c.b)(s),E=0;E<y.length;E++){var O=y[E];n(new u.a({gridRange:O,cellDataDelta:new f.a({setSlots:0,clearSlots:p.a.ALL,delta:{}})})),O.each((function(e,t){var a=i.getCellDataAtPosition(e,t);a&&(a.getSheetRange()||[]).forEach((function(e){var t=e.id;n(new R.a({sheetId:r.sheetId,sheetRangeId:t,nonPersistingLocalChange:!1}))}))}))}I&&n(I),n(new c.a({startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex,sheetId:this.sheetId}))}}},{key:"checkMergeBorders",value:function(e,t,n){var r=t.startRowIndex,a=t.endRowIndex,o=t.startColIndex,s=t.endColIndex,i={top:void 0,right:void 0,bottom:void 0,left:void 0},l=!0;(e.row!=r||e.column!=o||Object(_.a)(n,e.row,e.column,b.a.LEFT,!0)||Object(_.a)(n,e.row,e.column,b.a.TOP,!0))&&(l=!1),i.top=this._getTopBorder(n,o,s,r),i.left=this._getLeftBorder(n,r,a,o);var c=this._getRightBorder(n,r,a,s,l,e),u=c.right,d=c.isAllRight;i.right=u;var f=this._getBottomBorder(n,o,s,a,l,e),h=f.bottom,p=f.isAllBottom;return i.bottom=h,this._getSetRangeMutation(n,r,a,o,s,i,d,p)}},{key:"_checkRangeValid",value:function(e){for(var t=0;t<this.behaviors.length;t++){var n=this.behaviors[t];if(n.isSingle()||n.hasMergeCell(e.sheetManager.getSheetBySheetId(n.sheetId).mergeManager.mergeList))return{isWarningOnly:!0,ignore:!0};for(var r=t+1;r<this.behaviors.length;r++)if(n.isCross(this.behaviors[r]))return{isWarningOnly:!0,ignore:!0}}return null}},{key:"_checkCrossFilterHeader",value:function(e){return function(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=t.sheetManager.getSheetBySheetId(r.sheetId);if(null!==a){var o=a.getBasicFilter();if(null!==o){var s=o.range,i=s.startRowIndex,l=(s.endRowIndex,s.startColIndex),c=s.endColIndex,u=new d.b(s.sheetId,i,i,l,c);if(r.isCross(u))return!0}}}return!1}(this.behaviors,e)?{isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u5408\u5e76\u5355\u5143\u683c\u6682\u4e0d\u80fd\u5305\u542b\u7b5b\u9009\u6309\u94ae\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u8bf7\u89e3\u9664\u7b5b\u9009\u4e4b\u540e\u91cd\u8bd5\u3002"}}:null}},{key:"_checkIntersectAndForm",value:function(t){return function(t,n){for(var r=0,a=0;a<t.length;a++){var o=e.SpreadsheetApp.feature.relateForm,s=t[a],i=n.sheetManager.getSheetBySheetId(s.sheetId);if(null!==i&&o&&o.isRelated(s.sheetId))if(i.data.rowData||!1){var l=i.data.rowMetadata,c=i.data.colMetadata;if(r=o.checkReleaseRange(s,l,c,4))return 4===r}}return!1}(this.behaviors,t)?{isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u64cd\u4f5c\u88ab\u7981\u6b62\u3002\u65e0\u6cd5\u5408\u5e76\u5305\u542b\u6536\u96c6\u8868\u95ee\u9898\u6216\u6570\u636e\u7684\u5355\u5143\u683c\u3002",btnTxt:"\u6211\u77e5\u9053\u4e86"}}:null}},{key:"_checkCrossMergeRange",value:function(e){for(var t=0;t<this.behaviors.length;t++)for(var n=this.behaviors[t],r=e.sheetManager.getSheetBySheetId(n.sheetId).mergeManager.mergeList,a=0;a<r.length;a++){if(r[a].isCross(n))return{isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u60a8\u5fc5\u987b\u9009\u62e9\u5408\u5e76\u5355\u5143\u683c\u8303\u56f4\u5185\u7684\u6240\u6709\u5355\u5143\u683c\u6216\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c\u3002"}}}return null}},{key:"_checkMultiContent",value:function(e){for(var t=0;t<this.behaviors.length;t++){var n=this.behaviors[t],r=e.sheetManager.getSheetBySheetId(n.sheetId);if(null!==r)for(var a=0,o=n.startRowIndex;o<=n.endRowIndex;o++)for(var s=n.startColIndex;s<=n.endColIndex;s++){var i=r.getCellDataAtPosition(o,s);if(null!==i&&(null!==i.getEffectiveValue()&&""!==i.getEffectiveValue().value||null!==i.getFormula())&&(a+=1)>1)return{isWarningOnly:!0,warning:{title:"\u5408\u5e76\u5355\u5143\u683c\u63d0\u793a",content:"\u5408\u5e76\u540e\u5c06\u53ea\u4fdd\u7559\u5de6\u4e0a\u89d2\u5355\u5143\u683c\u4e2d\u7684\u5185\u5bb9\uff0c\u7ee7\u7eed\u5408\u5e76\u5417\uff1f"}}}}return null}},{key:"_findMainCell",value:function(e,t){var n,r=t.startRowIndex,a=t.endRowIndex,o=t.startColIndex,s=t.endColIndex,i=o;e:for(n=r;n<=a;n++)for(i=o;i<=s;i++){var l=e.getCellDataAtPosition(n,i);if(null!==l&&(l.getEffectiveValue()&&""!==l.getEffectiveValue().value)){if(n!==r||i!==o)break e;break e}}return n>a&&(n=r,i=o),{x:i,y:n}}},{key:"_updateMainPosition",value:function(e,t,n,r){var a=r.sheetManager.getSheetBySheetId(this.sheetId);if(e.row!==t||e.column!==n){var o=a.getCellDataAtPosition(t,n),s=a.getCellDataAtPosition(e.row,e.column),i=Object(g.a)({cellData:o,rowIndex:t,colIndex:n,sheetId:this.sheetId},{cellData:s,rowIndex:e.row,colIndex:e.column,sheetId:this.sheetId},p.a.ALL,v.a.ALL,{getSheetTitleBySheetId:function(e){return r.sheetManager.getSheetTitleBySheetId(e)}}),l=new m.a({gridRange:new d.b(this.sheetId,t,t,n,n),cellDataDeltaAtPositions:[{rowIndex:t,colIndex:n,cellDataDelta:i}]}),c=l.cellDataDeltaAtPositions[0].cellDataDelta.delta.userEnteredFormatDelta;return null!==c&&void 0!==c&&(c.clearSlot(v.b.BORDER_TOP),c.clearSlot(v.b.BORDER_BOTTOM),c.clearSlot(v.b.BORDER_LEFT),c.clearSlot(v.b.BORDER_RIGHT)),l}return null}},{key:"_getTopBorder",value:function(e,t,n,r){for(var a,o=t;o<=n;o++){var s=Object(_.a)(e,r,o,b.a.TOP,!0);if(null===s)return null;if(void 0===a)a=s;else{if(null===a)return null;if(!a.equal(s))return null}}return a}},{key:"_getLeftBorder",value:function(e,t,n,r){for(var a,o=t;o<=n;o++){var s=Object(_.a)(e,o,r,b.a.LEFT,!0);if(null===s)return null;if(void 0===a)a=s;else{if(null===a)return null;if(!a.equal(s))return null}}return a}},{key:"_getRightBorder",value:function(e,t,n,r,a,o){for(var s,i=!0,l=!1,c=t;c<=n;c++){var u=Object(_.a)(e,c,r,b.a.RIGHT,!0);if(null!==u)if(i=!1,void 0===s)s=u;else{if(null===s){s=null;break}if(!s.equal(u)){s=null;break}}else s=null}return i&&a&&null!==(s=Object(_.a)(e,o.row,o.column,b.a.RIGHT,!1))&&(l=!0),{right:s,isAllRight:l}}},{key:"_getBottomBorder",value:function(e,t,n,r,a,o){for(var s,i=!0,l=!1,c=t;c<=n;c++){var u=Object(_.a)(e,r,c,b.a.BOTTOM,!0);if(null!==u)if(i=!1,void 0===s)s=u;else{if(null===s)break;if(!s.equal(u)){s=null;break}}else s=null}return i&&a&&null!==(s=Object(_.a)(e,o.row,o.column,b.a.BOTTOM,!1))&&(l=!0),{bottom:s,isAllBottom:l}}},{key:"_getSetRangeMutation",value:function(e,t,n,r,a,o,s,i){for(var l=new d.b(e.getSheetId(),t,n,r,a),c=[],u=[],h=t;h<=n;h++)for(var g=r;g<=a;g++)c.length=0,h===t?(c.push(b.a.TOP),g===r&&c.push(b.a.LEFT),g===a&&c.push(b.a.RIGHT),h===n&&c.push(b.a.BOTTOM)):h===n?(c.push(b.a.BOTTOM),g===r&&c.push(b.a.LEFT),g===a&&c.push(b.a.RIGHT)):g===r?(c.push(b.a.LEFT),g===a&&c.push(b.a.RIGHT)):g===a?c.push(b.a.RIGHT):c=[],i&&c.push(b.a.BOTTOM),s&&c.push(b.a.RIGHT),c=Array.from(new Set(c)),u.push({rowIndex:h,colIndex:g,cellDataDelta:new f.a({setSlots:1<<p.b.SLOT_USER_ENTERED_FORMAT_DELTA,clearSlots:0,delta:{userEnteredFormatDelta:new I.a({setSlots:this._getSetSlots(c),clearSlots:this._getClearSlots(c),delta:E.CellFormatFactory.createInstance({borders:this._getBorders(c,o)})})}})});return new m.a({gridRange:l,cellDataDeltaAtPositions:u})}},{key:"_getBorders",value:function(e,t){var n,r={};for(n=0;n<e.length;n++)t[e[n]]&&(r[e[n]]={color:t[e[n]].color,style:t[e[n]].style});return E.BordersFactory.createInstance(r)}},{key:"_getSetSlots",value:function(e){var t,n=0;for(t=0;t<e.length;t++)switch(e[t]){case b.a.TOP:n+=1<<v.b.BORDER_TOP;break;case b.a.RIGHT:n+=1<<v.b.BORDER_RIGHT;break;case b.a.BOTTOM:n+=1<<v.b.BORDER_BOTTOM;break;case b.a.LEFT:n+=1<<v.b.BORDER_LEFT}return n}},{key:"_getClearSlots",value:function(e){var t,n=0;for(n+=1<<v.b.BORDER_TOP,n+=1<<v.b.BORDER_RIGHT,n+=1<<v.b.BORDER_BOTTOM,n+=1<<v.b.BORDER_LEFT,t=0;t<e.length;t++)switch(e[t]){case b.a.TOP:n-=1<<v.b.BORDER_TOP;break;case b.a.RIGHT:n-=1<<v.b.BORDER_RIGHT;break;case b.a.BOTTOM:n-=1<<v.b.BORDER_BOTTOM;break;case b.a.LEFT:n-=1<<v.b.BORDER_LEFT}return n}},{key:"id",get:function(){return s.id}}]),s}(l.a);S.id=y.a.MERGE_CELLS_REQUEST,t.a=S}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/behavior/request/multisheet/RenameSheetRequest.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),s=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),l=n("./src/core/behavior/request/Request.ts"),c=n("./src/core/behavior/request/Type.ts"),u=n("../packages/mutation/src/sheet/SetSheetPropertiesMutation.ts"),d=n("../packages/model/src/sheet/sheetUtils.ts"),f=n("../packages/model/src/sheet/SheetPropertiesDelta.ts"),h=n("../packages/model/src/sheet/SheetPropertiesSlotOperation.ts");function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(i.a)(e);if(t){var a=Object(i.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var g=function(t){Object(o.a)(s,t);var n=p(s);function s(e){var t;return Object(r.a)(this,s),(t=n.call(this,e)).behaviors=[],null===e||void 0===e||e.forEach((function(e){t.behaviors.push(e)})),t}return Object(a.a)(s,[{key:"isMultiSheetRequest",value:function(){return!0}},{key:"check",value:function(t){var n=null,r=t.sheetManager.sheetCount,a=null,o=t.sheetManager.sheetList;if(!r)return n={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u91cd\u547d\u540d\u4e0d\u6210\u529f"}};for(var s,i=0;s=this.behaviors[i];i++){var l=s.sheetName.trim(),c=e.$(".sheet-tab-name.rename")[0];t.sheetManager.hasSheetId(s.sheetId)||(null===c||void 0===c||c.focus(),a="\u5de5\u4f5c\u8868ID\u4e0d\u5b58\u5728\u3002"),""===l&&(null===c||void 0===c||c.focus(),a="\u5de5\u4f5c\u8868\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a\u3002"),l.length>=32&&(null===c||void 0===c||c.focus(),a="\u5de5\u4f5c\u8868\u540d\u79f0\u4e0d\u53ef\u4ee5\u8d85\u8fc731\u4e2a\u5b57\u7b26\u3002"),Object(d.isIncludeIllegalChar)(l)&&(null===c||void 0===c||c.focus(),a="\u5de5\u4f5c\u8868\u540d\u79f0\u4e0d\u80fd\u5305\u542b\u4ee5\u4e0b\u5b57\u7b26\uff1a : \\ / ? * [ ] \uff0c\u8bf7\u5c1d\u8bd5\u5220\u9664\u8fd9\u4e9b\u5b57\u7b26\u3002"),Object(d.isStartOrEndWithSingleQuotes)(l)&&(null===c||void 0===c||c.focus(),a="\u5de5\u4f5c\u8868\u540d\u79f0\u7684\u8d77\u6b62\u4f4d\u7f6e\u4e0d\u80fd\u4e3a\u5355\u5f15\u53f7 ' \uff0c\u8bf7\u5c1d\u8bd5\u4fee\u6539\u5355\u5f15\u53f7\u4f4d\u7f6e\u3002"),Object(d.isIncludeInvisibleChar)(l)&&(null===c||void 0===c||c.focus(),a="\u5de5\u4f5c\u8868\u540d\u79f0\u53ef\u80fd\u5305\u542b\u67d0\u4e9b\u4e0d\u53ef\u89c1\u7684\u7279\u6b8a\u5b57\u7b26\uff0c\u8bf7\u5220\u9664\u8fd9\u4e9b\u5b57\u7b26\u6216\u7a7a\u683c\u3002");for(var u=0,f=o.length;u<f;u++){if(o[u].getTitle().toUpperCase()===l.toUpperCase()&&o[u].getSheetId()!==s.sheetId)return null===c||void 0===c||c.focus(),{isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:a="\u5de5\u4f5c\u8868\u540d\u79f0\u53ef\u80fd\u91cd\u590d\uff0c\u8bf7\u4fee\u6539\u3002"}}}}return a&&(n={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:a}}),n}},{key:"do",value:function(e,t,n){n(new u.a({sheetId:e.sheetId,sheetDelta:new f.b({operation:h.a.SET_PROPERTIES,delta:{name:e.sheetName}})}))}},{key:"id",get:function(){return s.id}}]),s}(l.a);g.id=c.a.RENAME_SHEET_REQUEST,t.a=g}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/core/behavior/request/utils/cellDataUtil.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r=n("../packages/model/src/cell/CellData.ts"),a=n("../packages/model/src/cell/CellDataDelta.ts"),o=n("../packages/model/src/cell/CellDataSlot.ts"),s=n("../packages/model/src/cell/CellFormatSlot.ts"),i=n("../packages/model/src/cell/cellFormatUtils.ts"),l=n("./src/core/feature/formula/utils/parseUtil.ts"),c=n("../packages/model/src/cell/cellDataUtils.ts");function u(e,t){return!(!e.cellData&&!t.cellData)&&(e.cellData||(e.cellData=new r.a),t.cellData||(t.cellData=new r.a),!0)}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.a.ALL,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.a.ALL,d=arguments.length>4?arguments[4]:void 0;if(!d.getSheetTitleBySheetId)throw new Error("createCellDataDelta need getSheetTitleBySheetId when formulaRelative is true");var f,h,p=new a.a;if(!u(e,t))return p;for(var g=0,m=n;m>0;m>>=1,g++)if(1===(1&m))if(t.cellData.hasSlot(g))switch(g){case o.b.SLOT_USER_ENTERED_FORMAT_DELTA:f=Object(i.createCellFormatDelta)(e.cellData.getUserEnteredFormat(),t.cellData.getUserEnteredFormat(),r),p.setSlot(g,f);break;case o.b.SLOT_EFFIECTIVE_FORMAT_DELTA:f=Object(i.createCellFormatDelta)(e.cellData.getEffectiveFormat(),t.cellData.getEffectiveFormat(),r),p.setSlot(g,f);break;case o.b.SLOT_FORMULA:if(t.cellData.getFormula()){if(void 0===e.rowIndex||void 0===e.colIndex||void 0===t.rowIndex||void 0===t.colIndex){console.error("\u9519\u8bef\uff0c\u68c0\u6d4b\u51fd\u6570delta\u5fc5\u987b\u8981\u4f20\u5165rowIndex\u548ccolIndex");break}p.setSlot(g,Object(l.c)(t.cellData.getFormula().toString(t.rowIndex,t.colIndex,d),e.rowIndex,e.colIndex,e.sheetId))}else p.setSlot(g,null);break;default:(h=c.cellDataSetSlotGetterMap[g])&&p.setSlot(g,t.cellData[h]())}else(e.cellData.setSlots&1<<g)>0&&p.clearSlot(g);return p}},"./src/core/behavior/request/utils/index.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return _}));n("../packages/model/src/cell/CellFormatDelta.ts");var r=n("../packages/model/src/range/DimensionRange.ts");function a(e,t,n){for(var a=[],o=1,s=e[0],i=e[0];o<e.length;o++)e[o]!==e[o-1]+1&&(i=e[o-1],a.push(new r.a(t,s,i,n)),s=e[o]);return i=e[o-1],a.push(new r.a(t,s,i,n)),a}var o,s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../packages/model/src/cell/format/BorderType.ts"),l=n("../packages/model/src/cell/format/BorderStyle.ts"),c=n("../packages/model/src/cell/format/colorUtils.ts");function u(e,t){var n,r=null;return e&&(r=null===(n=e.getUserEnteredFormat())||null===n.getBorders()||null===n.getBorders()[t]?null:n.getBorders()[t]),r}function d(e,t,n,r,a){var o=e.getCellDataAtPosition(t,n),s=null,l=null,d=null;if(!a&&null===o)return null;switch(r){case i.a.TOP:a&&(s=e.getCellDataAtPosition(t-1,n)),l=u(o,r),d=u(s,i.a.BOTTOM);break;case i.a.RIGHT:a&&(s=e.getCellDataAtPosition(t,n+1)),l=u(o,r),d=u(s,i.a.LEFT);break;case i.a.BOTTOM:a&&(s=e.getCellDataAtPosition(t+1,n)),l=u(o,r),d=u(s,i.a.TOP);break;case i.a.LEFT:a&&(s=e.getCellDataAtPosition(t,n-1)),l=u(o,r),d=u(s,i.a.RIGHT)}return function(e,t){if(!t||null===t.style)return 1;if(!e||null===e.style)return-1;var n=function(e,t){if(!t.style)return 1;if(!e.style)return-1;return f[e.style]-f[t.style]}(e,t);if(0===n)return function(e,t){if(!t)return 1;if(!e)return-1;return Object(c.compareColorByBrightness)(e.color,t.color)}(e,t);return n}(l,d)>0?l:d}var f=(o={},Object(s.a)(o,l.a.NONE,0),Object(s.a)(o,l.a.HAIR,1),Object(s.a)(o,l.a.DASH_DOT,2),Object(s.a)(o,l.a.DASH_DOT_DOT,3),Object(s.a)(o,l.a.DOTTED,4),Object(s.a)(o,l.a.DASHED,5),Object(s.a)(o,l.a.THIN,6),Object(s.a)(o,l.a.MEDIUM_DASH_DOT_DOT,7),Object(s.a)(o,l.a.SLANTED_DASH_DOT,8),Object(s.a)(o,l.a.MEDIUM_DASH_DOT,9),Object(s.a)(o,l.a.MEDIUM_DASHED,10),Object(s.a)(o,l.a.MEDIUM,11),Object(s.a)(o,l.a.THICK,12),Object(s.a)(o,l.a.DOUBLE,13),o);n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.string.bold.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var h=n("../packages/model/src/cell/CellFormatSlot.ts"),p=n("../packages/model/src/cell/CellDataDelta.ts"),g=n("../packages/model/src/cell/CellDataSlot.ts"),m=n("./src/core/utils/cell.ts"),b=n("../packages/model/src/factory/index.ts");function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(s.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n,r){var a,o=r.delta.userEnteredFormatDelta,s=new p.a,i=e.getCellDataAtPosition(t,n),l=!1;if(null===i||null===o||void 0===o)return s;if(null===(a=i.getTextFormatRuns())||0===a.length)return s;a=a.map((function(e){return e.clone()}));var c=i.getMentionDetails(),u=[];c&&(u=Object.keys(c).map((function(e){var t=c[e].pos;return[t[0],t[1]]})).sort((function(e,t){return e[0]-t[0]})),a=function(e,t,n){for(var r,a,o=[],s=0,i=0,l=t.length,c=0;c<l;c++){r=t[c],a=c+1<l?t[c+1]:null,s=r.startIndex,i=a?a.startIndex:e.length,E([s,i],n).forEach((function(e){var t;o.push(b.TextFormatRunFactory.createInstance({startIndex:e.pos[0],format:(null===(t=r.format)||void 0===t?void 0:t.clone())||null}))}))}return o}(Object(m.getMergedValue)(i),a,u));return(l=(l=l||function(e,t,n){var r,a=!1,o=n.clearSlots,s=!1;for(r=0;o>0;o>>=1,r++){if(1===(1&o))switch(r){case h.b.FOREGROUND_COLOR:s=y(e,t,"color",null);break;case h.b.FONT_FAMINY:s=y(e,t,"fontFamily",null);break;case h.b.FONT_SIZE:s=y(e,t,"fontSize",null);break;case h.b.BOLD:s=y(e,t,"bold",null);break;case h.b.ITALIC:s=y(e,t,"italic",null);break;case h.b.STRIKETHROUGH:s=y(e,t,"strikethrough",null);break;case h.b.UNDERLINE:s=y(e,t,"underline",null)}a=a||s}return a}(a,u,o))||function(e,t,n){var r,a=!1,o=n.setSlots,s=!1;for(r=0;o>0;o>>=1,r++){if(1===(1&o))switch(r){case h.b.FOREGROUND_COLOR:s=y(e,t,"color",n.delta.getTextFormat().color);break;case h.b.FONT_FAMINY:s=y(e,t,"fontFamily",n.delta.getTextFormat().fontFamily);break;case h.b.FONT_SIZE:s=y(e,t,"fontSize",n.delta.getTextFormat().fontSize);break;case h.b.BOLD:s=y(e,t,"bold",n.delta.getTextFormat().bold);break;case h.b.ITALIC:s=y(e,t,"italic",n.delta.getTextFormat().italic);break;case h.b.STRIKETHROUGH:s=y(e,t,"strikethrough",n.delta.getTextFormat().strikethrough);break;case h.b.UNDERLINE:s=y(e,t,"underline",n.delta.getTextFormat().underline)}a=a||s}return a}(a,u,o))&&s.setSlot(g.b.SLOT_RICH_TEXT_STYLE_RUN,a),s}function y(e,t,n,r){var a,o,i=!1;for(a=0;a<e.length;a++){var l;R(t,(o=e[a]).startIndex)||(e.splice(a,1,b.TextFormatRunFactory.createInstance(I(I({},o.getOptions()),{},{format:b.TextFormatFactory.createInstance(I(I({},null===(l=o.format)||void 0===l?void 0:l.getOptions()),{},Object(s.a)({},n,r)))}))),i=!0)}return i}function R(e,t){if(!e.length)return!1;for(var n=0;n<e.length;n++)if(e[n][0]===t)return!0;return!1}function E(e,t){if(!t||!t.length)return[{pos:e,isMention:!1}];var n=[],r=t.filter((function(t){return e[0]<=t[0]&&t[1]<=e[1]}));if(r.length>0){for(var a,o=e[0],s=0;s<r.length;s++)o<(a=r[s])[0]&&n.push({pos:[o,a[0]],isMention:!1}),n.push({pos:a,isMention:!0}),o=a[1];return o<e[1]&&n.push({pos:[o,e[1]],isMention:!1}),n}return[{pos:e,isMention:!1}]}},"./src/core/behavior/request/workbook/filterUtils/getExtendFilterRangeMutation.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../packages/mutation/src/filter/UpdateFilterMutation.ts"),a=n("../packages/model/src/range/GridRange.ts"),o=n("./src/core/behavior/request/workbook/filterUtils/handleFilterRange.ts");function s(e,t){var n=!1,r=e.getBasicFilter();if(!r||!t)return!1;var o=r.range,s=new a.b(o.sheetId,o.endRowIndex+1,o.endRowIndex+1,o.startColIndex,o.endColIndex);return t.forEach((function(t){if(function(e,t){for(var n=t.startRowIndex,r=t.endRowIndex,o=t.startColIndex,s=t.endColIndex,i=n,l=r,c=o,u=s,d=n;d<=r;d++)for(var f=o;f<=s;f++){var h=e.getCellDataAtPosition(d,f),p=null===h||void 0===h?void 0:h.getMergeReference();if(p&&!t.contain(p)){var g=p.startRowIndex,m=p.endRowIndex,b=p.startColIndex,v=p.endColIndex;i=Math.min(i,g),l=Math.max(l,m),c=Math.min(c,b),u=Math.max(u,v)}}return new a.b(t.sheetId,i,l,c,u)}(e,t).isCross(s))return n=!0,!1})),n}function i(e,t){for(var n=t.startRowIndex,r=t.endRowIndex,s=t.startColIndex,i=t.endColIndex,l=e.getRowCount()-1,c=r,u=r+1;u<=l;u++){for(var d=!0,f=s;f<=i;f++)if(!Object(o.d)(e,u,f)){d=!1;break}if(d)break;c=u}return new a.b(t.sheetId,n,c,s,i)}t.a=function(e){var t=e.getSheetId(),n=e.getBasicFilter();return n?[new r.b({updateType:r.a.UPDATE,sheetId:t,workbookRangeId:n.workbookRangeId,delta:{defaultFilterId:n.workbookRangeId,range:i(e,n.range)}})]:[]}},"./src/core/behavior/requests.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return Io}));var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=n("./src/core/behavior/request/Type.ts"),o=(n("../node_modules/core-js/modules/es.array.every.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js")),s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),l=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),c=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../node_modules/@babel/runtime/helpers/esm/typeof.js"),f=n("./src/core/behavior/request/Request.ts"),h=n("../packages/mutation/src/dimension/InsertDimensionMutation.ts"),p=n("../packages/model/src/dimension/DimensionType.ts"),g=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),m=n("../packages/model/src/range/DimensionRange.ts"),b=n("../packages/model/src/range/GridRange.ts"),v=n("../packages/mutation/src/cell/SetRangeMutation.ts"),I=n("../packages/model/src/cell/CellDataSlot.ts"),_=n("../packages/model/src/cell/cellDataUtils.ts"),y=n("../packages/mutation/src/merge/MergeCellsMutation.ts"),R=n("../packages/model/src/cell/metadata/CustomDataType.ts");function E(e,t){var n,r,a,o,s=[],i=e.getSheetId();for(r=t.startRowIndex;r<=t.endRowIndex;r++)for(n=t.startColIndex;n<=t.endColIndex;n++){var l,c;a=e.getCellDataAtPosition(r,n);var u=Object(I.c)(I.b.SLOT_USER_ENTERED_FORMAT_DELTA),d=null===(l=a)||void 0===l||null===(c=l.getMetadata())||void 0===c?void 0:c.customDataType,f=d&&d!==R.o.IMAGE;if(f&&(u+=Object(I.c)(I.b.SLOT_METADATA)),o=Object(_.createCellDataDelta)({cellData:null,sheetId:i},{cellData:a,sheetId:i},u),f){var h=Object(R.q)(d);h&&o.setSlot(I.b.SLOT_EFFIECTIVE_VALUE,h)}s.push({rowIndex:r,colIndex:n,cellDataDelta:o})}return new v.a({gridRange:t,cellDataDeltaAtPositions:s})}var O=n("../packages/model/src/rule/ConditionalFormatRule.ts"),S=n("../packages/mutation/src/conditionalFormat/UpdateConditionalFormatMutation.ts"),T=n("../node_modules/@tencent/jank-sdk/lib/index.js"),w=n("../packages/model/src/cell/index.ts");function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var j=function(e,t,n,r){var a,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(d.a)(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(s=(o<3?a(s):o>3?a(t,n,s):a(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},x=function(e){Object(l.a)(n,e);var t=k(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheet.getSheetId(),a.type=e.type,a.selection=r,e.insertInfo?(e.insertInfo.forEach((function(e){e.amount=Math.floor(e.amount)})),a.behaviors=e.insertInfo):r&&(a.type===p.a.ROWS?a.behaviors=a.getInsertOption(e.sheet,r.getRows()):a.behaviors=a.getInsertOption(e.sheet,r.getCols())),a}return Object(i.a)(n,[{key:"check",value:function(e){var t=null;return this.behaviors.every((function(e){return e.index>=0&&e.amount>=0}))||(t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u63d2\u5165\u7684\u884c\u5217\u4f4d\u7f6e\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u64cd\u4f5c\u3002"}}),t}},{key:"predictRequestSize",value:function(e){var t,n,r,a=e.sheetManager.getSheetBySheetId(this.sheetId),o=0,s=0,i=this.behaviors[0].index;if(0===i)return 0;if(!a)return 0;if(this.type===p.a.ROWS)for(t=s=a.getColCount(),r=0;r<t;r++)(n=a.getCellDataAtPosition(i-1,r))&&0!==n.setSlots||(s-=1);else{if(this.type!==p.a.COLUMNS)return 0;for(t=s=a.getRowCount(),r=0;r<t;r++)(n=a.getCellDataAtPosition(r-1,i))&&0!==n.setSlots||(s-=1)}return this.behaviors.forEach((function(e){o+=e.amount*s*40})),o}},{key:"requestSizeOverLimitTips",value:function(){return"\u6570\u636e\u91cf\u8f83\u5927\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f\u3002\u5efa\u8bae\u5206\u6279\u63d2\u5165".concat(this.type===p.a.ROWS?"\u884c":"\u5217","\u3002")}},{key:"do",value:function(e,t,n){var r,a,o,s,i,l,c=0,u=0,d=t.sheetManager.getSheetBySheetId(this.sheetId),f=[];if(null!==d){this.selection||(this.selection=t.parent.view.getSelection());var I=this.selection.activeCell,_=I.rowIndex,y=I.colIndex,R=d.getRowCount(),O=d.getColCount(),S=e.index;S=this.type===p.a.ROWS?S>R-1?R-1:_:S>O-1?O-1:y;var T=!1;for(c=0;c<this.behaviors.length;c++)if(T){var w=new m.a(this.sheetId,this.behaviors[c].index,this.behaviors[c].amount,this.type);w.insertDimension({sheetId:this.sheetId,index:e.index,amount:e.amount,type:this.type}),this.behaviors[c].index=w.startIndex,this.behaviors[c].amount=w.endIndex-w.startIndex+1}else this.behaviors[c]===e&&(T=!0);var k=this.beforeInsertDimension(t,e,this.type),j=k.beforeMutations,x=k.afterMutations;j.forEach((function(e){n(e)})),this.type===p.a.ROWS&&(a=new b.b(this.sheetId,S,S,0,d.getColCount()-1),o=E(d,a),this.checkBorders(o,d,e.index>S)),this.type===p.a.COLUMNS&&(a=new b.b(this.sheetId,0,d.getRowCount()-1,S,S),o=E(d,a),this.checkBorders(o,d,e.index>S)),n(new h.a({index:e.index,amount:e.amount,type:this.type,sheetId:this.sheetId})),(this.type===p.a.ROWS||this.type===p.a.COLUMNS)&&(S=e.index<=S?S+e.amount:S);var C=Object(g.d)({sheet:d,type:this.type,ranges:[new m.a(this.sheetId,S,S,this.type)]},{pixelSize:!0,ignoreDefaultSize:!0});for(c=0;c<C.length;c++)(r=C[c]).operation.length>0&&(r.ranges.forEach((function(t){t.startIndex=e.index,t.endIndex=e.index+e.amount-1})),n(r));if(o&&o.cellDataDeltaAtPositions.length>0){for(c=0;c<o.cellDataDeltaAtPositions.length;c++)if(s=o.cellDataDeltaAtPositions[c].rowIndex,i=o.cellDataDeltaAtPositions[c].colIndex,0!==(l=o.cellDataDeltaAtPositions[c].cellDataDelta).setSlots)if(this.type===p.a.ROWS)for(u=0;u<e.amount;u++)f.push({rowIndex:e.index+u,colIndex:i,cellDataDelta:l});else for(u=0;u<e.amount;u++)f.push({rowIndex:s,colIndex:e.index+u,cellDataDelta:l});a=this.type===p.a.ROWS?new b.b(this.sheetId,e.index,e.index+e.amount-1,0,d.getColCount()-1):new b.b(this.sheetId,0,d.getRowCount()-1,e.index,e.index+e.amount-1),0!==f.length&&n(new v.a({gridRange:a,cellDataDeltaAtPositions:f}))}x.forEach((function(e){n(e)}))}}},{key:"updateDataValidationAfterInsertMutation",value:function(e,t,n,r){var a=e.delta.userEnteredFormatDelta;return null!=(null===a||void 0===a?void 0:a.delta.getDataValidation())?this.getCellDataDeltaAtPosition(t,n,r):e}},{key:"getCellDataDeltaAtPosition",value:function(e,t,n){var r,a,o=e.getSheetId();return null!==(r=e.getCellDataAtPosition(t,n))&&null!==r.getMergeReference()&&(a=r.getMergeReference(),r=e.getCellDataAtPosition(a.startRowIndex,a.startColIndex)),Object(_.createCellDataDelta)({cellData:null,rowIndex:this.type===p.a.ROWS?t+1:t,colIndex:this.type===p.a.ROWS?n:n+1,sheetId:o},{cellData:r,rowIndex:t,colIndex:n,sheetId:o},1<<I.b.SLOT_USER_ENTERED_FORMAT_DELTA)}},{key:"getInsertOption",value:function(e,t){for(var n,r=[],a=1,o=t[0],s=1;a<t.length;a++)t[a]===t[a-1]+1?s+=1:(n={index:o,amount:s},r.push(n),o=t[a],s=1);return n={index:o,amount:s},r.push(n),r}},{key:"checkBorders",value:function(e,t,n){var r,a,o,s,i,l,c,u,d,f=e.cellDataDeltaAtPositions,h=e.gridRange,g=!1;for(this.type===p.a.ROWS?(o=1,s=0,t.getRowCount()<=h.startRowIndex+o&&(g=!0)):(o=0,s=1,t.getColCount()<=h.startColIndex+s&&(g=!0)),i=0;i<f.length;i++){var m;(null===(m=(l=f[i].cellDataDelta.delta).userEnteredFormatDelta)||void 0===m?void 0:m.delta)&&(null!==(c=l.userEnteredFormatDelta.delta).getBorders()&&(g&&n?(l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_TOP),l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_BOTTOM),l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_LEFT),l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_RIGHT)):(r=f[i].rowIndex,a=f[i].colIndex,null!==(u=n?t.getCellDataAtPosition(r+o,a+s):t.getCellDataAtPosition(r-o,a-s))&&null!==(d=u.getUserEnteredFormat())&&null!==d.getBorders()?(c.getBorderTop()&&(d.getBorderTop()&&c.getBorderTop().equal(d.getBorderTop())||l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_TOP)),c.getBorderRight()&&(d.getBorderRight()&&c.getBorderRight().equal(d.getBorderRight())||l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_RIGHT)),c.getBorderBottom()&&(d.getBorderBottom()&&c.getBorderBottom().equal(d.getBorderBottom())||l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_BOTTOM)),c.getBorderLeft()&&(d.getBorderLeft()&&c.getBorderLeft().equal(d.getBorderLeft())||l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_LEFT))):(l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_TOP),l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_BOTTOM),l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_LEFT),l.userEnteredFormatDelta.clearSlot(w.CELL_FORMAT_SLOT.BORDER_RIGHT)))))}}},{key:"beforeInsertDimension",value:function(e,t,n){t.index,t.amount;var r=[],a=[],s=this.conflictMerge(t,e);r.push.apply(r,Object(o.a)(s.beforeMutations)),a.push.apply(a,Object(o.a)(s.afterMutations));var i=this.conflictWorkbookrange(t,e,n);a.push.apply(a,Object(o.a)(i.afterMutations));var l=this.conflictConditionalFormat(t,e);return r.push.apply(r,Object(o.a)(l.beforeMutations)),a.push.apply(a,Object(o.a)(l.afterMutations)),{beforeMutations:r,afterMutations:a}}},{key:"conflictWorkbookrange",value:function(e,t,n){e.index,e.amount,t.sheetManager.getSheetBySheetId(this.sheetId);return{beforeMutations:[],afterMutations:[]}}},{key:"conflictMerge",value:function(e,t){var n=this,r=e.index,a=e.amount,o=t.sheetManager.getSheetBySheetId(this.sheetId),s={beforeMutations:[],afterMutations:[]};return o.mergeManager.each((function(e){n.type===p.a.ROWS?r>e.startRowIndex&&r<=e.endRowIndex&&s.afterMutations.push(new y.a({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex+a,startColIndex:e.startColIndex,endColIndex:e.endColIndex})):n.type===p.a.COLUMNS&&r>e.startColIndex&&r<=e.endColIndex&&s.afterMutations.push(new y.a({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex+a}))})),s}},{key:"conflictConditionalFormat",value:function(e,t){var n=this,r={beforeMutations:[],afterMutations:[]},a=this.sheetId,o=t.sheetManager.getSheetBySheetId(a),s=o.conditionalFormatRuleManager.rules,i=s.length;if(i<1)return r;var l,c=e.index,u=e.amount,d=o.getRowCount()-1,f=o.getColCount()-1;l=this.type===p.a.ROWS?new b.b(a,c,c,0,f):new b.b(a,0,d,c,c);for(var h=0;h<i;h++){var g=s[h],m=!1,v=g.rule.ruleRanges.map((function(e){if(l.isCross(e)){m=!0;var t=e.clone();return t.insertDimension({type:n.type,sheetId:a,index:c,amount:u}),t}return e}));if(m){var I=new O.a({ruleRanges:v,booleanConditionalFormat:g.rule.booleanConditionalFormat,uid:g.rule.uid});r.afterMutations.push(new S.a({sheetId:a,ruleIndex:g.index,rule:I,oldRuleRanges:g.rule.ruleRanges}))}}return r}},{key:"id",get:function(){return n.id}}]),n}(f.a);x.id=a.a.INSERT_DIMENSION_REQUEST,j([Object(T.b)(x)],x.prototype,"predictRequestSize",null);var C=x,D=n("./src/core/behavior/request/dimension/DeleteDimensionRequest.ts"),A=n("./src/core/behavior/request/dimension/util.ts");function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var L=function(e){Object(l.a)(n,e);var t=M(n);function n(e,r){var a,i;(Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheetId,a.behaviors=[],e.dimensionModifiers)&&(i=a.behaviors).push.apply(i,Object(o.a)(e.dimensionModifiers));return a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){Object(A.a)(e,t,n)}},{key:"id",get:function(){return n.id}}]),n}(f.a);L.id=a.a.SET_DIMENSION_SIZE_REQUEST;var N=n("./src/core/behavior/request/utils/index.ts"),U=n("../packages/model/src/range/gridRangeUtils.ts");function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var F=function(e){Object(l.a)(n,e);var t=P(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheetId,a.type=e.type,e.dimensionRanges?(a.behaviors=[],e.dimensionRanges.forEach((function(e){e.dimension===a.type&&a.behaviors.push(e)}))):r&&(a.type===p.a.ROWS?a.behaviors=Object(N.b)(r.getRows(),a.sheetId,a.type):a.behaviors=Object(N.b)(r.getCols(),a.sheetId,a.type)),a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(null!==r)for(var a=Object(U.divideDimensionRangeByFilter)([e],r.getBasicFilter()),o=0;o<a.length;o++){var s=a[o];n(new g.c({ranges:[s],operation:[{slot:g.a.SLOT_HIDDEN,hidden:1}],sheetId:this.sheetId,type:this.type}))}}},{key:"check",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return null===t||this.type!==p.a.COLUMNS&&this.type!==p.a.ROWS?{isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}}:this.isAllDimensionWillHidden(t)?{isWarningOnly:!1,error:{title:"\u9690\u85cf\u884c\u5217",content:"\u64cd\u4f5c\u88ab\u7981\u6b62\u3002\u65e0\u6cd5\u9690\u85cf\u6240\u6709\u7684".concat(this.type===p.a.COLUMNS?"\u5217":"\u884c","\u3002")}}:null}},{key:"isAllDimensionWillHidden",value:function(e){if(this.type===p.a.ROWS){for(var t=0;t<e.getRowCount();t++)if(!B(t,this.behaviors)&&!e.data.isRowHidden(t))return!1}else if(this.type===p.a.COLUMNS)for(var n=0;n<e.getColCount();n++)if(!B(n,this.behaviors)&&!e.data.isColHidden(n))return!1;return!0}},{key:"id",get:function(){return n.id}}]),n}(f.a);function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.startIndex<=e&&r.endIndex>=e)return!0}return!1}F.id=a.a.SET_DIMENSION_HIDE_REQUEST;var H=F;function G(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var z=function(e){Object(l.a)(n,e);var t=G(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheetId,a.type=e.type,e.dimensionRanges?(a.behaviors=[],e.dimensionRanges.forEach((function(e){e.dimension===a.type&&a.behaviors.push(e)}))):r&&(a.type===p.a.ROWS?a.behaviors=Object(N.b)(r.getRows(),a.sheetId,a.type):a.behaviors=Object(N.b)(r.getCols(),a.sheetId,a.type)),a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){if(null!==t.sheetManager.getSheetBySheetId(e.sheetId))for(var r=[e],a=0;a<r.length;a++){var o=r[a];n(new g.c({ranges:[o],operation:[{slot:g.a.SLOT_HIDDEN,hidden:0}],sheetId:this.sheetId,type:this.type}))}}},{key:"id",get:function(){return n.id}}]),n}(f.a);z.id=a.a.SET_DIMENSION_SHOW_REQUEST;var q=z;function V(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Q=function(e){Object(l.a)(n,e);var t=V(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).canUndoRedo=!1,a.behaviors=[{sheetId:e.sheetId,type:e.type,amount:e.amount}],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(null!==r){var a,o,s,i,l,c,u=[],d=r.getRowCount()-1,f=r.getColCount()-1;if(e.type===p.a.ROWS)l=new b.b(e.sheetId,d,d,0,f);else{if(e.type!==p.a.COLUMNS)throw new Error("unknown dimension type");l=new b.b(e.sheetId,0,d,f,f)}var g=E(r,l);if(n(new h.a({index:d+1,amount:e.amount,type:e.type,sheetId:e.sheetId})),g&&g.cellDataDeltaAtPositions.length>0){for(a=0;a<g.cellDataDeltaAtPositions.length;a++)if(s=g.cellDataDeltaAtPositions[a].rowIndex,i=g.cellDataDeltaAtPositions[a].colIndex,0!==(c=g.cellDataDeltaAtPositions[a].cellDataDelta).setSlots)if(e.type===p.a.ROWS)for(o=0;o<e.amount;o++)u.push({rowIndex:s+o+1,colIndex:i,cellDataDelta:c});else for(o=0;o<e.amount;o++)u.push({rowIndex:s,colIndex:i+o+1,cellDataDelta:c});l=e.type===p.a.ROWS?new b.b(e.sheetId,d+1,d+1+e.amount-1,0,f):new b.b(e.sheetId,0,d,f+1,f+1+e.amount-1),u.length>0&&n(new v.a({gridRange:l,cellDataDeltaAtPositions:u}))}}}},{key:"id",get:function(){return a.a.EXPAND_DIMENSION_REQUEST}}]),n}(f.a);Q.id=a.a.EXPAND_DIMENSION_REQUEST;var W=Q,Y=n("../packages/mutation/src/embedded/AddEmbeddedObjectMutation.ts"),K=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),Z=n("../packages/model/src/range/index.ts"),X=n("../packages/model/src/cell/metadata/Metadata.ts"),J=n("./src/core/behavior/request/cell/ClearRangeRequest.ts"),$=n("../packages/mutation/src/embedded/DeleteEmbeddedObjectMutation.ts"),ee=n("../packages/model/src/embedded/index.ts");function te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ne=function(e){Object(l.a)(n,e);var t=te(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=e instanceof Array?e:[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=e.x,a=e.y,o=e.sheetId,s=e.type,i=t.sheetManager.getSheetBySheetId(o);!i||s===ee.EMBEDDED_OBJECT_TYPE.CELL_IMAGE&&Object(R.y)(i,a,r)||(n(new Y.a({data:e})),ae(e,t,n))}},{key:"id",get:function(){return n.id}}]),n}(f.a);function re(e){var t=e.id,n=Object(J.b)();return n.setSlot(w.CELL_DATA_SLOT.SLOT_EFFIECTIVE_VALUE,new w.ExtendedValue({type:w.EXTENDED_VALUE_TYPE.STRING,value:"\u56fe\u7247"})),n.setSlot(w.CELL_DATA_SLOT.SLOT_METADATA,X.a.newInstance({customDataType:R.o.IMAGE})),n.setSlot(w.CELL_DATA_SLOT.SLOT_REF_IDS,[t]),n}function ae(e,t,n){var r=e.x,a=e.y,o=e.sheetId;if(e.type===ee.EMBEDDED_OBJECT_TYPE.CELL_IMAGE){var s,i=null===(s=t.sheetManager.getSheetBySheetId(o))||void 0===s?void 0:s.getCellImage(a,r);i&&n(new $.a({key:i.id,sheetId:o}));var l=new Z.GridRange(o,a,a,r,r);n(new K.a({gridRange:l,cellDataDelta:re(e)}))}}ne.id=a.a.ADD_IMAGE_REQUEST;var oe=ne,se=n("./src/core/behavior/request/embedded/DeleteImageRequest.ts"),ie=n("../packages/mutation/src/embedded/UpdateEmbeddedObjectMutation.ts"),le=n("../packages/model/src/embedded/EmbeddedObjectType.ts");function ce(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ue=function(e){Object(l.a)(n,e);var t=ce(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=e instanceof Array?e:[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){if(e.changeType){var r;if((null===(r=t.activeSheet.imageManager.getImage(e.id))||void 0===r?void 0:r.type)===e.type)return void console.warn("\u56fe\u7247\u7c7b\u578b\u8f6c\u6362\u53c2\u6570\u5f02\u5e38\uff0c\u53ef\u80fd\u5df2\u7ecf\u88ab\u534f\u540c\u8f6c\u6362");if(e.type===le.a.CELL_IMAGE&&ae(e,t,n),e.type===le.a.IMAGE){var a=e.x,o=e.y,s=e.id,i=e.sheetId;Object(se.b)({row:o,col:a,id:s,sheetId:i},t,n)}}n(new ie.a({data:e}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);ue.id=a.a.UPDATE_IMAGE_REQUEST;var de=ue,fe=n("../packages/mutation/src/dimension/DeleteDimensionMutation.ts"),he=n("../packages/mutation/src/other/MapRangeMutation.ts"),pe=n("./src/core/behavior/request/merge/MergeCellsRequest.ts"),ge=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts");function me(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var be=function(e){Object(l.a)(n,e);var t=me(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheetId,e.gridRanges?a.behaviors=e.gridRanges:r&&(a.behaviors=r.rangeSelections),a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=e.startRowIndex,a=e.endRowIndex,o=e.startColIndex,s=e.endColIndex,i=new b.b(this.sheetId,r,a,o,s),l=t.sheetManager.getSheetBySheetId(this.sheetId);if(l)for(var c=Object(ge.b)(i,l),u=0;u<c.length;u++)n(c[u])}},{key:"id",get:function(){return n.id}}]),n}(f.a);be.id=a.a.UNMERGE_CELLS_REQUEST;var ve=be,Ie=n("../packages/model/src/cell/CellDataDelta.ts"),_e=n("../packages/mutation/src/filter/UpdateFilterMutation.ts"),ye=n("../packages/mutation/src/filter/DeleteFilterMutation.ts"),Re=n("../packages/mutation/src/filter/DefineFilterMutation.ts"),Ee=n("../packages/mutation/src/sheet/UpdateSheetRangeMutation.ts"),Oe=n("./src/core/utils/range.ts"),Se=n("../packages/report/src/index.ts"),Te=n("../packages/mutation/src/workbook/workbookRange/UpdateWorkbookRangeMutation.ts"),we=n("../packages/model/src/workbookRange/WorkbookRangeType.ts"),ke=n("../packages/model/src/workbookRange/WorkbookRangeDelta.ts");function je(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var xe=function(e,t,n,r){var a,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(d.a)(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(s=(o<3?a(s):o>3?a(t,n,s):a(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s};function Ce(e,t,n){for(var r={from:0,to:0},a=0;a<e.length;a++){var o=e[a],s=void 0;s=t.dimension===p.a.ROWS?new m.a(o.sheetId,o.startRowIndex,o.endRowIndex,p.a.ROWS):new m.a(o.sheetId,o.startColIndex,o.endColIndex,p.a.COLUMNS),t.isCross(s)&&!t.isContain(s)&&(r.from+=1),n.isCross(s)&&(r.to+=1)}return Se.b.tdwReport({opername:"doc_excel_editor",module:"excel_mob_dimension",action:t.dimension===p.a.ROWS?"drag_row":"drag_line",ver11:r.from,ver12:r.to}),r}var De=function(e){Object(l.a)(n,e);var t=je(n);function n(e,r){var a;Object(s.a)(this,n),(a=t.call(this,e,r)).commonDimensionCheck=function(e){var t=null,n=e.sheetManager.getSheetBySheetId(a.sheetId),r=a.type!==p.a.ROWS&&a.type!==p.a.COLUMNS,o=a.behaviors.length>1||null===n;return(r||o)&&(t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}}),t},a.basicFilterCheck=function(e){var t=null,n=a.colBasicFilterCheck(e);if(null!==n)return t=n;var r=a.rowBasicFilterCheck(e);return null!==r?t=r:t},a.colBasicFilterCheck=function(e){var t,n=null,r=e.sheetManager.getSheetBySheetId(a.sheetId),o=null===r||void 0===r?void 0:r.getBasicFilter();return o&&a.type===p.a.COLUMNS&&(t=o.getHiddenRows())&&t.length>0?n={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u79fb\u52a8\u4e4b\u524d\u8bf7\u5148\u53d6\u6d88\u7b5b\u9009\u3002"}}:n},a.rowBasicFilterCheck=function(e){var t,n,r=a.behaviors[0].from,o=a.behaviors[0].to,s=null,i=e.sheetManager.getSheetBySheetId(a.sheetId),l=null===i||void 0===i?void 0:i.getBasicFilter();if(l&&a.type===p.a.ROWS&&r.startIndex!==o){t=l.range,n=l.getHiddenRows();var c=a.isIncludeFilterHead(t,r),u=a.isIncludeAllFilterRange(t,r);c&&(!u||u&&n&&n.length>0)&&(s={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u79fb\u52a8\u4e4b\u524d\u8bf7\u5148\u53d6\u6d88\u7b5b\u9009\u3002"}})}return s},a.mergeRangesCheck=function(e){var t=a.behaviors[0].from,n=a.behaviors[0].to,r=e.sheetManager.getSheetBySheetId(a.sheetId);if(null===r)return null;for(var o=r.mergeManager.mergeList,s=0,i=o.length;s<i;s++){var l=o[s],c=a.type===p.a.ROWS?a.mergeRangeRowCheck(n,t,l,o):a.mergeRangeColCheck(n,t,l,o);if(null!==c)return c}return null},a.checkConflictFilterType=function(e,t){var n=e.from;return{isMoveWholeFilterRow:a.type===p.a.ROWS&&n.startIndex<=t.startRowIndex&&n.endIndex>=t.endRowIndex,isMoveWholeFilteCol:a.type===p.a.COLUMNS&&n.startIndex<=t.startColIndex&&n.endIndex>=t.endColIndex,isMovePartFilterCol:a.type===p.a.COLUMNS&&!(n.endIndex<t.startColIndex||n.startIndex>t.endColIndex),isMovePartFilterRow:a.type===p.a.ROWS&&t.endRowIndex>=n.startIndex&&t.endRowIndex<=n.endIndex}},a.handleMovePartFilterCol=function(e,t,n){var r=e.from,o=e.to,s=o.startIndex-r.startIndex,i=r.endIndex-r.startIndex+1,l=t.startColIndex,c=t.endColIndex;o.startIndex<=t.startColIndex?(l=t.startColIndex+i,c=t.endColIndex+i):o.startIndex<=t.endColIndex&&(c=t.endColIndex+i),t.endColIndex>=r.startIndex&&t.endColIndex<=r.endIndex&&s>0&&(l=t.startColIndex,c=t.endColIndex+s),t.startColIndex>=r.startIndex&&t.startColIndex<=r.endIndex&&s<0&&(l=t.startColIndex+s,c=t.endColIndex+i);var u=new b.b(t.sheetId,t.startRowIndex,t.endRowIndex,l,c);return new _e.b({sheetId:a.sheetId,workbookRangeId:n,updateType:_e.a.UPDATE,delta:{range:u,defaultFilterId:n}})},a.updateRangeIfDeleteRowCol=function(e,t,n,r,a){var o=t.startIndex,s=t.endIndex,i=e.clone(),l=i.startRowIndex,c=i.endRowIndex,u=i.startColIndex,d=i.endColIndex,f=[],h=!1;if(n!==p.a.ROWS||e.isCol?n!==p.a.COLUMNS||e.isRow||(o<=u&&s>=d?h=!0:o<=d&&o>=u?(o>u&&f.push(new b.b(r,l,c,u,o-1)),s<d&&f.push(new b.b(r,l,c,s+1,d)),h=!0):s>=u&&s<=d?o<=u&&(f.push(new b.b(r,l,c,s+1,d)),h=!0):f.push(i)):o<=l&&s>=c?h=!0:o<=c&&o>=l?(o>l&&f.push(new b.b(r,l,o-1,u,d)),s<c&&f.push(new b.b(r,s+1,c,u,d)),h=!0):s>=l&&s<=c?o<=l&&(f.push(new b.b(r,s+1,c,u,d)),h=!0):f.push(i),h)if(n===p.a.ROWS){var g=Math.max(o,e.startRowIndex),m=Math.min(s,e.endRowIndex);f.push(new b.b(e.sheetId,g+a,m+a,e.startColIndex,e.endColIndex))}else{var v=Math.max(o,e.startColIndex),I=Math.min(s,e.endColIndex);f.push(new b.b(e.sheetId,e.startRowIndex,e.endRowIndex,v+a,I+a))}return{result:f,needUpdate:h}},a.handleUpperCrossWhenRowConflictWithColRange=function(e,t){var n=null;e.to.startIndex<e.from.startIndex?n=new b.b(t.range.sheetId,e.to.startIndex+t.range.startRowIndex-e.from.startIndex,t.range.endRowIndex,t.range.startColIndex,t.range.endColIndex):n=e.to.startIndex<=t.range.endRowIndex&&e.from.startIndex<t.range.startRowIndex?new b.b(t.range.sheetId,e.to.startIndex+t.range.startRowIndex-e.from.startIndex,t.range.endRowIndex,t.range.startColIndex,t.range.endColIndex):new b.b(t.range.sheetId,e.from.endIndex+1,t.range.endRowIndex,t.range.startColIndex,t.range.endColIndex);return n},a.handleDownCrossWhenRowConflictWithColRange=function(e,t){var n=null;e.to.startIndex>e.from.startIndex?n=new b.b(t.range.sheetId,t.range.startRowIndex,e.to.endIndex+t.range.endRowIndex-e.from.endIndex,t.range.startColIndex,t.range.endColIndex):n=e.to.startIndex>t.range.startRowIndex&&e.from.endIndex>t.range.endRowIndex?new b.b(t.range.sheetId,t.range.startRowIndex,e.to.endIndex+t.range.endRowIndex-e.from.endIndex,t.range.startColIndex,t.range.endColIndex):new b.b(t.range.sheetId,t.range.startRowIndex,e.from.startIndex-1,t.range.startColIndex,t.range.endColIndex);return n},a.handleLeftCrossWhenColConflictWithRowRange=function(e,t){var n=null;e.to.startIndex<e.from.startIndex?n=new b.b(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,e.to.startIndex+t.range.startColIndex-e.from.startIndex,t.range.endColIndex):n=e.to.startIndex<=t.range.endColIndex&&e.from.startIndex<t.range.startColIndex?new b.b(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,e.to.startIndex+t.range.startColIndex-e.from.startIndex,t.range.endColIndex):new b.b(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,e.from.endIndex+1,t.range.endColIndex);return n},a.handleRightCrossWhenColConflictWithRowRange=function(e,t){var n=null;e.to.startIndex>e.from.startIndex?n=new b.b(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,t.range.startColIndex,e.to.endIndex+t.range.endColIndex-e.from.endIndex):n=e.to.startIndex>t.range.startColIndex&&e.from.endIndex>t.range.endColIndex?new b.b(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,t.range.startColIndex,e.to.endIndex+t.range.endColIndex-e.from.endIndex):new b.b(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,t.range.startColIndex,e.from.startIndex-1);return n},a.sheetId=e.sheetId,a.type=e.type;var o=0,i=0;e.from&&e.from.dimension===a.type&&(o=e.from.startIndex,i=e.from.endIndex);var l={from:new m.a(a.sheetId,o,i,a.type),to:e.to};return a.behaviors=[l],a}return Object(i.a)(n,[{key:"predictRequestSize",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId),n=0,r=0;return t?(this.type===p.a.ROWS?r=t.getColCount():this.type===p.a.COLUMNS&&(r=t.getRowCount()),this.behaviors.forEach((function(e){n+=(e.from.endIndex-e.from.startIndex+1)*r*280})),n):0}},{key:"requestSizeOverLimitTips",value:function(){return"\u6570\u636e\u91cf\u8f83\u5927\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f\u3002\u5efa\u8bae\u5206\u6279\u79fb\u52a8".concat(this.type===p.a.ROWS?"\u884c":"\u5217","\u3002")}},{key:"check",value:function(e){var t=this.behaviors[0].to,n=this.commonDimensionCheck(e);if(null!==n)return n;var r=this.basicFilterCheck(e);if(null!==r)return r;var a=this.mergeRangesCheck(e);if(null!==a)return a;var o=this.gridRangeCheck(e,t);return null!==o?o:null}},{key:"isIncludeFilterHead",value:function(e,t){return e.startRowIndex>=t.startIndex&&e.startRowIndex<=t.endIndex}},{key:"isIncludeAllFilterRange",value:function(e,t){return e.startRowIndex>=t.startIndex&&e.endRowIndex<=t.endIndex}},{key:"mergeRangeRowCheck",value:function(e,t,n,r){var a=null;if(e>n.startRowIndex&&e<=n.endRowIndex)return a={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u62b1\u6b49\uff0c\u65e0\u6cd5\u5c06\u884c\u79fb\u5230\u7a7f\u8d8a\u67d0\u4e2a\u5408\u5e76\u5355\u5143\u683c\u7684\u4f4d\u7f6e\u3002\u8bf7\u53d6\u6d88\u5408\u5e76\uff0c\u7136\u540e\u91cd\u8bd5\u3002"}},Ce(r,t,new m.a(t.sheetId,e,e+t.endIndex-t.startIndex,t.dimension)),a;var o=new m.a(n.sheetId,n.startRowIndex,n.endRowIndex,p.a.ROWS);return t.isCross(o)&&!t.isContain(o)?(a={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u62b1\u6b49\uff0c\u65e0\u6cd5\u79fb\u52a8\u53ea\u5305\u542b\u5408\u5e76\u5355\u5143\u683c\u7684\u4e00\u90e8\u5206\u7684\u884c\u3002\u8bf7\u53d6\u6d88\u5408\u5e76\uff0c\u7136\u540e\u91cd\u8bd5\u3002"}},Ce(r,t,new m.a(t.sheetId,e,e+t.endIndex-t.startIndex,t.dimension)),a):a}},{key:"mergeRangeColCheck",value:function(e,t,n,r){var a=null;if(e>n.startColIndex&&e<=n.endColIndex)return a={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u62b1\u6b49\uff0c\u65e0\u6cd5\u5c06\u5217\u79fb\u5230\u7a7f\u8d8a\u67d0\u4e2a\u5408\u5e76\u5355\u5143\u683c\u7684\u4f4d\u7f6e\u3002\u8bf7\u53d6\u6d88\u5408\u5e76\uff0c\u7136\u540e\u91cd\u8bd5\u3002"}},Ce(r,t,new m.a(t.sheetId,e,e+t.endIndex-t.startIndex,t.dimension)),a;var o=new m.a(n.sheetId,n.startColIndex,n.endColIndex,p.a.COLUMNS);return t.isCross(o)&&!t.isContain(o)?(a={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u62b1\u6b49\uff0c\u65e0\u6cd5\u79fb\u52a8\u53ea\u5305\u542b\u5408\u5e76\u5355\u5143\u683c\u7684\u4e00\u90e8\u5206\u7684\u5217\u3002\u8bf7\u53d6\u6d88\u5408\u5e76\uff0c\u7136\u540e\u91cd\u8bd5\u3002"}},Ce(r,t,new m.a(t.sheetId,e,e+t.endIndex-t.startIndex,t.dimension)),a):a}},{key:"gridRangeCheck",value:function(e,t){var n=null,r=this.type===p.a.ROWS?t:b.a,a=this.type===p.a.COLUMNS?t:b.a,o=this.type===p.a.ROWS?t-1:b.a,s=this.type===p.a.COLUMNS?t-1:b.a,i=new b.b(this.sheetId,o,o,s,s),l=new b.b(this.sheetId,r,r,a,a),c=e.parent.sheetStatus.getRangeCanEdit(i),u=e.parent.sheetStatus.getRangeCanEdit(l);return c||u||(n={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u521b\u5efa\u4eba\u300c".concat(window.clientVars.ownerNick,"\u300d\u8bbe\u7f6e\u4e86\u4fdd\u62a4\u8303\u56f4\uff0c\u4f60\u6ca1\u6709\u6743\u9650\u8fdb\u884c\u6b64\u64cd\u4f5c\u3002\u5982\u9700\u7f16\u8f91\uff0c\u8bf7\u8054\u7cfb\u521b\u5efa\u8005\u6388\u4e88\u6743\u9650\u3002")}}),n}},{key:"do",value:function(e,t,n){var r,a,o,s,i=t.sheetManager.getSheetBySheetId(this.sheetId),l=0,c=e.to;if(null!==i){var u=i.getBasicFilter(),d=e.from,f=Object(U.divideDimensionRangeByFilter)([d],u),p=0,g=0;for(a=0;a<f.length;a++)c<f[a].startIndex?c+=g:p+=g,f[a].startIndex-=p,f[a].endIndex-=p,g=(e={from:f[a],to:c}).from.endIndex-e.from.startIndex+1,n(new h.a({index:c,amount:g,type:this.type,sheetId:this.sheetId})),(r=new m.a(this.sheetId,e.from.startIndex,e.from.endIndex,this.type)).insertDimension({sheetId:this.sheetId,index:e.to,amount:g,type:this.type}),l=(o={from:r,to:new m.a(this.sheetId,c,c+g-1,this.type)}).to.startIndex-o.from.startIndex,this.doMapRange(o,e,n),this.doSetDimensionProperties(o,l,i,n),this.doSetRange(o,i,l,n),this.doSetCellProperties(o,i,n),(s=this.beforeMoveDimension(t,o,this.type)).beforeMutations,s.afterMutations.forEach((function(e){n(e)})),n(new fe.a({index:o.from.startIndex,amount:g,type:this.type,sheetId:this.sheetId}))}}},{key:"doMapRange",value:function(e,t,n){var r,a={from:{startIndex:e.from.startIndex,endIndex:e.from.endIndex},to:t.to,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId},o={from:{startIndex:-1,endIndex:-1},to:-1,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId};this.type===p.a.ROWS?r=new he.a({row:a,column:o,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId}):this.type===p.a.COLUMNS&&(r=new he.a({row:o,column:a,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId})),n(r)}},{key:"doSetDimensionProperties",value:function(e,t,n,r){var a,o=0,s=Object(g.d)({sheet:n,type:this.type,ranges:[e.from]},{hiddenByUser:!0,pixelSize:!0,ignoreDefaultHidden:!0,ignoreDefaultSize:!0,formData:!0});for(o=0;o<s.length;o++)(a=s[o]).operation.length>0&&(a.ranges.forEach((function(e){e.startIndex+=t,e.endIndex+=t})),r(a))}},{key:"getGridRange",value:function(e,t){var n;return this.type===p.a.ROWS?n=new b.b(this.sheetId,e.from.startIndex,e.from.endIndex,0,t.getColCount()-1):this.type===p.a.COLUMNS&&(n=new b.b(this.sheetId,0,t.getRowCount()-1,e.from.startIndex,e.from.endIndex)),n}},{key:"doSetRange",value:function(e,t,n,r){var a,o=this,s=this.getGridRange(e,t);s&&((a=this.getSetRangeMutation(t,s,n)).cellDataDeltaAtPositions.length>0&&(this.type===p.a.ROWS?(a.gridRange.startRowIndex+=n,a.gridRange.endRowIndex+=n):this.type===p.a.COLUMNS&&(a.gridRange.startColIndex+=n,a.gridRange.endColIndex+=n),a.cellDataDeltaAtPositions.forEach((function(e){o.type===p.a.ROWS?e.rowIndex+=n:o.type===p.a.COLUMNS&&(e.colIndex+=n)}))),r(a))}},{key:"doSetCellProperties",value:function(e,t,n){var r=this.getGridRange(e,t);r&&n(new K.a({gridRange:r,cellDataDelta:new Ie.a({setSlots:0,clearSlots:I.a.ALL,delta:{}})}))}},{key:"getSetRangeMutation",value:function(e,t,n){var r,a,o,s,i=[],l=e.getSheetId();for(a=t.startRowIndex;a<=t.endRowIndex;a++)for(r=t.startColIndex;r<=t.endColIndex;r++){o=e.getCellDataAtPosition(a,r);var c=this.type===p.a.ROWS?a+n:a,u=this.type===p.a.ROWS?r:r+n;s=Object(_.createCellDataDelta)({cellData:null,rowIndex:c,colIndex:u,sheetId:l},{cellData:o,rowIndex:a,colIndex:r,sheetId:l});var d=e.getCellDataAtPosition(c,u),f=null===d||void 0===d?void 0:d.getFormula();f&&s.setSlot(I.b.SLOT_FORMULA,f),i.push({rowIndex:a,colIndex:r,cellDataDelta:s})}return new v.a({gridRange:t,cellDataDeltaAtPositions:i})}},{key:"beforeMoveDimension",value:function(e,t,n){var r=[],a=[],s=this.conflictMerge(t,e);r.push.apply(r,Object(o.a)(s.beforeMutations)),a.push.apply(a,Object(o.a)(s.afterMutations));var i=this.conflictFilter(t,e);r.push.apply(r,Object(o.a)(i.beforeMutations)),a.push.apply(a,Object(o.a)(i.afterMutations));var l=this.conflictWorkbooRange(t,n,e);a.push.apply(a,Object(o.a)(l.afterMutations));var c=this.conflictConditionalFormat(t,n,e);a.push.apply(a,Object(o.a)(c.afterMutations));var u=this.conflictWorkbookRange(t,n,e);return a.push.apply(a,Object(o.a)(u.afterMutations)),{beforeMutations:r,afterMutations:a}}},{key:"conflictWorkbooRange",value:function(e,t,n){var r=e.from,a=e.to.startIndex-r.startIndex,o={beforeMutations:[],afterMutations:[]},s=n.sheetManager.getSheetBySheetId(this.sheetId);return s.sheetRangeManager.each((function(e,n){var i=e.gridRange;t===p.a.ROWS?i.startRowIndex>=r.startIndex&&i.endRowIndex<=r.endIndex&&o.afterMutations.push(new Ee.a({sheetId:s.getSheetId(),sheetRangeId:n,gridRange:new b.b(s.getSheetId(),i.startRowIndex+a,i.endRowIndex+a,i.startColIndex,i.endColIndex),sheetRangeType:e.sheetRangeType,nonPersistingLocalChange:!1,padId:e.padId})):i.startColIndex>=r.startIndex&&i.endColIndex<=r.endIndex&&o.afterMutations.push(new Ee.a({sheetId:s.getSheetId(),sheetRangeId:n,gridRange:new b.b(s.getSheetId(),i.startRowIndex,i.endRowIndex,i.startColIndex+a,i.endColIndex+a),sheetRangeType:e.sheetRangeType,nonPersistingLocalChange:!1,padId:e.padId}))})),o}},{key:"conflictMerge",value:function(e,t){var n,r,a,o,s=e.from,i=e.to,l=t.sheetManager.getSheetBySheetId(this.sheetId),c=l.mergeManager.mergeList,u=i.startIndex-s.startIndex,d=[],f=[],h={beforeMutations:[],afterMutations:[]};if(0===c.length)return h;for(r=0;r<c.length;r++)n=c[r],this.type===p.a.ROWS?n.startRowIndex>=s.startIndex&&n.endRowIndex<=s.endIndex&&(a=new b.b(n.sheetId,n.startRowIndex+u,n.endRowIndex+u,n.startColIndex,n.endColIndex),(o=n.clone()).insertDimension({sheetId:o.sheetId,type:p.a.ROWS,index:i.startIndex,amount:s.endIndex-s.startIndex+1}),d.push(a),f.push(n)):this.type===p.a.COLUMNS&&n.startColIndex>=s.startIndex&&n.endColIndex<=s.endIndex&&(a=new b.b(n.sheetId,n.startRowIndex,n.endRowIndex,n.startColIndex+u,n.endColIndex+u),(o=n.clone()).insertDimension({sheetId:o.sheetId,type:p.a.COLUMNS,index:i.startIndex,amount:s.endIndex-s.startIndex+1}),d.push(a),f.push(n));return new pe.a({sheetId:l.getSheetId(),gridRanges:d}).run(t,(function(e){h.afterMutations.push(e)})),new ve({sheetId:l.getSheetId(),gridRanges:f}).run(t,(function(e){h.afterMutations.push(e)})),h}},{key:"conflictFilter",value:function(e,t){var n=e.from,r=e.to,a=t.sheetManager.getSheetBySheetId(this.sheetId),o=r.startIndex-n.startIndex,s=a.getBasicFilter(),i={beforeMutations:[],afterMutations:[]};if(null===s)return i;var l,c=s.range,u=s.workbookRangeId,d=s.getHiddenRows(),f=this.checkConflictFilterType(e,c),h=f.isMoveWholeFilterRow,p=f.isMoveWholeFilteCol,g=f.isMovePartFilterCol,m=f.isMovePartFilterRow;if(h)l=new b.b(c.sheetId,c.startRowIndex+o,c.endRowIndex+o,c.startColIndex,c.endColIndex),d=d.map((function(e){return e+o})),i.afterMutations.push(new _e.b({sheetId:this.sheetId,workbookRangeId:u,updateType:_e.a.UPDATE,delta:{hiddenRows:d,range:l,defaultFilterId:u}}));else if(p){l=new b.b(c.sheetId,c.startRowIndex,c.endRowIndex,c.startColIndex+o,c.endColIndex+o);var v=s.criteriaMap,I={};v.forEach((function(e,t){I[+t+o]=e})),i.afterMutations.push(new ye.a({sheetId:this.sheetId,delta:{defaultFilterId:u}})),i.afterMutations.push(new Re.a({sheetId:this.sheetId,gridRange:l,delta:{defaultFilterId:u,hiddenRows:d,criteriaDelta:I}}))}else if(g){var _=this.handleMovePartFilterCol(e,c,u);i.afterMutations.push(_)}else if(m){var y=n.endIndex-n.startIndex+1,R=c.startRowIndex,E=c.endRowIndex;r.startIndex<=R&&(R+=y,E+=y),l=new b.b(c.sheetId,R,E,c.startColIndex,c.endColIndex),i.afterMutations.push(new _e.b({sheetId:this.sheetId,workbookRangeId:u,updateType:_e.a.UPDATE,delta:{range:l,defaultFilterId:u}}))}return i}},{key:"conflictConditionalFormat",value:function(e,t,n){var r=this,a={beforeMutations:[],afterMutations:[]},s=this.sheetId,i=n.sheetManager.getSheetBySheetId(s).conditionalFormatRuleManager.rules,l=i.length;if(!(l>0))return a;for(var c=e.from,u=e.to,d=u.startIndex-c.startIndex,f=c.endIndex-c.startIndex+1,h=function(e){var n=i[e],l=n.rule.ruleRanges,h=[],g=[],m=!1;if(l.forEach((function(e){var n=function(e){var n=u.startIndex,r=e.clone(),a=[r],o=!1;return t===p.a.ROWS?n>r.startRowIndex&&n<=r.endRowIndex&&(r.insertDimension({sheetId:r.sheetId,type:p.a.ROWS,index:n,amount:f}),o=!0):n>r.startColIndex&&n<=r.endColIndex&&(r.insertDimension({sheetId:r.sheetId,type:p.a.COLUMNS,index:n,amount:f}),o=!0),{result:a,needUpdate:o}}(e);n.needUpdate&&(m=!0),h.push.apply(h,Object(o.a)(n.result))})),h.forEach((function(e){var n,a=r.updateRangeIfDeleteRowCol(e,c,t,s,d);a.needUpdate&&(m=!0),(n=g).push.apply(n,Object(o.a)(a.result))})),g=Object(Oe.mergeMultiRanges)(g),m){var b=new O.a({ruleRanges:g,booleanConditionalFormat:n.rule.booleanConditionalFormat,uid:n.rule.uid});a.afterMutations.push(new S.a({sheetId:s,ruleIndex:n.index,rule:b,oldRuleRanges:l}))}},g=0;g<l;g++)h(g);return a}},{key:"conflictWorkbookRange",value:function(e,t,n){var r,a=this,o={beforeMutations:[],afterMutations:[]};return n.workbookRangeManager.each((function(t){if(a.sheetId===t.range.sheetId&&t.type!==we.a.CHART){var n=new ke.a;if(t.type===we.a.PROTECTED_RANGE)n.setProtectionProperties(t.properties);else if(t.type===we.a.LINKED_RANGE){var s=t.properties;s&&n.setLinkedRangeProperties(s)}r=null;var i=a.type===p.a.ROWS&&!t.range.isCol,l=a.type===p.a.COLUMNS&&!t.range.isRow;i?r=a.rowConflictWithColRange(e,t):l&&(r=a.colConflictWithRowRange(e,t)),r&&o.afterMutations.push(new Te.a({workbookRangeId:t.id,workbookRangeType:t.type,gridRange:r,workbookRangePropertiesDelta:n}))}})),o}},{key:"rowConflictWithColRange",value:function(e,t){var n=null,r=e.from.startIndex<=t.range.startRowIndex&&e.from.endIndex>=t.range.endRowIndex,a=e.from.startIndex<=t.range.startRowIndex&&e.from.endIndex>=t.range.startRowIndex,o=e.from.startIndex<=t.range.endRowIndex&&e.from.endIndex>=t.range.endRowIndex;return r?n=new b.b(t.range.sheetId,e.to.startIndex+t.range.startRowIndex-e.from.startIndex,e.to.endIndex+t.range.endRowIndex-e.from.endIndex,t.range.startColIndex,t.range.endColIndex):a?this.handleUpperCrossWhenRowConflictWithColRange(e,t):o?this.handleDownCrossWhenRowConflictWithColRange(e,t):n}},{key:"colConflictWithRowRange",value:function(e,t){var n=null,r=e.from.startIndex<=t.range.startColIndex&&e.from.endIndex>=t.range.endColIndex,a=e.from.startIndex<=t.range.startColIndex&&e.from.endIndex>=t.range.startColIndex,o=e.from.startIndex<=t.range.endColIndex&&e.from.endIndex>=t.range.endColIndex;return r?n=new b.b(t.range.sheetId,t.range.startRowIndex,t.range.endRowIndex,e.to.startIndex+t.range.startColIndex-e.from.startIndex,e.to.endIndex+t.range.endColIndex-e.from.endIndex):a?this.handleLeftCrossWhenColConflictWithRowRange(e,t):o?this.handleRightCrossWhenColConflictWithRowRange(e,t):n}},{key:"id",get:function(){return n.id}}]),n}(f.a);De.id=a.a.MOVE_DIMENSION_REQUEST,xe([Object(T.b)(De)],De.prototype,"predictRequestSize",null);var Ae=De,Me=n("../packages/mutation/src/sheet/UpdateAllSheetsMutation.ts");function Le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ne=function(e){Object(l.a)(n,e);var t=Le(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).canUndoRedo=!1,a.behaviors=e.behaviors,a.sheetId=e.sheetId,a}return Object(i.a)(n,[{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"do",value:function(e,t,n){n(new Me.a({sheetId:this.sheetId,data:e}))}},{key:"afterdo",value:function(){}},{key:"id",get:function(){return n.id}}]),n}(f.a);Ne.id=a.a.SET_SHEETS_REQUEST;var Ue=Ne,Pe=n("../packages/model/src/cell/CellFormatDelta.ts"),Fe=n("./src/core/behavior/request/enum/FormatItem.ts"),Be=n("../packages/model/src/cell/CellFormatSlot.ts"),He=n("./src/base/util/timer.ts");function Ge(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ze=function(e){Object(l.a)(n,e);var t=Ge(n);function n(e,r){var a,o,i,l;Object(s.a)(this,n);var c=(a=t.call(this,e,r)).normalizeFormatValue(e.formatItem,e.formatValue),u=null==e.formatValue;if(e.gridRange)l={gridRange:e.gridRange,formatItem:e.formatItem,formatValue:c,isClear:u},a.behaviors.push(l);else if(r)for(o=0,i=r.rangeSelections.length;o<i;o++)l={gridRange:r.rangeSelections[o],formatItem:e.formatItem,formatValue:c,isClear:u},a.behaviors.push(l);return a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r,a,o=this.getCellDataDelta(e),s=[e.gridRange],i=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId);if(!o.isEmpty()&&i){s=Object(U.divideGridRangesByFilter)(s,i.getBasicFilter());for(var l=0,c=(s=Object(U.divideGridRangesByMerges)(s,i.mergeManager.mergeList)).length;l<c;l++){a=s[l],n(new K.a({gridRange:a,cellDataDelta:o}));for(var u=a.startRowIndex;u<=a.endRowIndex;u++)for(var d=a.startColIndex;d<=a.endColIndex;d++)(r=Object(N.c)(i,u,d,o)).isEmpty()||n(new K.a({gridRange:new b.b(e.gridRange.sheetId,u,u,d,d),cellDataDelta:r}))}He.a.wait(1e3).run((function(){for(var t=e.gridRange.startRowIndex,n=e.gridRange.endRowIndex;t<=n;t++)for(var r=e.gridRange.startColIndex,a=e.gridRange.endColIndex;r<=a;r++){var o=null===i||void 0===i?void 0:i.getCellDataAtPosition(t,r);(null===o||void 0===o?void 0:o.getHyperlink())&&Se.b.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url_style"})}}))}}},{key:"getCellDataDelta",value:function(e){var t,n,a=e.isClear,o=e.formatItem,s=new Pe.a,i=(t={},Object(r.a)(t,Fe.a.FONT_FAMINY,(function(){return s.clearSlot(Be.b.FONT_FAMINY)})),Object(r.a)(t,Fe.a.FONT_SIZE,(function(){return s.clearSlot(Be.b.FONT_SIZE)})),Object(r.a)(t,Fe.a.BOLD,(function(){return s.clearSlot(Be.b.BOLD)})),Object(r.a)(t,Fe.a.ITALIC,(function(){return s.clearSlot(Be.b.ITALIC)})),Object(r.a)(t,Fe.a.WRAP_STRATEGY,(function(){return s.clearSlot(Be.b.WRAP_STRATEGY)})),Object(r.a)(t,Fe.a.HORIZONTAL_ALIGN,(function(){return s.clearSlot(Be.b.HORIZONTAL_ALIGN)})),Object(r.a)(t,Fe.a.VERTICAL_ALIGN,(function(){return s.clearSlot(Be.b.VERTICAL_ALIGN)})),Object(r.a)(t,Fe.a.COLOR,(function(){return s.clearSlot(Be.b.FOREGROUND_COLOR)})),Object(r.a)(t,Fe.a.BACKGROUND_COLOR,(function(){return s.clearSlot(Be.b.BACKGROUND_COLOR)})),Object(r.a)(t,Fe.a.STRIKE_THROUGH,(function(){return s.clearSlot(Be.b.STRIKETHROUGH)})),Object(r.a)(t,Fe.a.UNDERLINE,(function(){return s.clearSlot(Be.b.UNDERLINE)})),t),l=(n={},Object(r.a)(n,Fe.a.FONT_FAMINY,(function(){return s.setSlot(Be.b.FONT_FAMINY,e.formatValue)})),Object(r.a)(n,Fe.a.FONT_SIZE,(function(){return s.setSlot(Be.b.FONT_SIZE,e.formatValue)})),Object(r.a)(n,Fe.a.BOLD,(function(){return s.setSlot(Be.b.BOLD,e.formatValue)})),Object(r.a)(n,Fe.a.ITALIC,(function(){return s.setSlot(Be.b.ITALIC,e.formatValue)})),Object(r.a)(n,Fe.a.WRAP_STRATEGY,(function(){return s.setSlot(Be.b.WRAP_STRATEGY,e.formatValue)})),Object(r.a)(n,Fe.a.HORIZONTAL_ALIGN,(function(){return s.setSlot(Be.b.HORIZONTAL_ALIGN,e.formatValue)})),Object(r.a)(n,Fe.a.VERTICAL_ALIGN,(function(){return s.setSlot(Be.b.VERTICAL_ALIGN,e.formatValue)})),Object(r.a)(n,Fe.a.COLOR,(function(){return s.setSlot(Be.b.FOREGROUND_COLOR,e.formatValue)})),Object(r.a)(n,Fe.a.BACKGROUND_COLOR,(function(){return s.setSlot(Be.b.BACKGROUND_COLOR,e.formatValue)})),Object(r.a)(n,Fe.a.STRIKE_THROUGH,(function(){return s.setSlot(Be.b.STRIKETHROUGH,e.formatValue)})),Object(r.a)(n,Fe.a.UNDERLINE,(function(){return s.setSlot(Be.b.UNDERLINE,e.formatValue)})),n);a?i[o]&&i[o]():l[o]&&l[o]();var c=new Ie.a;return c.setSlot(I.b.SLOT_USER_ENTERED_FORMAT_DELTA,s),c}},{key:"normalizeFormatValue",value:function(e,t){var n,a=this,o=(n={},Object(r.a)(n,Fe.a.FONT_FAMINY,(function(){return a.normalizeFontFamily(t)})),Object(r.a)(n,Fe.a.FONT_SIZE,(function(){return a.normalizeFontSize(t)})),Object(r.a)(n,Fe.a.BOLD,(function(){return a.normalizeBold(t)})),Object(r.a)(n,Fe.a.ITALIC,(function(){return a.normalizeItalic(t)})),Object(r.a)(n,Fe.a.WRAP_STRATEGY,(function(){return a.normalizeWrapStrategy(t)})),Object(r.a)(n,Fe.a.HORIZONTAL_ALIGN,(function(){return a.normalizeHorizontalAlign(t)})),Object(r.a)(n,Fe.a.VERTICAL_ALIGN,(function(){return a.normalizeVerticalAlign(t)})),Object(r.a)(n,Fe.a.COLOR,(function(){return a.normalizeColor(t)})),Object(r.a)(n,Fe.a.BACKGROUND_COLOR,(function(){return a.normalizeColor(t)})),Object(r.a)(n,Fe.a.STRIKE_THROUGH,(function(){return a.normalizeStrikethrough(t)})),Object(r.a)(n,Fe.a.UNDERLINE,(function(){return a.normalizeUnderline(t)})),n);if(o[e])return o[e]()}},{key:"normalizeFontFamily",value:function(e){return e}},{key:"normalizeFontSize",value:function(e){return e}},{key:"normalizeBold",value:function(e){return e}},{key:"normalizeItalic",value:function(e){return e}},{key:"normalizeWrapStrategy",value:function(e){return e}},{key:"normalizeHorizontalAlign",value:function(e){return e}},{key:"normalizeVerticalAlign",value:function(e){return e}},{key:"normalizeColor",value:function(e){return e}},{key:"normalizeStrikethrough",value:function(e){return e}},{key:"normalizeUnderline",value:function(e){return e}},{key:"id",get:function(){return n.id}}]),n}(f.a);ze.id=a.a.SET_FORMAT_REQUEST;var qe=ze,Ve=(n("../node_modules/core-js/modules/es.number.constructor.js"),n("../packages/mutation/src/sheet/SetSheetPropertiesMutation.ts")),Qe=n("../packages/model/src/sheet/SheetPropertiesDelta.ts"),We=n("../packages/model/src/sheet/SheetPropertiesSlotOperation.ts"),Ye=n("../packages/mutation/src/new-embedded/NewUpdateEmbeddedObjectMutation.ts");function Ke(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ze=function(e){Object(l.a)(n,e);var t=Ke(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheetId,a.behaviors=[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){void 0!==e.row&&n(new Ve.a({sheetId:this.sheetId,sheetDelta:new Qe.b({operation:We.a.SET_PROPERTIES,delta:{frozenRowCount:e.row}})})),void 0!==e.column&&n(new Ve.a({sheetId:this.sheetId,sheetDelta:new Qe.b({operation:We.a.SET_PROPERTIES,delta:{frozenColCount:e.column}})})),t.embeddedObjectManager.each((function(t){var r=t.location.position,a=r.rowIndex,o=r.colIndex;if(a<Number(e.row)||o<Number(e.column)){var s=t.clone();s.location.position={rowIndex:Math.max(a,Number(e.row)),colIndex:Math.max(o,Number(e.column))},n(new Ye.a({object:s}))}}))}},{key:"check",value:function(e){var t=null,n=e.sheetManager.getSheetBySheetId(this.sheetId),r=this.behaviors[0].column||0,a=this.behaviors[0].row||0;if(null===n)return{isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}};if(0===r&&0===a){this.behaviors[0].column=1,this.behaviors[0].row=1;var o=n.properties.gridProperties;if(1!==o.frozenColCount||1!==o.frozenRowCount)return t={isWarningOnly:!0,warning:{title:"\u51bb\u7ed3\u7a97\u683c",content:"\u786e\u5b9a\u8981\u51bb\u7ed3\u9996\u884c\u548c\u9996\u5217\u5417\uff1f",repeat:!0}}}return-1===r&&(this.behaviors[0].column=0),-1===a&&(this.behaviors[0].row=0),t}},{key:"id",get:function(){return n.id}}]),n}(f.a);Ze.id=a.a.FREEZE_REQUEST;var Xe,Je=Ze,$e=n("./src/core/behavior/request/cell/SetSingleValueRequest.ts"),et=(n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../packages/mutation/src/other/ReorderRangeMutation.ts")),tt=(n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.math.sign.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("./src/core/feature/formula/utils.ts")),nt=n("../node_modules/pinyin/lib/web-pinyin.js"),rt=n.n(nt);!function(e){e[e.KEEP=1]="KEEP",e[e.EXCHANGE=-1]="EXCHANGE",e[e.EQUAL=0]="EQUAL"}(Xe||(Xe={}));var at=function(e){return e?Xe.EXCHANGE:Xe.KEEP},ot=function(e){return e?Xe.KEEP:Xe.EXCHANGE},st=function(e,t,n,r,a){return e<t?at(n):e>t?ot(n):Xe.EQUAL},it=function(e){return"string"===typeof e&&("TRUE"===(e+="").toUpperCase()||"FALSE"===e.toUpperCase())},lt=function(e){return"string"===typeof e?Object(tt.v)(e):!("object"!==Object(d.a)(e)||!e.displayText)&&Object(tt.v)(e.displayText)},ct=function(e){return"string"===typeof e&&/^\s+/.test(e+="")},ut=function(e){if("string"!==typeof e)return!1;e=e[0];return/[!"#\$%&()\*,\.\/:;\?@\[\\,\]\^_\\`{|}~+<=>]+/gi.test(e+="")||/[\uff01\u3002\uff1f\u3001\uff1b\uff1a\u201c\u201d\u3010\u3011\u3014\uff08\uff09\[\]\u300c\u300d}\u3015\uff0e\u300a\u300b\xb7\u2014_*\xd7\u25a1\u25b2\u25cf\uff5e\u2192]+/gi.test(e)},dt=["!",'"',"#","$","%","&","(",")","*",",",".","/",":",";","?","@","[","\\","]","^","_","`","{","|","}","~","+","<",">"],ft=function(e){return"string"===typeof e&&!ct(e)&&!ut(e)},ht=function(e){return-1!==e.indexOf("-")?e.replace(/-/gi,""):e},pt=function(e){return-1!==e.indexOf("'")?e.replace(/'/gi,""):e},gt=function(e){return/[\u4e00-\u9fa5]+/g.test(e)},mt=function(e,t,n,r,a){if("string"===typeof e&&(e=e.toLowerCase()),"string"===typeof t&&(t=t.toLowerCase()),!("string"===typeof e)&&!("string"===typeof t))return null;var o=function(e,t,n,r,a){var o=ft(t),s=ft(e);return o&&(t=ht(t),t=pt(t)),s&&(e=ht(e),e=pt(e)),gt(t)&&gt(e)?n?rt.a.compare(e,t):rt.a.compare(t,e):s&&o?st(e,t,n):s?ot(n):o?at(n):null}(e,t,n);if(null!=o)return o;var s=function(e,t,n,r,a){var o=ut(e)&&!ct(e),s=ut(t)&&!ct(t);if(o&&s){var i=dt.indexOf(t),l=dt.indexOf(e);return-1!=i&&-1!=l?st(l,i,n):st(e,t,n)}return o?ot(n):s?at(n):null}(e,t,n);if(null!=s)return s;var i=function(e,t,n,r,a){var o=ct(e[0]),s=ct(t[0]);return o&&s?st(e,t,n):o?ot(n):s?at(n):null}(e,t,n);return null!=i?i:null};function bt(e){var t,n,r=(null===(t=e.getMetadata())||void 0===t?void 0:t.customDataType)===R.o.CHECKBOX&&(null===(n=e.getEffectiveValue())||void 0===n?void 0:n.value);return"string"===typeof r?r===R.n?1:-1:0}function vt(e){var t,n,r=(null===(t=e.getMetadata())||void 0===t?void 0:t.customDataType)===R.o.STAR&&(null===(n=e.getEffectiveValue())||void 0===n?void 0:n.value);if("string"===typeof r){var a=r.indexOf(R.g);return a<0?R.m+1:a+1}return 0}function It(e,t,n,r){var a=r(e),o=r(t);return a&&o?Math.sign(a-o)*(n?1:-1):a?n?Xe.EXCHANGE:Xe.KEEP:o?n?Xe.KEEP:Xe.EXCHANGE:null}var _t=function(e,t,n,r,a,o,s,i){var l=n.type,c=function(e,t,n,r,a){var o=null===e||""===e||void 0===e,s=null===t||""===t||void 0===t;return o&&s?Xe.EQUAL:o?Xe.KEEP:s?Xe.EXCHANGE:null}(e,t);if(null!=c)return c;var u=function(e,t,n,r,a,o,s){var i,l,c=(null===(i=e.getMetadata())||void 0===i?void 0:i.customDataType)===R.o.IMAGE,u=(null===(l=t.getMetadata())||void 0===l?void 0:l.customDataType)===R.o.IMAGE;return c&&u?Xe.EQUAL:c?Xe.KEEP:u?Xe.EXCHANGE:null}(o,s);if(null!=u)return u;var d=function(e,t,n){return It(e,t,n,bt)}(o,s,l);if(null!=d)return d;var f=function(e,t,n){return It(e,t,n,vt)}(o,s,l);if(null!=f)return f;var h=function(e,t,n,r,a){var o=lt(e),s=lt(t);return o&&s?Xe.EQUAL:o?ot(n):s?at(n):null}(e,t,l);if(null!=h)return h;var p=function(e,t,n,r,a){"string"===typeof e&&(e=e.toLowerCase()),"string"===typeof t&&(t=t.toLowerCase());var o=it(e),s=it(t);return o&&s?st(e,t,n):o?ot(n):s?at(n):null}(e,t,l);if(null!=p)return p;var g=mt(e,t,l);if(null!=g)return g;var m=function(e,t,n,r,a){var o="number"===typeof e,s="number"===typeof t;if(o&&s){var i=parseFloat(e),l=parseFloat(t);return st(i,l,n)}return o?ot(n):s?at(n):null}(e,t,l);return null!=m?m:Xe.EQUAL},yt=n("../packages/model/src/cell/ExtendedValueType.ts"),Rt=n("./src/core/data/configService/spreadConfig.ts");function Et(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ot=function(e){Object(l.a)(n,e);var t=Et(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheetId,a.gridRange=e.gridRange,a.behaviors=[{reorderInfos:e.reorderInfos,hasTitle:e.hasTitle}],a}return Object(i.a)(n,[{key:"check",value:function(e){var t=null,n=e.sheetManager.getSheetBySheetId(this.sheetId),r=this.gridRange;if(null===n)return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}};for(var a=n.mergeManager.mergeList,o=0;o<a.length;o++){var s=a[o];if(r.isCross(s)){var i="";return s.startColIndex===s.endColIndex&&s.startRowIndex!==s.endRowIndex?i="\u7eb5\u5411\u7684":s.startColIndex!==s.endColIndex&&s.startRowIndex===s.endRowIndex&&(i="\u6a2a\u5411\u7684"),t={isWarningOnly:!1,error:{title:"\u6392\u5e8f\u63d0\u793a",content:"\u4f60\u7684\u6392\u5e8f\u533a\u57df\u4e2d\u5305\u542b".concat(i,"\u5408\u5e76\u5355\u5143\u683c ").concat(s.toString()," \uff0c\u8bf7\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c\u540e\u518d\u8fdb\u884c\u6392\u5e8f\u3002")}}}}return t}},{key:"do",value:function(e,t,n){var r,a=this.gridRange,o=t.sheetManager.getSheetBySheetId(this.sheetId),s=e.hasTitle;if(void 0!==o){for(var i=this.createUnmergeCellsMutations(t),l=0;l<i.length;l++)n(i[l]);var c=this.reorder(o,a,s,e.reorderInfos),u=this.createUpdateSheetRangeMutations(t,c,a);n(new et.a({sheetId:this.sheetId,range:a,operation:c})),u.length>0&&u.forEach((function(e){n(e)}));for(var d=0;d<i.length;d++)i[d]instanceof ge.a&&(r=i[d].startRowIndex,c.rules[r]?n(new y.a({sheetId:this.sheetId,startRowIndex:c.rules[r].to,endRowIndex:c.rules[r].to,startColIndex:i[d].startColIndex,endColIndex:i[d].endColIndex})):n(new y.a({sheetId:this.sheetId,startRowIndex:i[d].startRowIndex,endRowIndex:i[d].endRowIndex,startColIndex:i[d].startColIndex,endColIndex:i[d].endColIndex})))}}},{key:"reorder",value:function(e,t,n,r){var a,o,s,i={queue:[],rules:{}},l=[],c=[];for(o=t.startRowIndex<0?e.data.startRow:t.startRowIndex,s=t.endRowIndex<0?e.data.rowData.length-1:t.endRowIndex,n&&(o+=1),a=o;a<=s;a++)e.data.isRowHidden(a)||(l.push({index:a}),c.push({index:a,value:this.getCellData(e,a,r)}));for(c.sort(St(r,e)),a=0;a<c.length;a++)c[a].index!==l[a].index&&(i.queue.push("".concat(c[a].index)),i.rules["".concat(c[a].index)]={from:c[a].index,to:l[a].index});return i}},{key:"getCellData",value:function(e,t,n){for(var r,a=[],o=0;o<n.length;o++)r=n[o].column,null!==e.data.rowData[t]&&(e.getCellDataAtPosition(t,r)?a.push(e.data.rowData[t]?e.data.rowData[t].values[r]:null):a.push(null));return a}},{key:"createUnmergeCellsMutations",value:function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return new ve({sheetId:n.getSheetId(),gridRanges:[this.gridRange]}).run(e,(function(e){t.push(e)})),t}},{key:"createUpdateSheetRangeMutations",value:function(e,t,n){var r,a,o,s,i,l=[],c=e.sheetManager.getSheetBySheetId(this.sheetId),u=this.sheetId;function d(e,t,n){l.push(new Ee.a({sheetId:u,sheetRangeId:e.id,sheetRangeType:e.type,gridRange:new b.b(u,t,t,n,n),padId:Rt.a.getConfig("padId")}))}for(r=0;r<t.queue.length;r++)for(o=t.queue[r],a=n.startColIndex;a<=n.endColIndex;a++)(s=c.getCellDataAtPosition(t.rules[o].from,a))&&(i=s.getSheetRange())&&i.forEach((function(e){d(e,t.rules[o].to,a)}));return l}},{key:"id",get:function(){return n.id}}]),n}(f.a);function St(e,t){var n=0,r=function(e){if(e)switch(e.type){case yt.a.NUMBER:return parseFloat("".concat(e.value));case yt.a.STRING:case yt.a.BOOL:return"".concat(e.value);case yt.a.ERROR:return e.value}return null};return function(t,a){var o;for(n=0;n<e.length;n++){var s,i,l=r(null===(s=t.value[n])||void 0===s?void 0:s.getEffectiveValue()),c=r(null===(i=a.value[n])||void 0===i?void 0:i.getEffectiveValue());if(0!==(o=_t(l,c,e[n],t.index,a.index,t.value[n],a.value[n])))return o}return 0}}Ot.id=a.a.REORDER_RANGE_REQUEST;var Tt=Ot,wt=(n("../node_modules/core-js/modules/es.array.splice.js"),n("../packages/model/src/cell/format/BorderType.ts")),kt=n("../packages/model/src/factory/index.ts");function jt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var xt=function(e){Object(l.a)(n,e);var t=jt(n);function n(e,r){var a,o,i,l;Object(s.a)(this,n);var c=[];if((a=t.call(this,e,r)).props=e.props,r)for(o=0,i=r.rangeSelections.length;o<i;o++)l={gridRange:r.rangeSelections[o],props:e.props,type:e.type},c.push(l);else e.gridRange&&(l={gridRange:e.gridRange,props:e.props,type:e.type},c.push(l));return a.behaviors=c,a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r,a=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId),o=[e.gridRange],s=e.gridRange,i=[],l=e.type;if(null!==a)for(o=Object(U.divideGridRangesByFilter)(o,a.getBasicFilter()),r=0;r<o.length;r++)s=o[r],i=[],Array.prototype.push.apply(i,this.getSetCellsBorder(s,l,t)),Array.prototype.push.apply(i,this.getClearCellsBorder(s,l,t)),s.startRowIndex=Math.max(0,s.startRowIndex-1),s.endRowIndex=Math.min(a.getRowCount()-1,s.endRowIndex+1),s.startColIndex=Math.max(0,s.startColIndex-1),s.endColIndex=Math.min(a.getColCount()-1,s.endColIndex+1),n(new v.a({gridRange:s,cellDataDeltaAtPositions:i}))}},{key:"getSetCellsBorder",value:function(e,t,n){var r,a,o=[],s=e.startRowIndex,i=e.endRowIndex,l=e.startColIndex,c=e.endColIndex,u=[];for(a=s;a<=i;a++)for(r=l;r<=c;r++)o.length=0,o.push({from:wt.a.DIAG_DOWN,to:wt.a.DIAG_DOWN}),o.push({from:wt.a.DIAG_UP,to:wt.a.DIAG_UP}),a===s?(o.push({from:wt.a.TOP,to:wt.a.TOP}),a!==i?o.push({from:wt.a.MIDDLE,to:wt.a.BOTTOM}):o.push({from:wt.a.BOTTOM,to:wt.a.BOTTOM})):a===i?(o.push({from:wt.a.BOTTOM,to:wt.a.BOTTOM}),a!==s?o.push({from:wt.a.MIDDLE,to:wt.a.TOP}):o.push({from:wt.a.TOP,to:wt.a.TOP})):o.push({from:wt.a.MIDDLE,to:wt.a.TOP},{from:wt.a.MIDDLE,to:wt.a.BOTTOM}),r===l?(o.push({from:wt.a.LEFT,to:wt.a.LEFT}),r!==c?o.push({from:wt.a.CENTER,to:wt.a.RIGHT}):o.push({from:wt.a.RIGHT,to:wt.a.RIGHT})):r===c?(o.push({from:wt.a.RIGHT,to:wt.a.RIGHT}),r!==l?o.push({from:wt.a.CENTER,to:wt.a.LEFT}):o.push({from:wt.a.LEFT,to:wt.a.LEFT})):o.push(o.push({from:wt.a.CENTER,to:wt.a.LEFT},{from:wt.a.CENTER,to:wt.a.RIGHT})),u.push({rowIndex:a,colIndex:r,cellDataDelta:this.getCellDataDeltaSet(o,t)});return u}},{key:"getClearCellsPrevRowBottomBorder",value:function(e,t,n){var r=n.sheetManager.getSheetBySheetId(e.sheetId),a=e.startRowIndex,o=(e.endRowIndex,e.startColIndex),s=e.endColIndex,i=kt.BorderFactory.createInstance(this.props),l=[],c=a-1;if(c>=0&&t[wt.a.TOP])for(var u=o;u<=s;u++){var d=r.data.rowData[c]&&r.data.rowData[c].values[u];if(d){var f=d.getUserEnteredFormat();if(f&&f.getBorders()){var h=f.getBorderBottom();h&&(h.color||h.style)&&(o===s&&h.equal(i)||l.push({rowIndex:c,colIndex:u,cellDataDelta:this.getCellDataDeltaClear(wt.a.BOTTOM)}))}}}return l}},{key:"getClearCellsNextRowTopBorder",value:function(e,t,n){var r=n.sheetManager.getSheetBySheetId(e.sheetId),a=(e.startRowIndex,e.endRowIndex),o=e.startColIndex,s=e.endColIndex,i=kt.BorderFactory.createInstance(this.props),l=[],c=a+1;if(c<r.getRowCount()&&t[wt.a.BOTTOM])for(var u=o;u<=s;u++){var d=r.data.rowData[c]&&r.data.rowData[c].values[u];if(d){var f=d.getUserEnteredFormat();if(f&&f.getBorders()){var h=f.getBorderTop();h&&(h.color||h.style)&&(o===s&&h.equal(i)||l.push({rowIndex:c,colIndex:u,cellDataDelta:this.getCellDataDeltaClear(wt.a.TOP)}))}}}return l}},{key:"getClearCellsPrevColRightBorder",value:function(e,t,n){var r=n.sheetManager.getSheetBySheetId(e.sheetId),a=e.startRowIndex,o=e.endRowIndex,s=e.startColIndex,i=e.endColIndex,l=kt.BorderFactory.createInstance(this.props),c=[],u=s-1;if(u>=0&&t[wt.a.LEFT])for(var d=a;d<=o;d++){var f=r.data.rowData[d]&&r.data.rowData[d].values[u];if(f){var h=f.getUserEnteredFormat();if(h&&h.getBorders()){var p=h.getBorderRight();p&&(p.color||p.style)&&(s===i&&p.equal(l)||c.push({rowIndex:d,colIndex:u,cellDataDelta:this.getCellDataDeltaClear(wt.a.RIGHT)}))}}}return c}},{key:"getClearCellsNextColLeftBorder",value:function(e,t,n){var r=n.sheetManager.getSheetBySheetId(e.sheetId),a=e.startRowIndex,o=e.endRowIndex,s=e.startColIndex,i=e.endColIndex,l=kt.BorderFactory.createInstance(this.props),c=[],u=i+1;if(u<r.getColCount()&&t[wt.a.RIGHT])for(var d=a;d<=o;d++){var f=r.data.rowData[d]&&r.data.rowData[d].values[u];if(f){var h=f.getUserEnteredFormat();if(h&&h.getBorders()){var p=h.getBorderLeft();p&&(p.color||p.style)&&(s===i&&p.equal(l)||c.push({rowIndex:d,colIndex:u,cellDataDelta:this.getCellDataDeltaClear(wt.a.LEFT)}))}}}return c}},{key:"getClearCellsBorder",value:function(e,t,n){return[].concat(Object(o.a)(this.getClearCellsPrevRowBottomBorder(e,t,n)),Object(o.a)(this.getClearCellsNextRowTopBorder(e,t,n)),Object(o.a)(this.getClearCellsPrevColRightBorder(e,t,n)),Object(o.a)(this.getClearCellsNextColLeftBorder(e,t,n)))}},{key:"getCellDataDeltaSet",value:function(e,t){var n,r=[];for(n=0;n<e.length;n++)t[e[n].from]?r.push(e[n].to):(e.splice(n,1),n-=1);var a=new Pe.a({setSlots:this.getSetSlots(r),delta:kt.CellFormatFactory.createInstance({borders:this.getBorders(r)})});return new Ie.a({setSlots:1<<I.b.SLOT_USER_ENTERED_FORMAT_DELTA,delta:{userEnteredFormatDelta:a}})}},{key:"getBorders",value:function(e){var t,n={};for(t=0;t<e.length;t++)n[e[t]]={color:this.props.color,style:this.props.style};return kt.BordersFactory.createInstance(n)}},{key:"getSetSlots",value:function(e){var t,n=0;for(t=0;t<e.length;t++)switch(e[t]){case wt.a.TOP:n+=1<<Be.b.BORDER_TOP;break;case wt.a.RIGHT:n+=1<<Be.b.BORDER_RIGHT;break;case wt.a.BOTTOM:n+=1<<Be.b.BORDER_BOTTOM;break;case wt.a.LEFT:n+=1<<Be.b.BORDER_LEFT}return n}},{key:"getCellDataDeltaClear",value:function(e){var t=0;switch(e){case wt.a.TOP:t+=1<<Be.b.BORDER_TOP;break;case wt.a.RIGHT:t+=1<<Be.b.BORDER_RIGHT;break;case wt.a.BOTTOM:t+=1<<Be.b.BORDER_BOTTOM;break;case wt.a.LEFT:t+=1<<Be.b.BORDER_LEFT}var n=new Pe.a({clearSlots:t});return new Ie.a({setSlots:1<<I.b.SLOT_USER_ENTERED_FORMAT_DELTA,delta:{userEnteredFormatDelta:n}})}},{key:"id",get:function(){return n.id}}]),n}(f.a);xt.id=a.a.SET_BORDERS_REQUEST;var Ct=xt,Dt=(n("../node_modules/core-js/modules/es.array.find-index.js"),n("../node_modules/core-js/modules/es.array.reduce.js"),n("../packages/model/src/grid/Selection.ts")),At=(n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../packages/model/src/cell/CellData.ts")),Mt=n("./src/core/feature/copyPaste/interfaces.ts"),Lt=n("../packages/model/src/cell/CellFormat.ts");function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pt=function(e){var t=e.ranges,n=e.gridData,r=e.cellMask,a=e.formatMask;return function(e,t,n,r,a,o){for(var s,i,l,c,u,d,f,h=[],p=e.ranges,g=e.gridData,m=e.isFormatPainter,b=0,y=g,R=r.data.rowData,E=[],O=0,S=0;b<p.length;b++){var T=(s=p[b]).sheetId;E=[],i=s.startRowIndex<0?y.startRow:s.startRowIndex,l=s.endRowIndex<0?r.getRowCount()-1:s.endRowIndex,c=s.startColIndex<0?y.startCol:s.startColIndex,u=s.endColIndex<0?r.getColCount()-1:s.endColIndex;for(var w=i;w<=l;w++){S=0;for(var k=c;k<=u;k++){var j;if(d=y.rowData[w+O-i]?y.rowData[w+O-i].values[k+S-c]:null,f=R[i+w+O-i]?R[i+w+O-i].values[c+k+S-c]:null,d&&(!d||0!==d.setSlots)||f&&(!f||0!==f.setSlots)){var x=new At.a;x.setSlots=I.a.ALL,x.setUserEnteredFormat((null===(j=f)||void 0===j?void 0:j.getUserEnteredFormat())||null);var C={cellData:x,rowIndex:0,colIndex:0,sheetId:T};if(f&&a===Mt.c.text){var D,A,M,L,N=null===(D=f.getUserEnteredFormat())||void 0===D?void 0:D.getOptions(),U=null===(A=d)||void 0===A||null===(M=A.getUserEnteredFormat())||void 0===M?void 0:M.getOptions(),P=new Lt.a(Ut(Ut({},N),U));null===(L=d)||void 0===L||L.setUserEnteredFormat(P)}var F={cellData:d,rowIndex:w-i,colIndex:k-c,sheetId:T},B=m?Object(_.createCellDataDeltaForFormatPainter)(C,F):Object(_.createCellDataDelta)(C,F,t,n),H=B.delta.effectiveFormatDelta;H&&(H.clearSlot(Be.b.BACKGROUND_COLOR),B.setSlot(I.b.SLOT_EFFIECTIVE_FORMAT_DELTA,H)),B.delta.formula||m||B.clearSlot(I.b.SLOT_FORMULA),o||B.clearSlot(I.b.SLOT_MENTION),E.push({rowIndex:w,colIndex:k,cellDataDelta:B})}}S+=u-c+1}O+=l-i+1,h.push(new v.a({gridRange:s,cellDataDeltaAtPositions:E}))}return h}({ranges:t,gridData:n,isFormatPainter:e.isFormatPainter},r,a,e.activeSheet,e.fromOuterContentType,e.isNeedMention)},Ft=n("../packages/model/src/range/SheetRangeType.ts"),Bt=n("../packages/mutation/src/sheet/DefineSheetRangeMutation.ts"),Ht=n("../packages/mutation/src/sheet/DeleteSheetRangeMutation.ts");function Gt(e,t){var n=e.rowIndex,r=e.colIndex;if(!t[n])return null;var a=t[n].values[r];if(!a)return null;var o=a.getSheetRange();if(!o)return null;for(var s=0;s<o.length;s++){var i=o[s],l=i.id,c=i.type;if(c===Ft.a.COMMENT_RANGE)return{id:l,type:c}}return null}function zt(e,t,n,r){var a=t.startColIndex-n.startColIndex,o=t.startRowIndex-n.startRowIndex;return{colIndex:e.colIndex-a,rowIndex:e.rowIndex-o}}function qt(e){return e.map((function(e){return new ge.a(e)}))}function Vt(e){return e.toDimensionData().amount}function Qt(e,t,n,r){var a,o,s,i,l=t.endColIndex,c=t.endRowIndex,u=t.sheetId,d=e.getColCount(),f=e.getRowCount();l=Math.max(l,d-1),c=Math.max(c,f-1);var h=n.reduce((function(e,t){return e+Vt(t)}),0),g=null===(a=n[0])||void 0===a?void 0:a.dimension,m=null===(o=n[0])||void 0===o?void 0:o.sheetId,b=r.reduce((function(e,t){return e+Vt(t)}),0),v=null===(s=r[0])||void 0===s?void 0:s.dimension,I=null===(i=r[0])||void 0===i?void 0:i.sheetId;return m===u&&(g===p.a.ROWS?c-=h:g===p.a.COLUMNS&&(l-=h)),I===u&&(v===p.a.ROWS?c+=b:v===p.a.COLUMNS&&(l+=b)),{endRowIndex:c,endColIndex:l}}function Wt(e){var t=[],n=e.pasteDimensionRanges,r=e.type,a=function(e,t){var n,r,a,s,i,l,c=[],u=e.values,d=e.type,f=e.ranges,h=0,p=0,b=0,v=null;function I(e,n){return e&&n?!e.equal(n,t):e!==n}function _(e,n){return e&&n?!e.equal(n,t):e!==n}function y(e,n){return e&&n?e.equal(n,t):e===n}var R=function(){n=f[h],r=n.startIndex;var e=(a=n.endIndex)-r+1,R=[];for(p=r;p<=a;p++)s=u[p-r],i=u[p-r+1],I(v=u[p-r-1],s)&&(b=1),y(v,s)&&(b+=1),(_(s,i)||p===a)&&b&&0!==(l=s?Object(g.b)(s,d,t):[{slot:g.a.SLOT_HIDDEN,hidden:0},{slot:g.a.SLOT_SIZE,size:null}]).length&&R.push(new g.c({ranges:[new m.a(n.sheetId,p-b+1,p,n.dimension)],operation:l,type:d,sheetId:n.sheetId}));for(var E=[],O=r;O<=a;O++){var S=O-r;S%e===0&&function(){var t=parseInt("".concat(S/e),10),n=R.map((function(n){return n.ranges.forEach((function(n){n.startIndex=n.startIndex+t*e,n.endIndex=n.endIndex+t*e})),n}));E=[].concat(Object(o.a)(E),Object(o.a)(n))}()}c=[].concat(Object(o.a)(c),Object(o.a)(E))};for(h=0;h<f.length;h++)R();return c}({values:e.values,type:r,ranges:n},{pixelSize:!0,hiddenByUser:!0,ignoreDefaultHidden:!0,clearDefaultSize:!0});return t=[].concat(Object(o.a)(t),Object(o.a)(a))}function Yt(e){var t=e.pasteDimensionRanges,n=e.values,r=[],a=t.length;if(!n||0===t.length)return r;var s=t[0].dimension;if(t.filter((function(e){return e.dimension===t[0].dimension})).length!==a)return console.warn("pasteDimensionRanges ars not same dimension type"),r;var i=Wt({pasteDimensionRanges:t,type:s,values:n});return r=[].concat(Object(o.a)(r),Object(o.a)(i))}var Kt=function(e){if(!e)return[];var t=[],n=e.sheet,r=e.pasteRange,a=e.pasteDimensionPropsRanges,s=e.insertDimensionRanges,i=e.deleteDimensionRanges,l=e.rowsDimensionProperties,c=e.columnsDimensionProperties;if(i){var u=i.map((function(e){return new fe.a({index:e.startIndex,amount:e.endIndex-e.startIndex+1,type:e.dimension,sheetId:e.sheetId})}));t=[].concat(Object(o.a)(t),Object(o.a)(u))}if(s){var d=s.map((function(e){return new h.a({index:e.startIndex,amount:e.endIndex-e.startIndex+1,type:e.dimension,sheetId:e.sheetId})}));t=[].concat(Object(o.a)(t),Object(o.a)(d))}var f=[];s||(f=function(e,t,n,r){var a=[],o=t.sheetId,s=e.getColCount(),i=e.getRowCount(),l=Qt(e,t,n,r),c=l.endRowIndex,u=l.endColIndex;return u>=s&&a.push(new h.a({type:p.a.COLUMNS,index:s,amount:u-s+1,sheetId:o})),c>=i&&a.push(new h.a({type:p.a.ROWS,index:i,amount:c-i+1,sheetId:o})),a}(n,r,i||[],s||[])),t=[].concat(Object(o.a)(t),Object(o.a)(f));var g=function(e){var t=e.pasteDimensionRanges,n=e.rowsDimensionProperties,r=e.columnsDimensionProperties,a=[];if(!t||0===t.length)return a;var s=t.filter((function(e){return e.dimension===p.a.ROWS})),i=t.filter((function(e){return e.dimension===p.a.COLUMNS}));if(n){var l=Yt({pasteDimensionRanges:s,values:n});a=[].concat(Object(o.a)(a),Object(o.a)(l))}if(r){var c=Yt({pasteDimensionRanges:i,values:r});a=[].concat(Object(o.a)(a),Object(o.a)(c))}return a}({pasteDimensionRanges:a,rowsDimensionProperties:l,columnsDimensionProperties:c});return t=[].concat(Object(o.a)(t),Object(o.a)(g))};var Zt=function(e){return Object(o.a)(qt(e))},Xt=n("../packages/mutation/src/other/CopyPasteMutation.ts");function Jt(e,t){if(1===e.getColCount()&&1===e.getRowCount())return!0;if(t){var n=t.getMergeReference();if(null===n||void 0===n?void 0:n.equals(e))return!0}return!1}var $t,en,tn=n("../packages/model/src/dimension/index.ts");function nn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}function rn(e,t){var n,r,a,o,s=e.sheetId,i=e.cellMask,l=e.formatMask,c=e.copyRange,u=e.pasteRange,d=c.startColIndex,f=c.startRowIndex,h=(c.endColIndex,c.endRowIndex,u.startColIndex),p=u.startRowIndex,g=(u.endColIndex,u.endRowIndex,c.getColCount()),m=c.getRowCount(),v=u.getColCount(),I=u.getRowCount(),_=t[f]&&t[f].values[d],y=t[p]&&t[p].values[h],R=Jt(c,_),E=Jt(u,y);R&&E?(a=1,o=1):(g<v?a=v/g>>0:g>v?(g=v,a=1):a=1,m<I?o=I/m>>0:m>I?(m=I,o=1):o=1);var O=[],S=new b.b(c.sheetId,c.startRowIndex,c.startRowIndex+m-1,c.startColIndex,c.startColIndex+g-1),T=u,w=new b.b(u.sheetId,u.startRowIndex,u.startRowIndex+m-1,u.startColIndex,u.startColIndex+g-1);for(n=0;n<o;n++)for(r=0;r<a;r++)(T=w.clone()).insertDimension({sheetId:T.sheetId,type:tn.DIMENSION_TYPE.ROWS,index:-1,amount:n*m}),T.insertDimension({sheetId:T.sheetId,type:tn.DIMENSION_TYPE.COLUMNS,index:-1,amount:r*g}),O.push(new Xt.a({source:S,destination:T}));return[new Xt.b({sheetId:s,cellMask:i,formatMask:l,pasteMappings:O})]}!function(e){e[e.PASTE_NORMAL=0]="PASTE_NORMAL",e[e.PASTE_VALUES=1]="PASTE_VALUES",e[e.PASTE_FORMAT=2]="PASTE_FORMAT",e[e.PASTE_NO_BORDERS=3]="PASTE_NO_BORDERS",e[e.PASTE_FORMULA=4]="PASTE_FORMULA",e[e.PASTE_DATA_VALIDATION=5]="PASTE_DATA_VALIDATION",e[e.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",e[e.PASTE_AS_TEXT=7]="PASTE_AS_TEXT",e[e.PASTE_COLUMN_WIDTHS=8]="PASTE_COLUMN_WIDTHS"}($t||($t={})),function(e){e[e.NORMAL=1]="NORMAL"}(en||(en={}));var an=function(e){Object(l.a)(n,e);var t=nn(n);function n(e,r){var a;Object(s.a)(this,n),a=t.call(this,e,r);var o=e.sheetId,i=e.pasteType,l=e.pasteOrientation,c=e.copyRange;if(a.sheetId=o,a.copyRange=c,r){var u=r.rangeSelections;0===u.length||u.length>1?console.warn("invalid rangeSelections length"):(a.pasteRange=u[0],a.behaviors=u.map((function(e){return{sheetId:a.sheetId,pasteType:i,pasteOrientation:l,copyRange:c,pasteRange:e}})))}return a}return Object(i.a)(n,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){t.parent&&n(rn(e,t.activeSheet.data.rowData))}},{key:"id",get:function(){return n.id}}]),n}(f.a);an.id=a.a.COPY_PASTE_REQUEST;var on=an,sn=n("./src/core/behavior/request/other/CopyPaste/Embedded.ts");function ln(e){return e.map((function(e){return new g.c({ranges:[e],operation:[{slot:g.a.SLOT_SIZE,size:null},{slot:g.a.SLOT_HIDDEN,hidden:0}],type:e.dimension,sheetId:e.sheetId})}))}var cn=n("./src/core/behavior/request/workbook/filterUtils/getExtendFilterRangeMutation.ts"),un=n("../packages/model/src/grid/Cell.ts"),dn=n("../packages/model/src/config/index.ts"),fn=function(e){var t=e.insertDimensionRanges,n=e.deleteDimensionRanges,r=e.sheet,a={beforeMutations:[],afterMutations:[]};return a=t.reduce((function(e,t){var a=function(e){var t,n=e.insertDimensionRange,r=e.deleteDimensionRanges,a=e.sheet,o=n.startIndex,s=n.endIndex,i=n.dimension,l=s-o+1,c=a.mergeManager.mergeList,u={beforeMutations:[],afterMutations:[]},d=function(){var e=c[t].clone();r.forEach((function(t){e.deleteDimension({sheetId:t.sheetId,type:t.dimension,index:t.startIndex,amount:t.endIndex-t.startIndex+1})})),i===p.a.ROWS?o>e.startRowIndex&&o<=e.endRowIndex&&u.afterMutations.push(new y.a({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex+l,startColIndex:e.startColIndex,endColIndex:e.endColIndex})):i===p.a.COLUMNS&&o>e.startColIndex&&o<=e.endColIndex&&u.afterMutations.push(new y.a({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex+l}))};for(t=0;t<c.length;t++)d();return u}({insertDimensionRange:t,deleteDimensionRanges:n,sheet:r}),s=a.beforeMutations,i=a.afterMutations;return e.beforeMutations=[].concat(Object(o.a)(e.beforeMutations),Object(o.a)(s)),e.afterMutations=[].concat(Object(o.a)(e.afterMutations),Object(o.a)(i)),e}),a)},hn=n("../packages/mutation/src/MutationId.ts"),pn=n("./src/base/config/report.ts"),gn=n("../packages/mutation/src/index.ts");function mn(e,t,n){if(!e)return[];var r=[];return e.conditionalFormatRuleManager.each((function(e){var a=[];if(e.rule.ruleRanges.forEach((function(e){if(e.isCross(t)){var r=Object(U.getCrossGridRange)(e,t);if(null===r||void 0===r?void 0:r.isValid()){var o=r.startRowIndex-t.startRowIndex,s=r.startColIndex-t.startColIndex,i=new Z.GridRange(n.sheetId,n.startRowIndex+o,n.startRowIndex+o+r.getRowCount()-1,n.startColIndex+s,n.startColIndex+s+r.getColCount()-1);a.push(i)}}})),a.length>0){var o=e.rule.clone();o.uid=null,o.ruleRanges=a,r.push(function(e,t){var n={sheetId:e,ruleIndex:0,rule:t};return new gn.a(n)}(n.sheetId,o))}})),r}function bn(e,t){if(!e)return[];var n=[],r=[];return e.conditionalFormatRuleManager.each((function(e){var a=[],s=!1;if(e.rule.ruleRanges.forEach((function(e){if(e.isRow||e.isCol||!e.isCross(t))a.push(e);else{s=!0;var n=Object(U.getCrossGridRange)(e,t),r=[];n&&r.push.apply(r,Object(o.a)(Object(U.gridRangeExcept)(e,n))),r.length>0&&a.push.apply(a,r)}})),s){var i=e.rule.clone(),l=i.ruleRanges;a.length>0?(i.ruleRanges=a,n.push(function(e,t,n,r){return new gn.l({sheetId:e,ruleIndex:t,rule:n,oldRuleRanges:r})}(t.sheetId,e.index,i,l))):r.push(function(e,t,n){return new gn.b({sheetId:e,ruleIndex:t,oldRuleRanges:n})}(t.sheetId,e.index,l))}})),[].concat(n,r)}var vn=n("./src/core/app/tool.ts"),In=n("./src/core/feature/copyPaste/middleware/factory.ts"),_n=n("./src/core/feature/copyPaste/middleware/interface.ts");function yn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Rn=function(e,t,n,r){var a,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"===typeof Reflect?"undefined":Object(d.a)(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(s=(o<3?a(s):o>3?a(t,n,s):a(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},En=function(e){Object(l.a)(n,e);var t=yn(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=[e],a.sheetId=e.sheetId,a}return Object(i.a)(n,[{key:"isGridRangesCanPaste",value:function(e,t){var n=e.parent;return!!n&&(!(-1!==t.findIndex((function(e){return!n.sheetStatus.getRangeCanEdit(e)})))||(this.pasteSizeOverLimitTips="\u6b64\u8303\u56f4\u5df2\u88ab\u4fdd\u62a4\u3002\u5982\u9700\u7f16\u8f91\uff0c\u8bf7\u8054\u7cfb\u521b\u5efa\u8005\u300c".concat(vn.a.window.clientVars.ownerNick,"\u300d\u6388\u4e88\u6743\u9650\u3002"),!1))}},{key:"predictRequestSize",value:function(e){var t=this;if(this.calIsOverSheetSizeAfterPaste(e))return this.pasteSizeOverLimitTips="\u8d85\u51fa\u6700\u5927\u5355\u5143\u683c\u6570\u91cf\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f\u3002",1024e3;var n=0;return this.behaviors.forEach((function(r){var a=r.gridData,o=r.pasteEmbeddedObjects,s=r.sheetId,i=r.pasteRanges;if(o&&o.length>1e3&&(n=1024e3),a&&!n){var l=a.rowData.length,c=e.sheetManager.getSheetBySheetId(s),u=c?c.getColCount():0;n=u>dn.MAX_COL_COUNT||l>dn.MAX_ROW_COUNT||u*l>dn.MAX_CELL_COUNT?1024e3:a.rowData.reduce((function(e,t){return e+(t?t.values.reduce((function(e,t){if(t){var n=t.getEffectiveValue();if(n&&"string"===typeof n.value)return e+50+n.value.length}return e+50}),0):0)}),0)}var d=t.isGridRangesCanPaste(e,i);n=d?n:1024e3})),n||0}},{key:"getTablePropsMutation",value:function(e){var t=[];return In.a.getAllMiddleWares({level:_n.a.CELL_PROPS,tableProps:!0}).forEach((function(n){n.genMutation&&t.push.apply(t,Object(o.a)(n.genMutation(e)))})),t}},{key:"requestSizeOverLimitTips",value:function(){return this.pasteSizeOverLimitTips?this.pasteSizeOverLimitTips:"\u6570\u636e\u91cf\u8f83\u5927\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f\u3002\u5efa\u8bae\u5bfc\u5165\u539f\u6709\u6587\u6863\u6216\u5206\u6279\u7c98\u8d34\u3002"}},{key:"do",value:function(e,t,n){var r,a,s,i,l=e.params,c=l.isNeedMention,u=l.fromOuterContentType,d=e.pasteRanges,f=e.gridData,h=e.unmergeInfos,p=e.mergeInfos,g=e.infoDimension,m=e.cutData,v=e.copyPasteMutationsOptions,_=e.pasteEmbeddedObjects,R=e.cellMask,E=e.formatMask,O=e.isFormatPainter,S=e.clearRangeContent,T=e.propsKeys,w=d.map((function(e){return e.clone()})),k=m.cutGridRanges.length>0,j=void 0!==R?R:I.a.ALL,x=void 0!==E?E:Be.a.ALL,C=void 0!==u?u:Mt.c.illegal,D=t.parent;if(D){var A=t.activeSheet,M=A.data.rowData,L=[],N=[];try{if(v){var U=g.insertDimensionRanges,P=g.deleteDimensionRanges,F=v.copyRange;P&&P.forEach((function(e){var t=e.startIndex,n=e.endIndex,r=e.dimension,a=e.sheetId;d.forEach((function(e){e.deleteDimension({sheetId:a,type:r,amount:n-t+1,index:t})})),F.deleteDimension({sheetId:a,type:r,amount:n-t+1,index:t})})),U&&U.forEach((function(e){var t=e.startIndex,n=e.endIndex,r=e.dimension,a=e.sheetId;F.insertDimension({sheetId:a,type:r,amount:n-t+1,index:t})})),L=rn({sheetId:this.sheetId,copyRange:F,pasteRange:d[0],cellMask:j,formatMask:x},M)}else f&&(L=Pt({fromOuterContentType:C,ranges:d,gridData:f,cellMask:j,formatMask:x,isFormatPainter:O,activeSheet:A,isNeedMention:c}))}catch(Q){console.error(Q)}k&&(N=function(e){var t=e.fromRange,n=e.toRange,r=e.spreadsheetApp;if(!r||!t||!n)return[];var a=[],o=t.sheetId,s=r.spreadsheet.sheetManager.getSheetBySheetId(o);if(!s)return[];for(var i=s.data.rowData,l=n.sheetId,c={rowLen:t.endRowIndex-t.startRowIndex+1,colLen:t.endColIndex-t.startColIndex+1},u=t.startRowIndex;u<=t.endRowIndex;u++)for(var d=t.startColIndex;d<=t.endColIndex;d++){var f={rowIndex:u,colIndex:d},h=zt(f,t,n,c);if(h){var p=Gt(f,i);if(p)if(l===o){var g=new b.b(o,h.rowIndex,h.rowIndex,h.colIndex,h.colIndex),m=new Ee.a({sheetRangeId:p.id,gridRange:g,sheetRangeType:p.type,sheetRangePropertiesDelta:{},nonPersistingLocalChange:!1,sheetId:o,padId:Rt.a.getConfig("padId")});a.push(m)}else{var v=new b.b(l,h.rowIndex,h.rowIndex,h.colIndex,h.colIndex),I=new Bt.a({sheetRangeId:p.id,gridRange:v,sheetRangeType:p.type,sheetRangePropertiesDelta:{},nonPersistingLocalChange:!1,sheetId:l,padId:Rt.a.getConfig("padId")});a.push(I);var _=new Ht.a({sheetId:o,sheetRangeId:p.id,nonPersistingLocalChange:!1});a.push(_)}}}return a}({spreadsheetApp:D,fromRange:e.copyRange,toRange:e.toGridRange}));var B=[];if(k&&B.push.apply(B,Object(o.a)(bn(D.spreadsheet.sheetManager.getSheetBySheetId(e.copyRange.sheetId),e.copyRange))),B.push.apply(B,Object(o.a)(bn(D.spreadsheet.sheetManager.getSheetBySheetId(e.toGridRange.sheetId),e.toGridRange))),B.push.apply(B,Object(o.a)(mn(D.spreadsheet.sheetManager.getSheetBySheetId(e.copyRange.sheetId),e.copyRange,e.toGridRange))),S){var H=new un.a(S.sheetId,S.startRowIndex,S.startColIndex),G=new Dt.a(H,[S],[S],!1);new J.a({},G).run(t,n)}var z=[];g.insertDimensionRanges&&(z=fn({insertDimensionRanges:g.insertDimensionRanges||[],deleteDimensionRanges:g.deleteDimensionRanges||[],sheet:A}).afterMutations);var q=[].concat(Object(o.a)((null===(r=g.deleteDimensionRanges)||void 0===r?void 0:r.length)?[]:ln(m.cutColumnsDimensionRanges)),Object(o.a)((null===(a=g.deleteDimensionRanges)||void 0===a?void 0:a.length)?[]:ln(m.cutRowsDimensionRanges)),Object(o.a)(Kt(g)),Object(o.a)((null===(s=g.deleteDimensionRanges)||void 0===s?void 0:s.length)?[]:Zt(m.cutUnmergeOptions)),Object(o.a)((null===(i=g.deleteDimensionRanges)||void 0===i?void 0:i.length)?[]:m.cutGridRanges.map((function(e){return new K.a({gridRange:e,cellDataDelta:new Ie.a({clearSlots:I.a.ALL}).setSlot(I.b.SLOT_USER_ENTERED_FORMAT_DELTA,new Pe.a({clearSlots:Be.a.ALL}).clearSlot(Be.b.BORDER_TOP).clearSlot(Be.b.BORDER_RIGHT).clearSlot(Be.b.BORDER_BOTTOM).clearSlot(Be.b.BORDER_LEFT))})}))),Object(o.a)(qt(h)),Object(o.a)(L),Object(o.a)(function(e){return e.map((function(e){return new y.a(e)}))}(p)),Object(o.a)(z),Object(o.a)(N),B);if(_&&(q=[].concat(Object(o.a)(q),Object(o.a)(Object(sn.a)(_)))),T&&(q=[].concat(Object(o.a)(q),Object(o.a)(this.getTablePropsMutation(T)))),g)(function(e,t){var n=e.filter((function(e){return e.id===hn.b.MERGE_CELLS_MUTATION}))[0],r=e.filter((function(e){return e.id===hn.b.INSERT_DIMENSION_MUTATION}));if(n&&0===r.length){var a=n.endColIndex,o=n.endRowIndex,s=t.getColCount(),i=t.getRowCount();if(a>=s)return!1;if(o>=i)return!1}return!0})(q,A)||Se.b.run(pn.CONFIG.PASTE_DATA_GENERATE_MUTATION_2,["formatPainter",O,A.getSheetId(),"row",A.getRowCount(),"col",A.getColCount(),g.pasteRange,g.deleteDimensionRanges,g.insertDimensionRanges]);else Se.b.run(pn.CONFIG.PASTE_DATA_GENERATE_MUTATION_1);if(function(e){var t=e.filter((function(e){return e.id===hn.b.SET_RANGE_MUTATION}))[0];if(t){var n=t.gridRange,r=n.endColIndex,a=n.endRowIndex;if(!r&&0!==r)return!1;if(!a&&0!==a)return!1}return!0}(q)||Se.b.run(pn.CONFIG.PASTE_DATA_GENERATE_MUTATION_3,["formatPainter",O,A.getSheetId(),g.pasteRange,w,m,e.toGridRange]),q.forEach((function(e){return n(e)})),Object(cn.b)(A,d)){var V=Object(cn.a)(A);V.length>0&&n(V[0])}}}},{key:"calIsOverSheetSizeAfterPaste",value:function(e){var t=!1;return this.behaviors.forEach((function(n){var r=n.infoDimension,a=n.sheetId,o=r.insertDimensionRanges,s=r.deleteDimensionRanges,i=r.pasteRange,l=e.sheetManager.getSheetBySheetId(a);if(l){var c=Qt(l,i,s||[],o||[]),u=c.endRowIndex,d=c.endColIndex,f=(u+1)*(d+1);u>dn.MAX_ROW_COUNT&&(t=!0),d>dn.MAX_COL_COUNT&&(t=!0),f>dn.MAX_CELL_COUNT&&(t=!0)}})),t}},{key:"id",get:function(){return n.id}}]),n}(f.a);En.id=a.a.PASTE_DATA_REQUEST,Rn([Object(T.b)(En)],En.prototype,"predictRequestSize",null);var On=En,Sn=n("./src/core/behavior/request/cell/ClearFormatRequest.ts"),Tn=n("../packages/model/src/utils/numberFormat/ParsedValueType.ts"),wn=n("../packages/model/src/utils/numberFormat/FormatParseEngine.ts"),kn=n("./src/base/util/url.ts"),jn=n("./src/core/feature/formula/utils/parseUtil.ts");function xn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Cn=function(e){Object(l.a)(n,e);var t=xn(n);function n(e,r){var a;Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=e;for(var o=0;o<a.behaviors.length;o++)a.behaviors[o].linkUrl=Object(kn.d)(a.behaviors[o].value);return a}return Object(i.a)(n,[{key:"check",value:function(){return null}},{key:"do",value:function(e,t,n){var r=e.sheetId,a=t.sheetManager.getSheetBySheetId(r);if(a&&!Object(R.w)(a,e.y,e.x)){var o=a.getCellDataAtPosition(e.y,e.x),s=this.getCellDataDelta(o,e.value,e.linkUrl,e.y,e.x,r);if(!s.isEmpty())n(new K.a({gridRange:new b.b(e.sheetId,e.y,e.y,e.x,e.x),cellDataDelta:s}))}}},{key:"getCellDataDelta",value:function(e,t,n,r,a,o){var s,i,l,c=new Ie.a,u=null!==(s=null===e||void 0===e?void 0:e.getUserEnteredFormat())&&void 0!==s?s:null,d=null!==(i=null===u||void 0===u?void 0:u.getNumberFormat())&&void 0!==i?i:null,f=Object(wn.parseValueWithStyle)(t,d);return f.valueType===Tn.a.FORMULA?"string"===typeof f.value&&(c.clearSlot(I.b.SLOT_EFFIECTIVE_VALUE),c.setSlot(I.b.SLOT_FORMULA,Object(jn.c)(f.value,r,a,o))):(c.setSlot(I.b.SLOT_EFFIECTIVE_VALUE,kt.ExtendedValueFactory.createInstance({type:Number(f.valueType),value:f.value})),(l=new Pe.a).setSlot(Be.b.NUMBER_FORMAT,f.numberFormat),c.setSlot(I.b.SLOT_USER_ENTERED_FORMAT_DELTA,l)),n&&c.setSlot(I.b.SLOT_HYPERLINK,n),c.clearSlot(I.b.SLOT_MENTION),c}},{key:"id",get:function(){return a.a.REPLACE_ALL_REQUEST}}]),n}(f.a);Cn.id=a.a.REPLACE_ALL_REQUEST;var Dn=Cn,An=n("./src/core/behavior/request/cell/SetLinkRequest.ts");function Mn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ln=function(e){Object(l.a)(n,e);var t=Mn(n);function n(e,r){var a;Object(s.a)(this,n),a=t.call(this,e,r);var o=(null===r||void 0===r?void 0:r.activeCell.sheetId)||"";return a.behaviors=[{sheetId:o,rowIndex:e.rowIndex,colIndex:e.colIndex}],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(r){this.clearLinkedRange(e,r,n);var a=this.getCellDataDelta();n(new K.a({gridRange:new b.b(e.sheetId,e.rowIndex,e.rowIndex,e.colIndex,e.colIndex),cellDataDelta:a}))}}},{key:"clearLinkedRange",value:function(e,t,n){}},{key:"getCellDataDelta",value:function(){var e=new Ie.a;e.clearSlot(I.b.SLOT_HYPERLINK),e.clearSlot(I.b.SLOT_HYPERLINK_TYPE),e.clearSlot(I.b.SLOT_HYPERLINK_RUN);var t=e.delta.userEnteredFormatDelta||new Pe.a;return t.clearSlot(Be.b.FOREGROUND_COLOR),t.clearSlot(Be.b.UNDERLINE),e.setSlot(I.b.SLOT_USER_ENTERED_FORMAT_DELTA,t),e.clearSlot(I.b.SLOT_RICH_TEXT_STYLE_RUN),e}},{key:"id",get:function(){return n.id}}]),n}(f.a);Ln.id=a.a.CLEAR_LINK_REQUEST;var Nn=Ln,Un=n("../node_modules/@tencent/tdocs-format-render/lib/index.js");function Pn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Fn=function(e){Object(l.a)(n,e);var t=Pn(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).options=e,e.gridRange?a.behaviors=[e]:r&&(a.behaviors=r.rangeSelections.map((function(t){return{gridRange:t,pattern:e.pattern}}))),a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=this,a=this.getCellDataDelta(e),o=e.gridRange.sheetId,s=t.sheetManager.getSheetBySheetId(o);if(!a.isEmpty()&&s)if(e.cells)n(new gn.j({gridRange:e.gridRange,cellDataDeltaAtPositions:e.cells.map((function(e){var t,n,i=e.row,l=e.col;return{cellDataDelta:r.options.shouldReparse?Object($e.b)({cellData:null,rowIndex:i,colIndex:l,sheetId:o,userEnterValue:(null===(t=s.getCellDataAtPosition(i,l))||void 0===t||null===(n=t.getFormattedValue())||void 0===n?void 0:n.value)||"",linkUrl:null,skipTransformToText:!0}):a,rowIndex:i,colIndex:l}}))}));else{var i=[e.gridRange];i=Object(U.divideGridRangesByFilter)(i,s.getBasicFilter()),(i=Object(U.divideGridRangesByMerges)(i,s.mergeManager.mergeList)).forEach((function(e){var t=Object(Sn.a)(s,e);n(new K.a({gridRange:e,cellDataDelta:a})),t&&n(t)}))}}},{key:"getCellDataDelta",value:function(e){var t=e.pattern,n=new Pe.a,r=Object(Un.getNumberFormatByFormatCode)(t);n.setSlot(Be.b.NUMBER_FORMAT,r);var a=new Ie.a;return a.setSlot(I.b.SLOT_USER_ENTERED_FORMAT_DELTA,n),a}},{key:"id",get:function(){return n.id}}]),n}(f.a);Fn.id=a.a.SET_NUMBER_FORMAT_REQUEST;var Bn=Fn;function Hn(e,t,n){if(t=t||Object(Un.getDefaultNumberFormat)(),e&&e.type===yt.a.NUMBER){var r=e.value,a=t.pattern||"";n>0?(a=Object(Un.increaseDecimalFormat)(r,a),t=Object(Un.getNumberFormatByFormatCode)(a)):n<0&&(a=Object(Un.decreaseDecimalFormat)(r,a),t=Object(Un.getNumberFormatByFormatCode)(a))}return t}function Gn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var zn=function(e){Object(l.a)(n,e);var t=Gn(n);function n(e,r){var a,o,i,l;if(Object(s.a)(this,n),a=t.call(this,e,r),r)for(a.activeCell=r.activeCell,a.decimalsDelta=e.decimalsDelta,i=0,l=r.rangeSelections.length;i<l;i++)o={gridRange:r.rangeSelections[i],decimalsDelta:e.decimalsDelta},a.behaviors.push(o);else e.gridRange&&(o={gridRange:e.gridRange,decimalsDelta:e.decimalsDelta},a.behaviors.push(o));return a}return Object(i.a)(n,[{key:"check",value:function(e){var t=e.parent.view.getSelection(),n=e.activeSheet.getCellDataAtPosition(t.activeCell.rowIndex,t.activeCell.colIndex);if(n){var r=n.getUserEnteredFormat(),a=(null===r||void 0===r?void 0:r.getNumberFormat())||Object(Un.getDefaultNumberFormat)(),o=Hn(n.getEffectiveValue(),a,this.decimalsDelta);return a.pattern===o.pattern?{ignore:!0}:null}return{ignore:!0}}},{key:"do",value:function(e,t,n){var r=t.sheetManager.getSheetBySheetId(this.activeCell.sheetId);if(r){var a=r.getCellDataAtPosition(this.activeCell.rowIndex,this.activeCell.colIndex),o=this.getCellDataDelta(a,e.decimalsDelta),s=[e.gridRange];!o.isEmpty()&&r&&(s=Object(U.divideGridRangesByFilter)(s,r.getBasicFilter()),(s=Object(U.divideGridRangesByMerges)(s,r.mergeManager.mergeList)).forEach((function(e){n(new K.a({gridRange:e,cellDataDelta:o}))})))}}},{key:"getCellDataDelta",value:function(e,t){var n,r,a,o=null!==(n=null===e||void 0===e?void 0:e.getUserEnteredFormat())&&void 0!==n?n:null,s=null!==(r=null===o||void 0===o?void 0:o.getNumberFormat())&&void 0!==r?r:null,i=Hn(null!==(a=null===e||void 0===e?void 0:e.getEffectiveValue())&&void 0!==a?a:null,s,t),l=new Pe.a;l.setSlot(Be.b.NUMBER_FORMAT,i);var c=new Ie.a;return c.setSlot(I.b.SLOT_USER_ENTERED_FORMAT_DELTA,l),c}},{key:"id",get:function(){return n.id}}]),n}(f.a);zn.id=a.a.ADJUST_DECIMALS_REQUEST;var qn=zn,Vn=n("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),Qn=n("../packages/model/src/cell/ExtendedValue.ts"),Wn=n("../packages/model/src/cell/cellFormatUtils.ts"),Yn=n("../packages/model/src/cell/formula/FormulaModel.ts"),Kn=n("./src/core/view/level-2/shape-upload/utils.ts"),Zn=n("../packages/model/src/sheet/sheetUtils.ts");function Xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xn(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $n(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var er=function(e){Object(l.a)(n,e);var t=$n(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).shapeList=[],a.sheetId=e.sheetId,a.behaviors=[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=this,a=e.changes,o=e.mergeCells,s=e.range,i=(e.originCell,t.sheetManager.getSheetBySheetId(this.sheetId));if(i){var l=a.filter((function(e){var n=Object(Vn.a)(e,2),a=n[0],o=n[1];return t.parent.sheetStatus.getRangeCanEdit(new b.b(r.sheetId,a,a,o,o))}));o.forEach((function(e){Object(ge.b)(e,i).forEach(n)}));var c=l.map((function(e){var t=r.getCellDataDelta(e,i);return{rowIndex:e[0],colIndex:e[1],cellDataDelta:t}})),u=new v.a({gridRange:s,cellDataDeltaAtPositions:c});if(n(u),this.shapeList.length&&(this.shapeList.forEach((function(e){n(new Y.a({data:e}))})),this.shapeList.length=0),o.forEach((function(e){n(new y.a({startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex,sheetId:r.sheetId}))})),Object(cn.b)(i,[s])){var d=Object(cn.a)(i);d.length>0&&n(d[0])}}}},{key:"collectShape",value:function(e,t,n,r){if(t){var a=t.position.overlayPosition,o=a.widthPixels,s=a.heightPixels;this.shapeList.push(Jn(Jn({},t),{},{id:e,x:r,y:n,offsetX:0,offsetY:0,width:o,height:s,zIndex:0}))}}},{key:"getCellDataDelta",value:function(e,t){var n,r=e[0],a=e[1],o=e[2],s=e[3],i=e[4]||new At.a,l=null===i||void 0===i?void 0:i.getUserEnteredFormat(),c=t.getCellDataAtPosition(r,a),u=new Ie.a,d=(null===l||void 0===l?void 0:l.getNumberFormat())||null;if(o instanceof Yn.a)u.clearSlot(I.b.SLOT_EFFIECTIVE_VALUE),u.setSlot(I.b.SLOT_FORMULA,o.clone());else{var f=Object(wn.parseValueWithStyle)(o,d);f.valueType===Tn.a.FORMULA?(u.clearSlot(I.b.SLOT_EFFIECTIVE_VALUE),u.setSlot(I.b.SLOT_FORMULA,Object(jn.c)(f.value,r,a,t.getSheetId()))):(u.setSlot(I.b.SLOT_EFFIECTIVE_VALUE,kt.ExtendedValueFactory.createInstance({type:Number(f.valueType),value:f.value})),u.clearSlot(I.b.SLOT_FORMULA))}var h=i.getMetadata();u.setSlot(I.b.SLOT_METADATA,h);var p=Object(Zn.getCellImageByCellData)(t,i);if(p){var g=Object(Kn.c)();u.setSlot(I.b.SLOT_METADATA,X.a.newInstance({customDataType:R.o.IMAGE})),u.setSlot(I.b.SLOT_REF_IDS,[g]),this.collectShape(g,p,r,a)}else{var m,b=i.getRefIds();if(u.setSlot(I.b.SLOT_REF_IDS,b),(null===h||void 0===h?void 0:h.customDataType)===R.o.SELECT)u.setSlot(I.b.SLOT_EFFIECTIVE_VALUE,new Qn.a({type:yt.a.STRING,value:null===(m=h.config)||void 0===m?void 0:m.getSelectedTextValue(b||[])}))}if(i.getHyperlinkRuns()&&u.setSlot(I.b.SLOT_HYPERLINK_RUN,i.getHyperlinkRuns()),i.getLinkIconStatus()&&u.setSlot(I.b.SLOT_LINK_ICON_TYPE,i.getLinkIconStatus()),null===c)n=null;else{var v;null===(v=n=c.getUserEnteredFormat())||void 0===v||v.getDataValidation()}var _=Object(Wn.createCellFormatDelta)(n,l);u.setSlot(I.b.SLOT_USER_ENTERED_FORMAT_DELTA,_),u.setSlot(I.b.SLOT_HYPERLINK,s),u.setSlot(I.b.SLOT_HYPERLINK_TYPE,i.getHyperlinkType());var y=i.getTextFormatRuns();return u.setSlot(I.b.SLOT_RICH_TEXT_STYLE_RUN,y),u}},{key:"id",get:function(){return n.id}}]),n}(f.a);er.id=a.a.AUTO_FILL_REQUEST;var tr=er,nr=n("../packages/utils/src/index.ts"),rr=n("./src/core/behavior/request/workbook/filterUtils/handleFilterRange.ts");function ar(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var or=function(e){Object(l.a)(n,e);var t=ar(n);function n(e,r){var a;Object(s.a)(this,n),a=t.call(this,e,r);var o=e.sheetId;return r?a.behaviors=[{sheetId:o,gridRange:r.rangeSelections[r.rangeSelections.length-1]}]:e.gridRange&&(a.behaviors=[{sheetId:o,gridRange:e.gridRange}]),a}return Object(i.a)(n,[{key:"check",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.behaviors[0].sheetId);if(!t)return null;for(var n=0;n<this.behaviors.length;n++){var r=this.behaviors[n];if(!(null===r||void 0===r?void 0:r.gridRange)||!Object(rr.b)(t,r.gridRange))return{isWarningOnly:!1,error:{title:"\u65e0\u6cd5\u7b5b\u9009",content:"\u672a\u627e\u5230\u53ef\u521b\u5efa\u7b5b\u9009\u7684\u533a\u57df\uff0c\u8bf7\u9009\u62e9\u6709\u6570\u636e\u7684\u533a\u57df\u540e\u91cd\u8bd5\u3002",btnTxt:"\u786e\u5b9a"}}}return null}},{key:"do",value:function(e,t,n){var r=nr.a.getRandomId(),a=e.gridRange,o=e.sheetId,s=t.sheetManager.getSheetBySheetId(o);if(s){var i,l=Object(rr.c)(s,a),c=Object(Vn.a)(l,3),u=c[0],d=c[1],f=c[2];switch(n(new Re.a({gridRange:u,sheetId:o,delta:{hiddenRows:[],defaultFilterId:r,criteriaDelta:{}}})),d){case rr.a.SINGLE_CELL:i="single_cell_filter";break;case rr.a.ONE_ROW_PART:case rr.a.ONE_ROW_WHOLE:i=f?"single_merge_row_filter":"single_row_filter";break;case rr.a.SINGLE_MERGE_CELL:i="single_merge_cell_filter";break;default:i="multi_cell_filter"}Se.b.tdwReport({opername:"doc_excel_editor",module:"excel_filter",action:i})}}},{key:"id",get:function(){return a.a.SET_BASIC_FILTER_REQUEST}}]),n}(f.a);or.id=a.a.SET_BASIC_FILTER_REQUEST;var sr=or;function ir(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var lr=function(e){Object(l.a)(n,e);var t=ir(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheetId,a.behaviors=[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=e.sheetId,a=null===t||void 0===t?void 0:t.sheetManager.getSheetBySheetId(r),o=null===a||void 0===a?void 0:a.getBasicFilter();if(o){var s=o.workbookRangeId;n(new ye.a({sheetId:r,delta:{defaultFilterId:s}}))}}},{key:"afterdo",value:function(){}},{key:"id",get:function(){return n.id}}]),n}(f.a);lr.id=a.a.CLEAR_BASIC_FILTER_REQUEST;var cr=lr,ur=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),dr=n("./src/external/view/main/panel/FillterPanel/utils/filterUtil.ts"),fr=function(e,t){e=e.clone();var n={},r=e.range.startRowIndex,a=e.range.endRowIndex,o=e.criteriaMap,s=[];return o.forEach((function(e,o){var i=e.visibleValues||[],l=!1;void 0===i&&(i=e.hiddenValues,l=!0);var c=i.reduce((function(e,t){return e[t]=1,e}),{}),u=r;for(u+=1;u<=a;u++){var d=Object(dr.c)(t.activeSheet,u,o);null!==d&&void 0!==d||(d=""),void 0===n[u]&&hr(c[d],l)&&(s.push(u),n[u]=1)}})),s},hr=function(e,t){return t?e:!e};function pr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pr(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var br=function(e){Object(l.a)(n,e);var t=mr(n);function n(e,r){var a;Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheetId,a.delta=e.delta,a.rangeFilterId=e.rangeFilterId;var o=Object(ur.a)(a),i=o.sheetId,l=o.rangeFilterId,c=Object(ur.a)(a).delta;return a.isFilterSyncOn=e.isFilterSyncOn,a.behaviors=[{updateType:_e.a.UPDATE,workbookRangeId:l,delta:c,sheetId:i},{updateType:_e.a.RECAL,workbookRangeId:l,delta:c,sheetId:i}],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=e.sheetId,a=t.sheetManager.getSheetBySheetId(r);a&&(e.updateType===_e.a.UPDATE&&this.doUpdateCriteria(e,t,n),e.updateType===_e.a.RECAL&&this.doRecal(e,t,n,a))}},{key:"doRecal",value:function(e,t,n,r){var a=e.delta,o=e.updateType,s=e.workbookRangeId,i=e.sheetId,l=a.updateColumnCriteriaDelta,c=a.defaultFilterId,u=[];if(a.defaultFilterId){var d=r.getBasicFilter();if(!d||!l)return;l.forEach((function(e){Object(_e.c)(e,d)})),u=fr(d,t)}n(new _e.b({delta:{defaultFilterId:c,hiddenRows:u},updateType:o,workbookRangeId:s,sheetId:i,nonPersistingLocalChange:!this.isFilterSyncOn}))}},{key:"doUpdateCriteria",value:function(e,t,n){var r=e.sheetId;t.sheetManager.getSheetBySheetId(r)&&n(new _e.b(gr(gr({},e),{},{nonPersistingLocalChange:!this.isFilterSyncOn})))}},{key:"id",get:function(){return n.id}}]),n}(f.a);br.id=a.a.UPDATE_FILTER_CRITERIA_REQUEST;var vr,Ir=br;function _r(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}!function(e){e[e.SWITCH=0]="SWITCH",e[e.SYNC_FILTER=1]="SYNC_FILTER"}(vr||(vr={}));var yr=function(e){Object(l.a)(n,e);var t=_r(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).isOn=e.isOn,r.behaviors=[{type:vr.SWITCH}],r}return Object(i.a)(n,[{key:"check",value:function(e){var t=this;return this.isOn&&e.sheetManager.sheetList.forEach((function(e){if(e.isLoaded){var n=e.getBasicFilter();n&&t.behaviors.push({type:vr.SYNC_FILTER,sheetId:e.getSheetId(),basicFilter:n})}})),null}},{key:"do",value:function(e,t,n){e.type===vr.SWITCH?n(new gn.k({isOn:this.isOn})):e.type===vr.SYNC_FILTER&&n(function(e,t){for(var n=t.getHiddenRows(),r=t.workbookRangeId,a=t.range,o=[],s=a.startColIndex,i=a.endColIndex;s<=i;s++){var l=t.getColFilterCriteria(s);l?o.push({columnIndex:s,criteria:{visibleValues:l.visibleValues}}):o.push({columnIndex:s,clear:!0})}return new gn.m({updateType:_e.a.UPDATE,sheetId:e,workbookRangeId:r,delta:{defaultFilterId:r,hiddenRows:n,updateColumnCriteriaDelta:o}})}(e.sheetId,e.basicFilter))}},{key:"id",get:function(){return n.id}}]),n}(f.a);yr.id=a.a.SWITCH_FILTER_SYNC_REQUEST;var Rr=yr;function Er(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Or=function(e){Object(l.a)(n,e);var t=Er(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=[],a.sheetId=e.sheetId,a.nonPersistingLocalChange=!1,r?a.behaviors.push({sheetRangeId:e.sheetRangeId,gridRange:new b.b(a.sheetId,r.activeCell.rowIndex,r.activeCell.rowIndex,r.activeCell.colIndex,r.activeCell.colIndex),sheetRangeType:e.sheetRangeType}):e.gridRange&&a.behaviors.push({sheetRangeId:e.sheetRangeId,gridRange:new b.b(e.gridRange.sheetId,e.gridRange.startRowIndex,e.gridRange.startRowIndex,e.gridRange.startColIndex,e.gridRange.startColIndex),sheetRangeType:e.sheetRangeType}),a}return Object(i.a)(n,[{key:"check",value:function(e){var t;return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u53ea\u80fd\u7ed9\u552f\u4e00\u5355\u5143\u683c\u8bbe\u7f6e\u6279\u6ce8\u3002"}},this.behaviors.length>1?t:this.behaviors[0].gridRange.isSingle()?null:t}},{key:"do",value:function(e,t,n){t.sheetManager.getSheetBySheetId(this.sheetId)&&n(new Bt.a({sheetId:this.sheetId,sheetRangeId:e.sheetRangeId,gridRange:e.gridRange,sheetRangeType:e.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,padId:Rt.a.getConfig("padId")}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);Or.id=a.a.DEFINE_COMMENT_RANGE_REQUEST;var Sr=Or;function Tr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var wr=function(e){Object(l.a)(n,e);var t=Tr(n);function n(e,r){var a;Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=[],a.sheetId=e.sheetId;var o={sheetRangeId:e.sheetRangeId,sheetRangeType:Ft.a.COMMENT_RANGE};return a.behaviors.push(o),a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=t.sheetManager.getSheetBySheetId(this.sheetId);r&&(null!==r.sheetRangeManager.getSheetRange(e.sheetRangeId)&&n(new Ht.a({sheetId:this.sheetId,sheetRangeId:e.sheetRangeId,nonPersistingLocalChange:!1})))}},{key:"id",get:function(){return n.id}}]),n}(f.a);wr.id=a.a.DELETE_COMMENT_RANGE_REQUEST;var kr=wr;function jr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var xr=function(e){Object(l.a)(n,e);var t=jr(n);function n(e,r){var a,o,i,l,c,u;if(Object(s.a)(this,n),o=t.call(this,e,r),i=e.sheetId?e.sheetId:(null===r||void 0===r?void 0:r.activeCell.sheetId)||"",null===(a=e.data)||void 0===a?void 0:a.length)for(l=0,c=e.data.length;l<c;l++){var d=e.data[l];u={gridRange:new b.b(i,d.rowIndex,d.rowIndex,d.colIndex,d.colIndex),options:{sheetId:i,userEnterValue:d.userEnterValue,linkUrl:Object(kn.d)(d.userEnterValue,!1)}},o.behaviors.push(u)}return o}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r,a,o=e.gridRange.sheetId,s=t.sheetManager.getSheetBySheetId(o);if(s){var i=e.options,l=e.gridRange,c=s.getCellDataAtPosition(l.startRowIndex,l.startColIndex),u=this.getCellDataDelta(c,i.userEnterValue,i.linkUrl,l.startRowIndex,l.startColIndex,o);n(new K.a({gridRange:l,cellDataDelta:u}));for(r=0,a=this.behaviors.length;r<a;r++){this.behaviors[r].options;var d=this.behaviors[r].gridRange;if(Object(cn.b)(s,[d])){!0;break}}var f=Object(cn.a)(s);f.length>0&&n(f[0])}}},{key:"getCellDataDelta",value:function(e,t,n,r,a,o){return Object($e.b)({cellData:e,sheetId:o,rowIndex:r,colIndex:a,linkUrl:n,userEnterValue:t})}},{key:"id",get:function(){return n.id}}]),n}(f.a);function Cr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}xr.id=a.a.SET_RANGE_VALUE_REQUEST;var Dr=function(e){Object(l.a)(n,e);var t=Cr(n);function n(e,r){var a;Object(s.a)(this,n),a=t.call(this,e,r);var o=e.gridRanges||(null===r||void 0===r?void 0:r.rangeSelections)||[];return a.behaviors=o.map((function(t){return{gridRange:t,dataValidation:e.dataValidation}})),a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=this.getCellDataDelta(e.dataValidation),a=[e.gridRange],o=t.sheetManager.getSheetBySheetId(e.gridRange.sheetId);if(!r.isEmpty()&&o){a=Object(U.divideGridRangesByFilter)(a,o.getBasicFilter());for(var s=0,i=(a=Object(U.divideGridRangesByMerges)(a,o.mergeManager.mergeList)).length;s<i;s++)n(new K.a({gridRange:a[s],cellDataDelta:r}))}}},{key:"getCellDataDelta",value:function(e){var t=new Pe.a,n=new Ie.a;return null==e?(t.clearSlot(Be.b.DATA_VALIDATION),n.clearSlot(I.b.SLOT_IS_DATA_VALID),n.setSlot(I.b.SLOT_USER_ENTERED_FORMAT_DELTA,t)):(t.setSlot(Be.b.DATA_VALIDATION,e),n.setSlot(I.b.SLOT_USER_ENTERED_FORMAT_DELTA,t)),n}},{key:"id",get:function(){return n.id}}]),n}(f.a);Dr.id=a.a.SET_DATA_VALIDATION_REQUEST;var Ar=Dr;function Mr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Lr=function(e){Object(l.a)(n,e);var t=Mr(n);function n(e,r){var a;if(Object(s.a)(this,n),(a=t.call(this,e,r)).sheetId=e.sheetId,a.type=e.type,e.dimensionRanges){a.behaviors=[];for(var o=Math.max(e.dimensionRanges.length,e.formDatas.length),i=0;i<o;i++)e.dimensionRanges[i].dimension===a.type&&a.behaviors.push({dimensionRange:e.dimensionRanges[i],formData:e.formDatas[i]})}return a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r,a=t.sheetManager.getSheetBySheetId(e.dimensionRange.sheetId);if(a){var o=Object(U.divideDimensionRangeByFilter)([e.dimensionRange],a.getBasicFilter());for(r=0;r<o.length;r++){var s=o[r],i=e.formData;n(new g.c({ranges:[s],operation:[{slot:g.a.SLOT_FORMDATA,formData:i}],sheetId:this.sheetId,type:this.type}))}}}},{key:"id",get:function(){return n.id}}]),n}(f.a);Lr.id=a.a.SET_DIMENSION_FORMDATA_REQUEST;var Nr=Lr;function Ur(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Pr=function(e){Object(l.a)(n,e);var t=Ur(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=e.requests,a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){e.run(t,n)}},{key:"predictRequestSize",value:function(e){var t,n,r=0;for(t=0,n=this.behaviors.length;t<n;t++)r+=this.behaviors[t].predictRequestSize(e);return r}},{key:"getRanges",value:function(e){var t,n,r=[];for(t=0,n=this.behaviors.length;t<n;t++)r=[].concat(Object(o.a)(r),Object(o.a)(this.behaviors[t].getRanges(e)));return r}},{key:"check",value:function(e){var t,n,r;for(t=0,n=this.behaviors.length;t<n;t++)if(null!==(r=this.behaviors[t].check(e)))return r;return null}},{key:"id",get:function(){return n.id}}]),n}(f.a);Pr.id=a.a.MULTI_REQUEST;var Fr=Pr,Br=n("../packages/mutation/src/conditionalFormat/AddConditionalFormatMutation.ts"),Hr=n("../packages/model/src/rule/BooleanConditionalFormat.ts"),Gr=n("../packages/model/src/rule/BooleanCondition.ts"),zr=n("../packages/model/src/rule/ConditionValue.ts"),qr=n("../packages/model/src/rule/ArgTokenType.ts"),Vr=n("../packages/model/src/cell/format/colorUtils.ts");function Qr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}function Wr(e){var t=e.booleanConditionalFormat,n=t.condition,r=t.format,a=[];if(n.userInputOne){var o=new zr.a({type:qr.a.VALUE_TOKEN,userEnteredValue:n.userInputOne});a.push(o)}if(n.userInputTwo){var s=new zr.a({type:qr.a.VALUE_TOKEN,userEnteredValue:n.userInputTwo});a.push(s)}var i=Object(Vr.colorValues)("".concat(r.bgColor));return new O.a({ruleRanges:e.ruleRanges,booleanConditionalFormat:new Hr.a({condition:new Gr.b({type:e.booleanConditionalFormat.condition.conditionType,values:a}),format:kt.CellFormatFactory.createInstance({setSlots:1<<Be.b.BACKGROUND_COLOR,backgroundColor:kt.ColorFactory.createInstance({red:i[0],green:i[1],blue:i[2]})}),stopIftrue:!1}),uid:e.userId})}var Yr=function(e){Object(l.a)(n,e);var t=Qr(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=[e],a}return Object(i.a)(n,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){var r=e.rule,a=null===t||void 0===t?void 0:t.activeSheetId;if(null===t||void 0===t?void 0:t.sheetManager.getSheetBySheetId(a)){var o={sheetId:a,ruleIndex:0,rule:Wr(r)};n(new Br.a(o))}}},{key:"id",get:function(){return n.id}}]),n}(f.a);Yr.id=a.a.ADD_CONDITIONAL_FORMAT_REQUEST;var Kr=Yr,Zr=n("../packages/mutation/src/conditionalFormat/DeleteConditionalFormatMutation.ts");function Xr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Jr=function(e){Object(l.a)(n,e);var t=Xr(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).ruleIndex=e.ruleIndex,a.behaviors=[e],a}return Object(i.a)(n,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){var r,a=e.ruleIndex,o=null===t||void 0===t?void 0:t.activeSheetId,s=null===t||void 0===t?void 0:t.sheetManager.getSheetBySheetId(o),i=null===s||void 0===s||null===(r=s.conditionalFormatRuleManager)||void 0===r?void 0:r.getConditionalFormatRuleByRuleIndex(a);i&&n(new Zr.a({sheetId:o,ruleIndex:a,oldRuleRanges:i.ruleRanges}))}},{key:"afterdo",value:function(){}},{key:"id",get:function(){return n.id}}]),n}(f.a);Jr.id=a.a.DELETE_CONDITIONAL_FORMAT_REQUEST;var $r=Jr;function ea(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ta=function(e){Object(l.a)(n,e);var t=ea(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).ruleIndex=e.ruleIndex,a.behaviors=[e],a}return Object(i.a)(n,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){var r,a=e.ruleIndex,o=e.rule,s=null===t||void 0===t?void 0:t.activeSheetId,i=null===t||void 0===t?void 0:t.sheetManager.getSheetBySheetId(s),l=null===i||void 0===i||null===(r=i.conditionalFormatRuleManager)||void 0===r?void 0:r.getConditionalFormatRuleByRuleIndex(a);if(l){var c=Wr(o);n(new S.a({sheetId:s,ruleIndex:a,rule:c,oldRuleRanges:l.ruleRanges}))}}},{key:"afterdo",value:function(){}},{key:"id",get:function(){return n.id}}]),n}(f.a);ta.id=a.a.UPDATE_CONDITIONAL_FORMAT_REQUEST;var na=ta,ra=(n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../packages/mutation/src/sheet/DeleteSheetMutation.ts")),aa=n("../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts"),oa=n("../packages/mutation/src/new-embedded/NewDeleteEmbeddedObjectMutation.ts");function sa(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ia(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ia(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function la(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ca=function(e){Object(l.a)(n,e);var t=la(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=e,a}return Object(i.a)(n,[{key:"isMultiSheetRequest",value:function(){return!0}},{key:"check",value:function(e){var t=null;if(e.sheetManager.getDisplayedSheetList().length<=1)return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u81f3\u5c11\u4fdd\u7559\u4e00\u4e2a\u53ef\u67e5\u770b\u7684\u5de5\u4f5c\u8868\u3002"}};for(var n,r=0;n=this.behaviors[r+=1];){if(!e.sheetManager.getSheetBySheetId(n.sheetId))return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u4f60\u6240\u5220\u9664\u7684\u5de5\u4f5c\u8868\u4e0d\u5b58\u5728\u3002"}};if(e.sheetManager.getSheetBySheetId(n.sheetId).getIndex()!==n.sheetIndex)return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\b\u53c2\u6570\u4e0d\u4e00\u81f4,\u8bf7\u91cd\u8bd5\u3002"}}}return t}},{key:"do",value:function(e,t,n){var r=this.getWorkbookRangeIdList(t,e.sheetId);r.length>0&&r.forEach((function(e){n(new aa.a({workbookRangeId:e,workbookRangeType:we.a.PROTECTED_RANGE}))})),t.embeddedObjectManager.each((function(t){var r=t.location;e.sheetId===r.sheetId&&(n(new oa.a({objectId:t.objectId,sheetId:e.sheetId})),t.properties.chart.workbookRangeId.forEach((function(e){n(new aa.a({workbookRangeId:e,workbookRangeType:we.a.CHART}))})))})),n(new ra.a(e))}},{key:"getWorkbookRangeIdList",value:function(e,t){var n,r=[],a=sa(e.workbookRangeManager.protectedRangeMap.entries());try{for(a.s();!(n=a.n()).done;){var o=Object(Vn.a)(n.value,2),s=o[0];o[1].range.sheetId===t&&r.push(s)}}catch(i){a.e(i)}finally{a.f()}return r}},{key:"id",get:function(){return n.id}}]),n}(f.a);ca.id=a.a.DELETE_SHEET_REQUEST;var ua=ca,da=n("../packages/mutation/src/sheet/InsertSheetMutation.ts");function fa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ha=function(e){Object(l.a)(n,e);var t=fa(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,e)).behaviors=[];for(var a=0;a<e.length;a++){var o={sheetId:e[a].sheetId,sheetIndex:e[a].sheetIndex,sheetName:e[a].sheetName,sheetType:e[a].sheetType,rowCount:dn.DEFAULT_ROW_COUNT,colCount:dn.DEFAULT_COL_COUNT,delta:new Qe.b({operation:We.a.INSERT_SHEET,delta:{name:e[a].sheetName,rightToLeft:!1,hideGridline:!1,frozenRowCount:0,frozenColCount:0,hidden:e[a].isHidden}})};r.behaviors.push(o)}return r}return Object(i.a)(n,[{key:"isMultiSheetRequest",value:function(){return!0}},{key:"check",value:function(e){var t=null,n=e.sheetManager.sheetCount;if(n>=256)return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u5de5\u4f5c\u8868\u521b\u5efa\u4e0d\u6210\u529f, \u5de5\u4f5c\u8868\u6570\u91cf\u5df2\u8fbe\u6700\u5927\u9650\u5236\u3002"}};for(var r,a=0;r=this.behaviors[a];){if(a+=1,r.sheetIndex>n)return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u65b0\u589e\u5de5\u4f5c\u8868\u51fa\u73b0\u95ee\u9898\uff0c\u7d22\u5f15\u8d85\u51fa\u8303\u56f4\u3002"}};if(e.sheetManager.hasSheetId(r.sheetId))return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u65b0\u589e\u5de5\u4f5c\u8868\u51fa\u73b0\u95ee\u9898\uff0c\u5de5\u4f5c\u8868ID\u91cd\u590d\u3002"}};e.sheetManager.hasSheetTitle(r.sheetName)&&(t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u65b0\u589e\u5de5\u4f5c\u8868\u51fa\u73b0\u95ee\u9898\uff0c\u5de5\u4f5c\u8868\u540d\u91cd\u590d\u3002"}})}return t}},{key:"do",value:function(e,t,n){n(new da.a({sheetId:e.sheetId,sheetIndex:e.sheetIndex,sheetType:e.sheetType,sheetDelta:e.delta,rowCount:e.rowCount,colCount:e.colCount}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);ha.id=a.a.INSERT_SHEET_REQUEST;var pa=ha,ga=n("../packages/mutation/src/sheet/MoveSheetMutation.ts");function ma(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ba=function(e){Object(l.a)(n,e);var t=ma(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=e,a}return Object(i.a)(n,[{key:"isMultiSheetRequest",value:function(){return!0}},{key:"check",value:function(e){for(var t=null,n=e.sheetManager.sheetCount,r=0,a=this.behaviors.length;r<a;r++){var o=this.behaviors[r];return(o.fromIndex<0||o.fromIndex>=n||o.toIndex<0||o.toIndex>=n)&&(t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u79fb\u52a8\u5de5\u4f5c\u8868\u7684\u7d22\u5f15\u51fa\u73b0\u95ee\u9898"}}),t}return t}},{key:"do",value:function(e,t,n){n(new ga.a(e))}},{key:"id",get:function(){return n.id}}]),n}(f.a);ba.id=a.a.MOVE_SHEET_REQUEST;var va=ba;function Ia(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var _a=function(e){Object(l.a)(n,e);var t=Ia(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).behaviors=e,r}return Object(i.a)(n,[{key:"isMultiSheetRequest",value:function(){return!0}},{key:"check",value:function(e){for(var t,n=null,r=0;t=this.behaviors[r];)if(r+=1,t.hidden){for(var a=0,o=0,s=e.sheetManager.sheetList.length;o<s;o++){var i=e.sheetManager.sheetList[o];i.getDisplayHidden()||(a+=1)}if(a<=1)return n={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u5fc5\u987b\u4fdd\u7559\u4e00\u4e2a\u5de5\u4f5c\u8868"}}}return n}},{key:"do",value:function(e,t,n){n(new Ve.a({sheetId:e.sheetId,sheetDelta:new Qe.b({operation:We.a.SET_PROPERTIES,delta:{hidden:e.hidden}})}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);_a.id=a.a.HIDE_SHEET_REQUEST;var ya=_a,Ra=n("./src/core/behavior/request/multisheet/RenameSheetRequest.ts"),Ea=n("./src/core/data/converter/tencentdoc/handleKeyframe/keyframeOne.ts"),Oa=n("./src/base/config/version.ts");function Sa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ta=function(e){Object(l.a)(n,e);var t=Sa(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).behaviors=e,r}return Object(i.a)(n,[{key:"isMultiSheetRequest",value:function(){return!0}},{key:"check",value:function(e){var t=null,n=e.sheetManager.sheetCount;if(n>=256)return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u5de5\u4f5c\u8868\u521b\u5efa\u4e0d\u6210\u529f, \u5de5\u4f5c\u8868\u6570\u91cf\u5df2\u8fbe\u6700\u5927\u9650\u5236\u3002"}};for(var r,a=0;r=this.behaviors[a];){if(a+=1,r.sheetIndex>n)return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u65b0\u589e\u5de5\u4f5c\u8868\u51fa\u73b0\u95ee\u9898\u3002"}};if(e.sheetManager.hasSheetId(r.newSheetId))return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u5de5\u4f5c\u8868ID\u5df2\u5b58\u5728, \u8bf7\u91cd\u8bd5\u3002"}}}return t}},{key:"do",value:function(e,t,n){var r=t.sheetManager.getSheetBySheetId(e.sheetId);if(r){t.copyWorkbookDataWhenCopySheet(r.getSheetId(),e.newSheetId),n(new da.a({sheetId:e.newSheetId,sheetIndex:r.getIndex()+1,sheetType:r.getSheetType(),rowCount:r.getRowCount(),colCount:r.getColCount(),sheetDelta:new Qe.b({operation:We.a.COPY_SHEET,delta:{name:e.newSheetName,rowCount:r.getRowCount(),colCount:r.getColCount(),rightToLeft:r.getIsRtl(),hideGridline:r.getHideGridlines(),frozenRowCount:r.getFrozenRowCount(),frozenColCount:r.getFrozenColCount(),hidden:r.getDisplayHidden(),tabColor:r.getTabColor().toHex()}})}));var a=t.sheetManager.getSheetBySheetId(e.newSheetId);a&&(this.copySheetData(a,r),a.isLoaded=!0)}}},{key:"copySheetData",value:function(e,t){var n=JSON.stringify(t.serialize()),r=e.getSheetId(),a=e.getTitle();Object(Ea.a)(e,n,0,0,Oa.a.KEYFRAME_VER),e.sheetRangeManager.each((function(t,n){e.sheetRangeManager.deleteSheetRange(n)})),e.setSheetId(r),e.setTitle(a)}},{key:"id",get:function(){return n.id}}]),n}(f.a);Ta.id=a.a.COPY_SHEET_REQUEST;var wa=Ta,ka=function e(t){Object(s.a)(this,e),this.soft=!1,this.holes=[],this.description="",this.range=t.range,void 0!==t.holes&&(this.holes=t.holes),void 0!==t.description&&(this.description=t.description),void 0!==t.soft&&(this.soft=t.soft)},ja=n("../packages/model/src/workbookRange/protectedRange/ProtectionProperties.ts"),xa=n("../packages/mutation/src/workbook/workbookRange/DefineWorkbookRangeMutation.ts");function Ca(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Da=function(e){Object(l.a)(n,e);var t=Ca(n);function n(e,r){var a;Object(s.a)(this,n),a=t.call(this,e,r);var o=e.workbookRangeId,i=new ka(e);return a.behaviors=[{data:i,workbookRangeId:o}],a}return Object(i.a)(n,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){var r=new ke.a,a=(new Date).valueOf(),o=new ja.a({hole:e.data.holes.length>0,softProtection:e.data.soft,description:e.data.description,modifyTime:a});r.setProtectionProperties(o),n(new xa.a({workbookRangeId:e.workbookRangeId,gridRange:e.data.range,workbookRangeType:we.a.PROTECTED_RANGE,workbookRangePropertiesDelta:r}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);Da.id=a.a.ADD_PROTECTED_RANGE_REQUEST;var Aa=Da;function Ma(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var La=function(e){Object(l.a)(n,e);var t=Ma(n);function n(e,r){var a;Object(s.a)(this,n),a=t.call(this,e,r);var o=e.workbookRangeId,i=new ka(e);return a.behaviors=[{data:i,workbookRangeId:o,ignoreHoles:e.ignoreHoles}],a}return Object(i.a)(n,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){var r=t.workbookRangeManager.getProtectedRangeById(e.workbookRangeId);if(null!==r){var a=new ke.a,o=(new Date).valueOf(),s=new ja.a({hole:r.properties.hole,softProtection:r.properties.softProtection,description:r.properties.description,modifyTime:o});void 0!==e.ignoreHoles?s.hole=e.ignoreHoles:void 0!==e.data.holes&&(s.hole=e.data.holes.length>0),void 0!==e.data.soft&&(s.softProtection=e.data.soft),void 0!==e.data.description&&(s.description=e.data.description),a.setProtectionProperties(s),n(new Te.a({workbookRangeId:e.workbookRangeId,gridRange:e.data.range,workbookRangeType:we.a.PROTECTED_RANGE,workbookRangePropertiesDelta:a}))}else console.error("updateProtectedRange fail, because workbookRangeId no match")}},{key:"id",get:function(){return n.id}}]),n}(f.a);La.id=a.a.UPDATE_PROTECTED_RANGE_REQUEST;var Na=La;function Ua(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Pa=function(e){Object(l.a)(n,e);var t=Ua(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=[],e.workbookRangeIds.forEach((function(e){a.behaviors.push({workbookRangeId:e})})),a}return Object(i.a)(n,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){n(new aa.a({workbookRangeId:e.workbookRangeId,workbookRangeType:we.a.PROTECTED_RANGE}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);Pa.id=a.a.DELETE_PROTECTED_RANGE_REQUEST;var Fa=Pa,Ba=n("../packages/mutation/src/new-embedded/NewAddEmbeddedObjectMutation.ts"),Ha=n("../packages/model/src/new-embedded/EmbeddedObjectType.ts");function Ga(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var za=function(e){Object(l.a)(n,e);var t=Ga(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=e instanceof Array?e:[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){e.objects.forEach((function(t){var r=t.properties.type,a=nr.a.getRandomId();switch(r){case Ha.a.CHART:if(t.properties.chart){var o=e.range||new b.b(t.location.sheetId),s=new ke.a;s.setEmbeddedObjectId(t.objectId),n(new xa.a({gridRange:o,workbookRangeId:a,workbookRangeType:we.a.CHART,workbookRangePropertiesDelta:s}));var i=t.properties.chart;i&&i.addWorkbookRangeId(a)}}n(new Ba.a({object:t}))}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);za.id=a.a.ADD_EMBEDDED_OBJECT;var qa=za;function Va(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Qa=function(e){Object(l.a)(n,e);var t=Va(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=e instanceof Array?e:[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){e.objects.forEach((function(t){switch(t.properties.type){case Ha.a.CHART:var r=t.properties.chart;if(r){var a=e.range;if(a){var o=new ke.a;o.setEmbeddedObjectId(t.objectId),n(new Te.a({gridRange:a,workbookRangeId:r.workbookRangeId[0],workbookRangeType:we.a.CHART,workbookRangePropertiesDelta:o}))}}}n(new Ye.a({object:t}))}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);Qa.id=a.a.UPDATE_EMBEDDED_OBJECT;var Wa=Qa;function Ya(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ka=function(e){Object(l.a)(n,e);var t=Ya(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=e instanceof Array?e:[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){switch(e.embeddedObjectType){case Ha.a.CHART:var r=t.embeddedObjectManager.getEmbeddedObject(e.objectId);if(r){var a=r.properties.chart;if(a){var o=a.workbookRangeId;n(new oa.a({objectId:e.objectId,sheetId:e.sheetId})),o.forEach((function(e){n(new aa.a({workbookRangeId:e,workbookRangeType:we.a.CHART,nonPersistingLocalChange:!1}))}))}}}}},{key:"id",get:function(){return n.id}}]),n}(f.a);Ka.id=a.a.DELETE_EMBEDDED_OBJECT;var Za,Xa=Ka,Ja=n("../packages/model/src/filter/SortOrder.ts");function $a(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}!function(e){e[e.ReverseOrder=0]="ReverseOrder",e[e.PositiveSequence=1]="PositiveSequence"}(Za||(Za={}));var eo=function(e){Object(l.a)(n,e);var t=$a(n);function n(e,r){var a;Object(s.a)(this,n),(a=t.call(this,e,r)).gridRange=e.gridRange,a.sheetId=e.sheetId;var o=e.filter,i=o.rangeFilterId,l=o.isFilterSyncOn,c=e.filter.delta,u=e.reorder,d=u.reorderInfos,f=u.hasTitle,h=d.map((function(e){return{sortOrder:e.type===Za.PositiveSequence?Ja.a.ASCENDING:Ja.a.DESCENDING,dimensionIndex:e.column}}));return a.behaviors=[{type:"filter",updateType:_e.a.UPDATE,workbookRangeId:i,delta:c,sheetId:a.sheetId,sortSpecs:h,nonPersistingLocalChange:!l},{type:"filter",updateType:_e.a.RECAL,workbookRangeId:i,delta:c,sheetId:a.sheetId,sortSpecs:h,nonPersistingLocalChange:!l},{type:"reorder",reorderInfos:d,hasTitle:f}],l||a.behaviors.unshift({type:"filter",updateType:_e.a.UPDATE,workbookRangeId:i,delta:{defaultFilterId:c.defaultFilterId},sheetId:a.sheetId,sortSpecs:h,nonPersistingLocalChange:!1}),a}return Object(i.a)(n,[{key:"check",value:function(e){var t,n,r=null,a=e.sheetManager.getSheetBySheetId(this.sheetId),o=this.gridRange;if(null===a)return r={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}};var s=a.mergeManager.mergeList;for(n=0;n<s.length;n++)if(t=s[n],o.isCross(t)){var i="";return t.startColIndex===t.endColIndex&&t.startRowIndex!==t.endRowIndex?i="\u7eb5\u5411\u7684":t.startColIndex!==t.endColIndex&&t.startRowIndex===t.endRowIndex&&(i="\u6a2a\u5411\u7684"),r={isWarningOnly:!1,error:{title:"\u6392\u5e8f\u63d0\u793a",content:"\u4f60\u7684\u6392\u5e8f\u533a\u57df\u4e2d\u5305\u542b".concat(i,"\u5408\u5e76\u5355\u5143\u683c ").concat(t.toString()," \uff0c\u8bf7\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c\u540e\u518d\u8fdb\u884c\u6392\u5e8f\u3002")}}}return r}},{key:"do",value:function(e,t,n){var r,a,o,s,i,l=this.gridRange,c=t.sheetManager.getSheetBySheetId(this.sheetId);if(c)switch(e.type){case"filter":e.updateType===_e.a.UPDATE&&this.doUpdateCriteria(e,t,n),e.updateType===_e.a.RECAL&&this.doRecal(e,t,n,c);break;case"reorder":for(r=this.createUnmergeCellsMutations(t),o=0;o<r.length;o++)n(r[o]);for(i=this.reorder(c,l,e.hasTitle,e.reorderInfos),a=this.createUpdateSheetRangeMutations(t,i,l),n(new et.a({sheetId:this.sheetId,range:l,operation:i})),a.length>0&&a.forEach((function(e){n(e)})),o=0;o<r.length;o++)r[o]instanceof ge.a&&(s=r[o].startRowIndex,i.rules[s]?n(new y.a({sheetId:this.sheetId,startRowIndex:i.rules[s].to,endRowIndex:i.rules[s].to,startColIndex:r[o].startColIndex,endColIndex:r[o].endColIndex})):n(new y.a({sheetId:this.sheetId,startRowIndex:r[o].startRowIndex,endRowIndex:r[o].endRowIndex,startColIndex:r[o].startColIndex,endColIndex:r[o].endColIndex})))}}},{key:"doRecal",value:function(e,t,n,r){var a=e.delta,o=e.updateType,s=e.workbookRangeId,i=e.sheetId,l=e.sortSpecs,c=e.nonPersistingLocalChange,u=a.updateColumnCriteriaDelta,d=a.defaultFilterId,f=[];if(a.defaultFilterId){var h=r.getBasicFilter();if(!h||!u)return;u.forEach((function(e){Object(_e.c)(e,h)})),f=fr(h,t)}n(new _e.b({delta:{defaultFilterId:d,hiddenRows:f},updateType:o,workbookRangeId:s,sheetId:i,sortSpecs:l,nonPersistingLocalChange:c}))}},{key:"doUpdateCriteria",value:function(e,t,n){var r=e.sheetId;t.sheetManager.getSheetBySheetId(r)&&n(new _e.b(e))}},{key:"createUnmergeCellsMutations",value:function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return new ve({sheetId:n.getSheetId(),gridRanges:[this.gridRange]}).run(e,(function(e){t.push(e)})),t}},{key:"reorder",value:function(e,t,n,r){var a,o,s,i={queue:[],rules:{}},l=[],c=[],u=e.getBasicFilter(),d=[];for(u&&(d=u.getHiddenRows()),o=t.startRowIndex<0?e.data.startRow:t.startRowIndex,s=t.endRowIndex<0?e.data.rowData.length-1:t.endRowIndex,n&&(o+=1),a=o;a<=s;a++)d.indexOf(a)>=0||(l.push({index:a}),c.push({index:a,value:this.getCellData(e,a,r)}));for(c.sort(St(r)),a=0;a<c.length;a++)c[a].index!==l[a].index&&(i.queue.push("".concat(c[a].index)),i.rules["".concat(c[a].index)]={from:c[a].index,to:l[a].index});return i}},{key:"getCellData",value:function(e,t,n){for(var r,a=[],o=0;o<n.length;o++)r=n[o].column,null!==e.data.rowData[t]&&(e.getCellDataAtPosition(t,r)?a.push(e.data.rowData[t]?e.data.rowData[t].values[r]:null):a.push(null));return a}},{key:"createUpdateSheetRangeMutations",value:function(e,t,n){var r=[],a=e.sheetManager.getSheetBySheetId(this.sheetId),o=this.sheetId;for(var s=function(e){for(var s=t.queue[e],i=function(e){var n=a.getCellDataAtPosition(t.rules[s].from,e);if(n){var i=n.getSheetRange();i&&i.forEach((function(n){var a,i,l;a=n,i=t.rules[s].to,l=e,r.push(new Ee.a({sheetId:o,sheetRangeId:a.id,sheetRangeType:a.type,gridRange:new b.b(o,i,i,l,l),padId:Rt.a.getConfig("padId")}))}))}},l=n.startColIndex;l<=n.endColIndex;l++)i(l)},i=0;i<t.queue.length;i++)s(i);return r}},{key:"id",get:function(){return a.a.REORDER_FILTER_REQUEST}}]),n}(f.a);eo.id=a.a.REORDER_FILTER_REQUEST;var to=eo;function no(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ro=function(e){Object(l.a)(n,e);var t=no(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){n(new Ve.a({sheetId:e.sheetId,sheetDelta:new Qe.b({operation:We.a.SET_PROPERTIES,delta:{hideGridline:e.hideGridlines}})}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);ro.id=a.a.SET_HIDE_GRIDLINES_REQUEST;var ao=ro;function oo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var so=function(e){Object(l.a)(n,e);var t=oo(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=this,a=e.cellFlags,o=e.range,s=e.rangeFlags;a?n(new gn.j({gridRange:o,cellDataDeltaAtPositions:a.map((function(e){var t=e.row,n=e.col,a=e.ignoreFlags;return{rowIndex:t,colIndex:n,cellDataDelta:r.getCellDataDelta(a)}}))})):"number"===typeof s&&n(new gn.h({gridRange:o,cellDataDelta:this.getCellDataDelta(s)}))}},{key:"getCellDataDelta",value:function(e){var t=new Ie.a;return e?t.setSlot(I.b.SLOT_IGNORED_ERROR_FLAGS,e):t.clearSlot(I.b.SLOT_IGNORED_ERROR_FLAGS),t}},{key:"id",get:function(){return a.a.SET_IGNORED_ERROR_FLAGS}}]),n}(f.a);so.id=a.a.SET_IGNORED_ERROR_FLAGS;var io=n("./src/core/behavior/request/cell/SetMetadataRequest.ts");function lo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var co=function(e){Object(l.a)(n,e);var t=lo(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this,e,r)).behaviors=[e],a}return Object(i.a)(n,[{key:"do",value:function(e,t,n){var r=e.refIds,a=e.range,o=e.cellValue;n(new gn.h({gridRange:a,cellDataDelta:this.getCellDataDelta(r,o)}))}},{key:"getCellDataDelta",value:function(e,t){var n=new Ie.a;return e?n.setSlot(I.b.SLOT_REF_IDS,e):n.clearSlot(I.b.SLOT_REF_IDS),"string"===typeof t&&n.setSlot(I.b.SLOT_EFFIECTIVE_VALUE,new w.ExtendedValue({type:w.EXTENDED_VALUE_TYPE.STRING,value:t})),n}},{key:"id",get:function(){return a.a.SET_REF_IDS}}]),n}(f.a);co.id=a.a.SET_REF_IDS;var uo=n("../packages/model/src/workbookRange/linkedRange/LinkedRangeProperties.ts"),fo=function e(t){Object(s.a)(this,e),this.namedRangeId=null,this.range=t.range};function ho(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var po=function(e){Object(l.a)(n,e);var t=ho(n);function n(e,r){var a;Object(s.a)(this,n),a=t.call(this,e,r);var o=e.workbookRangeId,i=(e.range,new fo(e));return a.behaviors=[{data:i,workbookRangeId:o}],a}return Object(i.a)(n,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){var r=new ke.a,a=new uo.a({});r.setLinkedRangeProperties(a),n(new xa.a({workbookRangeId:e.workbookRangeId,gridRange:e.data.range,workbookRangeType:we.a.LINKED_RANGE,workbookRangePropertiesDelta:r}))}},{key:"id",get:function(){return n.id}}]),n}(f.a);po.id=a.a.ADD_LINKED_RANGE_REQUEST;var go,mo=po,bo=n("./src/core/behavior/request/cell/SetHyperlinkRunsRequest.ts"),vo=(go={},Object(r.a)(go,C.id,C),Object(r.a)(go,D.a.id,D.a),Object(r.a)(go,Ae.id,Ae),Object(r.a)(go,L.id,L),Object(r.a)(go,H.id,H),Object(r.a)(go,q.id,q),Object(r.a)(go,oe.id,oe),Object(r.a)(go,se.a.id,se.a),Object(r.a)(go,de.id,de),Object(r.a)(go,Tt.id,Tt),Object(r.a)(go,Ue.id,Ue),Object(r.a)(go,qe.id,qe),Object(r.a)(go,pe.a.id,pe.a),Object(r.a)(go,ve.id,ve),Object(r.a)(go,Je.id,Je),Object(r.a)(go,$e.a.id,$e.a),Object(r.a)(go,Ct.id,Ct),Object(r.a)(go,Sn.b.id,Sn.b),Object(r.a)(go,Dn.id,Dn),Object(r.a)(go,On.id,On),Object(r.a)(go,An.a.id,An.a),Object(r.a)(go,Nn.id,Nn),Object(r.a)(go,J.a.id,J.a),Object(r.a)(go,Bn.id,Bn),Object(r.a)(go,qn.id,qn),Object(r.a)(go,tr.id,tr),Object(r.a)(go,sr.id,sr),Object(r.a)(go,cr.id,cr),Object(r.a)(go,Ir.id,Ir),Object(r.a)(go,Rr.id,Rr),Object(r.a)(go,W.id,W),Object(r.a)(go,on.id,on),Object(r.a)(go,xr.id,xr),Object(r.a)(go,Ar.id,Ar),Object(r.a)(go,Sr.id,Sr),Object(r.a)(go,kr.id,kr),Object(r.a)(go,Nr.id,Nr),Object(r.a)(go,to.id,to),Object(r.a)(go,ao.id,ao),Object(r.a)(go,Kr.id,Kr),Object(r.a)(go,$r.id,$r),Object(r.a)(go,na.id,na),Object(r.a)(go,Aa.id,Aa),Object(r.a)(go,Na.id,Na),Object(r.a)(go,Fa.id,Fa),Object(r.a)(go,pa.id,pa),Object(r.a)(go,ua.id,ua),Object(r.a)(go,va.id,va),Object(r.a)(go,ya.id,ya),Object(r.a)(go,Ra.a.id,Ra.a),Object(r.a)(go,wa.id,wa),Object(r.a)(go,qa.id,qa),Object(r.a)(go,Wa.id,Wa),Object(r.a)(go,Xa.id,Xa),Object(r.a)(go,Fr.id,Fr),Object(r.a)(go,so.id,so),Object(r.a)(go,io.b.id,io.b),Object(r.a)(go,co.id,co),Object(r.a)(go,mo.id,mo),Object(r.a)(go,bo.a.id,bo.a),go);function Io(e,t,n){if(!vo[e])throw new Error("unknown request id");if(e===a.a.MULTI_REQUEST)for(var r=0,o=t.requests.length;r<o;r++)t.requests[r]=Io(t.requests[r].requestId,t.requests[r].opt,n);return new(0,vo[e])(t,n)}},"./src/core/data/converter/keyframe/zip.ts":function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return f}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.join.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array-buffer.slice.js"),n("../node_modules/core-js/modules/es.object.get-own-property-names.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.constructor.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.match.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/es.typed-array.uint8-array.js"),n("../node_modules/core-js/modules/es.typed-array.copy-within.js"),n("../node_modules/core-js/modules/es.typed-array.every.js"),n("../node_modules/core-js/modules/es.typed-array.fill.js"),n("../node_modules/core-js/modules/es.typed-array.filter.js"),n("../node_modules/core-js/modules/es.typed-array.find.js"),n("../node_modules/core-js/modules/es.typed-array.find-index.js"),n("../node_modules/core-js/modules/es.typed-array.for-each.js"),n("../node_modules/core-js/modules/es.typed-array.includes.js"),n("../node_modules/core-js/modules/es.typed-array.index-of.js"),n("../node_modules/core-js/modules/es.typed-array.iterator.js"),n("../node_modules/core-js/modules/es.typed-array.join.js"),n("../node_modules/core-js/modules/es.typed-array.last-index-of.js"),n("../node_modules/core-js/modules/es.typed-array.map.js"),n("../node_modules/core-js/modules/es.typed-array.reduce.js"),n("../node_modules/core-js/modules/es.typed-array.reduce-right.js"),n("../node_modules/core-js/modules/es.typed-array.reverse.js"),n("../node_modules/core-js/modules/es.typed-array.set.js"),n("../node_modules/core-js/modules/es.typed-array.slice.js"),n("../node_modules/core-js/modules/es.typed-array.some.js"),n("../node_modules/core-js/modules/es.typed-array.sort.js"),n("../node_modules/core-js/modules/es.typed-array.subarray.js"),n("../node_modules/core-js/modules/es.typed-array.to-locale-string.js"),n("../node_modules/core-js/modules/es.typed-array.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/typeof.js"),a=n("../node_modules/pako/index.js"),o=n.n(a),s=(n("../node_modules/atob/browser-atob.js"),n("../packages/report/src/index.ts")),i=n("./src/base/config/report.ts");function l(e){var t="";try{!function(e){if(!e||!e.k)return;var t,n=e.k.st,r=e.k.s;if("set"===n){var a,o=0,s=0;try{s=c(JSON.stringify(r)).length}catch(i){a=h(r),n="z",t=a}a||(a=h(r),o=c(JSON.stringify(a)).length,.9*s>o?(n="z",t=a):(n="set",t=r)),e.k.st=n,e.k.s=t}}(e);var n=JSON.stringify([e]),r=o.a.deflate(n);if(r){var a={type:"k",z:u(r)};t=JSON.stringify([a])}else s.b.run(i.CONFIG.ZIP_KEYFRAME)}catch(l){s.b.run(i.CONFIG.ZIP_KEYFRAME_CATCH_ERROR,[l&&l.stack])}return t}function c(e){return u(o.a.deflate(e))}function u(e){for(var t="",n=0,r=e.length;6e3*n<r;)t+=btoa(String.fromCharCode.apply(null,Array.prototype.slice.call(e,6e3*n,6e3*(n+1)))),n++;return t}function d(e){if(!e||!e.from||!e.to)return"";var t=function(e){if(!e||!e.from||!e.to)return[];var t,n;return t={row:Math.min(e.from.row,e.to.row),col:Math.min(e.from.col,e.to.col)},n={row:Math.max(e.from.row,e.to.row),col:Math.max(e.from.col,e.to.col)},[t,n]}(e),n=t[0],r=t[1];if(n&&r){if(n.col===r.col&&n.row===r.row)return f(n);var a=f(n),o=f(r);if(a&&o)return"".concat(a,":").concat(o);if(a)return a;if(o)return o}return""}function f(e){var t="";if(e&&"number"===typeof e.col){var n="A".charCodeAt(0),r="Z".charCodeAt(0)-"A".charCodeAt(0)+1;if(!r)return"";var a=e.col||0,o=0,s=!0;do{o=Math.floor(a%r-(s?0:1)),a=Math.floor(a/r),t=String.fromCharCode(o+n)+t,s=!1}while(a);t+=e.row+1}return t}function h(e){return function(e){if(!e||!e.length)return;for(var t=m(e),n=[],a=0,o=t.length;a<o;a++)for(var s=0,i=t[a].length;s<i;s++){var l=t[a][s];if(l&&(!l.isSearched||1!==l.isSearched)){var c={row:a,col:a},u=g(t,c,v(l));if(u){p(t,l,c,u);var f={from:c,to:u},h=m(l);delete h.isSearched;var b=[d(f),h];n.push(b)}}}return n;function v(e){return function(t){return function(e,t){if(null===e&&null===t)return!0;if(null===e||null===t)return!1;if("object"!==Object(r.a)(e)||"object"!==Object(r.a)(t))return!1;if(e.isSearched&&1===e.isSearched)return!1;var n=!0;for(var a in t)t[a]!==e[a]&&(n=!1);return n}(t,e)}}}(e)}function p(e,t,n,r){if(n&&"number"===typeof n.row&&"number"===typeof n.col&&r&&"number"===typeof r.row&&"number"===typeof r.col){n||(n={row:0,col:0});for(var a=Object.getOwnPropertyNames(t).length-(t.isSearched?1:0),o=n.row;o<=r.row;o++)for(var s=n.col;s<=r.col;s++){var i=e[o][s];i&&(a===Object.getOwnPropertyNames(i).length-(i.isSearched?1:0)?i.isSearched=1:i.isSearched=2)}}}function g(e,t,n){if(e&&e.length&&e[t.row].length){var r,a,o;t||(t={row:0,col:0});var s=0,i={row:t.row,col:t.col};for(r=t.row,a=e.length;r<a;r++){var l=e[r];for(o=t.col,s=s?Math.min(s,l.length):l.length;o<s;o++){if(!n(l[o])){if(r===t.row)i.col=o-1,s=o;else if(r===e.length-1)i.row=e.length-1;else if(o<i.col+1)return i.row=r-1,i;break}o===l.length-1?(i.col=l.length-1,r===e.length-1&&(i.row=e.length-1)):r===e.length-1&&o===s-1&&(i.row=e.length-1)}}return i}}var m=function e(t){if(!t||"object"!==Object(r.a)(t))return t;var n={};return Array.isArray(t)?n=t.map((function(t){return e(t)})):Object.keys(t).forEach((function(r){return n[r]=e(t[r])})),n}},"./src/core/feature/relateForm/seeker-util.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return I}));n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.symbol.description.js"),n("../node_modules/core-js/modules/es.symbol.iterator.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.every.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.from.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.slice.js"),n("../node_modules/core-js/modules/es.array.some.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.string.split.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=n("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),o=n("../packages/model/src/range/GridRange.ts"),s=n("../node_modules/lodash/throttle.js");function i(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=/(\u5e8f\u53f7|\u7f16\u53f7|\u59d3\u540d|\u540d\u5b57|\u540d\u79f0|\u4eba\u5458|\u6210\u5458|\u5546\u54c1\u540d\u79f0|\u8d1f\u8d23\u4eba|\u5c97\u4f4d|\u804c\u4f4d|\u6027\u522b|\u7535\u8bdd|\u8054\u7cfb\u65b9\u5f0f|\u53f7\u7801|\u624b\u673a\u53f7|\u6c11\u65cf|\u7c4d\u8d2f|\u6bd5\u4e1a\u9662\u6821|\u4e13\u4e1a|\u5b66\u4f4d|\u5b66\u5386|\u8eab\u4efd\u8bc1|\u8eab\u4efd\u8bc1\u53f7\u7801|\u6237\u53e3\u6240\u5728\u5730|\u91d1\u989d|\u7c7b\u578b|\u5de5\u4f5c\u5355\u4f4d|\u5e74\u9f84|\u9879\u76ee|\u7c7b\u522b|\u5206\u7c7b|\u4e8b\u9879|\u4ea7\u54c1|\u65e5\u671f|\u65f6\u95f4|\u65e5\u671f\u65f6\u95f4|\u661f\u671f|\u751f\u65e5|\u51fa\u751f\u6708\u65e5|\u8fdb\u5c55|\u9636\u6bb5\u8fdb\u5c55|\u9636\u6bb5\u6210\u679c|\u9879\u76ee\u8fdb\u5c55|\u9879\u76ee\u6210\u679c|\u72b6\u6001|\u4e0b\u5468\u8ba1\u5212|\u76ee\u6807|\u4efb\u52a1|KPI|OKR|\u5907\u6ce8|\u8bf4\u660e|\u4ef7\u683c|\u552e\u4ef7|\u5355\u4ef7|\u90e8\u95e8|\u8bed\u6587|\u6570\u5b66|\u82f1\u8bed|\u653f\u6cbb|\u5386\u53f2|\u5730\u7406|\u7269\u7406|\u5316\u5b66|\u751f\u7269)/i;function u(e,t){return t.map((function(t){return e[t].values.map((function(e){var t;if(null===(t=e.getMetadata())||void 0===t?void 0:t.customDataType)return null;var n=null===e||void 0===e?void 0:e.getEditValue(),r=null===e||void 0===e?void 0:e.getFormattedValue();return(null===r||void 0===r?void 0:r.value)||n}))}))}function d(e,t){return t.map((function(t){return e[t].values.map((function(e){return null===e||void 0===e?void 0:e.getMergeReference()}))}))}var f=function(e,t){for(var n=t;n>=0;n--)if(e[n])return e[n];return null},h=function(e){for(var t=e[e.length-1];!t;)e.pop(),t=e[e.length-1]};var p=function(e,t){for(var n=[],r=0;r<t.length;r++){var a=t[r];n.push({col:r,row:e,value:a||"-"})}return n};function g(e,t){var n=e.slice(0);if(t.length>1)for(var r=1;r<t.length;r++)for(var a=t[r],o=0;o<e.length;o++){var s=a[o],i=e[o]?e[o]:f(e,o);s&&i&&(n[o]="".concat(i," - ").concat(s))}return n}function m(e,t){var n=t.slice(0);n=function(e,t){var n=u(e,t),r=d(e,t),a=[];return n.forEach((function(e,n){var o=!r[n].every((function(e){return null===e})),s="",i=new Map;e.forEach((function(e){var t=e||"";i.set(t,1),s+=t}));for(var l=0,c=s.length,u=0;u<c;u++)s.charCodeAt(u)>128&&(l+=1);if(!o&&l/c<.2||i.size<2){var d=t[n];a.push(d)}})),a.forEach((function(e){var n=t.indexOf(e);t.splice(n,1)})),t}(e,n);for(var r=u(e,n),o=d(e,n),s=new Map,l=[],c=function(e){var t=r[e],n=o[e],a=o[e-1],i=[],c=function(e,t){if(t){var n="".concat(t.startRowIndex,",").concat(t.endRowIndex);e.includes(n)||e.push(n)}};n.forEach((function(e){return c(l,e)})),a&&a.forEach((function(e){return c(i,e)}));var u=!!l.length,d=!!i.length,f=s.get(e-1);u&&d&&l.some((function(e){return i.includes(e)}))&&f?(f.push(t),s.set(e-1,f)):s.set(e,[t])},f=0;f<r.length;f++)c(f);var p,m=new Map,b=i(s);try{for(b.s();!(p=b.n()).done;){var v=Object(a.a)(p.value,2),I=v[0],_=v[1],y=g(_[0].slice(0),_);h(y),m.set(I,y)}}catch(R){b.e(R)}finally{b.f()}return{cellIndexMap:m,indexs:n,mergeRanges:l}}function b(e,t){for(var n=[],r=0;r<10;r++){if(e[r]){var a=t[r];a&&a.hiddenByUser||n.push(r)}}for(var o=[],s=0;s<n.length;s++){for(var i=n[s],l=e[i].values,c=0,u=0,d=0;d<l.length;d++){var f=l[d];(null===f||void 0===f?void 0:f.getEditValue())?(u+=1)>=2&&(c+=1):u=0}c&&o.push(i)}return o}function v(e,t,n){var r,o=t.cellIndexMap,s=t.indexs,l=t.mergeRanges.map((function(e){return e.split(",").map((function(e){return Number(e)}))})),u=new Map,p=i(o);try{for(p.s();!(r=p.n()).done;){var g=Object(a.a)(r.value,2),m=g[0],b=g[1],v={emptys:0,solids:0,keywords:0,total:0},I=b.slice(0);h(I);for(var _=0;_<I.length;_++){var y=I[_];y||0===_?v.solids+=1:v.emptys-=1,c.test(y)&&(v.keywords+=2)}v.total=v.emptys+v.solids+v.keywords,u.set(m,v)}}catch(C){p.e(C)}finally{p.f()}var R,E=[],O=i(u.values());try{for(O.s();!(R=O.n()).done;){var S=R.value;E.push(S.total)}}catch(C){O.e(C)}finally{O.f()}var T=E.indexOf(Math.max.apply(null,E)),w=Array.from(u.keys())[T],k=s[w];l=l.filter((function(e){var t=Object(a.a)(e,2),n=t[0],r=t[1];return k>=n&&k<=r}));var j=o.get(w)||[];if(l.length&&l.some((function(e){return e[0]===e[1]&&e[0]===k}))){var x=d(e,[k]);Object(a.a)(x,1)[0].forEach((function(e,t){if(e&&t<j.length&&null===j[t]){var r=f(j,t);r&&n?j.splice(t,1,r):j.splice(t,1)}}))}return{headData:j,hitLine:k,merges:l}}function I(e){try{var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.data;if(!n||!n.rowData||!n.rowMetadata)return null;var r=n.rowData,a=n.rowMetadata,o=b(r,a),s=m(r,o),i=v(r,s,t),l=i.headData,c=i.merges,u=i.hitLine;return u>=0?{headDatas:p(u,l),merges:c}:null}(e,!0);if(!t||0===t.headDatas.length)return null;var n=t.headDatas,a=t.merges,s=n[0],i=s.row,l=s.col,c=n[n.length-1].col,u=0===a.length?i:Math.max.apply(Math,Object(r.a)(a.map((function(e){return e[e.length-1]}))));return new o.b(e.getSheetId(),i,u,l,c)}catch(d){return console.error(d),null}}n.n(s)()(I,15)},"./src/core/network/message-center/utils.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var r,a=n("./src/base/error/errCodeType.ts"),o=n("./src/base/error/errorCodeModalProxy.ts"),s=n("./src/core/utils/config.ts");function i(e){if(!Object(s.a)()&&e.socket.onceOpened)if(e.socket&&e.socket.client){var t,n,r=e.socket.client.getRoomState(),i=(null===(t=e.offlineEdit)||void 0===t||t.status,null===(n=e.offlineEdit)||void 0===n?void 0:n.isShield);if((!e.sheetStatus.workbookStatus.isOnline||"RECONNECTING_In_CLOSED"===r||"SHUTDOWN"===r)&&i)return e.socket.hideOfflineTips(),e.socket.hadShowOfflineTip=!0,e.event.errorCode.trigger("errorCode",{type:"front",code:a.a.OFFLINE_INDEXDB_NOT_AVAILABLE}),void e.permissions.activeTempStatus(!1);if(!e.sheetStatus.workbookStatus.isOnline&&!e.socket.hadShowOfflineTip){if(!e.offlineEdit.isDBAvaliable())return e.permissions.activeTempStatus(!1),void e.event.errorCode.trigger("errorCode",{type:"front",code:a.a.OFFLINE_INDEXDB_NOT_AVAILABLE});e.socket.hadShowOfflineTip=!0,o.b.client.showNetworkOfflineTip(e.sheetStatus.workbookStatus.canEdit,(function(t){e.socket.offlineSnackbar=t}))}}else e.socket.hadShowOfflineTip||(e.socket.hadShowOfflineTip=!0,o.b.client.showNetworkOfflineTip())}!function(e){e.USER_CHANGE_NEW="userChangeNew",e.USER_CHANGE_UPDATE="userChangeUpdate",e.USER_CHANGE_COMMIT="userChangeCommit",e.USER_CHANGE_RETRY_COMMIT="userChangeRetryCommit",e.COMMITING_QUEUE_RESET="commitingQueueReset",e.UPDATE_WAITING_QUEUE_VERSION="updateWaitingQueueVersion",e.APPLY_CT="applyCt",e.ACCEPT_COMMIT="acceptCommit",e.COMMIT_WITH_ERROR_CODE="commitWithErrorCode",e.AFTER_APPLY_COLLAB_MUTATIONS="afterApplyCollabMutations"}(r||(r={}))},"./src/core/utils/config.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("../node_modules/core-js/modules/es.array.index-of.js");var r=n("./src/core/data/configService/spreadConfig.ts");function a(){return-1!==["local","new"].indexOf(r.a.getConfig("padStatus"))}},"./src/core/view/level-2/data-context-menu/config.ts":function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"d",(function(){return m}));n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.object.values.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var r,a,o=n("../packages/model/src/cell/format/index.ts"),s=n("../packages/model/src/rule/index.ts"),i=n("../packages/model/src/cell/metadata/CustomDataType.ts"),l=n("../packages/model/src/cell/metadata/select/SelectTemplateType.ts");n.d(t,"f",(function(){return l.a})),function(e){e.RED="red",e.BLUE="blue",e.YELLOW="yellow",e.PINK="pink",e.PURPLE="purple",e.ORANGE="orange"}(r||(r={})),function(e){e[e.DATAVALIDATION=101]="DATAVALIDATION",e[e.REPEAT=102]="REPEAT",e[e.CONDITIONFORMAT=103]="CONDITIONFORMAT",e[e.SMARTSPLIT=104]="SMARTSPLIT"}(a||(a={}));var c=[{text:"\u5355\u9009\u591a\u9009",id:i.c.SELECT.toString(),subMenu:[{text:"\u81ea\u5b9a\u4e49",id:l.a.CUSTOM.toString(),splitAfter:!0},{text:"\u662f\u5426",id:l.a.YES_NO.toString()},{text:"\u6027\u522b",id:l.a.SEX.toString()},{text:"\u5b66\u5386",id:l.a.EDUCATION.toString()},{text:"\u72b6\u6001",id:l.a.PROJECT_STATUS.toString(),info:"\u5df2\u5b8c\u6210/\u672a\u5b8c\u6210"},{text:"\u4f18\u5148\u7ea7",id:l.a.PRIORITY.toString(),info:"P0/P1/P2"},{text:"\u670d\u88c5\u5c3a\u5bf8",id:l.a.CLOTHING_SIZE.toString(),info:"L/M/S"}]},{text:"\u590d\u9009\u6846",id:i.c.CHECKBOX.toString()},{text:"\u8bc4\u661f",id:i.c.STAR.toString(),splitAfter:!0},{text:"\u66f4\u591a\u6570\u636e\u9a8c\u8bc1",id:"advancedValidate"}],u=function(){var e=[];return e[i.c.ID]=o.DATA_VALIDATION_RULE_TYPE.CUSTOM_ID_CARD,e[i.c.EMAIL]=o.DATA_VALIDATION_RULE_TYPE.CUSTOM_TEXT_MAIL,e[i.c.PHONE_NUM]=o.DATA_VALIDATION_RULE_TYPE.CUSTOM_NUM_PHONE,e}(),d=[{text:"\u6570\u636e\u9a8c\u8bc1",id:a.DATAVALIDATION.toString(),subMenu:c,splitAfter:!0,redDot:!0},{text:"\u9ad8\u4eae\u91cd\u590d\u503c",id:a.REPEAT.toString(),callback:function(e){e.view.canvas.conditionFormatCenter.panel.hide(),e.view.canvas.conditionFormatCenter.panel.show(s.CONDITION_TYPE.REPEAT)}},{text:"\u5176\u4ed6\u6761\u4ef6\u683c\u5f0f",id:a.CONDITIONFORMAT.toString(),callback:function(e){e.view.canvas.conditionFormatCenter.panel.hide(),e.view.canvas.conditionFormatCenter.panel.show(s.CONDITION_TYPE.NUMBER_GREATER)},splitAfter:!0},{text:"\u667a\u80fd\u5206\u5217",id:a.SMARTSPLIT.toString(),callback:function(e){e.feature.smartSplit.doManualSmartSplit()}}];function f(e){return d.find((function(t){return t.id===e}))}var h,p=l.b;!function(e){e[e.SHEETBAR=0]="SHEETBAR",e[e.COL=1]="COL",e[e.CONTEXT=2]="CONTEXT"}(h||(h={}));var g=[{background:"#ea2f2f29",textColor:"#ea2f2f",label:"\u7ea2"},{background:"#f36f3929",textColor:"#f36f39",label:"\u6a59"},{background:"#02b1ff29",textColor:"#02b1ff",label:"\u84dd"},{background:"#19bd8f29",textColor:"#19bd8f",label:"\u7eff"},{background:"#7c5ed829",textColor:"#7c5ed8",label:"\u7d2b"},{background:"#e85bbe29",textColor:"#e85bbe",label:"\u7c89"},{background:"#20202029",textColor:"rgba(0,0,0,0.64)",label:"\u7070"},{background:"#ffffff",textColor:"rgba(0,0,0,0.4)",label:"\u767d"}],m=function(){var e=[];e[h.COL]="column",e[h.SHEETBAR]="toolbar",e[h.CONTEXT]="rightside_menu";var t=[];t[i.c.SELECT]="choice",t[i.c.STAR]="star",t[i.c.CHECKBOX]="checkbox",t[i.c.PROGRESS]="progress";var n=[];return n[l.a.CUSTOM]="selfdefine",n[l.a.SEX]="sexuality",n[l.a.EDUCATION]="education",n[l.a.YES_NO]="yes_or_no",n[l.a.PRIORITY]="priority",n[l.a.PROJECT_STATUS]="status",n[l.a.CLOTHING_SIZE]="size",{from:e,customdatainfo:t,selecttemplate:n}}()},"./src/external/errorUI/client.ts":function(e,t,n){"use strict";(function(e){n.d(t,"k",(function(){return I})),n.d(t,"o",(function(){return _})),n.d(t,"g",(function(){return y})),n.d(t,"i",(function(){return R})),n.d(t,"t",(function(){return E})),n.d(t,"a",(function(){return O})),n.d(t,"q",(function(){return S})),n.d(t,"s",(function(){return T})),n.d(t,"n",(function(){return w})),n.d(t,"b",(function(){return j})),n.d(t,"h",(function(){return C})),n.d(t,"v",(function(){return A})),n.d(t,"u",(function(){return M})),n.d(t,"j",(function(){return L})),n.d(t,"l",(function(){return N})),n.d(t,"p",(function(){return U})),n.d(t,"r",(function(){return P})),n.d(t,"d",(function(){return F})),n.d(t,"e",(function(){return B})),n.d(t,"c",(function(){return H})),n.d(t,"m",(function(){return G})),n.d(t,"f",(function(){return z}));n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.find.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.promise.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=(n("../node_modules/regenerator-runtime/runtime.js"),n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js")),o=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),s=n.n(o),i=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),l=n.n(i),c=n("./src/external/errorUI/utils.ts"),u=n("./src/base/event/event.ts"),d=n("./src/external/offlineEdit/model/ClearType.ts"),f=n("../packages/report/src/index.ts"),h=n("./src/base/index.ts"),p=n("./src/external/errorUI/collector.ts"),g=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),m=n.n(g);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;if(!m.a.isTencentDocsApp||!m.a.isTencentDocsAppVersionAboveOrEqual("2.2.0")||!m.a.isAndroidPad&&!m.a.isIPad){var n,r=e?"\u7f16\u8f91":"\u67e5\u770b";return n=l.a.show({message:"\u7f51\u7edc\u5f02\u5e38\uff0c\u79bb\u7ebf".concat(r,"\u4e2d\uff0c\u6587\u6863\u6700\u65b0\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002"),style:{zIndex:10003},autoClose:!1,closable:!0}),t&&t(n),p.a.doms.push(n),n}}function _(e){var t=l.a.show({message:"\u7f16\u8f91\u5185\u5bb9\u6682\u65e0\u6cd5\u4fdd\u5b58".concat("(".concat(e,")\u3002")),type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5982\u4f55\u5904\u7406",onClick:function(){return Object(c.b)(e),!1}}]});p.a.doms.push(t)}function y(e){var t=l.a.show({message:"\u7f16\u8f91\u5185\u5bb9\u6682\u65e0\u6cd5\u4fdd\u5b58".concat("(".concat(e,")\u3002")),type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5982\u4f55\u5904\u7406",onClick:function(){return Object(c.b)(e,!1,!1,"\u6587\u4ef6\u5df2\u88ab\u521b\u5efa\u8005\u5220\u9664\uff0c\u5185\u5bb9\u65e0\u6cd5\u4e0a\u4f20\u3002\u4e3a\u9632\u6b62\u5185\u5bb9\u4e22\u5931\uff0c\u8bf7\u5c06\u521a\u521a\u7f16\u8f91\u7684\u5185\u5bb9\u590d\u5236\u7c98\u8d34\u5230\u672c\u5730\u6216\u5bfc\u51fa\u6587\u4ef6\u8fdb\u884c\u5907\u4efd\uff0c\u518d\u70b9\u51fb\u5237\u65b0\u3002"),!1}}]});p.a.doms.push(t)}function R(e){var t=l.a.show({message:"\u767b\u5f55\u8fc7\u671f\uff0c\u70b9\u51fb\u5237\u65b0".concat("(".concat(e,")\u3002")),style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]});p.a.doms.push(t)}function E(e){u.c.spreadsheetEvent.trigger("clearOfflineStore",{type:d.a.ALL});var t,n="40203"===e,r="\u6240\u5728\u884c\u5217\u5305\u542b\u4fdd\u62a4\u8303\u56f4\uff0c\u6682\u4e0d\u652f\u6301\u6b64\u64cd\u4f5c\u3002(".concat(e,")"),a="\u4f60\u5728\u5f53\u524d\u6587\u6863\u7684\u6743\u9650\u5df2\u53d8\u66f4".concat("(".concat(e,")\u3002"));t=n?r:a;var o=l.a.show({message:t,type:n?"info":"error",style:{zIndex:10003},autoClose:!1,closable:n,onClose:n?function(){return!0}:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){return location.reload(),!1}}]});p.a.doms.push(o)}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u6570\u636e\u91cf\u8f83\u5927\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f",n=l.a.show({message:t,type:"info",style:{zIndex:10003,height:"auto",minHeight:"52px"},autoClose:!1,closable:!0,onClose:function(){return f.b.tdwReport({module:"excel_tips",opername:"doc_excel_editor",action:"excel_tips_copypaste_click"}),!0},action:[{text:"\u5982\u4f55\u5904\u7406",onClick:function(){return Object(c.b)(e),!1}}]});p.a.doms.push(n),f.b.tdwReport({module:"excel_tips",opername:"doc_excel_editor",action:"excel_tips_copypaste_view"})}function S(e){var t=l.a.show({message:"\u6b64\u5185\u5bb9\u56e0\u8fdd\u89c4\u65e0\u6cd5\u7f16\u8f91".concat("(".concat(e,")\u3002")),type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u4e86\u89e3\u8be6\u60c5",onClick:function(){window.open("https://".concat(location.host,"/doc/DWE9lbGhWTU9OV2VF"),"_blank")}}]});p.a.doms.push(t)}function T(e,t){var n;n=s.a.confirm({title:"\u7cfb\u7edf\u6d88\u606f",content:"".concat({insertNewSheet:"\u65b0\u5efa\u5de5\u4f5c\u8868",moveSheet:"\u79fb\u52a8\u5de5\u4f5c\u8868",copySheetById:"\u521b\u5efa\u526f\u672c",deleteSheet:"\u5220\u9664\u5de5\u4f5c\u8868",renameSheet:"\u91cd\u547d\u540d\u5de5\u4f5c\u8868"}[t],"\u5931\u8d25\uff0c\u6211\u4eec\u5bf9\u6b64\u8868\u793a\u62b1\u6b49\u3002\u53ef\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\u6216\u8054\u7cfb\u6211\u4eec\u53cd\u9988\u95ee\u9898\uff0c\u6211\u4eec\u5c06\u5c3d\u5feb\u4e3a\u4f60\u4fee\u590d\u3002"),okText:"\u8054\u7cfb\u6211\u4eec",onOk:function(){window.open("https://support.qq.com/products/28096?customInfo=".concat(e),"_blank")},cancelText:"\u5237\u65b0",onCancel:function(){window.location.reload()},onClose:function(){window.location.reload()}}),p.a.doms.push(n)}function w(){if(u.c.spreadsheetEvent.trigger("clearOfflineStore",{type:d.a.ALL}),!e.__alreadyShowPermissionChangesTip){e.__alreadyShowPermissionChangesTip=!0;var t=l.a.show({message:"\u4f60\u5728\u6b64\u8868\u683c\u7684\u6743\u9650\u5df2\u53d1\u751f\u53d8\u5316\u3002",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]});p.a.doms.push(t)}}function k(e){var t=window.clientVars.invitedUserInfos.find((function(t){return t.userId===e}));if(!t){var n=window.clientVars,r=n.userId,a=n.userName;if(e===r)return a}return null===t||void 0===t?void 0:t.name}function j(e,t,n){var r=k(t),a=e?"\u7b5b\u9009":"\u6392\u5e8f",o=l.a.show({message:"".concat(r?"\u300c".concat(r.length>10?"".concat(r.substr(0,10),"..."):r,"\u300d"):"\u6709\u534f\u4f5c\u8005").concat(a,"\u4e86\u5185\u5bb9\u3002"),zIndex:10003,autoClose:!1,action:"\u597d\u7684",onClickAction:function(){n(),f.b.tdwReport({opername:"doc_filter",module:"doc_filter_guest",action:"doc_".concat(e?"filter":"rank","_guest_confirm"),ver11:"pc"})},id:"collab_filter_reorder_tip"});return p.a.doms.push(o),o}var x=null;function C(e,t){return D.apply(this,arguments)}function D(){return(D=Object(a.a)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x){e.next=5;break}return x.close(),x=null,e.next=5,new Promise((function(e){return setTimeout(e,300)}));case 5:if(n||t){e.next=8;break}return l.a.show({message:"\u5df2\u53d6\u6d88\u201c\u7b5b\u9009\u5bf9\u6240\u6709\u4eba\u53ef\u89c1\u201d\u3002",zIndex:10003,type:"success"}),e.abrupt("return");case 8:n&&(r=k(n),x=l.a.show(v({message:"".concat(r?"\u300c".concat(r.length>10?"".concat(r.substr(0,10),"..."):r,"\u300d"):"\u6709\u534f\u4f5c\u8005"," ").concat(t?"\u5f00\u542f":"\u5173\u95ed","\u201c\u7b5b\u9009\u5bf9\u6240\u6709\u4eba\u53ef\u89c1\u201d\u3002"),zIndex:10003},t?{autoClose:!1,action:"\u597d\u7684",onClickAction:function(){x=null,f.b.tdwReport({opername:"doc_filter",module:"doc_filter_guest",action:"doc_filter_guest_click",ver11:"pc"})}}:{})),!t&&setTimeout((function(){x=null}),2e3));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){var t,n;null===(t=e.CoreSheet)||void 0===t||null===(n=t.saveStatus)||void 0===n||n.showSaveTips("saving",3e3,null,"\u5df2\u81ea\u52a8\u4fdd\u5b58")}function M(){var t,n;null===(t=e.CoreSheet)||void 0===t||null===(n=t.saveStatus)||void 0===n||n.showSaveTips("text",3e3,null,"\u4fdd\u5b58\u5931\u8d25")}function L(e){var t=l.a.show({message:"\u79bb\u7ebf\u7f16\u8f91\u4e0d\u53ef\u7528\uff0c\u8bf7\u8fde\u63a5\u7f51\u7edc\u540e\u5237\u65b0".concat("(".concat(e,")\u3002")),style:{zIndex:10003},autoClose:!1,action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]});p.a.doms.push(t)}function N(){var t,n;null===(t=e.CoreSheet)||void 0===t||null===(n=t.saveStatus)||void 0===n||n.showSaveTips("offline",null,"\u6b63\u5728\u79bb\u7ebf\u7f16\u8f91","\u6b63\u5728\u79bb\u7ebf\u7f16\u8f91"),function(e,t){var n=null;return function(){var r=this,a=arguments;n&&(h.a.util.timer.erase(n),n=null),n=h.a.util.timer.wait(t).run((function(){e.apply(r,a)}))}}((function(){var t,n;null===(t=e.CoreSheet)||void 0===t||null===(n=t.saveStatus)||void 0===n||n.showSaveTips("offline",3e3,"\u79bb\u7ebf\u7f16\u8f91\u4fdd\u5b58\u6210\u529f","\u79bb\u7ebf\u7f16\u8f91\u4fdd\u5b58\u6210\u529f")}),1e3)()}function U(){}function P(e){var t=l.a.show({message:"\u6682\u65e0\u6cd5\u8fde\u63a5\u5230\u670d\u52a1\u5668".concat("(".concat(e,")\u3002")),style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}},{text:"\u8054\u7cfb\u6211\u4eec",onClick:function(){Object(c.a)(e)}}]});p.a.doms.push(t)}function F(e){var t=s.a.confirm({title:"\u7cfb\u7edf\u6d88\u606f",content:"\u8868\u683c\u9047\u5230\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5".concat("\u3002"),okText:"\u5237\u65b0",onOk:function(){window.location.reload()},cancelText:"\u8054\u7cfb\u6211\u4eec",onCancel:function(){return Object(c.a)(e),!1}});p.a.doms.push(t)}function B(e){var t=s.a.confirm({title:"\u7cfb\u7edf\u6d88\u606f",content:"\u8868\u683c\u79bb\u7ebf\u6570\u636e\u5904\u7406\u9047\u5230\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5\u3002",okText:"\u5237\u65b0",onOk:function(){window.location.reload()},cancelText:"\u8054\u7cfb\u6211\u4eec",onCancel:function(){return Object(c.a)(e),!1}});p.a.doms.push(t)}function H(t){var n={title:"\u7cfb\u7edf\u6d88\u606f",content:"\u52a0\u8f7d\u8868\u683c\u65f6\u9047\u5230\u672a\u77e5\u9519\u8bef\uff0c\u6211\u4eec\u5bf9\u6b64\u8868\u793a\u62b1\u6b49\uff0c\u53ef\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\u6216\u8054\u7cfb\u6211\u4eec\u53cd\u9988\u95ee\u9898\uff0c\u6211\u4eec\u5c06\u5c3d\u5feb\u4e3a\u4f60\u4fee\u590d".concat("\u3002"),cancelText:null,okText:"\u53cd\u9988",onOk:function(){e.CoreSheet.support?e.CoreSheet.support.showSupportPage():e.open("https://support.qq.com/product/28096?clientInfo=".concat(e.navigator.userAgent,"&customInfo=").concat(encodeURIComponent(e.location.href)))}},r=s.a.confirm(n);p.a.doms.push(r)}function G(e){var t=l.a.show({message:"\u79bb\u7ebf\u6570\u636e\u540c\u6b65\u5931\u8d25\uff0c\u8bf7\u8fde\u63a5\u7f51\u7edc\u540e\u5237\u65b0".concat("(".concat(e,")\u3002")),style:{zIndex:10003},autoClose:!1,action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]});p.a.doms.push(t)}function z(e){var t;return t=s.a.confirm({title:"\u7cfb\u7edf\u6d88\u606f",content:"\u8868\u683c\u9047\u5230\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5\u3002",okText:"\u5237\u65b0",onOk:function(){window.location.reload()},cancelText:"\u8054\u7cfb\u6211\u4eec",onCancel:function(){window.open("https://support.qq.com/products/28096?customInfo=".concat(e),"_blank")},onClose:function(){window.location.reload()}}),p.a.doms.push(t),t}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/errorUI/component.tsx":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("../node_modules/core-js/modules/es.array.concat.js");var r=n("react"),a=n.n(r);function o(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return a.a.createElement("div",null,a.a.createElement("div",null,e),a.a.createElement("div",{style:{opacity:.4}},n?"\u9519\u8bef\u7801":"\u72b6\u6001\u7801",":",t," ",s()))}function s(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1<10?"0".concat(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0".concat(e.getDate()):e.getDate();e.getHours()<10?"0".concat(e.getHours()):e.getHours(),e.getMinutes()<10?"0".concat(e.getMinutes()):e.getMinutes(),e.getSeconds()<10?"0".concat(e.getSeconds()):e.getSeconds();return"".concat(t,"-").concat(n,"-").concat(r)}},"./src/external/errorUI/utils.ts":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n("../node_modules/@tencent/dui/lib/components/Modal/index.js"),a=n.n(r),o=n("./src/external/errorUI/component.tsx"),s=n("./src/base/event/event.ts"),i=n("./src/external/offlineEdit/model/ClearType.ts"),l=n("./src/external/errorUI/collector.ts");function c(e){window.open("https://support.qq.com/products/28096?customInfo=".concat(e),"_blank")}function u(t){var n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],u=arguments.length>3?arguments[3]:void 0;s.c.spreadsheetEvent.trigger("onShowHowToHandleDataLostModal"),n=r?a.a.confirm({maskStyle:{zIndex:10004},title:"\u5982\u4f55\u5904\u7406",content:Object(o.a)(u||"\u4e3a\u9632\u6b62\u5185\u5bb9\u4e22\u5931\uff0c\u8bf7\u5c06\u521a\u521a\u7f16\u8f91\u7684\u5185\u5bb9\u590d\u5236\u7c98\u8d34\u5230\u672c\u5730\u6216\u5bfc\u51fa\u6587\u4ef6\u8fdb\u884c\u5907\u4efd\uff0c\u518d\u70b9\u51fb\u4fee\u590d\u3002",t,i),okText:"\u5bfc\u51fa\u6587\u4ef6",onOk:function(){return e.CoreSheet.export.exportSheetData(),!1},cancelText:"\u4fee\u590d",onCancel:function(){d(t)},action:"\u8054\u7cfb\u6211\u4eec",onClickAction:function(){return c(t),!1},onClose:function(){}}):a.a.confirm({maskStyle:{zIndex:10004},title:"\u5982\u4f55\u5904\u7406",content:Object(o.a)(u||"\u4e3a\u9632\u6b62\u6570\u636e\u4e22\u5931\uff0c\u8bf7\u52ff\u5237\u65b0\u6216\u5173\u6389\u9875\u9762\u3002\u5efa\u8bae\u5148\u5bfc\u51fa\u6587\u4ef6\u6216\u5c06\u7f16\u8f91\u7684\u5185\u5bb9\u590d\u5236\u7c98\u8d34\u5230\u672c\u5730\uff0c\u7136\u540e\u518d\u5237\u65b0\u9875\u9762\u3002",t,i),okText:"\u5bfc\u51fa\u6587\u4ef6",onOk:function(){return e.CoreSheet.export.exportSheetData(),!1},cancelText:"\u5237\u65b0",onCancel:function(){window.location.reload()},action:"\u8054\u7cfb\u6211\u4eec",onClickAction:function(){return c(t),!1},onClose:function(){}}),l.a.doms.push(n)}function d(e){var t;t=a.a.confirm({maskStyle:{zIndex:10004},title:"\u63d0\u793a",content:Object(o.a)("\u4fee\u590d\u8fc7\u7a0b\u5c06\u4f1a\u6e05\u9664\u672c\u5730\u7f13\u5b58\uff0c\u53ef\u80fd\u9020\u6210\u90e8\u5206\u5185\u5bb9\u4e22\u5931\u3002\u8bf7\u786e\u8ba4\u5185\u5bb9\u5df2\u5907\u4efd\u5230\u672c\u5730\uff0c\u518d\u5f00\u59cb\u4fee\u590d\u3002",e),okText:"\u5f00\u59cb\u4fee\u590d",cancelText:"",onOk:function(){return s.c.spreadsheetEvent.trigger("clearOfflineStore",{type:i.a.UN_COMMITTED,callback:function(){window.location.reload()}}),!1},action:"\u8054\u7cfb\u6211\u4eec",onClickAction:function(){return c(e),!1},onClose:function(){}}),l.a.doms.push(t)}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/offlineEdit/model/ClearType.ts":function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.ALL="all",e.COMMITTED="committed",e.UN_COMMITTED="unCommitted"}(r||(r={}))},"./src/external/view/main/panel/FillterPanel/utils/filterConstant.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s}));var r="",a=/^\s+$/,o=44,s=44},"./src/external/view/main/panel/FillterPanel/utils/filterUtil.ts":function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return h}));n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.every.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.reduce.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.exec.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js");var r=n("./src/core/utils/index.ts"),a=n("./src/external/view/main/panel/FillterPanel/utils/filterConstant.ts");function o(e){return a.c.test(e)||""===e}function s(e,t){var n=[],r=[];for(e.replace(/(\d+)|(\D+)/g,(function(e,t,r){n.push([t||1/0,r||""])})),t.replace(/(\d+)|(\D+)/g,(function(e,t,n){r.push([t||1/0,n||""])}));n.length&&r.length;){var a=n.shift(),o=r.shift(),s=a[0]-o[0]||a[1].localeCompare(o[1]);if(s)return s}return n.length-r.length}function i(e){return(null===e||void 0===e||o(e))&&(e=a.a),e.replace&&(e=e.replace(/\ufeff/g,"")),e}function l(e,t,n){if(e.data.rowData[t]){var a=e.data.rowData[t].values[n];if(a)return(o=a)?r.a.cell.getMergedValue(o):null}var o;return null}function c(e,t){return(e.data.rowMetadata[t]||{hiddenByUser:!1}).hiddenByUser}function u(e){var t=new Map;return e.filter((function(e){return!t.has(e)&&t.set(e,1)}))}function d(e){return Object.keys(e).reduce((function(t,n){return t.push(e[n]),t}),[])}function f(e,t){return e.filter((function(e){return t.every((function(t){return t!==e}))}))}var h=function(e,t){var n=e,r=t.canSort,o=t.canToggleFilterSync;return r||(n-=a.d),o||(n-=a.b),n}}}]);
//# sourceMappingURL=pc-bundle_module_behavior_api-0be57374b9.js.map