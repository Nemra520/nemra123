(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk_part2"],{"../packages/mutation/src/Mutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.index-of.js");var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../packages/report/src/index.ts"),i=n("../packages/model/src/index.ts"),d=n("../packages/mutation/src/config/report.ts"),u=n("../packages/mutation/src/config/version.ts"),l=n("../packages/mutation/src/utils/index.ts"),h=n("../packages/mutation/src/MutationId.ts"),c=n("../packages/mutation/src/MutationOperationType.ts"),I=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,e),this.id=t,this.version=Object(l.c)(n.parentRequestId)?n.version:u.a.MUTATION_VER,this.parentRequestId=Object(l.c)(n.parentRequestId)?n.parentRequestId:-1,this.operationType=Object(l.c)(n.operationType)?n.operationType:c.a.LOCAL}return Object(o.a)(e,[{key:"runOnWorkbook",value:function(e){}},{key:"checkSheetId",value:function(e){var t=this.getAffectedSheetId();if(t){var n=e.getSheetId()===t,s=n?void 0:"SheetId \u4e0d\u4e00\u81f4 ".concat(e.getSheetId()," != ").concat(t);return n||this.runOnFormulaLayer(e),{isValid:n,errorMessage:s}}return{isValid:!0}}},{key:"runOnFormulaLayer",value:function(e){0}},{key:"check",value:function(e){return{isValid:!0}}},{key:"isMultiSheetMutation",value:function(){return!1}},{key:"getAffectedGridRanges",value:function(){return[]}},{key:"getSizeEstimate",value:function(){return 1}},{key:"isNonPersistedLocalChange",value:function(){return!1}},{key:"run",value:function(e,t){var n,s=[],r={isValid:!0};if(e instanceof i.Spreadsheet.Spreadsheet){this.checkAndRunOnWorkbook(e,t)&&(n=this.getAffectedSheetId());var o,a,d,u=this.getAffectedSheets(e);for(a=0,d=u.length;a<d&&(o=u[a],(r=this.checkAndRunOnSheet(o,t)).isValid);a++)s.push([o,t])}else r=this.checkAndRunOnSheet(e,t),s.push([e,t]);return{runResult:r,runCache:s,workbookWithSheetId:n,isMultiSheet:!1}}},{key:"checkAndRunOnSheet",value:function(e,t){if(!(e instanceof i.Sheet.BaseSheet))return{isValid:!1,errorMessage:"sheet\u7c7b\u578b\u4e0d\u662fModel.Spreadsheet.Spreadsheet"};var n=+new Date,s={isValid:!1,errorMessage:"\u9ed8\u8ba4\u9519\u8bef"},r=!1;try{s=this.check(e)}catch(o){a.b.run(d.b.CHECK_MUTATION_ERROR,this,o,s)}if(!(s=s.isValid?this.checkSheetId(e):s).isValid&&(a.b.run(d.b.CHECK_MUTATION_RESULT_ERROR,this,s),!t.ignoreCheck))return s;try{this.runOnSheet(e)}catch(o){console.error("Run mutation error: ",this,o),a.b.run(d.b.RUN_MUTATION_ERROR,o,this),o.message&&0===o.message.indexOf("ApiCheckError")||(r=!0)}return a.b.speed.hasDonePagePerformanceReport()||a.b.speed.runReport(d.c.MUTATIONS_RUN,n,+new Date,!0),{isValid:!r,errorMessage:r?"\u6709\u9047\u5230mutation\u8fd0\u884c\u9519\u8bef":void 0}}},{key:"checkAndRunOnWorkbook",value:function(e,t){return this.runOnWorkbook(e)}},{key:"transform",value:function(e,t){var n,r=(n={},Object(s.a)(n,h.b.INSERT_DIMENSION_MUTATION,"transformWithInsertDimensionMutation"),Object(s.a)(n,h.b.DELETE_DIMENSION_MUTATION,"transformWithDeleteDimensionMutation"),Object(s.a)(n,h.b.SET_DIMENSION_PROPERTIES_MUTATION,"transformWithSetDimensionPropertiesMutation"),Object(s.a)(n,h.b.SET_RANGE_MUTATION,"transformWithSetRangeMutation"),Object(s.a)(n,h.b.SET_CELL_PROPERTIES_MUTATION,"transformWithSetCellPropertiesMutation"),Object(s.a)(n,h.b.MERGE_CELLS_MUTATION,"transformWithMergeCellsMutation"),Object(s.a)(n,h.b.UNMERGE_CELLS_MUTATION,"transformWithUnmergeCellsMutation"),Object(s.a)(n,h.b.DEFINE_FILTER_MUTATION,"transformWithDefineFilterMutation"),Object(s.a)(n,h.b.DELETE_FILTER_MUTATION,"transformWithDeleteFilterMutation"),Object(s.a)(n,h.b.UPDATE_FILTER_MUTATION,"transformWithUpdateFilterMutation"),Object(s.a)(n,h.b.SWITCH_FILTER_SYNC_MUTATION,"transformWithSwitchFilterSyncMutation"),Object(s.a)(n,h.b.ADD_EMBEDDED_OBJECT_MUTATION,"transformWithAddEmbeddedObjectMutation"),Object(s.a)(n,h.b.DELETE_EMBEDDED_OBJECT_MUTATION,"transformWithDeleteEmbeddedObjectMutation"),Object(s.a)(n,h.b.UPDATE_EMBEDDED_OBJECT_MUTATION,"transformWithUpdateEmbeddedObjectMutation"),Object(s.a)(n,h.b.INSERT_SHEET_MUTATION,"transformWithInsertSheetMutation"),Object(s.a)(n,h.b.DELETE_SHEET_MUTATION,"transformWithDeleteSheetMutation"),Object(s.a)(n,h.b.MOVE_SHEET_MUTATION,"transformWithMoveSheetMutation"),Object(s.a)(n,h.b.SET_SHEET_PROPERTIES_MUTATION,"transformWithSetSheetPropertiesMutation"),Object(s.a)(n,h.b.UPDATE_ALL_SHEETS_MUTATION,"transformWithUpdateAllSheetsMutation"),Object(s.a)(n,h.b.DEFINE_SHEET_RANGE_MUTATION,"transformWithDefineSheetRangeMutation"),Object(s.a)(n,h.b.DELETE_SHEET_RANGE_MUTATION,"transformWithDeleteSheetRangeMutation"),Object(s.a)(n,h.b.UPDATE_SHEET_RANGE_MUTATION,"transformWithUpdateSheetRangeMutation"),Object(s.a)(n,h.b.SET_WORKBOOK_PROPERTIES_MUTATION,"transformWithSetWorkbookPropertiesMutation"),Object(s.a)(n,h.b.COPY_PASTE_MUTATION,"transformWithCopyPasteMutation"),Object(s.a)(n,h.b.REORDER_RANGE_MUTATION,"transformWithReorderRangeMutation"),Object(s.a)(n,h.b.MAP_RANGE_MUTATION,"transformWithMapRangeMutation"),Object(s.a)(n,h.b.EMPTY_MUTATION,"transformWithEmptyMutation"),Object(s.a)(n,h.b.ADD_CONDITIONAL_FORMAT_MUTATION,"transformWithAddConditionalFormatMutation"),Object(s.a)(n,h.b.DELETE_CONDITIONAL_FORMAT_MUTATION,"transformWithDeleteConditionalFormatMutation"),Object(s.a)(n,h.b.UPDATE_CONDITIONAL_FORMAT_MUTATION,"transformWithUpdateConditionalFormatMutation"),Object(s.a)(n,h.b.DEFINE_WORKBOOK_RANGE_MUTATION,"transformWithDefineWorkbookRangeMutation"),Object(s.a)(n,h.b.UPDATE_WORKBOOK_RANGE_MUTATION,"transformWithUpdateWorkbookRangeMutation"),Object(s.a)(n,h.b.DELETE_WORKBOOK_RANGE_MUTATION,"transformWithDeleteWorkbookRangeMutation"),Object(s.a)(n,h.b.NEW_ADD_EMBEDDED_OBJECT_MUTATION,"transformWithNewAddEmbeddedObjectMutation"),Object(s.a)(n,h.b.NEW_DELETE_EMBEDDED_OBJECT_MUTATION,"transformWithNewDeleteEmbeddedObjectMutation"),Object(s.a)(n,h.b.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION,"transformWithNewUpdateEmbeddedObjectMutation"),n);if(r[e.id])return this[r[e.id]](e,t);throw new Error("Should not have tried transforming the two mutations: ".concat(this.id,",").concat(e.id))}},{key:"transformWithInsertDimensionMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){return[this]}},{key:"transformWithSetDimensionPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithSetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return[this]}},{key:"transformWithUnmergeCellsMutation",value:function(e,t){return[this]}},{key:"transformWithDefineFilterMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteFilterMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return[this]}},{key:"transformWithSwitchFilterSyncMutation",value:function(e,t){return[this]}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithInsertSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithMoveSheetMutation",value:function(e,t){return[this]}},{key:"transformWithSetSheetPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateAllSheetsMutation",value:function(e,t){return[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithSetWorkbookPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){return[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){return[this]}},{key:"transformWithEmptyMutation",value:function(e,t){return[this]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteConditionalFormatMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,t){return[this]}},{key:"transformWithDefineWorkbookRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateWorkbookRangeMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteWorkbookRangeMutation",value:function(e,t){return[this]}},{key:"transformWithNewAddEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithNewDeleteEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithNewUpdateEmbeddedObjectMutation",value:function(e,t){return[this]}}]),e}();t.a=I},"../packages/mutation/src/MutationId.ts":function(e,t,n){"use strict";var s;n.d(t,"a",(function(){return r})),function(e){e[e.INSERT_DIMENSION_MUTATION=0]="INSERT_DIMENSION_MUTATION",e[e.DELETE_DIMENSION_MUTATION=1]="DELETE_DIMENSION_MUTATION",e[e.SET_DIMENSION_PROPERTIES_MUTATION=2]="SET_DIMENSION_PROPERTIES_MUTATION",e[e.SET_RANGE_MUTATION=3]="SET_RANGE_MUTATION",e[e.SET_CELL_PROPERTIES_MUTATION=4]="SET_CELL_PROPERTIES_MUTATION",e[e.MERGE_CELLS_MUTATION=5]="MERGE_CELLS_MUTATION",e[e.UNMERGE_CELLS_MUTATION=6]="UNMERGE_CELLS_MUTATION",e[e.UPDATE_FILTERS_MODEL_MUTATION=7]="UPDATE_FILTERS_MODEL_MUTATION",e[e.ADD_EMBEDDED_OBJECT_MUTATION=8]="ADD_EMBEDDED_OBJECT_MUTATION",e[e.DELETE_EMBEDDED_OBJECT_MUTATION=9]="DELETE_EMBEDDED_OBJECT_MUTATION",e[e.UPDATE_EMBEDDED_OBJECT_MUTATION=10]="UPDATE_EMBEDDED_OBJECT_MUTATION",e[e.INSERT_SHEET_MUTATION=11]="INSERT_SHEET_MUTATION",e[e.DELETE_SHEET_MUTATION=12]="DELETE_SHEET_MUTATION",e[e.MOVE_SHEET_MUTATION=13]="MOVE_SHEET_MUTATION",e[e.SET_SHEET_PROPERTIES_MUTATION=14]="SET_SHEET_PROPERTIES_MUTATION",e[e.UPDATE_ALL_SHEETS_MUTATION=15]="UPDATE_ALL_SHEETS_MUTATION",e[e.DEFINE_SHEET_RANGE_MUTATION=16]="DEFINE_SHEET_RANGE_MUTATION",e[e.DELETE_SHEET_RANGE_MUTATION=17]="DELETE_SHEET_RANGE_MUTATION",e[e.UPDATE_SHEET_RANGE_MUTATION=18]="UPDATE_SHEET_RANGE_MUTATION",e[e.SET_WORKBOOK_PROPERTIES_MUTATION=19]="SET_WORKBOOK_PROPERTIES_MUTATION",e[e.INIT_DATA_MUTATION=20]="INIT_DATA_MUTATION",e[e.COPY_PASTE_MUTATION=21]="COPY_PASTE_MUTATION",e[e.REORDER_RANGE_MUTATION=22]="REORDER_RANGE_MUTATION",e[e.MAP_RANGE_MUTATION=23]="MAP_RANGE_MUTATION",e[e.DEFINE_FILTER_MUTATION=24]="DEFINE_FILTER_MUTATION",e[e.DELETE_FILTER_MUTATION=25]="DELETE_FILTER_MUTATION",e[e.UPDATE_FILTER_MUTATION=26]="UPDATE_FILTER_MUTATION",e[e.EMPTY_MUTATION=27]="EMPTY_MUTATION",e[e.ADD_CONDITIONAL_FORMAT_MUTATION=28]="ADD_CONDITIONAL_FORMAT_MUTATION",e[e.DELETE_CONDITIONAL_FORMAT_MUTATION=29]="DELETE_CONDITIONAL_FORMAT_MUTATION",e[e.UPDATE_CONDITIONAL_FORMAT_MUTATION=30]="UPDATE_CONDITIONAL_FORMAT_MUTATION",e[e.DEFINE_WORKBOOK_RANGE_MUTATION=31]="DEFINE_WORKBOOK_RANGE_MUTATION",e[e.UPDATE_WORKBOOK_RANGE_MUTATION=32]="UPDATE_WORKBOOK_RANGE_MUTATION",e[e.DELETE_WORKBOOK_RANGE_MUTATION=33]="DELETE_WORKBOOK_RANGE_MUTATION",e[e.NEW_ADD_EMBEDDED_OBJECT_MUTATION=34]="NEW_ADD_EMBEDDED_OBJECT_MUTATION",e[e.NEW_DELETE_EMBEDDED_OBJECT_MUTATION=35]="NEW_DELETE_EMBEDDED_OBJECT_MUTATION",e[e.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION=36]="NEW_UPDATE_EMBEDDED_OBJECT_MUTATION",e[e.SWITCH_FILTER_SYNC_MUTATION=37]="SWITCH_FILTER_SYNC_MUTATION"}(s||(s={}));var r=[s.SET_DIMENSION_PROPERTIES_MUTATION,s.SET_RANGE_MUTATION,s.SET_CELL_PROPERTIES_MUTATION];t.b=s},"../packages/mutation/src/MutationOperationType.ts":function(e,t,n){"use strict";var s;!function(e){e[e.HISTORY=-1]="HISTORY",e[e.LOCAL=0]="LOCAL",e[e.UNDO=1]="UNDO",e[e.REDO=2]="REDO",e[e.COLLAB=3]="COLLAB"}(s||(s={})),t.a=s},"../packages/mutation/src/SlotOperation.ts":function(e,t,n){"use strict";var s;!function(e){e[e.SET_SLOT=0]="SET_SLOT",e[e.CLEAR_SLOT=1]="CLEAR_SLOT",e[e.ADD_SLOT=2]="ADD_SLOT",e[e.REMOVE_SLOT=3]="REMOVE_SLOT"}(s||(s={})),t.a=s},"../packages/mutation/src/api.interface.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s,r=n("../packages/services/src/instantiation.ts");!function(e){e[e.Workbook=1]="Workbook",e[e.Sheet=2]="Sheet"}(s||(s={}));var o=Object(r.c)("IMutationBehavior")},"../packages/mutation/src/api.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s,r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=n("../packages/lib/EventEmitter.ts"),d=n("../packages/report/src/index.ts"),u=n("../packages/model/src/index.ts"),l=n("../packages/mutation/src/config/report.ts"),h=n("../packages/mutation/src/config/version.ts"),c=n("../packages/mutation/src/utils/index.ts"),I=n("../packages/mutation/src/MutationId.ts"),m=n("../packages/mutation/src/converter.ts"),f=n("../packages/mutation/src/transform.ts"),g=n("../packages/mutation/src/dimension/InsertDimensionMutation.ts"),p=n("../packages/mutation/src/dimension/DeleteDimensionMutation.ts"),R=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),x=n("../packages/mutation/src/cell/SetRangeMutation.ts"),b=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),y=n("../packages/mutation/src/merge/MergeCellsMutation.ts"),k=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts"),O=n("../packages/mutation/src/embedded/AddEmbeddedObjectMutation.ts"),v=n("../packages/mutation/src/embedded/DeleteEmbeddedObjectMutation.ts"),T=n("../packages/mutation/src/embedded/UpdateEmbeddedObjectMutation.ts"),w=n("../packages/mutation/src/sheet/InsertSheetMutation.ts"),_=n("../packages/mutation/src/sheet/DeleteSheetMutation.ts"),j=n("../packages/mutation/src/sheet/MoveSheetMutation.ts"),D=n("../packages/mutation/src/sheet/SetSheetPropertiesMutation.ts"),M=n("../packages/mutation/src/sheet/DefineSheetRangeMutation.ts"),S=n("../packages/mutation/src/sheet/DeleteSheetRangeMutation.ts"),E=n("../packages/mutation/src/sheet/UpdateSheetRangeMutation.ts"),C=n("../packages/mutation/src/other/InitDataMutation.ts"),A=n("../packages/mutation/src/other/CopyPasteMutation.ts"),N=n("../packages/mutation/src/other/ReorderRangeMutation.ts"),P=n("../packages/mutation/src/other/MapRangeMutation.ts"),U=n("../packages/mutation/src/filter/DefineFilterMutation.ts"),W=n("../packages/mutation/src/filter/DeleteFilterMutation.ts"),L=n("../packages/mutation/src/filter/UpdateFilterMutation.ts"),F=n("../packages/mutation/src/filter/SwitchFilterSyncMutation.ts"),B=n("../packages/mutation/src/other/EmptyMutation.ts"),z=n("../packages/mutation/src/conditionalFormat/AddConditionalFormatMutation.ts"),V=n("../packages/mutation/src/conditionalFormat/DeleteConditionalFormatMutation.ts"),G=n("../packages/mutation/src/conditionalFormat/UpdateConditionalFormatMutation.ts"),H=n("../packages/mutation/src/workbook/workbookRange/DefineWorkbookRangeMutation.ts"),J=n("../packages/mutation/src/workbook/workbookRange/UpdateWorkbookRangeMutation.ts"),K=n("../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts"),Y=n("../packages/mutation/src/new-embedded/NewAddEmbeddedObjectMutation.ts"),Z=n("../packages/mutation/src/new-embedded/NewDeleteEmbeddedObjectMutation.ts"),q=n("../packages/mutation/src/new-embedded/NewUpdateEmbeddedObjectMutation.ts"),X=u.Utils.serializeUtils;!function(e){e[e.Workbook=1]="Workbook",e[e.Sheet=2]="Sheet"}(s||(s={}));var Q=function(){function t(){Object(o.a)(this,t),this.emitter=new i.a}return Object(a.a)(t,[{key:"_serializeMutation",value:function(e){if(e.version>=5)return e.serialize();return X.serialize(e,null,{notReplaceSheetId:!0})}},{key:"_deserializeMutation",value:function(e,t){if(e.v>=5)return t.deserialize(e.c);return X.deserialize(e.c,t,{notReplaceSheetId:!0})}},{key:"serializeMutation",value:function(e){var t={t:e.id,v:e.version,c:[],r:e.parentRequestId,o:e.operationType};try{e.version<5&&(t.v=h.a.MUTATION_VER_LOWEST_SUPPORT),t.c=this._serializeMutation(e)}catch(n){console.error("serialize mutation error: ",e,n),d.b.run(l.b.SERIALIZE_MUTATION,[e],n)}return t}},{key:"deserializeMutation",value:function(e){var n;if(e.v>h.a.MUTATION_VER)return this.emitter.emit(t.EVENT.DATA_VERSION_TOO_LOW,e.v),null;if(e.v<h.a.MUTATION_VER_LOWEST_SUPPORT)return console.error("mutation version is lower than support",e),d.b.monitor(l.a.MUTATION_VER_LOWER_THAN_SUPPORT),null;if(e.v<h.a.MUTATION_VER&&e.v>=5)try{e=Object(m.a)(e)}catch(a){return console.error("convert mutation error: ",e,a),d.b.monitor(l.a.CONVERT_MUTATION_ERROR),null}var s=(n={},Object(r.a)(n,I.b.INSERT_DIMENSION_MUTATION,g.a),Object(r.a)(n,I.b.DELETE_DIMENSION_MUTATION,p.a),Object(r.a)(n,I.b.SET_DIMENSION_PROPERTIES_MUTATION,R.c),Object(r.a)(n,I.b.SET_RANGE_MUTATION,x.a),Object(r.a)(n,I.b.SET_CELL_PROPERTIES_MUTATION,b.a),Object(r.a)(n,I.b.MERGE_CELLS_MUTATION,y.a),Object(r.a)(n,I.b.UNMERGE_CELLS_MUTATION,k.a),Object(r.a)(n,I.b.UPDATE_FILTERS_MODEL_MUTATION,B.a),Object(r.a)(n,I.b.ADD_EMBEDDED_OBJECT_MUTATION,O.a),Object(r.a)(n,I.b.DELETE_EMBEDDED_OBJECT_MUTATION,v.a),Object(r.a)(n,I.b.UPDATE_EMBEDDED_OBJECT_MUTATION,T.a),Object(r.a)(n,I.b.INSERT_SHEET_MUTATION,w.a),Object(r.a)(n,I.b.DELETE_SHEET_MUTATION,_.a),Object(r.a)(n,I.b.MOVE_SHEET_MUTATION,j.a),Object(r.a)(n,I.b.SET_SHEET_PROPERTIES_MUTATION,D.a),Object(r.a)(n,I.b.UPDATE_ALL_SHEETS_MUTATION,B.a),Object(r.a)(n,I.b.DEFINE_SHEET_RANGE_MUTATION,M.a),Object(r.a)(n,I.b.DELETE_SHEET_RANGE_MUTATION,S.a),Object(r.a)(n,I.b.UPDATE_SHEET_RANGE_MUTATION,E.a),Object(r.a)(n,I.b.SET_WORKBOOK_PROPERTIES_MUTATION,B.a),Object(r.a)(n,I.b.INIT_DATA_MUTATION,C.a),Object(r.a)(n,I.b.COPY_PASTE_MUTATION,A.b),Object(r.a)(n,I.b.REORDER_RANGE_MUTATION,N.a),Object(r.a)(n,I.b.MAP_RANGE_MUTATION,P.a),Object(r.a)(n,I.b.DEFINE_FILTER_MUTATION,U.a),Object(r.a)(n,I.b.DELETE_FILTER_MUTATION,W.a),Object(r.a)(n,I.b.UPDATE_FILTER_MUTATION,L.b),Object(r.a)(n,I.b.SWITCH_FILTER_SYNC_MUTATION,F.a),Object(r.a)(n,I.b.EMPTY_MUTATION,B.a),Object(r.a)(n,I.b.ADD_CONDITIONAL_FORMAT_MUTATION,z.a),Object(r.a)(n,I.b.DELETE_CONDITIONAL_FORMAT_MUTATION,V.a),Object(r.a)(n,I.b.UPDATE_CONDITIONAL_FORMAT_MUTATION,G.a),Object(r.a)(n,I.b.DEFINE_WORKBOOK_RANGE_MUTATION,H.a),Object(r.a)(n,I.b.UPDATE_WORKBOOK_RANGE_MUTATION,J.a),Object(r.a)(n,I.b.DELETE_WORKBOOK_RANGE_MUTATION,K.a),Object(r.a)(n,I.b.NEW_ADD_EMBEDDED_OBJECT_MUTATION,Y.a),Object(r.a)(n,I.b.NEW_DELETE_EMBEDDED_OBJECT_MUTATION,Z.a),Object(r.a)(n,I.b.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION,q.a),n),o=null;try{s[e.t]?o=this._deserializeMutation(e,s[e.t]):(console.error("deserialize mutation fail: ",e),d.b.run(l.b.DESERIALIZE_MUTATION_FAIL,[e,h.a.MUTATION_VER_LOWEST_SUPPORT,h.a.MUTATION_VER])),(o=o||new B.a({sheetId:""})).version=e.v,o.parentRequestId=e.r,o.operationType=e.o}catch(a){e.v>5?d.b.run(l.b.DESERIALIZE_MUTATION_CATCH_ERROR,[e,h.a.MUTATION_VER_LOWEST_SUPPORT,h.a.MUTATION_VER],a):d.b.run(l.b.DESERIALIZE_MUTATION_CATCH_ERROR_OLD,[e,h.a.MUTATION_VER],a)}return o}},{key:"getMutationDataSize",value:function(e){var t=this;try{var n=[];return e&&e.forEach((function(e){var s=t.serializeMutation(e);n.push(s)})),JSON.stringify(n).length}catch(s){return console.error(s),-1}}},{key:"getCollabMutations",value:function(e){var t=this;if("string"===typeof e)try{e=JSON.parse(e)}catch(s){throw d.b.run(l.b.GET_COLLAB_MUTATIONS,[e,s]),s}var n=[];return Array.isArray(e)&&e.forEach((function(e){if(e&&e.v){var s=t.deserializeMutation(e);s&&n.push(s)}})),n}},{key:"follow",value:function(e,t){var n,s,r,o,a=[],i=[],d=[];for(n=0,s=e.length;n<s;n++)(r=this.deserializeMutation(e[n]))&&i.push(r);for(n=0,s=t.length;n<s;n++)(o=this.deserializeMutation(t[n]))&&d.push(o);for(d=Object(f.a)(d,i,!0),n=0,s=t.length;n<s;n++)a.push(this.serializeMutation(d[n]));return a}},{key:"followRequestMutations",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var s,r,o,a,i,u,h,c;for(s=0,a=e.length;s<a;s++){for(i=e[s],h=[],r=0,o=t.length;r<o;r++)u=t[r],c=Object(f.a)(u,i,!n),r<o-1&&(i=Object(f.a)(i,u,n)),h.push(c);t=h}return d.b.monitor(33641616),t}catch(I){throw d.b.run(l.b.FOLLOW_REQUEST_MUTATIONS,[e,t,n,I&&I.stack]),I}}},{key:"followRequests",value:function(e,t){var n,s,r,o,a,i,u,l,h,I,m=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=[],g=!1;if(!Object(c.e)(e)||!Object(c.e)(t))return t;for(h=[],n=0,o=e.length;n<o;n++){for(u=[],s=0,r=e[n].length;s<r;s++)(a=this.deserializeMutation(e[n][s]))?u.push(a):g=!0;h.push(u)}for(I=[],n=0,o=t.length;n<o;n++){for(l=[],s=0,r=t[n].length;s<r;s++)(i=this.deserializeMutation(t[n][s]))?l.push(i):g=!0;I.push(l)}var p=this.followRequestMutations(h,I,m);return f=this.serializeRequests(p),g&&d.b.tdwReport({opername:"doc_excel_editor",module:"excel_core",action:"followRequests",obj3:"requestsA: ".concat(JSON.stringify(e||""),"  requestsB: ").concat(JSON.stringify(t||""))}),f}},{key:"serializeRequests",value:function(e){for(var t,n,s=[],r=0,o=e.length;r<o;r++){n=e[r],s[r]=[];for(var a=0,i=n.length;a<i;a++)t=n[a],s[r].push(this.serializeMutation(t))}return s}},{key:"deSerializeRequests",value:function(e){var t,n,s,r,o,a=[],i=[];for(t=0,r=e.length;t<r;t++){for(a=[],n=0,s=e[t].length;n<s;n++)(o=this.deserializeMutation(e[t][n]))&&i.push(o);a.push(i)}return a}},{key:"applyMutation",value:function(n,r,o){o||(o=e.SpreadsheetApp&&e.SpreadsheetApp.preview&&e.SpreadsheetApp.preview.isActive&&r.isLocal?e.SpreadsheetApp.preview.previewsheet:e.SpreadsheetApp.spreadsheet);try{this.emitter.emit(t.EVENT.BEFORE_MUTATION_RUN,{mutation:n,isLocal:r.isLocal,isFromFormula:r.isFromFormula,isCollab:r.isCollab,isReplay:r.isReplay})}catch(f){var a;null===(a=e.log)||void 0===a||a.error("BEFORE_MUTATION_RUN error.",f&&f.stack)}var i=n.run(o,r),d=i.runResult,u=i.runCache,l=i.workbookWithSheetId;if(i.isMultiSheet)this.triggerRender(n,o,r,s.Workbook);else if(d.isValid){for(var h=!1,c=0,I=u.length;c<I;c++){var m=u[c][0];this.triggerRender(n,m,u[c][1],s.Sheet),l&&m.getSheetId()!==l||(h=!0)}h||this.triggerRender(n,o,r,s.Workbook)}return this.triggerDataChange(n),d}},{key:"triggerRender",value:function(n,r,o,a){var i,u,h=+new Date;a===s.Workbook?(i=r.type,u=n.getAffectedSheetId()):(i=r.spreadsheetReference.type,u=r.getSheetId());try{this.emitter.emit(t.EVENT.AFTER_MUTATION_RUN,{sheetId:u,mutation:n,sType:i,isLocal:o.isLocal,isFromFormula:o.isFromFormula,isCollab:o.isCollab,isReplay:o.isReplay})}catch(I){var c;d.b.run(l.b.AFTER_MUTATION_RUN_CATCH_ERROR,I,n),null===(c=e.log)||void 0===c||c.error("triggerRender AFTER_MUTATION_RUN error.",null===I||void 0===I?void 0:I.stack)}d.b.speed.hasDonePagePerformanceReport()||d.b.speed.runReport(l.c.AFTER_MUTATIONS_RUN,h,+new Date,!0)}},{key:"triggerDataChange",value:function(n){try{this.emitter.emit(t.EVENT.DATA_CHANGE,{type:"afterMutationRun"})}catch(r){var s;return null===(s=e.log)||void 0===s||s.error("triggerDataChange DATA_CHANGE error.",r&&r.stack),d.b.run(l.b.AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR,r,n),!1}}},{key:"EVENT",get:function(){return t.EVENT}}]),t}();Q.EVENT={DATA_VERSION_TOO_LOW:"DATA_VERSION_TOO_LOW",DATA_CHANGE:"DATA_CHANGE",BEFORE_MUTATION_RUN:"BEFORE_MUTATION_RUN",AFTER_MUTATION_RUN:"AFTER_MUTATION_RUN"},t.a=Q}).call(this,n("../node_modules/webpack/buildin/global.js"))},"../packages/mutation/src/cell/SetCellPropertiesMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/get.js"),a=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),i=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=n("../packages/model/src/index.ts"),l=n("../packages/mutation/src/utils/index.ts"),h=n("../packages/mutation/src/MutationId.ts"),c=n("../packages/mutation/src/Mutation.ts"),I=n("../packages/mutation/src/cell/cellMutationUtils.ts"),m=n("../packages/mutation/src/cell/SetRangeMutation.ts"),f=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts");function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(i.a)(this,n)}}var p=u.Dimension.DIMENSION_TYPE,R=u.Range,x=R.GridRange,b=R.gridRangeUtils,y=u.Cell,k=y.CellDataDelta,O=y.CELL_DATA_SLOT_COMPOSE,v=y.CellDataDeltaPropertiesMap,T=y.cellDataUtils,w=y.cellDataDeltaUtils,_=function(e){Object(a.a)(n,e);var t=g(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,h.b.SET_CELL_PROPERTIES_MUTATION,e)).gridRange=e.gridRange,r.cellDataDelta=e.cellDataDelta,r}return Object(r.a)(n,[{key:"serialize",value:function(){var e=new v;return[this.gridRange.serialize(),this.cellDataDelta.serialize(e),e.serializedPropertiesMap]}},{key:"getAffectedSheetId",value:function(){return this.gridRange.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId);return t?[t]:[]}},{key:"check",value:function(e){var t=Object(o.a)(Object(d.a)(n.prototype),"check",this).call(this,e);if(!t.isValid)return t;if(!this.gridRange||!this.cellDataDelta)return{isValid:!1,errorMessage:"GridRange\u4e3a\u7a7a \u6216\u8005 cellDataDelta\u4e3a\u7a7a gridRange=".concat(JSON.stringify(this.gridRange)," cellDataDelta=").concat(JSON.stringify(this.cellDataDelta))};var s=this.gridRange,r=e.properties.gridProperties;return Object(l.c)(s.startRowIndex)&&Object(l.c)(s.endRowIndex)&&Object(l.c)(s.startColIndex)&&Object(l.c)(s.endColIndex)?s.startRowIndex<0||s.endRowIndex>=r.rowCount||s.startColIndex<0||s.endColIndex>=r.colCount?{isValid:!1,errorMessage:"gridRange \u8303\u56f4\u4e0d\u6b63\u786e\u3002 gridRange=".concat(JSON.stringify(s)," gridProperties=").concat(JSON.stringify(r))}:{isValid:!0}:{isValid:!1,errorMessage:"gridRange index\u7c7b\u578b\u4e0d\u662f\u6570\u5b57 girdRange=".concat(JSON.stringify(s))}}},{key:"run",value:function(e,t){return this.runMutationOptions={isLocal:!1},Object.assign(this.runMutationOptions,t),Object(o.a)(Object(d.a)(n.prototype),"run",this).call(this,e,t)}},{key:"runOnSheet",value:function(e){if(!this.cellDataDelta.isEmpty()){var t,n,s,r,o,a,i=this.cellDataDelta,d=this.gridRange,u=d.startRowIndex,l=d.endRowIndex,h=d.startColIndex,c=d.endColIndex;for(t=u,s=l;t<=s;t++)for(n=h,r=c;n<=r;n++){var I,m,f,g,p,R;if((o=e.getCellDataAtPosition(t,n))&&0!==o.setSlots||0!==i.setSlots){var x=null;null!=o&&(x=o.clone()),a=T.mergeDeltaToCellData(o,i),e.setCellDataAtPosition(t,n,a),e.mentionManager.updateMentions((null===(I=x)||void 0===I?void 0:I.getMentionDetails())||void 0,(null===(m=a)||void 0===m?void 0:m.getMentionDetails())||void 0,t,n,{isReplay:null===(f=this.runMutationOptions)||void 0===f?void 0:f.isReplay,isCollab:null===(g=this.runMutationOptions)||void 0===g?void 0:g.isCollab}),e.hyperlinkManager.updateHyperlink((null===(p=x)||void 0===p?void 0:p.getHyperlink())?{rowIndex:t,colIndex:n,cellData:x}:null,(null===(R=a)||void 0===R?void 0:R.getHyperlink())?{rowIndex:t,colIndex:n,cellData:a}:null)}}}}},{key:"invert",value:function(e){var t,n,s,r,o,a,i,d,u,l=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId),h=this.cellDataDelta,c=[],I=this.gridRange;if(!l)return[];var f=l.data;for(a=I.startRowIndex<0?f.startRow:I.startRowIndex,i=I.endRowIndex<0?l.getRowCount()-1:I.endRowIndex,d=I.startColIndex<0?f.startCol:I.startColIndex,u=I.endColIndex<0?l.getColCount()-1:I.endColIndex,t=a,s=i;t<=s;t++)for(n=d,r=u;n<=r;n++)o=l.getCellDataAtPosition(t,n),c.push({rowIndex:t,colIndex:n,cellDataDelta:w.invertCellDataDelta(o,h)});return[new m.a({gridRange:this.gridRange,cellDataDeltaAtPositions:c})]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s,r,o=[];e.type===p.ROWS?e.index>this.gridRange.startRowIndex&&e.index<=this.gridRange.endRowIndex?(o.push(new x(this.gridRange.sheetId,this.gridRange.startRowIndex,e.index-1,this.gridRange.startColIndex,this.gridRange.endColIndex)),o.push(new x(this.gridRange.sheetId,e.index,this.gridRange.endRowIndex,this.gridRange.startColIndex,this.gridRange.endColIndex))):o.push(this.gridRange):e.index>this.gridRange.startColIndex&&e.index<=this.gridRange.endColIndex?(o.push(new x(this.gridRange.sheetId,this.gridRange.startRowIndex,this.gridRange.endRowIndex,this.gridRange.startColIndex,e.index-1)),o.push(new x(this.gridRange.sheetId,this.gridRange.startRowIndex,this.gridRange.endRowIndex,e.index,this.gridRange.endColIndex))):o.push(this.gridRange);var a=[],i=Object(I.a)(this.cellDataDelta,e);for(s=0,r=o.length;s<r;s++)a.push(new n({gridRange:b.changeGridRangeByInsertDimension(o[s],o[s].sheetId,e.type,e.index,e.amount,!1,!1),cellDataDelta:i}));return a}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s=b.changeGridRangeByDeleteDimension(this.gridRange,e.sheetId,e.type,e.index,e.amount);return s.endRowIndex<s.startRowIndex||s.endColIndex<s.startColIndex?[]:[new n({gridRange:s,cellDataDelta:Object(I.a)(this.cellDataDelta,e)})]}},{key:"transformWithSetRangeMutation",value:function(e,t){if(this.gridRange.sheetId!==e.gridRange.sheetId)return[this];var s,r;if(!b.isTwoGridRangeCross(this.gridRange,e.gridRange))return[this];var o,a,i=e.getTotalSlots();if(0===((this.cellDataDelta.setSlots|this.cellDataDelta.clearSlots)&(i.cellDataSetSlots|i.cellDataClearSlots)))return[this];var d,u=[],l=[];for(s=0,r=e.cellDataDeltaAtPositions.length;s<r;s++)o=e.cellDataDeltaAtPositions[s],b.isCellInGridRange(this.gridRange,o.rowIndex,o.colIndex)&&(a=w.transformTwoCellDataDelta(this.cellDataDelta,o.cellDataDelta,t),d=new x(this.gridRange.sheetId,o.rowIndex,o.rowIndex,o.colIndex,o.colIndex),a.isEmpty()||u.push(new n({gridRange:d,cellDataDelta:a})),l.push(d));for(s=0,r=(l=b.divideGridRangeByCells(this.gridRange,l)).length;s<r;s++)u.push(new n({gridRange:l[s],cellDataDelta:this.cellDataDelta}));return u}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){if(this.gridRange.sheetId!==e.gridRange.sheetId)return[this];var s,r;if(!b.isTwoGridRangeCross(this.gridRange,e.gridRange))return[this];if(0===((this.cellDataDelta.setSlots|this.cellDataDelta.clearSlots)&(e.cellDataDelta.setSlots|e.cellDataDelta.clearSlots)))return[this];var o=w.transformTwoCellDataDelta(this.cellDataDelta,e.cellDataDelta,t);if(e.gridRange.contain(this.gridRange))return o.isEmpty()?[]:[new n({gridRange:this.gridRange,cellDataDelta:o})];var a=b.getCrossGridRange(this.gridRange,e.gridRange),i=[];o.isEmpty()||i.push(new n({gridRange:a,cellDataDelta:o}));var d=b.divideGridRangeByCells(this.gridRange,[a]);for(s=0,r=d.length;s<r;s++)i.push(new n({gridRange:d[s],cellDataDelta:this.cellDataDelta}));return i}},{key:"transformWithMergeCellsMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s,r;if(0===this.cellDataDelta.setSlots)return[this];var o,a=[];a.push(new x(e.sheetId,e.startRowIndex+1,e.endRowIndex,e.startColIndex,e.endColIndex)),a.push(new x(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex+1,e.endColIndex));var i=[];for(s=0,r=a.length;s<r;s++)(o=b.getCrossGridRange(this.gridRange,a[s]))&&i.push(o);if(0===i.length)return[this];if(t)return[new f.a({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex})];var d=[];for(s=0,r=(i=b.divideGridRangeByCells(this.gridRange,i)).length;s<r;s++)d.push(new n({gridRange:i[s],cellDataDelta:this.cellDataDelta}));return d}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.gridRange.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){return this.gridRange.sheetId,e.sheetId,[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s,r,o=b.getCrossGridRange(this.gridRange,e.range);if(!o)return[this];var a,i=b.divideGridRangeByCells(this.gridRange,[o]),d=[];for(s=0,r=i.length;s<r;s++)d.push(new n({gridRange:i[s],cellDataDelta:this.cellDataDelta}));var u=Object(I.a)(this.cellDataDelta,e),l=w.divideCellDataDeltaByBorders(u);for(s=o.startRowIndex,r=o.endRowIndex;s<=r;s++)(a=e.getOrderResult(s))?(l.borders&&!l.borders.isEmpty()&&d.push(new n({gridRange:new x(o.sheetId,s,s,o.startColIndex,o.endColIndex),cellDataDelta:l.borders})),l.other&&!l.other.isEmpty()&&d.push(new n({gridRange:new x(o.sheetId,a,a,o.startColIndex,o.endColIndex),cellDataDelta:l.other}))):d.push(new n({gridRange:new x(o.sheetId,s,s,o.startColIndex,o.endColIndex),cellDataDelta:this.cellDataDelta}));return d}},{key:"transformWithMapRangeMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sourceSheetId)return[this];var s,r,o=Object(I.a)(this.cellDataDelta,e),a=b.getCrossGridRange(this.gridRange,new x(e.sourceSheetId,-1===e.row.from.startIndex?0:e.row.from.startIndex,-1===e.row.from.endIndex?Number.MAX_VALUE:e.row.from.endIndex,-1===e.column.from.startIndex?0:e.column.from.startIndex,-1===e.column.from.endIndex?Number.MAX_VALUE:e.column.from.endIndex));if(!a)return[new n({gridRange:this.gridRange,cellDataDelta:o})];var i=[];i.push(new n({gridRange:a,cellDataDelta:new k({clearSlots:O.ALL})}));var d=new x(this.gridRange.sheetId,-1===e.row.from.startIndex?a.startRowIndex:a.startRowIndex-e.row.from.startIndex+e.row.to,-1===e.row.from.startIndex?a.endRowIndex:a.endRowIndex-e.row.from.startIndex+e.row.to,-1===e.column.from.startIndex?a.startColIndex:a.startColIndex-e.column.from.startIndex+e.column.to,-1===e.column.from.startIndex?a.endColIndex:a.endColIndex-e.column.from.startIndex+e.column.to);i.push(new n({gridRange:d,cellDataDelta:o}));var u=b.divideGridRangeByCells(this.gridRange,[a]);for(s=0,r=u.length;s<r;s++)i.push(new n({gridRange:u[s],cellDataDelta:this.cellDataDelta}));return i}}],[{key:"deserialize",value:function(e){var t=x.deserialize(e[0]),s=v.createPropertiesMap(e[2]);return new n({gridRange:t,cellDataDelta:k.deserialize(e[1],s)})}}]),n}(c.a);_.protoMap={0:{name:"gridRange",dataType:x},1:{name:"cellDataDelta",dataType:k}},t.a=_},"../packages/mutation/src/cell/SetRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.assign.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/get.js"),a=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),i=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=n("../packages/model/src/index.ts"),l=n("../packages/mutation/src/utils/index.ts"),h=n("../packages/mutation/src/MutationId.ts"),c=n("../packages/mutation/src/Mutation.ts"),I=n("../packages/mutation/src/cell/cellMutationUtils.ts"),m=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),f=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts");function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(i.a)(this,n)}}var p=u.Range,R=p.GridRange,x=p.gridRangeUtils,b=u.Cell,y=b.CellDataDelta,k=b.CELL_DATA_SLOT_COMPOSE,O=b.CellDataDeltaPropertiesMap,v=b.cellDataUtils,T=b.cellDataDeltaUtils,w={0:{name:"rowIndex",dataType:Number},1:{name:"colIndex",dataType:Number},2:{name:"cellDataDelta",dataType:y}},_=function(e){Object(a.a)(n,e);var t=g(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,h.b.SET_RANGE_MUTATION,e)).gridRange=e.gridRange,r.cellDataDeltaAtPositions=e.cellDataDeltaAtPositions,r}return Object(r.a)(n,[{key:"serialize",value:function(){var e,t,n,s={},r=new O,o=this.gridRange.endColIndex-this.gridRange.startColIndex+1;for(t=0,n=this.cellDataDeltaAtPositions.length;t<n;t++)s[((e=this.cellDataDeltaAtPositions[t]).rowIndex-this.gridRange.startRowIndex)*o+(e.colIndex-this.gridRange.startColIndex)]=e.cellDataDelta.serialize(r);return[this.gridRange.serialize(),s,r.serializedPropertiesMap]}},{key:"getSizeEstimate",value:function(){return this.cellDataDeltaAtPositions.length}},{key:"getAffectedSheetId",value:function(){return this.gridRange.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId);return t?[t]:[]}},{key:"check",value:function(e){var t=Object(o.a)(Object(d.a)(n.prototype),"check",this).call(this,e);if(!t.isValid)return t;if(!this.gridRange||!this.cellDataDeltaAtPositions)return{isValid:!1,errorMessage:"GridRange\u4e3a\u7a7a \u6216\u8005 cellDataDeltaAtPositions\u4e3a\u7a7a gridRange=".concat(JSON.stringify(this.gridRange)," cellDataDeltaAtPositions=").concat(JSON.stringify(this.cellDataDeltaAtPositions))};var s=this.gridRange,r=e.properties.gridProperties;return Object(l.c)(s.startRowIndex)&&Object(l.c)(s.endRowIndex)&&Object(l.c)(s.startColIndex)&&Object(l.c)(s.endColIndex)?s.startRowIndex<0||s.endRowIndex>=r.rowCount||s.startColIndex<0||s.endColIndex>=r.colCount?{isValid:!1,errorMessage:"gridRange \u8303\u56f4\u4e0d\u6b63\u786e\u3002 gridRange=".concat(JSON.stringify(s)," gridProperties=").concat(JSON.stringify(r))}:{isValid:!0}:{isValid:!1,errorMessage:"gridRange index\u7c7b\u578b\u4e0d\u662f\u6570\u5b57 girdRange=".concat(JSON.stringify(s))}}},{key:"run",value:function(e,t){return this.runMutationOptions={isLocal:!1},Object.assign(this.runMutationOptions,t),Object(o.a)(Object(d.a)(n.prototype),"run",this).call(this,e,t)}},{key:"runOnSheet",value:function(e){var t,n,s,r,o,a,i;for(t=0,n=this.cellDataDeltaAtPositions.length;t<n;t++){var d,u,l,h,c,I;if(s=this.cellDataDeltaAtPositions[t].rowIndex,r=this.cellDataDeltaAtPositions[t].colIndex,a=this.cellDataDeltaAtPositions[t].cellDataDelta,(o=e.getCellDataAtPosition(s,r))&&0!==o.setSlots||0!==a.setSlots){var m=null;null!=o&&(m=o.clone()),i=v.mergeDeltaToCellData(o,a),e.setCellDataAtPosition(s,r,i),e.mentionManager.updateMentions((null===(d=m)||void 0===d?void 0:d.getMentionDetails())||void 0,(null===(u=i)||void 0===u?void 0:u.getMentionDetails())||void 0,s,r,{isReplay:null===(l=this.runMutationOptions)||void 0===l?void 0:l.isReplay,isCollab:null===(h=this.runMutationOptions)||void 0===h?void 0:h.isCollab}),e.hyperlinkManager.updateHyperlink((null===(c=m)||void 0===c?void 0:c.getHyperlink())?{rowIndex:s,colIndex:r,cellData:m}:null,(null===(I=i)||void 0===I?void 0:I.getHyperlink())?{rowIndex:s,colIndex:r,cellData:i}:null)}}}},{key:"invert",value:function(e){var t,s,r,o,a,i,d=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId),u=[];if(!d)return[];for(t=0,s=this.cellDataDeltaAtPositions.length;t<s;t++)r=this.cellDataDeltaAtPositions[t].rowIndex,o=this.cellDataDeltaAtPositions[t].colIndex,i=this.cellDataDeltaAtPositions[t].cellDataDelta,a=d.getCellDataAtPosition(r,o),u.push({rowIndex:r,colIndex:o,cellDataDelta:T.invertCellDataDelta(a,i)});return[new n({gridRange:this.gridRange,cellDataDeltaAtPositions:u})]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s,r,o,a,i,d=x.changeGridRangeByInsertDimension(this.gridRange,e.sheetId,e.type,e.index,e.amount,!1,!1),u=[];for(s=0,r=this.cellDataDeltaAtPositions.length;s<r;s++)o=this.cellDataDeltaAtPositions[s],a=new R(this.gridRange.sheetId,o.rowIndex,o.rowIndex,o.colIndex,o.colIndex),(i=x.changeGridRangeByInsertDimension(a,e.sheetId,e.type,e.index,e.amount,!1,!1)).endRowIndex===i.startRowIndex&&i.endColIndex===i.startColIndex&&u.push({rowIndex:i.startRowIndex,colIndex:i.startColIndex,cellDataDelta:Object(I.a)(o.cellDataDelta,e)});return 0===u.length?[]:[new n({gridRange:d,cellDataDeltaAtPositions:u})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s,r,o=x.changeGridRangeByDeleteDimension(this.gridRange,e.sheetId,e.type,e.index,e.amount);if(o.endRowIndex<o.startRowIndex||o.endColIndex<o.startColIndex)return[];var a,i,d,u=[];for(s=0,r=this.cellDataDeltaAtPositions.length;s<r;s++)a=this.cellDataDeltaAtPositions[s],i=new R(this.gridRange.sheetId,a.rowIndex,a.rowIndex,a.colIndex,a.colIndex),(d=x.changeGridRangeByDeleteDimension(i,e.sheetId,e.type,e.index,e.amount)).endRowIndex===d.startRowIndex&&d.endColIndex===d.startColIndex&&u.push({rowIndex:d.startRowIndex,colIndex:d.startColIndex,cellDataDelta:Object(I.a)(a.cellDataDelta,e)});return 0===u.length?[]:[new n({gridRange:o,cellDataDeltaAtPositions:u})]}},{key:"transformWithSetRangeMutation",value:function(e,t){if(this.gridRange.sheetId!==e.gridRange.sheetId)return[this];var s,r;if(!x.isTwoGridRangeCross(this.gridRange,e.gridRange))return[this];var o=this.getTotalSlots(),a=e.getTotalSlots();if(0===((o.cellDataSetSlots|o.cellDataClearSlots)&(a.cellDataSetSlots|a.cellDataClearSlots)))return[this];if(Object(l.a)(this,e))return t?[this]:[];var i,d,u,h=[],c={};for(s=0,r=e.cellDataDeltaAtPositions.length;s<r;s++)i=e.cellDataDeltaAtPositions[s],c[d="".concat(i.rowIndex,",").concat(i.colIndex)]=i.cellDataDelta;for(s=0,r=this.cellDataDeltaAtPositions.length;s<r;s++)if(i=this.cellDataDeltaAtPositions[s],c[d="".concat(i.rowIndex,",").concat(i.colIndex)]){if((u=T.transformTwoCellDataDelta(i.cellDataDelta,c[d],t)).isEmpty())continue;h.push({rowIndex:i.rowIndex,colIndex:i.colIndex,cellDataDelta:u})}else h.push(i);return 0===h.length?[]:[new n({gridRange:this.gridRange,cellDataDeltaAtPositions:h})]}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){if(this.gridRange.sheetId!==e.gridRange.sheetId)return[this];var s,r;if(!x.isTwoGridRangeCross(this.gridRange,e.gridRange))return[this];var o=this.getTotalSlots();if(0===((o.cellDataSetSlots|o.cellDataClearSlots)&(e.cellDataDelta.setSlots|e.cellDataDelta.clearSlots)))return[this];var a,i,d=[];for(s=0,r=this.cellDataDeltaAtPositions.length;s<r;s++)if(a=this.cellDataDeltaAtPositions[s],x.isCellInGridRange(e.gridRange,a.rowIndex,a.colIndex)){if((i=T.transformTwoCellDataDelta(a.cellDataDelta,e.cellDataDelta,t)).isEmpty())continue;d.push({rowIndex:a.rowIndex,colIndex:a.colIndex,cellDataDelta:i})}else d.push(a);return 0===d.length?[]:[new n({gridRange:this.gridRange,cellDataDeltaAtPositions:d})]}},{key:"transformWithMergeCellsMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s,r,o=new R(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);if(!x.isTwoGridRangeCross(this.gridRange,o))return[this];var a,i=[];for(s=0,r=this.cellDataDeltaAtPositions.length;s<r;s++){var d=a=this.cellDataDeltaAtPositions[s],u=d.rowIndex,l=d.colIndex;if(!x.isCellInGridRange(o,u,l)||u===o.startRowIndex&&l===o.startColIndex)i.push(a);else if(t&&a.cellDataDelta.setSlots>0)return[new f.a(o),this]}return 0===i.length?[]:[new n({gridRange:this.gridRange,cellDataDeltaAtPositions:i})]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.gridRange.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var n=[];if(t)n.push(this);else if(e.sheetId!==this.gridRange.sheetId)n.push(this);else{for(var s=e.getAffectedGridRanges(),r=!1,o=0;o<s.length;o++){if(s[o].isCross(this.gridRange)){r=!0;break}}r||n.push(this)}return n}},{key:"transformWithReorderRangeMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s,r,o=x.getCrossGridRange(this.gridRange,e.range);if(!o)return[this];var a,i,d,u,l=[];for(s=0,r=this.cellDataDeltaAtPositions.length;s<r;s++)if(a=this.cellDataDeltaAtPositions[s],x.isCellInGridRange(o,a.rowIndex,a.colIndex)){if(null===(i=e.getOrderResult(a.rowIndex))){l.push(a);continue}u=Object(I.a)(a.cellDataDelta,e),(d=T.divideCellDataDeltaByBorders(u)).other&&!d.other.isEmpty()&&l.push({rowIndex:i,colIndex:a.colIndex,cellDataDelta:d.other}),d.borders&&!d.borders.isEmpty()&&l.push({rowIndex:a.rowIndex,colIndex:a.colIndex,cellDataDelta:d.borders})}else l.push(a);return 0===l.length?[]:[new n({gridRange:x.getUnionGridRange(this.gridRange,e.range),cellDataDeltaAtPositions:l})]}},{key:"transformWithMapRangeMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sourceSheetId)return[this];var s,r,o,a,i,d=x.getCrossGridRange(this.gridRange,new R(e.sourceSheetId,-1===e.row.from.startIndex?0:e.row.from.startIndex,-1===e.row.from.endIndex?Number.MAX_VALUE:e.row.from.endIndex,-1===e.column.from.startIndex?0:e.column.from.startIndex,-1===e.column.from.endIndex?Number.MAX_VALUE:e.column.from.endIndex)),u=[],l=[];if(!d){for(s=0,r=this.cellDataDeltaAtPositions.length;s<r;s++)o=this.cellDataDeltaAtPositions[s],u.push({rowIndex:o.rowIndex,colIndex:o.colIndex,cellDataDelta:Object(I.a)(o.cellDataDelta,e)});return 0===u.length?[]:[new n({gridRange:this.gridRange,cellDataDeltaAtPositions:u})]}for(l.push(new m.a({gridRange:d,cellDataDelta:new y({clearSlots:k.ALL})})),s=0,r=this.cellDataDeltaAtPositions.length;s<r;s++)if(o=this.cellDataDeltaAtPositions[s],x.isCellInGridRange(d,o.rowIndex,o.colIndex)){var h=e.row,c=e.column;a=-1===h.from.startIndex?o.rowIndex:o.rowIndex-h.from.startIndex+h.to,i=-1===c.from.startIndex?o.colIndex:o.colIndex-c.from.startIndex+c.to,l.push(new m.a({gridRange:new R(this.gridRange.sheetId,a,a,i,i),cellDataDelta:Object(I.a)(o.cellDataDelta,e)}))}else u.push({rowIndex:o.rowIndex,colIndex:o.colIndex,cellDataDelta:Object(I.a)(o.cellDataDelta,e)});return 0===u.length?l:[new n({gridRange:this.gridRange,cellDataDeltaAtPositions:u})].concat(l)}},{key:"getTotalSlots",value:function(){var e,t,n,s={cellDataSetSlots:0,cellDataClearSlots:0,cellFormatSetSlots:0,cellFormatClearSlots:0};for(e=0,t=this.cellDataDeltaAtPositions.length;e<t;e++){n=this.cellDataDeltaAtPositions[e],s.cellDataSetSlots|=n.cellDataDelta.setSlots,s.cellDataSetSlots|=n.cellDataDelta.clearSlots;var r=n.cellDataDelta.delta.userEnteredFormatDelta;r&&(s.cellFormatSetSlots|=r.setSlots,s.cellFormatClearSlots|=r.clearSlots)}return s}}],[{key:"deserialize",value:function(e){var t,s,r,o,a,i=R.deserialize(e[0]),d=Object.keys(e[1]),u=O.createPropertiesMap(e[2]),l=i.endColIndex-i.startColIndex+1,h=[];for(o=0,a=d.length;o<a;o++)s=(t=+d[o])%l+i.startColIndex,r=Math.floor(t/l)+i.startRowIndex,h.push({rowIndex:r,colIndex:s,cellDataDelta:y.deserialize(e[1][t],u)});return new n({gridRange:i,cellDataDeltaAtPositions:h})}}]),n}(c.a);_.protoMap={0:{name:"gridRange",dataType:R},1:{name:"cellDataDeltaAtPositions",dataType:{type:Array,subType:{type:Object,protoMap:w}}}},t.a=_},"../packages/mutation/src/cell/cellMutationUtils.ts":function(e,t,n){"use strict";function s(e,t){return e}n.d(t,"a",(function(){return s}))},"../packages/mutation/src/conditionalFormat/AddConditionalFormatMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.some.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/conditionalFormat/DeleteConditionalFormatMutation.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=d.Rule.ConditionalFormatRule,m=(d.Dimension.DIMENSION_TYPE,d.Range.GridRange),f=function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.ADD_CONDITIONAL_FORMAT_MUTATION,e)).sheetId=e.sheetId,r.ruleIndex=e.ruleIndex,r.rule=e.rule,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.ruleIndex,this.rule.serialize()]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){e.conditionalFormatRuleManager.addConditionalFormatRule(this.ruleIndex,this.rule)}},{key:"invert",value:function(e){return[new h.a({sheetId:this.sheetId,ruleIndex:this.ruleIndex,oldRuleRanges:this.rule.ruleRanges})]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=[];return this.rule.ruleRanges.forEach((function(t){(t=t.clone()).sheetId===e.sheetId&&(t.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),t.isValid()&&s.push(t))})),s.length>0?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new I({ruleRanges:s,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat})})]:[]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=[];return this.rule.ruleRanges.forEach((function(t){(t=t.clone()).sheetId===e.sheetId&&(t.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),t.isValid()&&s.push(t))})),s.length>0?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new I({ruleRanges:s,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat})})]:[]}},{key:"transformWithMergeCellsMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=new m(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);if(this.rule.ruleRanges.some((function(e){return e.isCross(s)}))){var r=new m(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex,e.startColIndex);if(this.rule.ruleRanges.some((function(e){return e.contain(r)})))return[this];var o=[];return this.rule.ruleRanges.forEach((function(e){if(e.sheetId===s.sheetId&&e.isCross(s)){var t=e.startRowIndex,n=e.endRowIndex;e.startRowIndex<s.startRowIndex&&(o.push(new m(e.sheetId,e.startRowIndex,s.startRowIndex,e.startColIndex,e.endColIndex)),t=s.startRowIndex),s.endRowIndex<e.endRowIndex&&(o.push(new m(e.sheetId,s.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),n=s.endRowIndex),e.startColIndex<s.startColIndex&&o.push(new m(e.sheetId,t,n,e.startColIndex,s.endColIndex)),s.endColIndex<e.endColIndex&&o.push(new m(e.sheetId,t,n,s.endColIndex,e.endColIndex))}else o.push(e)})),0===o.length?[]:(o.sort((function(e,t){return e.startRowIndex<t.startRowIndex||e.startColIndex<t.startColIndex||e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex})),[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new I({ruleRanges:o,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat})})])}return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){if(this.sheetId!==e.sourceSheetId)return[this];var s=[],r=[],o=[],a=[];return this.rule.ruleRanges.forEach((function(t){if(t.sheetId===e.sourceSheetId){var n=[],i=new m(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.from.startIndex,-1===e.row.to?t.endRowIndex:e.row.from.endIndex,-1===e.column.to?t.startColIndex:e.column.from.startIndex,-1===e.column.to?t.endColIndex:e.column.from.endIndex),d=t.getCross(i);d&&(n.push(d),r.push(d),a.push(new m(e.sourceSheetId,-1===e.row.to?d.startRowIndex:d.startRowIndex-e.row.from.startIndex+e.row.to,-1===e.row.to?d.endRowIndex:d.endRowIndex-e.row.from.startIndex+e.row.to,-1===e.column.to?d.startColIndex:d.startColIndex-e.column.from.startIndex+e.column.to,-1===e.column.to?d.endColIndex:d.endColIndex-e.column.from.startIndex+e.column.to)));var u=new m(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.to,-1===e.row.to?t.endRowIndex:e.row.to+e.row.from.endIndex-e.row.from.startIndex,-1===e.column.to?t.startColIndex:e.column.to,-1===e.column.to?t.endColIndex:e.column.to+e.column.from.endIndex-e.column.from.startIndex),l=t.getCross(u);l&&(n.push(l),o.push(l)),d||l?n.forEach((function(e){var n=t.startRowIndex,r=t.endRowIndex;t.startRowIndex<e.startRowIndex&&(s.push(new m(t.sheetId,t.startRowIndex,e.startRowIndex,t.startColIndex,t.endColIndex)),n=e.startRowIndex),e.endRowIndex<t.endRowIndex&&(s.push(new m(t.sheetId,e.endRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex)),r=e.endRowIndex),t.startColIndex<e.startColIndex&&s.push(new m(t.sheetId,n,r,t.startColIndex,e.endColIndex)),e.endColIndex<t.endColIndex&&s.push(new m(t.sheetId,n,r,e.endColIndex,t.endColIndex))})):s.push(t)}})),s.length>0||a.length>0?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new I({ruleRanges:[].concat(s,a),booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat})})]:[]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:this.ruleIndex>e.ruleIndex||this.ruleIndex===e.ruleIndex&&t?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex+1,rule:this.rule})]:[this]}},{key:"transformWithDeleteConditionalFormatMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:this.ruleIndex>e.ruleIndex?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex-1,rule:this.rule})]:[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],ruleIndex:e[1],rule:I.deserialize(e[2])})}}]),n}(l.a);f.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ruleIndex",dataType:Number},2:{name:"rule",dataType:d.Rule.ConditionalFormatRule}},t.a=f},"../packages/mutation/src/conditionalFormat/DeleteConditionalFormatMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/conditionalFormat/AddConditionalFormatMutation.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=d.Range.GridRange,m=function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.DELETE_CONDITIONAL_FORMAT_MUTATION,e)).sheetId=e.sheetId,r.ruleIndex=e.ruleIndex,r.oldRuleRanges=e.oldRuleRanges,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.ruleIndex,this.oldRuleRanges.map((function(e){return e.serialize()}))]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){e.conditionalFormatRuleManager.deleteConditionalFormatRule(this.ruleIndex)}},{key:"invert",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId).conditionalFormatRuleManager.getConditionalFormatRuleByRuleIndex(this.ruleIndex);return t?[new h.a({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:t})]:[]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:this.ruleIndex>=e.ruleIndex?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex+1,oldRuleRanges:this.oldRuleRanges})]:[this]}},{key:"transformWithDeleteConditionalFormatMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:this.ruleIndex===e.ruleIndex?[]:this.ruleIndex>e.ruleIndex?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex-1,oldRuleRanges:this.oldRuleRanges})]:[this]}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:this.ruleIndex===e.ruleIndex?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,oldRuleRanges:this.oldRuleRanges})]:[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],ruleIndex:e[1],oldRuleRanges:e[2].map((function(e){return I.deserialize(e)}))})}}]),n}(l.a);m.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ruleIndex",dataType:Number},2:{name:"oldRuleRanges",dataType:{type:Array,subType:I}}},t.a=m},"../packages/mutation/src/conditionalFormat/UpdateConditionalFormatMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.array.some.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts");function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var c=d.Rule.ConditionalFormatRule,I=(d.Dimension.DIMENSION_TYPE,d.Range.GridRange),m=function(e){Object(o.a)(n,e);var t=h(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.UPDATE_CONDITIONAL_FORMAT_MUTATION,e)).sheetId=e.sheetId,r.ruleIndex=e.ruleIndex,r.rule=e.rule,r.oldRuleRanges=e.oldRuleRanges,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.ruleIndex,this.rule.serialize(),this.oldRuleRanges.map((function(e){return e.serialize()}))]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){e.conditionalFormatRuleManager.updateConditionalFormatRule(this.ruleIndex,this.rule)}},{key:"invert",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId).conditionalFormatRuleManager.getConditionalFormatRuleByRuleIndex(this.ruleIndex);return t?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:t,oldRuleRanges:this.rule.ruleRanges})]:[]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=[];return this.rule.ruleRanges.forEach((function(t){(t=t.clone()).sheetId===e.sheetId&&(t.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),t.isValid()&&s.push(t))})),s.length>0?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new c({ruleRanges:s,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat}),oldRuleRanges:this.oldRuleRanges})]:[]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=[];return this.rule.ruleRanges.forEach((function(t){(t=t.clone()).sheetId===e.sheetId&&(t.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),t.isValid()&&s.push(t))})),s.length>0?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new c({ruleRanges:s,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat}),oldRuleRanges:this.oldRuleRanges})]:[]}},{key:"transformWithMergeCellsMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=new I(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);if(this.rule.ruleRanges.some((function(e){return e.isCross(s)}))){var r=new I(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex,e.startColIndex);if(this.rule.ruleRanges.some((function(e){return e.contain(r)})))return[this];var o=[];return this.rule.ruleRanges.forEach((function(e){if(e.sheetId===s.sheetId&&e.isCross(s)){var t=e.startRowIndex,n=e.endRowIndex;e.startRowIndex<s.startRowIndex&&(o.push(new I(e.sheetId,e.startRowIndex,s.startRowIndex,e.startColIndex,e.endColIndex)),t=s.startRowIndex),s.endRowIndex<e.endRowIndex&&(o.push(new I(e.sheetId,s.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),n=s.endRowIndex),e.startColIndex<s.startColIndex&&o.push(new I(e.sheetId,t,n,e.startColIndex,s.endColIndex)),s.endColIndex<e.endColIndex&&o.push(new I(e.sheetId,t,n,s.endColIndex,e.endColIndex))}else o.push(e)})),0===o.length?[]:(o.sort((function(e,t){return e.startRowIndex<t.startRowIndex||e.startColIndex<t.startColIndex||e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex})),[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new c({ruleRanges:o,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat}),oldRuleRanges:this.oldRuleRanges})])}return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){if(this.sheetId!==e.sourceSheetId)return[this];var s=[],r=[],o=[],a=[];return this.rule.ruleRanges.forEach((function(t){if(t.sheetId===e.sourceSheetId){var n=[],i=new I(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.from.startIndex,-1===e.row.to?t.endRowIndex:e.row.from.endIndex,-1===e.column.to?t.startColIndex:e.column.from.startIndex,-1===e.column.to?t.endColIndex:e.column.from.endIndex),d=t.getCross(i);d&&(n.push(d),r.push(d),a.push(new I(e.sourceSheetId,-1===e.row.to?d.startRowIndex:d.startRowIndex-e.row.from.startIndex+e.row.to,-1===e.row.to?d.endRowIndex:d.endRowIndex-e.row.from.startIndex+e.row.to,-1===e.column.to?d.startColIndex:d.startColIndex-e.column.from.startIndex+e.column.to,-1===e.column.to?d.endColIndex:d.endColIndex-e.column.from.startIndex+e.column.to)));var u=new I(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.to,-1===e.row.to?t.endRowIndex:e.row.to+e.row.from.endIndex-e.row.from.startIndex,-1===e.column.to?t.startColIndex:e.column.to,-1===e.column.to?t.endColIndex:e.column.to+e.column.from.endIndex-e.column.from.startIndex),l=t.getCross(u);l&&(n.push(l),o.push(l)),d||l?n.forEach((function(e){var n=t.startRowIndex,r=t.endRowIndex;t.startRowIndex<e.startRowIndex&&(s.push(new I(t.sheetId,t.startRowIndex,e.startRowIndex,t.startColIndex,t.endColIndex)),n=e.startRowIndex),e.endRowIndex<t.endRowIndex&&(s.push(new I(t.sheetId,e.endRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex)),r=e.endRowIndex),t.startColIndex<e.startColIndex&&s.push(new I(t.sheetId,n,r,t.startColIndex,e.endColIndex)),e.endColIndex<t.endColIndex&&s.push(new I(t.sheetId,n,r,e.endColIndex,t.endColIndex))})):s.push(t)}})),s.length>0||a.length>0?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new c({ruleRanges:[].concat(s,a),booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat}),oldRuleRanges:this.oldRuleRanges})]:[]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:this.ruleIndex>=e.ruleIndex?[new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex+1,rule:this.rule,oldRuleRanges:this.oldRuleRanges})]:[this]}},{key:"transformWithDeleteConditionalFormatMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:this.ruleIndex===e.ruleIndex?[]:(this.ruleIndex>e.ruleIndex&&new n({sheetId:this.sheetId,ruleIndex:this.ruleIndex-1,rule:this.rule,oldRuleRanges:this.oldRuleRanges}),[this])}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:this.ruleIndex===e.ruleIndex?t?[this]:[]:[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],ruleIndex:e[1],rule:c.deserialize(e[2]),oldRuleRanges:e[3].map((function(e){return I.deserialize(e)}))})}}]),n}(l.a);m.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ruleIndex",dataType:Number},2:{name:"rule",dataType:c},3:{name:"oldRuleRanges",dataType:{type:Array,subType:I}}},t.a=m},"../packages/mutation/src/config/report.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var s,r={MUTATION_VER_LOWER_THAN_SUPPORT:33910951,CONVERT_MUTATION_ERROR:33910952},o={SERIALIZE_MUTATION:"SERIALIZE_MUTATION",DESERIALIZE_MUTATION_FAIL:"DESERIALIZE_MUTATION_FAIL",DESERIALIZE_MUTATION_CATCH_ERROR:"DESERIALIZE_MUTATION_CATCH_ERROR",DESERIALIZE_MUTATION_CATCH_ERROR_OLD:"DESERIALIZE_MUTATION_CATCH_ERROR_OLD",GET_COLLAB_MUTATIONS:"GET_COLLAB_MUTATIONS",FOLLOW_REQUEST_MUTATIONS:"FOLLOW_REQUEST_MUTATIONS",CHECK_MUTATION_ERROR:"CHECK_MUTATION_ERROR",CHECK_MUTATION_RESULT_ERROR:"CHECK_MUTATION_RESULT_ERROR",RUN_MUTATION_ERROR:"RUN_MUTATION_ERROR",AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR:"AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR",AFTER_MUTATION_RUN_CATCH_ERROR:"AFTER_MUTATION_RUN_CATCH_ERROR"};!function(e){e.MUTATIONS_RUN="mutations_run",e.AFTER_MUTATIONS_RUN="after_mutations_run"}(s||(s={}))},"../packages/mutation/src/config/version.ts":function(e,t,n){"use strict";t.a={MUTATION_VER:5,MUTATION_VER_LOWEST_SUPPORT:3}},"../packages/mutation/src/converter.ts":function(e,t,n){"use strict";var s=n("../packages/mutation/src/config/version.ts"),r=[{verLowestSupport:3,verTarget:6,convert:function(e){return e}}];t.a=function(e){var t,n,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.a.MUTATION_VER;for(t=0,n=r.length;t<n&&(o=r[t],!(e.v>=a));t++)e.v>=o.verLowestSupport&&e.v<o.verTarget&&(e=o.convert(e));return e}},"../packages/mutation/src/dimension/DeleteDimensionMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/utils/index.ts"),c=n("../packages/mutation/src/dimension/InsertDimensionMutation.ts"),I=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),m=n("../packages/mutation/src/cell/SetRangeMutation.ts"),f=n("../packages/mutation/src/merge/MergeCellsMutation.ts"),g=n("../packages/mutation/src/embedded/UpdateEmbeddedObjectMutation.ts"),p=n("../packages/mutation/src/sheet/SetSheetPropertiesMutation.ts"),R=n("../packages/mutation/src/sheet/DefineSheetRangeMutation.ts");function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var b=d.Dimension.DIMENSION_TYPE,y=d.Range,k=y.DimensionRange,O=y.GridRange,v=d.Sheet,T=v.SheetPropertiesDelta,w=v.NEW_SHEET_PROPERTIES_SLOT_OPERATION,_=d.Cell.cellDataUtils,j=function(e){Object(o.a)(n,e);var t=x(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.DELETE_DIMENSION_MUTATION,e)).index=e.index,r.amount=e.amount,r.type=e.type,r.sheetId=e.sheetId,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.index,this.amount,this.sheetId,this.type]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){if(this.type!==b.ROWS&&this.type!==b.COLUMNS)return{isValid:!1,errorMessage:"type\u4e0d\u662f\u884c\u4e5f\u4e0d\u662f\u5217\u3002 ".concat(this.type)};var t=e.properties.gridProperties,n=this.type===b.ROWS?t.rowCount:t.colCount;return!Object(h.c)(this.index)||this.index<0||this.index>=n?{isValid:!1,errorMessage:"index\u503c\u4e0d\u89c4\u8303 index=".concat(this.index," dimensionCount=").concat(n)}:!Object(h.c)(this.amount)||this.amount<=0||this.index+this.amount>n?{isValid:!1,errorMessage:"amount\u503c\u4e0d\u89c4\u8303 amount=".concat(this.amount," index=").concat(this.index,"  dimensionCount=").concat(n)}:{isValid:!0}}},{key:"runOnSheet",value:function(e){e.deleteDimension({sheetId:this.sheetId,index:this.index,amount:this.amount,type:this.type})}},{key:"runOnWorkbook",value:function(e){return e.deleteDimension({sheetId:this.sheetId,type:this.type,index:this.index,amount:this.amount}),!0}},{key:"invert",value:function(e){var t,n,s,r,o=e.sheetManager.getSheetBySheetId(this.sheetId),a=[];if(null===o)return a;if(this.type!==b.ROWS&&this.type!==b.COLUMNS)return console.warn("DIMENSION_TYPE error"),a;a.push(new c.a({index:this.index,amount:this.amount,type:this.type,sheetId:this.sheetId})),t=new k(this.sheetId,this.index,this.index+this.amount-1,this.type),Array.prototype.push.apply(a,Object(I.d)({sheet:o,type:this.type,ranges:[t]},{hiddenByUser:!0,pixelSize:!0,ignoreDefaultHidden:!0,ignoreDefaultSize:!0,formData:!0})),n=this.type===b.ROWS?new O(this.sheetId,this.index,this.index+this.amount-1,0,o.getColCount()-1):new O(this.sheetId,0,o.getRowCount()-1,this.index,this.index+this.amount-1);var i=this.getSetRangeMutation(o,n);i&&a.push(i),this.type===b.ROWS?(s=o.getFrozenRowCount(),this.index<s&&this.index+this.amount>=s&&a.push(new p.a({sheetId:this.sheetId,sheetDelta:new T({operation:w.SET_PROPERTIES,delta:{frozenRowCount:s}})}))):this.type===b.COLUMNS&&(r=o.getFrozenColCount(),this.index<r&&this.index+this.amount>=r&&a.push(new p.a({sheetId:this.sheetId,sheetDelta:new T({operation:w.SET_PROPERTIES,delta:{frozenColCount:r}})}))),this.invertOnMerges(a,o,t);var d=e.parent,u=d&&d.calcController;if(u){var l=u.getInvertMutationsForDeleteDimensionMutation(this);a=a.concat(l)}return this.invertOnImages(a,o),a}},{key:"invertOnMerges",value:function(e,t,n){var s=this;t.mergeManager.each((function(t){(s.type===b.ROWS&&n.isCross(new k(t.sheetId,t.startRowIndex,t.endRowIndex,b.ROWS))||s.type===b.COLUMNS&&n.isCross(new k(t.sheetId,t.startColIndex,t.endColIndex,b.COLUMNS)))&&e.push(new f.a(t.clone()))})),t.sheetRangeManager.each((function(t,n){(s.type===b.ROWS&&t.gridRange.startRowIndex>=s.index&&t.gridRange.endRowIndex<=s.index+s.amount-1||s.type===b.COLUMNS&&t.gridRange.startColIndex>=s.index&&t.gridRange.endColIndex<=s.index+s.amount-1)&&e.push(new R.a({sheetId:t.sheetId,sheetRangeId:n,sheetRangeType:t.sheetRangeType,padId:t.padId,gridRange:t.gridRange.clone()}))}))}},{key:"invertOnImages",value:function(e,t){var n=this.index,s=this.amount;this.type===b.ROWS?t.imageManager.each((function(t,r){var o=t.position.overlayPosition.anchorCell.rowIndex;o>=n&&o<n+s&&e.push(new g.a({data:t.toObject()}))})):this.type===b.COLUMNS&&t.imageManager.each((function(t,r){var o=t.position.overlayPosition.anchorCell.colIndex;o>=n&&o<n+s&&e.push(new g.a({data:t.toObject()}))}))}},{key:"getSetRangeMutation",value:function(e,t){var n,s,r,o,a=[],i=e.getSheetId();for(s=t.startRowIndex;s<=t.endRowIndex;s++)for(n=t.startColIndex;n<=t.endColIndex;n++)r=e.getCellDataAtPosition(s,n),(o=_.createCellDataDelta({cellData:null,rowIndex:s,colIndex:n,sheetId:i},{cellData:r,rowIndex:s,colIndex:n,sheetId:i})).isEmpty()||a.push({rowIndex:s,colIndex:n,cellDataDelta:o});return a.length>0?new m.a({gridRange:t,cellDataDeltaAtPositions:a}):null}},{key:"isConflict",value:function(e){return this.sheetId===e.sheetId&&this.type===e.type}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(!this.isConflict(e))return[this];var s,r,o=[],a=new k(this.sheetId,this.index,this.index+this.amount-1,this.type);a.insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type});var i=a.toDimensionData();return s=i.index,r=i.amount,o.push(new n({index:s,amount:r,sheetId:this.sheetId,type:this.type})),o}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(!this.isConflict(e))return[this];var s,r,o=[],a=new k(this.sheetId,this.index,this.index+this.amount-1,this.type);a.deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type});var i=a.toDimensionData();return s=i.index,0===(r=i.amount)||o.push(new n({index:s,amount:r,sheetId:this.sheetId,type:this.type})),o}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}}],[{key:"deserialize",value:function(e){return new n({index:e[0],amount:e[1],sheetId:e[2],type:e[3]})}}]),n}(l.a);j.protoMap={0:{name:"index",dataType:Number},1:{name:"amount",dataType:Number},2:{name:"sheetId",dataType:String},3:{name:"type",dataType:String}},t.a=j},"../packages/mutation/src/dimension/InsertDimensionMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s,r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),o=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=n("../node_modules/@babel/runtime/helpers/esm/get.js"),d=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),u=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),h=n("../packages/model/src/index.ts"),c=n("../packages/mutation/src/MutationId.ts"),I=n("../packages/mutation/src/Mutation.ts"),m=n("../packages/mutation/src/utils/index.ts"),f=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),g=n("../packages/mutation/src/merge/MergeCellsMutation.ts"),p=h.Dimension.DIMENSION_TYPE,R=h.Range,x=R.DimensionRange,b=R.GridRange,y=h.Cell,k=y.CellDataDelta,O=y.CELL_DATA_SLOT,v=y.cellFormatUtils;function T(e,t,n,s){return{mergeData:function(e,t,n){var s,r,o=[];return e.mergeManager.each((function(a){var i;(s=!1,t===p.ROWS?n>a.startRowIndex&&n<=a.endRowIndex&&(s=!0):t===p.COLUMNS&&n>a.startColIndex&&n<=a.endColIndex&&(s=!0),s)&&(r=e.getCellDataAtPosition(a.startRowIndex,a.startColIndex),o.push({userEnterFormat:(null===(i=r)||void 0===i?void 0:i.getUserEnteredFormat())||null,gridRange:a}))})),o}(e,n,s)}}function w(e,t,n,s,r){var o=[],a=[];switch(e.id){case c.b.SET_RANGE_MUTATION:case c.b.SET_CELL_PROPERTIES_MUTATION:break;case c.b.MERGE_CELLS_MUTATION:o=function(e,t,n,s){var r=!1;t===e.sheetId&&(n===p.ROWS?s>e.startRowIndex&&s<=e.endRowIndex&&(r=!0):n===p.COLUMNS&&s>e.startColIndex&&s<=e.endColIndex&&(r=!0));if(r)return[{userEnterFormat:null,gridRange:new b(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)}];return[]}(e,n,s,r);break;case c.b.UPDATE_FILTERS_MODEL_MUTATION:case c.b.ADD_EMBEDDED_OBJECT_MUTATION:case c.b.UPDATE_EMBEDDED_OBJECT_MUTATION:case c.b.COPY_PASTE_MUTATION:case c.b.REORDER_RANGE_MUTATION:break;case c.b.DEFINE_WORKBOOK_RANGE_MUTATION:a=function(e,t,n,s){var r=!1;t!==e.gridRange.sheetId||e.gridRange.isSheet||(n===p.ROWS?s>e.gridRange.startRowIndex&&s<=e.gridRange.endRowIndex&&(r=!0):n===p.COLUMNS&&s>e.gridRange.startColIndex&&s<=e.gridRange.endColIndex&&(r=!0));if(r)return[e.clone()];return[]}(e,n,s,r)}return{mergeData:o,workbookRange:a}}function _(e,t,n,r,o){var a=[];return function(e,t,n,r,o,a){var i,d,u,l,h;for(i=0,d=e.mergeData.length;i<d;i++)u=e.mergeData[i],(l=j(t,u.gridRange,n,r,o)).isValid()&&!l.isSingle()&&a.push(new g.a({sheetId:l.sheetId,startRowIndex:l.startRowIndex,endRowIndex:l.endRowIndex,startColIndex:l.startColIndex,endColIndex:l.endColIndex})),h=n===p.ROWS?u.gridRange.startRowIndex:u.gridRange.startColIndex,t===s.DELETE&&u.userEnterFormat&&l.isValid()&&h>=r&&h<=r+o&&a.push(new f.a({gridRange:new b(l.sheetId,l.startRowIndex,l.startRowIndex,l.startColIndex,l.startColIndex),cellDataDelta:new k({setSlots:1<<O.SLOT_USER_ENTERED_FORMAT_DELTA,delta:{userEnteredFormatDelta:v.createCellFormatDelta(null,u.userEnterFormat)}})}))}(e,t,n,r,o,a),function(e,t,n,s,r,o){var a,i,d=e.workbookRange;if(void 0===d)return;for(a=0;a<d.length;a++)(i=j(t,d[a].gridRange,n,s,r)).isValid()&&(d[a].gridRange=i,o.push(d[a]))}(e,t,n,r,o,a),a}function j(e,t,n,r,o){var a;switch(e){case 0:return(a=n===p.ROWS?new x(t.sheetId,t.startRowIndex,t.endRowIndex,p.ROWS):new x(t.sheetId,t.startColIndex,t.endColIndex,p.COLUMNS)).insertDimension({sheetId:t.sheetId,index:r,amount:o,type:n}),n===p.ROWS?new b(t.sheetId,a.startIndex,a.endIndex,t.startColIndex,t.endColIndex):new b(t.sheetId,t.startRowIndex,t.endRowIndex,a.startIndex,a.endIndex);case 1:return(a=n===p.ROWS?new x(t.sheetId,t.startRowIndex,t.endRowIndex,p.ROWS):new x(t.sheetId,t.startColIndex,t.endColIndex,p.COLUMNS)).deleteDimension({sheetId:t.sheetId,index:r,amount:o,type:n}),n===p.ROWS?new b(t.sheetId,a.startIndex,a.endIndex,t.startColIndex,t.endColIndex):new b(t.sheetId,t.startRowIndex,t.endRowIndex,a.startIndex,a.endIndex);case s.UNDO_INSERT:case s.UNDO_DELETE:return t}return t}!function(e){e[e.INSERT=0]="INSERT",e[e.DELETE=1]="DELETE",e[e.UNDO_INSERT=2]="UNDO_INSERT",e[e.UNDO_DELETE=3]="UNDO_DELETE"}(s||(s={}));var D=n("../packages/mutation/src/dimension/DeleteDimensionMutation.ts");function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(l.a)(e);if(t){var r=Object(l.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(u.a)(this,n)}}var S=h.Dimension.DIMENSION_TYPE,E=function(e){Object(d.a)(n,e);var t=M(n);function n(e){var s;return Object(o.a)(this,n),(s=t.call(this,c.b.INSERT_DIMENSION_MUTATION,e)).index=e.index,s.amount=e.amount,s.type=e.type,s.sheetId=e.sheetId,s}return Object(a.a)(n,[{key:"serialize",value:function(){return[this.index,this.amount,this.sheetId,this.type]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"check",value:function(e){if(this.type!==S.ROWS&&this.type!==S.COLUMNS)return{isValid:!1,errorMessage:"type\u4e0d\u662f\u884c\u4e5f\u4e0d\u662f\u5217\u3002 ".concat(this.type)};var t=e.properties.gridProperties,n=this.type===S.ROWS?t.rowCount:t.colCount;return!Object(m.c)(this.index)||this.index<0||this.index>n?{isValid:!1,errorMessage:"index\u503c\u4e0d\u89c4\u8303 index=".concat(this.index," dimensionCount=").concat(n)}:!Object(m.c)(this.amount)||this.amount<=0?{isValid:!1,errorMessage:"amount\u503c\u4e0d\u89c4\u8303 amount=".concat(this.amount," index=").concat(this.index,"  dimensionCount=").concat(n)}:{isValid:!0}}},{key:"runOnSheet",value:function(e){e.insertDimension({sheetId:this.sheetId,index:this.index,amount:this.amount,type:this.type})}},{key:"runOnWorkbook",value:function(e){return e.insertDimension({sheetId:this.sheetId,type:this.type,index:this.index,amount:this.amount}),!0}},{key:"invert",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId),n=[];if(n.push(new D.a({index:this.index,amount:this.amount,type:this.type,sheetId:this.sheetId})),!t)return n;var o=_(T(t,s.INSERT,this.type,this.index),s.UNDO_INSERT,this.type,this.index,this.amount);return n=[].concat(Object(r.a)(n),Object(r.a)(o))}},{key:"transform",value:function(e,t){var o=w(e,s.INSERT,this.sheetId,this.type,this.index),a=Object(i.a)(Object(l.a)(n.prototype),"transform",this).call(this,e,t),d=_(o,s.INSERT,this.type,this.index,this.amount);return[].concat(Object(r.a)(a),Object(r.a)(d))}},{key:"isConflictWithCollabMutation",value:function(e){return this.sheetId===e.sheetId&&this.type===e.type}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(!this.isConflictWithCollabMutation(e))return[this];var s=this.index;return(this.index>e.index||t&&this.index===e.index)&&(s=this.index+e.amount),[new n({index:s,amount:this.amount,type:this.type,sheetId:this.sheetId})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){return this.isConflictWithCollabMutation(e)?this.index<=e.index?[this]:this.index>=e.index+e.amount?[new n({index:this.index-e.amount,amount:this.amount,type:this.type,sheetId:this.sheetId})]:[]:[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}}],[{key:"deserialize",value:function(e){return new n({index:e[0],amount:e[1],sheetId:e[2],type:e[3]})}}]),n}(I.a);E.protoMap={0:{name:"index",dataType:Number},1:{name:"amount",dataType:Number},2:{name:"sheetId",dataType:String},3:{name:"type",dataType:String}};t.a=E},"../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return w})),n.d(t,"b",(function(){return _}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/SlotOperation.ts"),c=n("../packages/mutation/src/other/mapRangeMutationUtil.ts"),I=n("../packages/model/src/cell/metadata/Metadata.ts");function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var f,g=d.Dimension,p=g.DimensionFormData,R=g.DIMENSION_TYPE,x=g.DimensionProperties,b=d.Range.DimensionRange;!function(e){e[e.SLOT_SIZE=1]="SLOT_SIZE",e[e.SLOT_HIDDEN=2]="SLOT_HIDDEN",e[e.SLOT_FORMDATA=3]="SLOT_FORMDATA",e[e.SLOT_COLUMN_TYPE_METADATA=7]="SLOT_COLUMN_TYPE_METADATA"}(f||(f={}));var y={0:{name:"slot",dataType:Number},1:{name:"size",dataType:Number},2:{name:"hidden",dataType:Number},3:{name:"formData",dataType:p}},k=function(e){var t,n=[e.slot,null!==e.slotOperation?e.slotOperation:h.a.SET_SLOT];switch(e.slot){case f.SLOT_SIZE:n[2]=e.size;break;case f.SLOT_HIDDEN:n[2]=e.hidden;break;case f.SLOT_FORMDATA:n[2]=e.formData?e.formData.serialize():null;break;case f.SLOT_COLUMN_TYPE_METADATA:n[2]=(null===(t=e.columnTypeMetadata)||void 0===t?void 0:t.serialize())||null}return n},O=function(e){var t={slot:e[0],slotOperation:e[1]};switch(e[0]){case f.SLOT_SIZE:t.size=e[2];break;case f.SLOT_HIDDEN:t.hidden=e[2];break;case f.SLOT_FORMDATA:t.formData=e[2]?p.deserialize(e[2]):null;break;case f.SLOT_COLUMN_TYPE_METADATA:t.columnTypeMetadata=e[2]?I.a.deserialize(e[2]):null}return t},v=function(e){Object(o.a)(n,e);var t=m(n);function n(e){var r;Object(s.a)(this,n),(r=t.call(this,u.b.SET_DIMENSION_PROPERTIES_MUTATION,e)).ranges=[];for(var o=0;o<e.ranges.length;o++)e.ranges[o].endIndex>=e.ranges[o].startIndex&&r.ranges.push(e.ranges[o]);return r.operation=e.operation,r.type=e.type,r.sheetId=e.sheetId,r}return Object(r.a)(n,[{key:"serialize",value:function(){var e,t,n=[],s=[];for(e=0,t=this.ranges.length;e<t;e++)n.push([this.ranges[e].startIndex,this.ranges[e].endIndex]);for(e=0,t=this.operation.length;e<t;e++)s.push(k(this.operation[e]));return[this.sheetId,n,s,this.type]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t}},{key:"check",value:function(e){if(!this.ranges||!this.operation)return{isValid:!1,errorMessage:"ranges\u4e3a\u7a7a \u6216\u8005 operation\u4e3a\u7a7a ranges=".concat(JSON.stringify(this.ranges)," operation=").concat(JSON.stringify(this.operation))};var t,n,s,r=this.ranges,o=e.properties.gridProperties;if(this.type!==R.ROWS&&this.type!==R.COLUMNS)return{isValid:!1,errorMessage:"type\u4e0d\u662f\u884c\u4e5f\u4e0d\u662f\u5217\u3002 ".concat(this.type)};for(t=0,n=r.length;t<n;t++){if(!(s=r[t]).isValid())return{isValid:!1,errorMessage:"dimensionRange\u503c\u975e\u6cd5 ".concat(JSON.stringify(s))};if(this.type===R.ROWS){if(s.endIndex>=o.rowCount)return{isValid:!1,errorMessage:"dimensionRange\u8d85\u51farowCount\u8303\u56f4 dimensionRange=".concat(JSON.stringify(s)," gridPreperties=").concat(JSON.stringify(o))}}else if(this.type===R.COLUMNS&&s.endIndex>=o.colCount)return{isValid:!1,errorMessage:"dimensionRange\u8d85\u51facolCount\u8303\u56f4 dimensionRange=".concat(JSON.stringify(s)," gridPreperties=").concat(JSON.stringify(o))}}return{isValid:!0}}},{key:"runOnSheet",value:function(e){for(var t=0;t<this.operation.length;t++)switch(this.operation[t].slot){case f.SLOT_SIZE:this.setDimensionSize(e,this.operation[t]);break;case f.SLOT_HIDDEN:this.setDimensionHidden(e,this.operation[t]);break;case f.SLOT_FORMDATA:this.setDimensionFormData(e,this.operation[t]);break;case f.SLOT_COLUMN_TYPE_METADATA:this.setColumnTypeMetadata(e,this.operation[t])}}},{key:"setColumnTypeMetadata",value:function(e,t){var n=this;this.ranges.forEach((function(s){var r=s.startIndex,o=s.endIndex;n.type===R.COLUMNS&&e.data.setColsTypeMetadata(r,o,t.columnTypeMetadata||null)}))}},{key:"setDimensionFormData",value:function(e,t){var n,s,r=this;this.ranges.forEach((function(o){n=o.startIndex,s=o.endIndex,r.type===R.ROWS?e.data.setRowsFormData(n,s,t.formData):r.type===R.COLUMNS&&e.data.setColsFormData(n,s,t.formData)}))}},{key:"setDimensionSize",value:function(e,t){var n,s,r=this;this.ranges.forEach((function(o){n=o.startIndex,s=o.endIndex,r.type===R.ROWS?e.data.setRowsHeight(n,s,t.size):r.type===R.COLUMNS&&e.data.setColsWidth(n,s,t.size)}))}},{key:"setDimensionHidden",value:function(e,t){for(var n,s=0;s<this.ranges.length;s++)n=this.ranges[s],this.type===R.ROWS?t.hidden?e.data.hideRows(n.startIndex,n.endIndex):e.data.showRows(n.startIndex,n.endIndex):this.type===R.COLUMNS&&(t.hidden?e.data.hideCols(n.startIndex,n.endIndex):e.data.showCols(n.startIndex,n.endIndex))}},{key:"invert",value:function(e){for(var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId),s=0,r=[];s<this.operation.length;s++){switch(r=[],this.operation[s].slot){case f.SLOT_SIZE:r=w({sheet:n,type:this.type,ranges:this.ranges},{pixelSize:!0,ignoreDefaultSize:!1});break;case f.SLOT_HIDDEN:r=w({sheet:n,type:this.type,ranges:this.ranges},{hiddenByUser:!0});break;case f.SLOT_FORMDATA:r=w({sheet:n,type:this.type,ranges:this.ranges},{formData:!0});break;case f.SLOT_COLUMN_TYPE_METADATA:r=w({sheet:n,type:this.type,ranges:this.ranges},{columnTypeMetadata:!0})}Array.prototype.push.apply(t,r)}return t}},{key:"isConflict",value:function(e){return this.sheetId===e.sheetId&&this.type===e.type}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(!this.isConflict(e))return[this];for(var s,r=[],o=0,a=[];o<this.ranges.length;o++)(s=this.ranges[o].clone()).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a.push(s);return r.push(new n({ranges:a,operation:this.operation,type:this.type,sheetId:this.sheetId})),r}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(!this.isConflict(e))return[this];for(var s,r=[],o=0,a=[];o<this.ranges.length;o++)(s=this.ranges[o].clone()).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),s.endIndex<s.startIndex||a.push(s);return 0===a.length||r.push(new n({ranges:a,operation:this.operation,type:this.type,sheetId:this.sheetId})),r}},{key:"transformWithSetDimensionPropertiesMutation",value:function(e,t){if(!this.isConflict(e))return[this];var s,r=0,o=0,a=0,i=[],d=[];for(r=0;r<this.operation.length;r++){for(o=0;o<e.operation.length;o++)if(this.operation[r].slot===e.operation[o].slot){for(s=T(this.ranges,e.ranges,t),a=0;a<s.length;a++)d=s[a],i.push(new n({ranges:d,operation:[this.operation[r]],type:this.type,sheetId:this.sheetId}));o=0;break}0!==o&&i.push(new n({ranges:this.ranges,operation:[this.operation[r]],type:this.type,sheetId:this.sheetId}))}return i}},{key:"transformWithMapRangeMutation",value:function(e,t){if(this.sheetId!==e.sourceSheetId)return[this];var s,r,o=[],a=0,i=[];if(Object(c.a)(this.type,e)){if(this.type===R.ROWS)s=e.row;else{if(this.type!==R.COLUMNS)return console.warn("DIMENSION_TYPE error"),o;s=e.column}for(;a<this.ranges.length;a++)r=this.ranges[a].clone(),Array.prototype.push.apply(i,r.move({from:s.from,to:s.to}));o.push(new n({ranges:i,operation:this.operation,type:this.type,sheetId:this.sheetId}))}else o.push(this);return o}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}}],[{key:"deserialize",value:function(e){var t,s,r=[],o=[];for(t=0,s=e[1].length;t<s;t++)r.push(new b(e[0],e[1][t][0],e[1][t][1],e[3]));for(t=0,s=e[2].length;t<s;t++)o.push(O(e[2][t]));return new n({sheetId:e[0],ranges:r,operation:o,type:e[3]})}}]),n}(l.a);function T(e,t,n){var s,r=0,o=0,a=0,i=[];for(r=0;r<e.length;r++)for(o=0;o<t.length;o++){for(s=e[r].divideByCross(t[o]),a=0;a<s.ranges.length;a++)s.ranges[a].endIndex<s.ranges[a].startIndex&&(s.ranges.splice(a,1),a-=1);s.ranges.length&&i.push(s.ranges),n&&s.cross&&i.push([s.cross])}return i}function w(e,t){var n,s=[],r=e.sheet,o=e.type,a=e.ranges;t||(t={hiddenByUser:!0,pixelSize:!0,ignoreDefaultHidden:!0,ignoreDefaultSize:!0,formData:!0,columnTypeMetadata:!0});var i,d,u,l,h,c,I=0,m=0,f=0;for(h=o===R.ROWS?r.getRowProperties.bind(r):r.getColProperties.bind(r),I=0;I<a.length;I++)for(i=(n=a[I]).startIndex,d=n.endIndex,f=0,l=u=h(i)||x.newInstance({}),m=i;m<=d;m++)(u=h(m)||x.newInstance({})).equal(l,t)?(m===d&&0!==(c=_(u,o,t)).length&&s.push(new v({ranges:[new b(n.sheetId,m-f,m,o)],operation:_(u,o,t),type:o,sheetId:n.sheetId})),f+=1):(0!==(c=_(l,o,t)).length&&s.push(new v({ranges:[new b(n.sheetId,m-f,m-1,o)],operation:c,type:o,sheetId:n.sheetId})),m===d&&0!==(c=_(u,o,t)).length&&s.push(new v({ranges:[new b(n.sheetId,m,m,o)],operation:_(u,o,t),type:o,sheetId:n.sheetId})),l=u);return s}function _(e,t,n){var s=[];return n.pixelSize&&(e.pixelSize?s.push({slot:f.SLOT_SIZE,size:e.pixelSize}):n.clearDefaultSize?s.push({slot:f.SLOT_SIZE,size:null}):n.ignoreDefaultSize||s.push({slot:f.SLOT_SIZE,size:null})),n.hiddenByUser&&(e.hiddenByUser?s.push({slot:f.SLOT_HIDDEN,hidden:1}):n.ignoreDefaultHidden||s.push({slot:f.SLOT_HIDDEN,hidden:0})),n.formData&&(e.formData?s.push({slot:f.SLOT_FORMDATA,formData:e.formData}):s.push({slot:f.SLOT_FORMDATA,formData:null})),n.columnTypeMetadata&&s.push({slot:f.SLOT_COLUMN_TYPE_METADATA,columnTypeMetadata:e.columnTypeMetadata}),s}v.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ranges",dataType:{type:Array,subType:b}},2:{name:"operation",dataType:{type:Array,subType:{type:Object,protoMap:y}}},3:{name:"type",dataType:String}},t.c=v},"../packages/mutation/src/embedded/AddEmbeddedObjectMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/embedded/embeddedImageDataProtoMap.ts"),c=n("../packages/mutation/src/embedded/DeleteEmbeddedObjectMutation.ts");function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var m=d.Dimension.DIMENSION_TYPE,f=d.Range.DimensionRange,g=function(e){Object(o.a)(n,e);var t=I(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.ADD_EMBEDDED_OBJECT_MUTATION,e)).data=e.data,r}return Object(r.a)(n,[{key:"serialize",value:function(){var e=[this.data.type,this.data.sheetId,this.data.id,this.data.url,this.data.width,this.data.height,this.data.x,this.data.y,this.data.offsetX,this.data.offsetY,this.data.zIndex];return this.data.clipInfo?e.push([this.data.clipInfo.clipTop,this.data.clipInfo.clipLeft,this.data.clipInfo.clipRight,this.data.clipInfo.clipBottom]):e.push(null),e}},{key:"getAffectedSheetId",value:function(){return this.data.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.data.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return e.imageManager.getImage(this.data.id)?{isValid:!1,errorMessage:"\u56fe\u7247ID\u5df2\u7ecf\u5b58\u5728\u4e86 ".concat(this.data.id)}:{isValid:!0}}},{key:"runOnSheet",value:function(e){e.imageManager.addImage(this.data)}},{key:"invert",value:function(e){var t=[];return t.push(new c.a({key:this.data.id,sheetId:this.data.sheetId})),t}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.data.sheetId!==e.sheetId)return[this];var s,r,o=[],a=this.data.sheetId;return(s=e.type===m.ROWS?new f(a,this.data.y,this.data.y,e.type):new f(a,this.data.x,this.data.x,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),r=JSON.parse(JSON.stringify(this.data)),e.type===m.ROWS?r.y=s.startIndex:r.x=s.startIndex,o.push(new n({data:r})),o}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.data.sheetId!==e.sheetId)return[this];var s,r,o=[],a=this.data.sheetId;return(s=e.type===m.ROWS?new f(a,this.data.y,this.data.y,e.type):new f(a,this.data.x,this.data.x,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),r=JSON.parse(JSON.stringify(this.data)),e.type===m.ROWS?r.y=s.startIndex:r.x=s.startIndex,o.push(new n({data:r})),o}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return this.data.sheetId,e.data.sheetId,[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){return this.data.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return this.data.sheetId,e.data.sheetId,[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.data.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return this.data.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return this.data.sheetId,e.sheetId,[this]}}],[{key:"deserialize",value:function(e){var t={data:{type:e[0],sheetId:e[1],id:e[2],url:e[3],width:e[4],height:e[5],x:e[6],y:e[7],offsetX:e[8],offsetY:e[9],zIndex:e[10]}};return e[11]&&(t.data.clipInfo={clipTop:e[11][0],clipLeft:e[11][1],clipRight:e[11][2],clipBottom:e[11][3]}),new n(t)}}]),n}(l.a);g.protoMap={0:{name:"data",dataType:{type:Object,protoMap:h.a}}},t.a=g},"../packages/mutation/src/embedded/DeleteEmbeddedObjectMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/mutation/src/MutationId.ts"),u=n("../packages/mutation/src/Mutation.ts"),l=n("../packages/mutation/src/embedded/AddEmbeddedObjectMutation.ts");function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var c=function(e){Object(o.a)(n,e);var t=h(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,d.b.DELETE_EMBEDDED_OBJECT_MUTATION,e)).key=e.key,r.sheetId=e.sheetId,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.key,this.sheetId]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return e.imageManager.getImage(this.key)?{isValid:!0}:{isValid:!1,errorMessage:"\u56fe\u7247key\u4e0d\u5b58\u5728 ".concat(this.key)}}},{key:"runOnSheet",value:function(e){e.imageManager.deleteImage(this.key)}},{key:"invert",value:function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);if(null===n)return t;var s=n.imageManager.getImage(this.key);return s&&t.push(new l.a({data:s.toObject()})),t}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return this.sheetId,e.data.sheetId,[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return e.key!==this.key&&n.push(this),n}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return this.sheetId,e.data.sheetId,[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return n.push(this),n}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return n.push(this),n}}],[{key:"deserialize",value:function(e){return new n({key:e[0],sheetId:e[1]})}}]),n}(u.a);c.protoMap={0:{name:"key",dataType:String},1:{name:"sheetId",dataType:String}},t.a=c},"../packages/mutation/src/embedded/UpdateEmbeddedObjectMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/embedded/embeddedImageDataProtoMap.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=d.Dimension.DIMENSION_TYPE,m=d.Range.DimensionRange,f=function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.UPDATE_EMBEDDED_OBJECT_MUTATION,e)).data=e.data,r}return Object(r.a)(n,[{key:"serialize",value:function(){var e=[this.data.type,this.data.sheetId,this.data.id,this.data.url,this.data.width,this.data.height,this.data.x,this.data.y,this.data.offsetX,this.data.offsetY,this.data.zIndex];return this.data.clipInfo?e.push([this.data.clipInfo.clipTop,this.data.clipInfo.clipLeft,this.data.clipInfo.clipRight,this.data.clipInfo.clipBottom]):e.push(null),e}},{key:"getAffectedSheetId",value:function(){return this.data.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.data.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return e.imageManager.getImage(this.data.id)?{isValid:!0}:{isValid:!1,errorMessage:"\u56fe\u7247ID\u5df2\u7ecf\u5b58\u5728\u4e86 ".concat(this.data.id)}}},{key:"runOnSheet",value:function(e){e.imageManager.updateImage(this.data)}},{key:"invert",value:function(e){var t=[],s=e.sheetManager.getSheetBySheetId(this.data.sheetId);if(null===s)return t;var r=s.imageManager.getImage(this.data.id);return r&&t.push(new n({data:r.toObject()})),t}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.data.sheetId!==e.sheetId)return[this];var s,r,o=[],a=this.data.sheetId;return(s=e.type===I.ROWS?new m(a,this.data.y,this.data.y,e.type):new m(a,this.data.x,this.data.x,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),r=JSON.parse(JSON.stringify(this.data)),e.type===I.ROWS?r.y=s.startIndex:r.x=s.startIndex,o.push(new n({data:r})),o}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.data.sheetId!==e.sheetId)return[this];var s,r,o=[],a=this.data.sheetId;return(s=e.type===I.ROWS?new m(a,this.data.y,this.data.y,e.type):new m(a,this.data.x,this.data.x,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),r=JSON.parse(JSON.stringify(this.data)),e.type===I.ROWS?r.y=s.startIndex:r.x=s.startIndex,o.push(new n({data:r})),o}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return this.data.sheetId,e.data.sheetId,[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){if(this.data.sheetId!==e.sheetId)return[this];var n=[];return e.key!==this.data.id&&n.push(this),n}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){if(this.data.sheetId!==e.data.sheetId)return[this];var n=[];return(e.data.id!==this.data.id||t)&&n.push(this),n}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.data.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return this.data.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return this.data.sheetId,e.sheetId,[this]}}],[{key:"deserialize",value:function(e){var t={data:{type:e[0],sheetId:e[1],id:e[2],url:e[3],width:e[4],height:e[5],x:e[6],y:e[7],offsetX:e[8],offsetY:e[9],zIndex:e[10]}};return e[11]&&(t.data.clipInfo={clipTop:e[11][0],clipLeft:e[11][1],clipRight:e[11][2],clipBottom:e[11][3]}),new n(t)}}]),n}(l.a);f.protoMap={0:{name:"data",dataType:{type:Object,protoMap:h.a}}},t.a=f},"../packages/mutation/src/embedded/embeddedImageDataProtoMap.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n("../node_modules/core-js/modules/es.number.constructor.js");var s=n("../packages/model/src/index.ts").Embedded.EmbeddedImageClip,r={0:{name:"type",dataType:String},1:{name:"sheetId",dataType:"sheetId"},2:{name:"id",dataType:String},3:{name:"url",dataType:String},4:{name:"width",dataType:Number},5:{name:"height",dataType:Number},6:{name:"x",dataType:Number},7:{name:"y",dataType:Number},8:{name:"offsetX",dataType:Number},9:{name:"offsetY",dataType:Number},10:{name:"zIndex",dataType:Number},11:{name:"clipInfo",dataType:s}}},"../packages/mutation/src/filter/DefineFilterMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.reduce.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/get.js"),a=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),i=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=n("../packages/model/src/index.ts"),l=n("../packages/mutation/src/MutationId.ts"),h=n("../packages/mutation/src/Mutation.ts"),c=n("../packages/mutation/src/utils/index.ts"),I=n("../packages/mutation/src/filter/DeleteFilterMutation.ts");function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(i.a)(this,n)}}var f=u.Dimension.DIMENSION_TYPE,g=u.Filter,p=g.BasicFilter,R=g.FilterCriteria,x=u.Range.GridRange;function b(e){var t=e.gridRange,n=e.workbookRangeId,s=e.criteriaDelta,r=e.hiddenRows,o=e.sortSpecs,a=e.sheet,i=s?function(e){var t=new Map;return Object.keys(e).forEach((function(n){t.set(parseInt(n,10),new R(e[n]))})),t}(s):void 0;return new p({range:t,hiddenRows:r,workbookRangeId:n,criteriaMap:i,sortSpecs:o,sheetReference:a})}var y=function(e){var t,n,s=[e.defaultFilterId||"",e.hiddenRows||[],e.filterViewId||""],r=Object.keys(e.criteriaDelta||{}),o={};for(t=0,n=r.length;t<n;t++){o[r[t]]=[!1===e.criteriaDelta[r[t]].visibleByDefault?0:1,e.criteriaDelta[r[t]].visibleValues||[]];var a=e.criteriaDelta[r[t]].hiddenValues;a&&(o[r[t]][2]=a)}return s.push(o),s},k=function(e){var t,n,s={defaultFilterId:e[0],hiddenRows:e[1],filterViewId:e[2]},r=Object.keys(e[3]),o={};for(t=0,n=r.length;t<n;t++)o[r[t]]={visibleByDefault:!!e[3][r[t]][0],visibleValues:e[3][r[t]][1],hiddenValues:e[3][r[t]][2]};return s.criteriaDelta=o,s},O=function(e){for(var t=[],n=0;n<e.length;n++)t.push([e[n].dimensionIndex,e[n].sortOrder]);return t},v=function(e){for(var t=[],n=0;n<e.length;n++)t.push({dimensionIndex:e[n][0],sortOrder:e[n][1]});return t},T=function(e){Object(a.a)(n,e);var t=m(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,l.b.DEFINE_FILTER_MUTATION,e)).sheetId=e.sheetId,r.delta=e.delta,r.gridRange=e.gridRange,r.sortSpecs=e.sortSpecs||[],r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.gridRange.serialize(),y(this.delta),O(this.sortSpecs)]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=this.sheetId,n=e.sheetManager.getSheetBySheetId(t);return n?[n]:[]}},{key:"check",value:function(e){var t=Object(o.a)(Object(d.a)(n.prototype),"check",this).call(this,e);if(!t.isValid)return t;var s=this.gridRange;if(!Object(c.c)(s.startRowIndex)||!Object(c.c)(s.endRowIndex)||!Object(c.c)(s.startColIndex)||!Object(c.c)(s.endColIndex))return{isValid:!1,errorMessage:"gridRange index\u7c7b\u578b\u4e0d\u662f\u6570\u5b57 girdRange=".concat(JSON.stringify(s))};var r=e.properties.gridProperties;return s.startRowIndex<0||s.startRowIndex>=r.rowCount||s.endRowIndex>=r.rowCount||s.startColIndex<0||s.startColIndex>=r.colCount||s.endColIndex>=r.colCount?{isValid:!1,errorMessage:"gridRange \u8303\u56f4\u4e0d\u6b63\u786e\u3002 gridRange=".concat(JSON.stringify(s)," gridProperties=").concat(JSON.stringify(r))}:{isValid:!0}}},{key:"runOnSheet",value:function(e){var t=this.delta.defaultFilterId;if(t){var n=this.delta,s=n.criteriaDelta,r=n.hiddenRows,o=e.getBasicFilter(),a=this.gridRange,i=this.sortSpecs;if(!o){var d=b({gridRange:a,workbookRangeId:t,criteriaDelta:s,hiddenRows:r,sortSpecs:i,sheet:e});e.setBasicFilter(d)}}}},{key:"invert",value:function(){var e=this.sheetId,t=this.delta.defaultFilterId;return t?[new I.a({sheetId:e,delta:{defaultFilterId:t}})]:[]}},{key:"transformWithInsertDimensionMutation",value:function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var t=e.type,s=e.index,r=e.amount,o=e.sheetId,a=this.gridRange.clone();return a.insertDimension({sheetId:o,type:t,index:s,amount:r}),[new n({gridRange:a,delta:function(e,t){var n=e.type,s=e.index,r=e.amount,o=!1;if(n===f.COLUMNS&&null!=t.criteriaDelta){o=!1;var a=t.criteriaDelta;if(a&&Object.keys(a).length>0){var i=Object.keys(a),d=i.filter((function(e){return parseInt(e,10)>s})).length>0;if(o=o||d,d){var u=i.reduce((function(e,t){return e[parseInt(t,10)>s?parseInt(t,10)+r:t]=a[parseInt(t,10)],e}),{});t.criteriaDelta=u}}if(o)return t.hiddenRows=[],t}return t}({type:t,index:s,amount:r},this.delta),sheetId:o})]}},{key:"transformWithDeleteDimensionMutation",value:function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var t=e.type,s=e.index,r=e.amount,o=e.sheetId,a=this.gridRange.clone();return a.deleteDimension({sheetId:o,type:t,index:s,amount:r}),[new n({gridRange:a,delta:function(e,t){var n=e.type,s=e.index,r=e.amount,o=!1;if(n===f.COLUMNS&&null!=t.criteriaDelta){o=!1;var a=t.criteriaDelta;if(a&&Object.keys(a).length>0){var i=Object.keys(a),d=i.filter((function(e){return parseInt(e,10)>s})).length>0;if(o=o||d,d){var u=i.reduce((function(e,t){return e[parseInt(t,10)>s?parseInt(t,10)-r:t]=a[parseInt(t,10)],e}),{});t.criteriaDelta=u,t.hiddenRows=[]}}if(o)return t}return t}({type:t,index:s,amount:r},this.delta),sheetId:o})]}},{key:"transformWithMergeCellsMutation",value:function(e){if(this.gridRange.sheetId!==e.sheetId)return[this];var t=e.startColIndex,n=e.startRowIndex,s=e.endColIndex,r=e.endRowIndex,o=e.sheetId;return new x(o,n,r,t,s).isCross(this.gridRange)?[]:[this]}},{key:"transformWithDefineFilterMutation",value:function(e){return this.gridRange.sheetId!==e.sheetId?[this]:Object(c.d)(e.delta.defaultFilterId||e.delta.filterViewId,this.delta.defaultFilterId||this.delta.filterViewId)?[]:[this]}},{key:"transformWithDeleteFilterMutation",value:function(e){return this.gridRange.sheetId!==e.sheetId?[this]:Object(c.d)(e.delta.defaultFilterId||e.delta.filterViewId,this.delta.defaultFilterId||this.delta.filterViewId)?[]:[this]}},{key:"transformWithUpdateFilterMutation",value:function(e){return this.gridRange.sheetId,e.sheetId,[this]}},{key:"transformWithReorderRangeMutation",value:function(e){return this.gridRange.sheetId,e.sheetId,[this]}},{key:"transformWithMapRangeMutation",value:function(e){return this.gridRange.sheetId,e.sourceSheetId,[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],gridRange:x.deserialize(e[1]),delta:k(e[2]),sortSpecs:v(e[3])})}}]),n}(h.a);T.protoMap={0:{name:"sheetId",dataType:String},1:{name:"gridRange",dataType:x},2:{name:"delta",dataType:{type:Object,protoMap:{0:{name:"defaultFilterId",dataType:String},1:{name:"hiddenRows",dataType:Array,subType:Number},2:{name:"filterViewId",dataType:String},3:{name:"criteriaDelta",dataType:{type:Object,subType:{type:Object,protoMap:{0:{name:"visibleByDefault",dataType:Boolean},1:{name:"visibleValues",dataType:Array,subType:String},2:{name:"hiddenValues",dataType:Array,subType:String}}}}}}}},3:{name:"sortSpecs",dataType:Array,subType:{dataType:Object,protoMap:{0:{name:"dimensionIndex",dataType:Number},1:{name:"sortOrder",dataType:Number}}}}},t.a=T},"../packages/mutation/src/filter/DeleteFilterMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/mutation/src/MutationId.ts"),u=n("../packages/mutation/src/Mutation.ts"),l=(n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../packages/utils/src/index.ts")),h=n("../packages/mutation/src/filter/DefineFilterMutation.ts");function c(e,t,n){var s=t.range,r=t.getHiddenRows(),o=t.sortSpecs,a=t.criteriaMap,i={};return a.forEach((function(e,t){var n=e.visibleValues;i[t]={visibleValues:n}})),new h.a({sheetId:e,gridRange:s,delta:{defaultFilterId:n||l.a.getRandomId(),hiddenRows:r,criteriaDelta:i},sortSpecs:o})}function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var m=function(e){Object(o.a)(n,e);var t=I(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,d.b.DELETE_FILTER_MUTATION,e)).sheetId=e.sheetId,r.delta=e.delta,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,[this.delta.defaultFilterId||""]]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=this.sheetId,n=e.sheetManager.getSheetBySheetId(t);return n?[n]:[]}},{key:"runOnSheet",value:function(e){this.delta.defaultFilterId&&e.clearBasicFilter()}},{key:"invert",value:function(e){var t=this.delta.defaultFilterId,n=this.sheetId,s=e.sheetManager.getSheetBySheetId(n);if(!s)return[];if(t){var r=s.getBasicFilter();if(r)return[c(n,r,t)]}return[]}},{key:"transformWithDefineFilterMutation",value:function(e){return this.sheetId,e.gridRange.sheetId,[this]}},{key:"transformWithDeleteFilterMutation",value:function(e){return this.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateFilterMutation",value:function(e){return this.sheetId,e.sheetId,[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],delta:{defaultFilterId:e[1][0]}})}}]),n}(u.a);m.protoMap={0:{name:"sheetId",dataType:String},1:{name:"delta",dataType:{type:Object,protoMap:{0:{name:"defaultFilterId",dataType:String}}}}};t.a=m},"../packages/mutation/src/filter/SwitchFilterSyncMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/mutation/src/Mutation.ts"),u=n("../packages/mutation/src/MutationId.ts");function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var h=function(e){Object(o.a)(n,e);var t=l(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.SWITCH_FILTER_SYNC_MUTATION,e)).isOn=e.isOn,r}return Object(r.a)(n,[{key:"getAffectedSheetId",value:function(){return"WORKBOOK"}},{key:"getAffectedSheets",value:function(){return[]}},{key:"invert",value:function(){return[new n({isOn:!this.isOn})]}},{key:"runOnSheet",value:function(){}},{key:"runOnWorkbook",value:function(e){return e.isFilterSync=this.isOn,!0}},{key:"serialize",value:function(){return[this.isOn]}},{key:"transformWithSwitchFilterSyncMutation",value:function(e,t){return t?[this]:[]}}],[{key:"deserialize",value:function(e){return new n({isOn:e[0]})}}]),n}(d.a);t.a=h},"../packages/mutation/src/filter/UpdateFilterMutation.ts":function(e,t,n){"use strict";n.d(t,"c",(function(){return x})),n.d(t,"a",(function(){return g}));n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),i=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=n("../packages/model/src/index.ts"),l=n("../packages/mutation/src/MutationId.ts"),h=n("../packages/mutation/src/Mutation.ts"),c=n("../packages/mutation/src/utils/index.ts");function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){Object(s.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(i.a)(this,n)}}var g,p=u.Filter.FilterCriteria,R=u.Range.GridRange;function x(e,t){var n=e.criteria,s=e.columnIndex,r=e.clear,o=t.getColFilterCriteria(s);if(r)return t.deleteColFilterCriteria(s),t;if(n){var a=n.visibleValues;a&&(o||(o=new p({})),o.visibleValues=a,t.setColFilterCriteria(s,o))}return t}!function(e){e[e.UPDATE=1]="UPDATE",e[e.RECAL=2]="RECAL"}(g||(g={}));var b={0:{name:"columnIndex",dataType:Number},1:{name:"clear",dataType:Boolean},2:{name:"criteria",dataType:{0:{name:"visibleByDefault",dataType:Boolean},1:{name:"visibleValues",dataType:Array,subType:String}}}},y=function(e){var t=[e.defaultFilterId||""];if(e.hiddenRows?t.push(e.hiddenRows):t.push(null),e.range?t.push(e.range.serialize()):t.push(null),e.updateColumnCriteriaDelta){var n=e.updateColumnCriteriaDelta;n.length?t.push(n.map((function(e){return[(t=e).columnIndex,t.clear?1:0,t.criteria?[!1===t.criteria.visibleByDefault?0:1,t.criteria.visibleValues||[]]:null];var t}))):t.push(null)}else t.push(null);return t},k=function(e){var t,n={defaultFilterId:e[0]};(e[1]&&(n.hiddenRows=e[1]),e[2]&&(n.range=R.deserialize(e[2])),e[3])&&(t=Object(c.b)(e[3][0])?e[3]:[e[3]],n.updateColumnCriteriaDelta=t.map((function(e){return{columnIndex:e[0],clear:!!e[1],criteria:e[2]?{visibleByDefault:!!e[2][0],visibleValues:e[2][1]}:void 0}})));return n},O=function(e){if(null===e)return null;for(var t=[],n=0;n<e.length;n++)t.push([e[n].dimensionIndex,e[n].sortOrder]);return t},v=function(e){if(null===e)return null;var t=[];if(null===e||void 0===e?void 0:e.length)for(var n=0;n<e.length;n++)t.push({dimensionIndex:e[n][0],sortOrder:e[n][1]});return t},T=function(e){Object(a.a)(n,e);var t=f(n);function n(e){var s;Object(r.a)(this,n),(s=t.call(this,l.b.UPDATE_FILTER_MUTATION,e)).workbookRangeId=e.workbookRangeId,s.updateType=e.updateType,s.sheetId=e.sheetId;var o=e.delta.updateColumnCriteriaDelta;return o&&!Object(c.b)(o)?s.delta=m(m({},e.delta),{},{updateColumnCriteriaDelta:[o]}):s.delta=m(m({},e.delta),{},{updateColumnCriteriaDelta:o}),s.delta.hiddenRows&&s.delta.hiddenRows.sort((function(e,t){return e-t})),s.sortSpecs=e.sortSpecs||null,s.nonPersistingLocalChange=!!e.nonPersistingLocalChange,s}return Object(o.a)(n,[{key:"serialize",value:function(){return[this.workbookRangeId,this.updateType,this.sheetId,y(this.delta),O(this.sortSpecs)]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=this.sheetId,n=e.sheetManager.getSheetBySheetId(t);return n?[n]:[]}},{key:"runOnSheet",value:function(e){this.updateType!==g.UPDATE&&this.updateType!==g.RECAL||this.delta.defaultFilterId&&this.updateBasicFilter(this.delta,e)}},{key:"updateBasicFilter",value:function(e,t){var n=e.hiddenRows,s=e.updateColumnCriteriaDelta,r=e.defaultFilterId,o=e.range,a=t.getBasicFilter();if(r&&a){if(s)(Object(c.b)(s)?s:[s]).forEach((function(e){x(e,a)})),t.setBasicFilter(a),this.nonPersistingLocalChange||a.setCacheCriteria();n&&(a.setHiddenRows(n),this.nonPersistingLocalChange||a.setCacheHiddenRows()),o&&(o.endRowIndex>=t.getRowCount()&&(o.endRowIndex=t.getRowCount()-1),o.endColIndex>=t.getColCount()&&(o.endColIndex=t.getColCount()-1),a.range=o),null!==this.sortSpecs&&(a.sortSpecs=this.sortSpecs)}}},{key:"invert",value:function(e){if(this.updateType===g.UPDATE||this.updateType===g.RECAL){var t=this.delta.defaultFilterId,s=this.sheetId,r=this.workbookRangeId,o=this.updateType,a=this.nonPersistingLocalChange,i=e.sheetManager.getSheetBySheetId(s);if(!i)return[];var d=i.getBasicFilter();if(t&&d){var u=d.sortSpecs,l=this.delta,h=l.hiddenRows,c=l.updateColumnCriteriaDelta,I=l.range;if(c)return[new n({workbookRangeId:r,sheetId:s,updateType:o,delta:{updateColumnCriteriaDelta:c.map((function(e){var t=e.columnIndex,n=d.getColFilterCriteria(t),s={columnIndex:t};return n?s.criteria=n:s.clear=!0,s})),defaultFilterId:t,range:d.range.clone()},sortSpecs:u,nonPersistingLocalChange:a})];if(h)return[new n({workbookRangeId:r,sheetId:s,updateType:o,delta:{hiddenRows:d.getHiddenRows(),defaultFilterId:t,range:d.range.clone()},sortSpecs:u,nonPersistingLocalChange:a})];if(I)return[new n({workbookRangeId:r,sheetId:s,updateType:o,delta:{range:d.range,defaultFilterId:t},nonPersistingLocalChange:a})];if(this.sortSpecs)return[new n({workbookRangeId:r,sheetId:s,updateType:o,delta:{defaultFilterId:t},sortSpecs:u,nonPersistingLocalChange:a})]}}return[]}},{key:"isNonPersistedLocalChange",value:function(){return this.nonPersistingLocalChange}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=e.sheetId,s=e.type,r=e.index,o=e.amount,a=this.delta.range;if(a){var i=a.clone();i.insertDimension({sheetId:n,type:s,index:r,amount:o})}return[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithDefineFilterMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithDeleteFilterMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){return this.sheetId,e.sourceSheetId,[this]}}],[{key:"deserialize",value:function(e){return new n({workbookRangeId:e[0],updateType:e[1],sheetId:e[2],delta:k(e[3]),sortSpecs:v(e[4])})}}]),n}(h.a);T.protoMap={0:{name:"workbookRangeId",dataType:String},1:{name:"updateType",dataType:Number},2:{name:"sheetId",dataType:String},3:{name:"delta",dataType:{type:Object,protoMap:{0:{name:"defaultFilterId",dataType:String},1:{name:"hiddenRows",dataType:Array,subType:Number},2:{name:"updateColumnCriteriaDelta",dataType:Object,protoMap:b},3:{name:"range",dataType:R}}}},4:{name:"sortSpecs",dataType:Array,subType:{type:Object,protoMap:{0:{name:"dimensionIndex",dataType:Number},1:{name:"sortOrder",dataType:Number}}}}},t.b=T},"../packages/mutation/src/index.ts":function(e,t,n){"use strict";n.d(t,"g",(function(){return s.b})),n.d(t,"d",(function(){return r.a})),n.d(t,"f",(function(){return o.a})),n.d(t,"e",(function(){return a.a})),n.d(t,"i",(function(){return d.c})),n.d(t,"j",(function(){return u.a})),n.d(t,"h",(function(){return l.a})),n.d(t,"c",(function(){return h.a})),n.d(t,"m",(function(){return R.b})),n.d(t,"k",(function(){return x.a})),n.d(t,"a",(function(){return b.a})),n.d(t,"b",(function(){return y.a})),n.d(t,"l",(function(){return k.a}));n("../packages/lib/global.ts");var s=n("../packages/mutation/src/MutationId.ts"),r=n("../packages/mutation/src/api.interface.ts"),o=n("../packages/mutation/src/api.ts"),a=n("../packages/mutation/src/MutationOperationType.ts"),i=n("../packages/mutation/src/Mutation.ts"),d=(n("../packages/mutation/src/dimension/InsertDimensionMutation.ts"),n("../packages/mutation/src/dimension/DeleteDimensionMutation.ts"),n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts")),u=n("../packages/mutation/src/cell/SetRangeMutation.ts"),l=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),h=(n("../packages/mutation/src/merge/MergeCellsMutation.ts"),n("../packages/mutation/src/merge/UnmergeCellsMutation.ts"),n("../packages/mutation/src/embedded/AddEmbeddedObjectMutation.ts"),n("../packages/mutation/src/embedded/DeleteEmbeddedObjectMutation.ts")),c=(n("../packages/mutation/src/embedded/UpdateEmbeddedObjectMutation.ts"),n("../packages/mutation/src/sheet/InsertSheetMutation.ts"),n("../packages/mutation/src/sheet/DeleteSheetMutation.ts"),n("../packages/mutation/src/sheet/MoveSheetMutation.ts"),n("../packages/mutation/src/sheet/SetSheetPropertiesMutation.ts"),n("../packages/mutation/src/sheet/UpdateAllSheetsMutation.ts"),n("../packages/mutation/src/sheet/DefineSheetRangeMutation.ts"),n("../packages/mutation/src/sheet/DeleteSheetRangeMutation.ts"),n("../packages/mutation/src/sheet/UpdateSheetRangeMutation.ts"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js")),I=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),m=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),f=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),g=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js");function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(g.a)(e);if(t){var r=Object(g.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(f.a)(this,n)}}i.a,n("../packages/mutation/src/other/InitDataMutation.ts"),n("../packages/mutation/src/other/CopyPasteMutation.ts"),n("../packages/mutation/src/other/ReorderRangeMutation.ts"),n("../packages/mutation/src/other/MapRangeMutation.ts"),n("../packages/mutation/src/filter/DefineFilterMutation.ts"),n("../packages/mutation/src/filter/DeleteFilterMutation.ts");var R=n("../packages/mutation/src/filter/UpdateFilterMutation.ts"),x=n("../packages/mutation/src/filter/SwitchFilterSyncMutation.ts"),b=(n("../packages/mutation/src/other/EmptyMutation.ts"),n("../packages/mutation/src/conditionalFormat/AddConditionalFormatMutation.ts")),y=n("../packages/mutation/src/conditionalFormat/DeleteConditionalFormatMutation.ts"),k=n("../packages/mutation/src/conditionalFormat/UpdateConditionalFormatMutation.ts");n("../packages/mutation/src/workbook/workbookRange/DefineWorkbookRangeMutation.ts"),n("../packages/mutation/src/workbook/workbookRange/UpdateWorkbookRangeMutation.ts"),n("../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts"),n("../packages/mutation/src/new-embedded/NewAddEmbeddedObjectMutation.ts"),n("../packages/mutation/src/new-embedded/NewDeleteEmbeddedObjectMutation.ts"),n("../packages/mutation/src/new-embedded/NewUpdateEmbeddedObjectMutation.ts")},"../packages/mutation/src/merge/MergeCellsMutation.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return v}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.some.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/other/mapRangeMutationUtil.ts"),c=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts"),I=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts"),m=n("../packages/mutation/src/filter/DeleteFilterMutation.ts"),f=n("../packages/mutation/src/conditionalFormat/UpdateConditionalFormatMutation.ts");function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var p=d.Range.GridRange,R=d.Dimension.DIMENSION_TYPE,x=d.Cell,b=x.CellDataDelta,y=x.CELL_DATA_SLOT_COMPOSE,k=d.Rule.ConditionalFormatRule,O=function(e){Object(o.a)(n,e);var t=g(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.MERGE_CELLS_MUTATION,e)).sheetId=e.sheetId,r.startRowIndex=e.startRowIndex,r.endRowIndex=e.endRowIndex,r.startColIndex=e.startColIndex,r.endColIndex=e.endColIndex,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){var t=new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(!t.isValid())return{isValid:!1,errorMessage:"GridRange\u503c\u975e\u6cd5 gridRange=".concat(JSON.stringify(t))};var n=e.properties.gridProperties;return this.endRowIndex>=n.rowCount||this.endColIndex>=n.colCount?{isValid:!1,errorMessage:"\u884c\u5217\u8303\u56f4\u4e0d\u6b63\u786e\u3002 endRowIndex=".concat(this.endRowIndex,"  endRowIndex=").concat(this.endColIndex," gridProperties=").concat(JSON.stringify(n))}:{isValid:!0}}},{key:"runOnSheet",value:function(e){e.mergeManager.addMerge(new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex))}},{key:"invert",value:function(e){return[new I.a({startRowIndex:this.startRowIndex,endRowIndex:this.endRowIndex,startColIndex:this.startColIndex,endColIndex:this.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return s.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new n({startRowIndex:s.startRowIndex,endRowIndex:s.endRowIndex,startColIndex:s.startColIndex,endColIndex:s.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return s.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),!s.isValid()||s.isSingle()?[]:[new n({startRowIndex:s.startRowIndex,endRowIndex:s.endRowIndex,startColIndex:s.startColIndex,endColIndex:s.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithSetRangeMutation",value:function(e,t){if(this.sheetId!==e.gridRange.sheetId)return[this];var n,s,r,o=[],a=e.cellDataDeltaAtPositions,i=new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(i.isCross(e.gridRange)){if(t){for(n=0;n<a.length;n++)0!==(s=a[n]).cellDataDelta.setSlots&&(r=new p(this.sheetId,s.rowIndex,s.rowIndex,s.colIndex,s.colIndex),i.isCross(r)&&o.push(new c.a({gridRange:r,cellDataDelta:new b({setSlots:0,clearSlots:y.ALL})})));o.push(this)}}else o.push(this);return o}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){if(this.sheetId!==e.gridRange.sheetId)return[this];var n,s,r=[],o=[],a=[];if(0===e.cellDataDelta.setSlots)r.push(this);else{for(o=v(new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex)),n=0;n<o.length;n++)(s=o[n].getCross(e.gridRange))&&a.push(s);if(a.length>0){if(t){for(n=0;n<a.length;n++)r.push(new c.a({gridRange:a[n],cellDataDelta:new b({setSlots:0,clearSlots:y.ALL})}));r.push(this)}}else r.push(this)}return r}},{key:"transformWithMergeCellsMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex),s=new p(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);return n.isCross(s)?t?[new I.a({startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex,sheetId:e.sheetId}),this]:[]:[this]}},{key:"transformWithUnmergeCellsMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[],s=new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex),r=new p(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);return s.isCross(r)?t&&n.push(e,this):n.push(this),n}},{key:"transformWithDefineFilterMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex).isCross(e.gridRange)&&n.push(new m.a({sheetId:e.sheetId,delta:{defaultFilterId:e.delta.defaultFilterId,filterViewId:e.delta.filterViewId}})),n.push(this),n}},{key:"transformWithCopyPasteMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return n.push(this),n}},{key:"transformWithReorderRangeMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex).isCross(e.range)||n.push(this),n}},{key:"transformWithMapRangeMutation",value:function(e,t){if(this.sheetId!==e.sourceSheetId)return[this];var n=[];return Object(h.a)(R.ROWS,e)||Object(h.a)(R.COLUMNS,e)||n.push(this),n}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(e.rule.ruleRanges.some((function(e){return e.isCross(n)}))){var s=new p(this.sheetId,this.startRowIndex,this.startRowIndex,this.startColIndex,this.startColIndex);if(e.rule.ruleRanges.some((function(e){return e.contain(s)})))return[this];var r=[];return e.rule.ruleRanges.forEach((function(e){if(e.sheetId===n.sheetId&&e.isCross(n)){var t=e.startRowIndex,s=e.endRowIndex;e.startRowIndex<n.startRowIndex&&(r.push(new p(e.sheetId,e.startRowIndex,n.startRowIndex,e.startColIndex,e.endColIndex)),t=n.startRowIndex),n.endRowIndex<e.endRowIndex&&(r.push(new p(e.sheetId,n.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),s=n.endRowIndex),e.startColIndex<n.startColIndex&&r.push(new p(e.sheetId,t,s,e.startColIndex,n.endColIndex)),n.endColIndex<e.endColIndex&&r.push(new p(e.sheetId,t,s,n.endColIndex,e.endColIndex))}else r.push(e)})),0===r.length?[this]:(r.sort((function(e,t){return e.startRowIndex<t.startRowIndex||e.startColIndex<t.startColIndex||e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex})),[this,new f.a({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new k({ruleRanges:r,booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})])}return[this]}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=new p(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(e.rule.ruleRanges.some((function(e){return e.isCross(n)}))){var s=new p(this.sheetId,this.startRowIndex,this.startRowIndex,this.startColIndex,this.startColIndex);if(e.rule.ruleRanges.some((function(e){return e.contain(s)})))return[this];var r=[];return e.rule.ruleRanges.forEach((function(e){if(e.sheetId===n.sheetId&&e.isCross(n)){var t=e.startRowIndex,s=e.endRowIndex;e.startRowIndex<n.startRowIndex&&(r.push(new p(e.sheetId,e.startRowIndex,n.startRowIndex,e.startColIndex,e.endColIndex)),t=n.startRowIndex),n.endRowIndex<e.endRowIndex&&(r.push(new p(e.sheetId,n.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),s=n.endRowIndex),e.startColIndex<n.startColIndex&&r.push(new p(e.sheetId,t,s,e.startColIndex,n.endColIndex)),n.endColIndex<e.endColIndex&&r.push(new p(e.sheetId,t,s,n.endColIndex,e.endColIndex))}else r.push(e)})),0===r.length?[this]:(r.sort((function(e,t){return e.startRowIndex<t.startRowIndex||e.startColIndex<t.startColIndex||e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex})),[this,new f.a({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new k({ruleRanges:r,booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})])}return[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],startRowIndex:e[1],endRowIndex:e[2],startColIndex:e[3],endColIndex:e[4]})}}]),n}(l.a);function v(e){var t=[],n=e.sheetId,s=e.startRowIndex,r=e.endRowIndex,o=e.startColIndex,a=e.endColIndex;return r>s&&t.push(new p(n,s+1,r,o,a)),a>o&&t.push(new p(n,s,s,o+1,a)),t}O.protoMap={0:{name:"sheetId",dataType:String},1:{name:"startRowIndex",dataType:Number},2:{name:"endRowIndex",dataType:Number},3:{name:"startColIndex",dataType:Number},4:{name:"endColIndex",dataType:Number}},t.a=O},"../packages/mutation/src/merge/UnmergeCellsMutation.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return k}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/merge/MergeCellsMutation.ts"),c=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts");function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var m=d.Range.GridRange,f=d.Cell,g=f.CELL_DATA_SLOT,p=f.CellDataDelta,R=f.CELL_FORMAT_SLOT,x=f.CELL_FORMAT_SLOT_COMPOSE,b=f.cellFormatUtils,y=function(e){Object(o.a)(n,e);var t=I(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.UNMERGE_CELLS_MUTATION,e)).sheetId=e.sheetId,r.startRowIndex=e.startRowIndex,r.endRowIndex=e.endRowIndex,r.startColIndex=e.startColIndex,r.endColIndex=e.endColIndex,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t}},{key:"check",value:function(e){var t=new m(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(!t.isValid())return{isValid:!1,errorMessage:"GridRange\u503c\u975e\u6cd5 gridRange=".concat(JSON.stringify(t))};var n=e.properties.gridProperties;return this.endRowIndex>=n.rowCount||this.endColIndex>=n.colCount?{isValid:!1,errorMessage:"\u884c\u5217\u8303\u56f4\u4e0d\u6b63\u786e\u3002 endRowIndex=".concat(this.endRowIndex,"  endRowIndex=").concat(this.endColIndex," gridProperties=").concat(JSON.stringify(n))}:{isValid:!0}}},{key:"runOnSheet",value:function(e){e.mergeManager.deleteMerge(new m(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex))}},{key:"invert",value:function(e){return[new h.a({startRowIndex:this.startRowIndex,endRowIndex:this.endRowIndex,startColIndex:this.startColIndex,endColIndex:this.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=new m(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return s.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new n({startRowIndex:s.startRowIndex,endRowIndex:s.endRowIndex,startColIndex:s.startColIndex,endColIndex:s.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=new m(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return s.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),!s.isValid()||s.isSingle()?[]:[new n({startRowIndex:s.startRowIndex,endRowIndex:s.endRowIndex,startColIndex:s.startColIndex,endColIndex:s.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithUnmergeCellsMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return this.sheetId===e.sheetId&&this.startRowIndex===e.startRowIndex&&this.endRowIndex===e.endRowIndex&&this.startColIndex===e.startColIndex&&this.endColIndex===e.endColIndex||n.push(this),n}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],startRowIndex:e[1],endRowIndex:e[2],startColIndex:e[3],endColIndex:e[4]})}}]),n}(l.a);function k(e,t){var n,s,r,o,a,i=[];return t.mergeManager.each((function(d){var u;e.isCross(d)&&(i.push(new y({startRowIndex:d.startRowIndex,endRowIndex:d.endRowIndex,startColIndex:d.startColIndex,endColIndex:d.endColIndex,sheetId:d.sheetId})),r=t.getCellDataAtPosition(d.startRowIndex,d.startColIndex),a=null!==r?b.createCellFormatDelta(null,r.getUserEnteredFormat(),x.ALL):null,(o=new p).setSlot(g.SLOT_USER_ENTERED_FORMAT_DELTA,a),n=new c.a({cellDataDelta:o,gridRange:new m(d.sheetId,d.startRowIndex,d.endRowIndex,d.startColIndex,d.endColIndex)}),(null===(u=s=n.cellDataDelta.delta.userEnteredFormatDelta)||void 0===u?void 0:u.delta.getBorders())&&(s.clearSlot(R.BORDER_TOP),s.clearSlot(R.BORDER_BOTTOM),s.clearSlot(R.BORDER_LEFT),s.clearSlot(R.BORDER_RIGHT)),i.push(n))})),i}y.protoMap={0:{name:"sheetId",dataType:String},1:{name:"startRowIndex",dataType:Number},2:{name:"endRowIndex",dataType:Number},3:{name:"startColIndex",dataType:Number},4:{name:"endColIndex",dataType:Number}},t.a=y},"../packages/mutation/src/new-embedded/NewAddEmbeddedObjectMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts"),c=n("../packages/mutation/src/new-embedded/NewDeleteEmbeddedObjectMutation.ts"),I=n("../packages/mutation/src/new-embedded/NewUpdateEmbeddedObjectMutation.ts");function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var f=d.NewEmbedded.EmbeddedObject,g=d.Dimension.DIMENSION_TYPE,p=d.Range.DimensionRange,R=function(e){Object(o.a)(n,e);var t=m(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.NEW_ADD_EMBEDDED_OBJECT_MUTATION,e)).object=e.object,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.object.serialize()]}},{key:"getAffectedSheetId",value:function(){return"WORKBOOK"}},{key:"getAffectedSheets",value:function(){return[]}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){}},{key:"runOnWorkbook",value:function(e){return!this.checkEmbeddedObject(e,this.object)||(e.embeddedObjectManager.addEmbeddedObject(this.object),!0)}},{key:"checkEmbeddedObject",value:function(e,t){var n,s=!0;return null===(n=t.properties.chart)||void 0===n||n.workbookRangeId.forEach((function(t){e.workbookRangeManager.getChartWorkbookRangeById(t)||(s=!1)})),s}},{key:"invert",value:function(e){return[new c.a({objectId:this.object.objectId,sheetId:this.object.location.sheetId})]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){var s=this.object.location;if(s.sheetId!==e.sheetId)return[this];var r,o=s.position,a=!1;if(e.type===g.ROWS?((r=new p(e.sheetId,o.rowIndex,o.rowIndex,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o.rowIndex||r.endIndex!==o.rowIndex):((r=new p(e.sheetId,o.colIndex,o.colIndex,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o.colIndex||r.endIndex!==o.colIndex),a){var i=this.object.clone();return i.location.position={rowIndex:e.type===g.ROWS?r.startIndex:o.rowIndex,colIndex:e.type===g.ROWS?o.colIndex:r.startIndex},[new n({object:i})]}return[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){var s=this.object.location;if(s.sheetId!==e.sheetId)return[this];var r,o=s.position,a=!1;if(e.type===g.ROWS?((r=new p(e.sheetId,o.rowIndex,o.rowIndex,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o.rowIndex||r.endIndex!==o.rowIndex):((r=new p(e.sheetId,o.colIndex,o.colIndex,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o.colIndex||r.endIndex!==o.colIndex),a){var i=this.object.clone();return i.location.position={rowIndex:e.type===g.ROWS?r.startIndex:o.rowIndex,colIndex:e.type===g.ROWS?o.colIndex:r.startIndex},[new n({object:i})]}return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.object.location.sheetId!==e.sheetId?[this]:[]}},{key:"transformWithDefineWorkbookRangeMutation",value:function(e,t){return this.object.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new h.a({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]}},{key:"transformWithUpdateWorkbookRangeMutation",value:function(e,t){return this.object.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new h.a({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]}},{key:"transformWithNewAddEmbeddedObjectMutation",value:function(e,t){return this.object.objectId===e.object.objectId?t?[new I.a({object:this.object.clone()})]:[]:[this]}},{key:"transformWithNewDeleteEmbeddedObjectMutation",value:function(e,t){return this.object.objectId===e.objectId?[]:[this]}},{key:"transformWithNewUpdateEmbeddedObjectMutation",value:function(e,t){return this.object.objectId===e.object.objectId?t?[new I.a({object:this.object.clone()})]:[]:[this]}}],[{key:"deserialize",value:function(e){return new n({object:f.deserialize(e[0])})}}]),n}(l.a);t.a=R},"../packages/mutation/src/new-embedded/NewDeleteEmbeddedObjectMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/mutation/src/MutationId.ts"),u=n("../packages/mutation/src/Mutation.ts"),l=n("../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts"),h=n("../packages/mutation/src/new-embedded/NewAddEmbeddedObjectMutation.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,d.b.NEW_DELETE_EMBEDDED_OBJECT_MUTATION,e)).objectId=e.objectId,r.sheetId=e.sheetId,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.objectId,this.sheetId]}},{key:"getAffectedSheetId",value:function(){return"WORKBOOK"}},{key:"getAffectedSheets",value:function(){return[]}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){}},{key:"runOnWorkbook",value:function(e){return e.embeddedObjectManager.deleteEmbeddedObject(this.objectId),!0}},{key:"invert",value:function(e){return[new h.a({object:e.embeddedObjectManager.getEmbeddedObject(this.objectId).clone()})]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:[]}},{key:"transformWithDefineWorkbookRangeMutation",value:function(e,t){return this.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new l.a({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]}},{key:"transformWithUpdateWorkbookRangeMutation",value:function(e,t){return this.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new l.a({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]}},{key:"transformWithNewDeleteEmbeddedObjectMutation",value:function(e,t){return this.objectId===e.objectId?[]:[this]}}],[{key:"deserialize",value:function(e){return new n({objectId:e[0],sheetId:e[1]})}}]),n}(u.a);t.a=I},"../packages/mutation/src/new-embedded/NewUpdateEmbeddedObjectMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=d.NewEmbedded.EmbeddedObject,m=d.Dimension.DIMENSION_TYPE,f=d.Range.DimensionRange,g=function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.NEW_UPDATE_EMBEDDED_OBJECT_MUTATION,e)).object=e.object,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.object.serialize()]}},{key:"getAffectedSheetId",value:function(){return"WORKBOOK"}},{key:"getAffectedSheets",value:function(){return[]}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){}},{key:"runOnWorkbook",value:function(e){return e.embeddedObjectManager.updateEmbeddedObject(this.object),!0}},{key:"invert",value:function(e){return[new n({object:e.embeddedObjectManager.getEmbeddedObject(this.object.objectId).clone()})]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){var s=this.object.location;if(s.sheetId!==e.sheetId)return[this];var r,o=s.position,a=!1;if(e.type===m.ROWS?((r=new f(e.sheetId,o.rowIndex,o.rowIndex,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o.rowIndex||r.endIndex!==o.rowIndex):((r=new f(e.sheetId,o.colIndex,o.colIndex,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o.colIndex||r.endIndex!==o.colIndex),a){var i=this.object.clone();return i.location.position={rowIndex:e.type===m.ROWS?r.startIndex:o.rowIndex,colIndex:e.type===m.ROWS?o.colIndex:r.startIndex},[new n({object:i})]}return[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){var s=this.object.location;if(s.sheetId!==e.sheetId)return[this];var r,o=s.position,a=!1;if(e.type===m.ROWS?((r=new f(e.sheetId,o.rowIndex,o.rowIndex,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o.rowIndex||r.endIndex!==o.rowIndex):((r=new f(e.sheetId,o.colIndex,o.colIndex,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),a=r.startIndex!==o.colIndex||r.endIndex!==o.colIndex),a){var i=this.object.clone();return i.location.position={rowIndex:e.type===m.ROWS?r.startIndex:o.rowIndex,colIndex:e.type===m.ROWS?o.colIndex:r.startIndex},[new n({object:i})]}return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.object.location.sheetId!==e.sheetId?[this]:[]}},{key:"transformWithDefineWorkbookRangeMutation",value:function(e,t){return this.object.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new h.a({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]}},{key:"transformWithUpdateWorkbookRangeMutation",value:function(e,t){return this.object.objectId===e.workbookRangePropertiesDelta.getEmbeddedObjectId()&&t?[new h.a({workbookRangeId:e.workbookRangeId,workbookRangeType:e.workbookRangeType}),this]:[this]}},{key:"transformWithNewAddEmbeddedObjectMutation",value:function(e,t){return this.object.objectId===e.object.objectId?t?[new n({object:this.object.clone()})]:[]:[this]}},{key:"transformWithNewDeleteEmbeddedObjectMutation",value:function(e,t){return this.object.objectId===e.objectId?[]:[this]}},{key:"transformWithNewUpdateEmbeddedObjectMutation",value:function(e,t){return this.object.objectId===e.object.objectId?t?[new n({object:this.object.clone()})]:[]:[this]}}],[{key:"deserialize",value:function(e){return new n({object:I.deserialize(e[0])})}}]),n}(l.a);t.a=g},"../packages/mutation/src/other/CopyPasteMutation.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),u=n("../packages/model/src/index.ts"),l=n("../packages/mutation/src/MutationId.ts"),h=n("../packages/mutation/src/Mutation.ts"),c=n("../packages/mutation/src/cell/SetRangeMutation.ts"),I=n("../packages/model/src/cell/index.ts");function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var f=u.Range,g=f.GridRange,p=f.DimensionRange,R=u.Cell.cellDataUtils,x=u.Dimension.DIMENSION_TYPE,b=function e(t){Object(d.a)(this,e),this.source=t.source,this.destination=t.destination};function y(e,t){return e.getRowCount()===t.getRowCount()&&e.getColCount()===t.getColCount()}b.protoMap={0:{name:"source",dataType:g},1:{name:"destination",dataType:g}};var k=function(e){Object(o.a)(n,e);var t=m(n);function n(e){var s;Object(d.a)(this,n),(s=t.call(this,l.b.COPY_PASTE_MUTATION,e)).sheetId=e.sheetId,s.cellMask=e.cellMask,s.formatMask=e.formatMask;var r=e.pasteMappings;return s.checkPasteMappings(r)?s.pasteMappings=e.pasteMappings:(console.warn("pasteMapping must be same rowLen and colLen"),s.pasteMappings=s.filterPasteMappings(r)),s}return Object(r.a)(n,[{key:"serialize",value:function(){var e,t,n=[this.sheetId,this.cellMask,this.formatMask],s=[];for(e=0,t=this.pasteMappings.length;e<t;e++)s.push([this.pasteMappings[e].source.serialize(),this.pasteMappings[e].destination.serialize()]);return n.push(s),n}},{key:"getAffectedGridRanges",value:function(){return this.pasteMappings.map((function(e){return e.destination}))}},{key:"checkPasteMappings",value:function(e){var t=!0;return e.forEach((function(e){var n=e.source,s=e.destination;t&&(t=y(n,s))})),t}},{key:"filterPasteMappings",value:function(e){return e.filter((function(e){return y(e.source,e.destination)}))}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=[];return function(e){var t=new Map;return e.filter((function(e){return!t.has(e)&&t.set(e,1)}))}(this.pasteMappings.map((function(e){var t=e.source;e.destination;return t.sheetId}))).forEach((function(n){var s=e.sheetManager.getSheetBySheetId(n);s&&t.push(s)})),t}},{key:"generateSetRangeMutations",value:function(e){var t=e.getSheetId(),n=this.cellMask,s=this.formatMask;return this.pasteMappings.map((function(r){for(var o=r.source,a=r.destination,i=o.startColIndex,d=o.startRowIndex,u=a.startColIndex,l=a.endColIndex,h=a.startRowIndex,m=a.endRowIndex,f=u-i,g=h-d,p=[],x=h;x<=m;x++)for(var b=u;b<=l;b++){var y=e.getCellDataAtPosition(x-g,b-f),k=e.getCellDataAtPosition(x,b),O=R.createCellDataDelta({cellData:k,rowIndex:x-g,colIndex:b-f,sheetId:t},{cellData:y,rowIndex:x,colIndex:b,sheetId:t},n,s);O.clearSlot(I.CELL_DATA_SLOT.SLOT_MENTION),O.isEmpty()||p.push({rowIndex:x,colIndex:b,cellDataDelta:O})}return new c.a({gridRange:a,cellDataDeltaAtPositions:p})}))}},{key:"runOnSheet",value:function(e){this.generateSetRangeMutations(e).forEach((function(t){return e.spreadsheetReference.parent.mutationBehavior.applyMutation(t,{isLocal:!0},e)}))}},{key:"invert",value:function(e){var t=[],n=this.cellMask,r=this.formatMask;return this.pasteMappings.forEach((function(o){var a=o.source,i=o.destination,d=a.sheetId,u=a.startColIndex,l=a.startRowIndex,h=i.startColIndex,I=i.endColIndex,m=i.startRowIndex,f=i.endRowIndex,g=h-u,p=m-l,x=e.sheetManager.getSheetBySheetId(d);if(x){x.data.rowData;for(var b=[],y=m;y<=f;y++)for(var k=h;k<=I;k++){var O=x.getCellDataAtPosition(y-p,k-g),v=x.getCellDataAtPosition(y,k),T=R.createCellDataDelta({cellData:v,rowIndex:y-p,colIndex:k-g,sheetId:d},{cellData:O,rowIndex:y,colIndex:k,sheetId:d},n,r);T.isEmpty()||b.push({rowIndex:y,colIndex:k,cellDataDelta:T})}var w=new c.a({gridRange:i,cellDataDeltaAtPositions:b}).invert(e);t=[].concat(Object(s.a)(t),Object(s.a)(w))}})),t}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];return this.pasteMappings.forEach((function(t){var n=t.source,s=t.destination;(n=n.clone()).insertDimension(e),(s=s.clone()).insertDimension(e)})),[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=-2147483647;function r(e,t){return e==s?e:e+t}function o(e){return e!=s?e:2147483647}function a(e,t){return e.startIndex==e.endIndex&&e.startIndex!=s&&e.endIndex!=s&&t.startIndex==t.endIndex&&t.startIndex!=s&&t.endIndex!=s?e.endIndex<t.startIndex:o(e.endIndex)<=t.startIndex}function i(e,t){return t.startIndex==t.endIndex&&t.startIndex!=s&&t.endIndex!=s?e.startIndex==e.endIndex&&e.startIndex!=s&&e.endIndex!=s&&e.startIndex==t.startIndex:e.startIndex==e.endIndex&&e.startIndex!=s&&e.endIndex!=s?e.startIndex>=t.startIndex&&e.startIndex<o(t.endIndex):e.startIndex>=t.startIndex&&o(e.endIndex)<=o(t.endIndex)}function u(e,t){var n,s,d,u,l,h;return 0==(u=t.endIndex-t.startIndex)||a(e,t)?e:i(e,t)?(h=t.startIndex,new f(h,h)):(l=e.startIndex,n=e.endIndex,d=o(e.endIndex),e.startIndex<t.startIndex&&d>t.startIndex&&d<o(t.endIndex)?n=t.startIndex:i(t,e)?n=r(n,-u):(s=o(t.endIndex),t.startIndex<e.startIndex&&s>e.startIndex&&s<o(e.endIndex)?(l=t.startIndex,n=r(n,-u)):a(t,e)&&(l=r(l,-u),n=r(n,-u))),new f(l,n))}function l(e,t,n,s){var r,o,a;return c(t,e.sheetId)?(a=n==x.ROWS,(r=u(o=m(e,n),s))==o||r.startIndex==o.startIndex&&r.endIndex==o.endIndex?e:a?function(e,t){return new g(e.sheetId,e.startRowIndex,e.endRowIndex,t.startIndex,t.endIndex)}(e,r):function(e,t){return new g(e.sheetId,t.startIndex,t.endIndex,e.startColIndex,e.endColIndex)}(e,r)):e}function h(e){return null==e?null:e}function c(e,t){return h(e)===h(t)}var I=g;function m(e,t){var n=e.startRowIndex,s=e.endRowIndex,r=e.startColIndex,o=e.endColIndex;e.sheetId;return t===x.ROWS?new f(n,s):new f(r,o)}var f=function e(t,n){Object(d.a)(this,e),this.startIndex=t,this.endIndex=n};function R(e,t,n){return function(e,t,n,s){return t==x.ROWS?new I(e.sheetId,n,e.endRowIndex,s,e.endColIndex):new I(e.sheetId,e.startRowIndex,n,e.startColIndex,s)}(e,n,t.startIndex,t.endIndex)}function y(e,t,n){var s,r,o,a,i,d;return d=m(e.source,n),s=m(e.destination,n),o=R(e.source,new f(d.startIndex,d.startIndex+t),n),i=R(e.source,new f(d.startIndex+t,d.endIndex),n),r=R(e.destination,new f(s.startIndex,s.startIndex+t),n),a=R(e.destination,new f(s.startIndex+t,s.endIndex),n),{a:new b({source:o,destination:r}),c:new b({source:i,destination:a})}}function k(e,t,n,s){return s>e&&t>n||e==n&&t==s}var O=[];this.pasteMappings.forEach((function(t){var n=t.source,s=t.destination;(n=n.clone()).deleteDimension(e),(s=s.clone()).deleteDimension(e),function t(n,s,r){var o,a,i,d,u,h,I;if(e.type){var f=s.type==x.ROWS?x.ROWS:x.COLUMNS;d=new p(s.sheetId,s.index,s.index+s.amount,e.type),I=m(n.source,f),u=m(n.destination,f),i=s.sheetId,k(I.startIndex,I.endIndex,d.startIndex,d.endIndex)&&i===n.source.sheetId?d.startIndex>I.startIndex?(t((h=y(n,d.startIndex-I.startIndex,f)).a,s,r),t(h.c,s,r)):d.endIndex<I.endIndex&&(t((h=y(n,d.endIndex-I.startIndex,f)).a,s,r),t(h.c,s,r)):k(u.startIndex,u.endIndex,d.startIndex,d.endIndex)&&i===n.destination.sheetId?d.startIndex>u.startIndex?(t((h=y(n,d.startIndex-u.startIndex,f)).a,s,r),t(h.c,s,r)):d.endIndex<u.endIndex&&(t((h=y(n,d.endIndex-u.startIndex,f)).a,s,r),t(h.c,s,r)):(a=c(i,n.source.sheetId)?l(n.source,i,f,d):n.source,o=c(i,n.destination.sheetId)?l(n.destination,i,f,d):n.destination,r.push(new b({source:a,destination:o})))}else console.warn("copy paste mutation transform with dimensionMutation that is without dimension type")}(t,e,O)}));var v=0==O.length?null:new n({sheetId:this.sheetId,pasteMappings:O,cellMask:this.cellMask,formatMask:this.formatMask});return v?[v]:[]}},{key:"transformWithSetRangeMutation",value:function(e,t){if(this.sheetId!==e.gridRange.sheetId)return[this];var n=[];if(t)n.push(this);else if(this.sheetId!==e.gridRange.sheetId)n.push(this);else{for(var s=this.getAffectedGridRanges(),r=!1,o=0;o<s.length;o++){if(s[o].isCross(e.gridRange)){r=!0;break}}r?(n.push(this),n.push(e)):n.push(this)}return n}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){return this.sheetId,e.gridRange.sheetId,[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}}],[{key:"deserialize",value:function(e){var t,s,r={sheetId:e[0],cellMask:e[1],formatMask:e[2],pasteMappings:[]};for(t=0,s=e[3].length;t<s;t++)r.pasteMappings.push({source:g.deserialize(e[3][t][0]),destination:g.deserialize(e[3][t][1])});return new n(r)}}]),n}(h.a);k.protoMap={0:{name:"cellMask",dataType:Number},1:{name:"formatMask",dataType:Number},2:{name:"pasteMappings",dataType:{type:Array,subType:b}},3:{name:"sheetId",dataType:String}},t.b=k},"../packages/mutation/src/other/EmptyMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/mutation/src/MutationId.ts");function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var l=function(e){Object(o.a)(n,e);var t=u(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,d.b.EMPTY_MUTATION,e)).sheetId=e.sheetId,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}],[{key:"deserialize",value:function(e){return new n({sheetId:""})}}]),n}(n("../packages/mutation/src/Mutation.ts").a);t.a=l},"../packages/mutation/src/other/InitDataMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/mutation/src/MutationId.ts");function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var l=function(e){Object(o.a)(n,e);var t=u(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,d.b.INIT_DATA_MUTATION,e)).sheetId=e.sheetId,r.lastRow=e.lastRow,r.lastCol=e.lastCol,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],lastRow:e[1],lastCol:e[2]})}}]),n}(n("../packages/mutation/src/Mutation.ts").a);t.a=l},"../packages/mutation/src/other/MapRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),c=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts"),I=n("../packages/mutation/src/conditionalFormat/UpdateConditionalFormatMutation.ts");function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var f=d.Dimension.DIMENSION_TYPE,g=d.Range,p=g.DimensionRange,R=g.GridRange,x=d.Rule.ConditionalFormatRule,b={0:{name:"from",dataType:{type:Object,protoMap:{0:{name:"startIndex",dataType:Number},1:{name:"endIndex",dataType:Number}}}},1:{name:"to",dataType:Number},2:{name:"sourceSheetId",dataType:String},3:{name:"destinationSheetId",dataType:String}},y=function(e){Object(o.a)(n,e);var t=m(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.MAP_RANGE_MUTATION,e)).sourceSheetId=e.sourceSheetId,r.destinationSheetId=e.destinationSheetId,r.row=e.row,r.column=e.column,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sourceSheetId,this.destinationSheetId,[[this.row.from.startIndex,this.row.from.endIndex],this.row.to,this.row.sourceSheetId,this.row.destinationSheetId],[[this.column.from.startIndex,this.column.from.endIndex],this.column.to,this.column.sourceSheetId,this.column.destinationSheetId]]}},{key:"getAffectedSheetId",value:function(){return this.destinationSheetId}},{key:"getAffectedSheets",value:function(e){var t,n,s=[];return(t=e.sheetManager.getSheetBySheetId(this.sourceSheetId))&&s.push(t),(n=e.sheetManager.getSheetBySheetId(this.destinationSheetId))&&n!==t&&s.push(n),s}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){var e=[];return e.push(new n({sourceSheetId:this.destinationSheetId,destinationSheetId:this.sourceSheetId,row:k(this.row),column:k(this.column)})),e}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sourceSheetId!==e.sheetId)return[this];var s,r,o=[];if(s=e.type===f.ROWS?{from:{startIndex:this.row.from.startIndex,endIndex:this.row.from.endIndex},to:this.row.to,sourceSheetId:this.row.sourceSheetId,destinationSheetId:this.row.destinationSheetId}:{from:{startIndex:this.column.from.startIndex,endIndex:this.column.from.endIndex},to:this.column.to,sourceSheetId:this.column.sourceSheetId,destinationSheetId:this.column.destinationSheetId},e.sheetId===s.sourceSheetId&&((r=new p(s.sourceSheetId,s.from.startIndex,s.from.endIndex,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),s.from.startIndex=r.startIndex,s.from.endIndex=r.endIndex),e.sheetId===s.destinationSheetId){var a=s.to+(e.index<=s.from.startIndex?Math.max(e.index+e.amount-s.from.startIndex,0):0);(r=new p(s.destinationSheetId,a,a,e.type)).insertDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),s.to=r.startIndex}return o.push(new n({sourceSheetId:this.sourceSheetId,destinationSheetId:this.destinationSheetId,row:e.type===f.ROWS?s:this.row,column:e.type===f.COLUMNS?s:this.column})),o}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.sourceSheetId!==e.sheetId)return[this];var s,r,o=[];if(s=e.type===f.ROWS?{from:{startIndex:this.row.from.startIndex,endIndex:this.row.from.endIndex},to:this.row.to,sourceSheetId:this.row.sourceSheetId,destinationSheetId:this.row.destinationSheetId}:{from:{startIndex:this.column.from.startIndex,endIndex:this.column.from.endIndex},to:this.column.to,sourceSheetId:this.column.sourceSheetId,destinationSheetId:this.column.destinationSheetId},e.sheetId===s.sourceSheetId&&((r=new p(s.sourceSheetId,s.from.startIndex,s.from.endIndex,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),s.from.startIndex=r.startIndex,s.from.endIndex=r.endIndex),e.sheetId===s.destinationSheetId){var a=s.to+(e.index<=s.from.startIndex?Math.max(e.index+e.amount-s.from.startIndex,0):0);(r=new p(s.destinationSheetId,a,a,e.type)).deleteDimension({sheetId:e.sheetId,index:e.index,amount:e.amount,type:e.type}),s.to=r.startIndex}return o.push(new n({sourceSheetId:this.sourceSheetId,destinationSheetId:this.destinationSheetId,row:e.type===f.ROWS?s:this.row,column:e.type===f.COLUMNS?s:this.column})),o}},{key:"transformWithSetDimensionPropertiesMutation",value:function(e,t){if(this.sourceSheetId!==e.sheetId)return[this];var n,s,r,o,a,i,d=[],u=e.ranges,l=[];if(d.push(this),e.sheetId!==this.sourceSheetId)return d;for(e.type===f.ROWS?(s=new p(this.sourceSheetId,this.row.from.startIndex,this.row.from.endIndex,f.ROWS),a=this.row.to):(s=new p(this.sourceSheetId,this.column.from.startIndex,this.column.from.endIndex,f.COLUMNS),a=this.column.to),r=0;r<u.length;r++)(n=u[r]).isCross(s)&&(o=n.divideByCross(s)).cross&&(i=o.cross.move({from:{startIndex:s.startIndex,endIndex:s.endIndex},to:a}),Array.prototype.push.apply(l,i));return l.length>0&&d.push(new h.c({operation:e.operation,ranges:l,type:e.type,sheetId:e.sheetId})),d}},{key:"transformWithSetRangeMutation",value:function(e,t){return this.sourceSheetId,e.gridRange.sheetId,[this]}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){return this.sourceSheetId,e.gridRange.sheetId,[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){if(this.sourceSheetId!==e.sheetId)return[this];var n,s=[],r=this.destinationSheetId;return r!==e.sheetId?[this]:(n=new R(r,this.row.to,this.row.to,this.column.to,this.column.to),new R(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex).isCross(n)&&(this.row.from.startIndex===this.row.from.endIndex&&this.column.from.startIndex===this.column.from.endIndex&&this.row.to===e.startRowIndex&&this.column.to===e.endRowIndex||s.push(new c.a({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex}))),s.push(this),s)}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sourceSheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return this.sourceSheetId,e.sheetId,[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return this.sourceSheetId,e.sheetId,[this]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,t){var n=this;if(this.sourceSheetId!==e.sheetId)return[this];if(this.sourceSheetId===e.sheetId||this.destinationSheetId===e.sheetId){var s=[],r=[],o=[],a=[];return e.rule.ruleRanges.forEach((function(e){if(e.sheetId===n.sourceSheetId){var t=[],i=new R(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.from.startIndex,-1===n.row.to?e.endRowIndex:n.row.from.endIndex,-1===n.column.to?e.startColIndex:n.column.from.startIndex,-1===n.column.to?e.endColIndex:n.column.from.endIndex),d=e.getCross(i);d&&(t.push(d),r.push(d),a.push(new R(n.sourceSheetId,-1===n.row.to?d.startRowIndex:d.startRowIndex-n.row.from.startIndex+n.row.to,-1===n.row.to?d.endRowIndex:d.endRowIndex-n.row.from.startIndex+n.row.to,-1===n.column.to?d.startColIndex:d.startColIndex-n.column.from.startIndex+n.column.to,-1===n.column.to?d.endColIndex:d.endColIndex-n.column.from.startIndex+n.column.to)));var u=new R(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.to,-1===n.row.to?e.endRowIndex:n.row.to+n.row.from.endIndex-n.row.from.startIndex,-1===n.column.to?e.startColIndex:n.column.to,-1===n.column.to?e.endColIndex:n.column.to+n.column.from.endIndex-n.column.from.startIndex),l=e.getCross(u);l&&(t.push(l),o.push(l)),d||l?t.forEach((function(t){var n=e.startRowIndex,r=e.endRowIndex;e.startRowIndex<t.startRowIndex&&(s.push(new R(e.sheetId,e.startRowIndex,t.startRowIndex,e.startColIndex,e.endColIndex)),n=t.startRowIndex),t.endRowIndex<e.endRowIndex&&(s.push(new R(e.sheetId,t.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),r=t.endRowIndex),e.startColIndex<t.startColIndex&&s.push(new R(e.sheetId,n,r,e.startColIndex,t.endColIndex)),t.endColIndex<e.endColIndex&&s.push(new R(e.sheetId,n,r,t.endColIndex,e.endColIndex))})):s.push(e)}})),s.length>0||a.length>0?[this,new I.a({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new x({ruleRanges:[].concat(s,a),booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})]:[this]}return[this]}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,t){var n=this;if(this.sourceSheetId!==e.sheetId)return[this];if(this.sourceSheetId===e.sheetId||this.destinationSheetId===e.sheetId){var s=[],r=[],o=[],a=[];return e.rule.ruleRanges.forEach((function(e){if(e.sheetId===n.sourceSheetId){var t=[],i=new R(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.from.startIndex,-1===n.row.to?e.endRowIndex:n.row.from.endIndex,-1===n.column.to?e.startColIndex:n.column.from.startIndex,-1===n.column.to?e.endColIndex:n.column.from.endIndex),d=e.getCross(i);d&&(t.push(d),r.push(d),a.push(new R(n.sourceSheetId,-1===n.row.to?d.startRowIndex:d.startRowIndex-n.row.from.startIndex+n.row.to,-1===n.row.to?d.endRowIndex:d.endRowIndex-n.row.from.startIndex+n.row.to,-1===n.column.to?d.startColIndex:d.startColIndex-n.column.from.startIndex+n.column.to,-1===n.column.to?d.endColIndex:d.endColIndex-n.column.from.startIndex+n.column.to)));var u=new R(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.to,-1===n.row.to?e.endRowIndex:n.row.to+n.row.from.endIndex-n.row.from.startIndex,-1===n.column.to?e.startColIndex:n.column.to,-1===n.column.to?e.endColIndex:n.column.to+n.column.from.endIndex-n.column.from.startIndex),l=e.getCross(u);l&&(t.push(l),o.push(l)),d||l?t.forEach((function(t){var n=e.startRowIndex,r=e.endRowIndex;e.startRowIndex<t.startRowIndex&&(s.push(new R(e.sheetId,e.startRowIndex,t.startRowIndex,e.startColIndex,e.endColIndex)),n=t.startRowIndex),t.endRowIndex<e.endRowIndex&&(s.push(new R(e.sheetId,t.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),r=t.endRowIndex),e.startColIndex<t.startColIndex&&s.push(new R(e.sheetId,n,r,e.startColIndex,t.endColIndex)),t.endColIndex<e.endColIndex&&s.push(new R(e.sheetId,n,r,t.endColIndex,e.endColIndex))})):s.push(e)}})),s.length>0||a.length>0?[this,new I.a({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new x({ruleRanges:[].concat(s,a),booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})]:[this]}return[this]}}],[{key:"deserialize",value:function(e){return new n({sourceSheetId:e[0],destinationSheetId:e[1],row:{from:{startIndex:e[2][0][0],endIndex:e[2][0][1]},to:e[2][1],sourceSheetId:e[2][2],destinationSheetId:e[2][3]},column:{from:{startIndex:e[3][0][0],endIndex:e[3][0][1]},to:e[3][1],sourceSheetId:e[3][2],destinationSheetId:e[3][3]}})}}]),n}(l.a);function k(e){var t={from:{startIndex:0,endIndex:0},to:0,sourceSheetId:e.destinationSheetId,destinationSheetId:e.sourceSheetId};return t.from.startIndex=e.to,t.from.endIndex=e.to+(e.from.endIndex-e.from.startIndex),t.to=e.from.startIndex,t}y.protoMap={0:{name:"sourceSheetId",dataType:String},1:{name:"destinationSheetId",dataType:String},2:{name:"row",dataType:{type:Object,protoMap:b}},3:{name:"column",dataType:{type:Object,protoMap:b}}},t.a=y},"../packages/mutation/src/other/ReorderRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.splice.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/merge/UnmergeCellsMutation.ts"),c=n("../packages/model/src/sheet/sheetUtils.ts");function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var m=d.Dimension.DIMENSION_TYPE,f=d.Range.GridRange,g={0:{name:"queue",dataType:{type:Array,subType:String}},1:{name:"rules",dataType:{type:Object,subType:{type:Object,protoMap:{0:{name:"from",dataType:Number},1:{name:"to",dataType:Number}}}}}},p=function(e){Object(o.a)(n,e);var t=I(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.REORDER_RANGE_MUTATION,e)).sheetId=e.sheetId,r.range=e.range,r.operation=e.operation,r}return Object(r.a)(n,[{key:"serialize",value:function(){var e,t,n=[this.sheetId,this.range.serialize()],s=[];s.push(this.operation.queue),s.push({});var r=Object.keys(this.operation.rules);for(e=0,t=r.length;e<t;e++)s[1][r[e]]=[this.operation.rules[r[e]].from,this.operation.rules[r[e]].to];return n.push(s),n}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"runOnSheet",value:function(e){for(var t=[],n=0;n<this.operation.queue.length;n++)t.push(this.operation.rules[this.operation.queue[n]]);Object(c.moveRange)(e,this.range,t)}},{key:"invert",value:function(e){var t=[];t=t.concat(this.reset());var n=e.parent,s=n&&n.calcController;if(s){var r=s.getInvertMutationsForRowReorderMutation(this);t=t.concat(r)}return t}},{key:"reset",value:function(){var e,t,s=[],r={queue:[],rules:{}},o=this.operation.queue,a=this.operation.rules;for(e=0;e<o.length;e++)t=a[o[e]],r.queue.push("".concat(t.to)),r.rules["".concat(t.to)]={from:t.to,to:t.from};return s.push(new n({range:this.range,sheetId:this.sheetId,operation:r})),s}},{key:"getOrderResult",value:function(e){var t,n;for(t=0,n=this.operation.queue.length;t<n;t++)if(e===Number(this.operation.queue[t]))return this.operation.rules[e].to;return null}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s,r,o=[],a=JSON.parse(JSON.stringify(this.operation)),i=a.queue,d=a.rules,u=this.range.clone();if(u.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),e.type===m.ROWS)for(r=0;r<i.length;r++)(s=d[i[r]]).from>=e.index&&(s.from+=e.amount,delete d[i[r]],i[r]="".concat(s.from),d[i[r]]=s),s.to>=e.index&&(s.to+=e.amount);return o.push(new n({range:u,sheetId:this.sheetId,operation:a})),o}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s,r,o=[],a=JSON.parse(JSON.stringify(this.operation)),i=a.queue,d=a.rules,u=this.range.clone();if(u.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),e.type===m.COLUMNS){if(!u.isValid())return o}else for(r=0;r<i.length;r++)(s=d[i[r]]).from>=e.index&&(s.from<=e.index+e.amount-1?(delete d[i[r]],i.splice(r,1)):s.from-=e.amount);return o.push(new n({range:u,sheetId:this.sheetId,operation:a})),o}},{key:"transformWithSetRangeMutation",value:function(e,t){return this.sheetId,e.gridRange.sheetId,[this]}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){return this.sheetId,e.gridRange.sheetId,[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[],s=e.startRowIndex,r=e.endRowIndex,o=e.startColIndex,a=e.endColIndex,i=e.sheetId,d=new f(i,s,r,o,a);return i===this.sheetId&&d.isCross(this.range)&&n.push(new h.a({sheetId:i,startRowIndex:s,endRowIndex:r,startColIndex:o,endColIndex:a})),n.push(this),n}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=[];return this.range.isCross(e.range)?t&&(n=n.concat(e.reset())).push(this):n.push(this),n}}],[{key:"deserialize",value:function(e){var t,s,r={sheetId:e[0],range:f.deserialize(e[1]),operation:{queue:e[2][0],rules:{}}},o=Object.keys(e[2][1]);for(t=0,s=o.length;t<s;t++)r.operation.rules[o[t]]={from:e[2][1][o[t]][0],to:e[2][1][o[t]][1]};return new n(r)}}]),n}(l.a);p.protoMap={0:{name:"sheetId",dataType:String},1:{name:"range",dataType:f},2:{name:"operation",dataType:{type:Object,protoMap:g}}},t.a=p},"../packages/mutation/src/other/mapRangeMutationUtil.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n("../packages/model/src/index.ts").Dimension.DIMENSION_TYPE;function r(e,t){var n,r=!1;return-1!==(n=e===s.ROWS?t.row:t.column).from.startIndex&&-1!==n.from.endIndex&&(r=!0),r}},"../packages/mutation/src/sheet/BaseMultiSheetMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/report/src/index.ts"),u=n("../packages/mutation/src/config/report.ts");function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var h=function(e){Object(o.a)(n,e);var t=l(n);function n(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(s.a)(this,n),t.call(this,e,r)}return Object(r.a)(n,[{key:"serialize",value:function(){return[]}},{key:"isMultiSheetMutation",value:function(){return!0}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return""}},{key:"invert",value:function(e){return[]}},{key:"run",value:function(e,t){var n={isValid:!1,errorMessage:"\u9ed8\u8ba4\u9519\u8bef"};return"undefined"!==typeof e.getSpreadsheetId&&(this.runOnWorkbook(e),n=this.checkAndRunOnSheet(e,t)),{runResult:n,runCache:[],workbookWithSheetId:void 0,isMultiSheet:!0}}},{key:"check",value:function(){return{isValid:!0}}},{key:"runOnSheet",value:function(e){}},{key:"checkAndRunOnSheet",value:function(e,t){var n=+new Date,s={isValid:!1,errorMessage:"\u9ed8\u8ba4\u9519\u8bef"},r=!1;try{s=this.check()}catch(o){d.b.run(u.b.CHECK_MUTATION_ERROR,this,o,s)}if(!s.isValid&&(d.b.run(u.b.CHECK_MUTATION_RESULT_ERROR,this,s),!t.ignoreCheck))return s;try{this.runOnSheet(e)}catch(o){console.error("Run mutation error: ",this,o),d.b.run(u.b.RUN_MUTATION_ERROR,o,this),o.message&&0===o.message.indexOf("ApiCheckError")||(r=!0)}return d.b.speed.hasDonePagePerformanceReport()||d.b.speed.runReport(u.c.MUTATIONS_RUN,n,+new Date,!0),{isValid:!r,errorMessage:r?"\u6709\u9047\u5230mutation\u8fd0\u884c\u9519\u8bef":void 0}}}]),n}(n("../packages/mutation/src/Mutation.ts").a);t.a=h},"../packages/mutation/src/sheet/DefineSheetRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/sheet/DeleteSheetRangeMutation.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}d.Dimension.DIMENSION_TYPE;var I=d.Range,m=I.GridRange,f=I.SheetRange,g=function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.DEFINE_SHEET_RANGE_MUTATION,e)).sheetId=e.sheetId,r.sheetRangeId=e.sheetRangeId,r.gridRange=e.gridRange,r.sheetRangeType=e.sheetRangeType,r.nonPersistingLocalChange=e.nonPersistingLocalChange||!1,r.padId=e.padId,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.sheetRangeId,this.gridRange.serialize(),this.sheetRangeType,this.padId]}},{key:"isNonPersistedLocalChange",value:function(){return this.nonPersistingLocalChange}},{key:"getAffectedSheetId",value:function(){return this.gridRange.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){var t=new f({sheetId:this.sheetId,gridRange:this.gridRange,sheetRangeType:this.sheetRangeType,padId:this.padId});e.sheetRangeManager.addSheetRange(this.sheetRangeId,t)}},{key:"invert",value:function(e){return[new h.a({sheetId:this.sheetId,sheetRangeId:this.sheetRangeId,nonPersistingLocalChange:this.nonPersistingLocalChange})]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=this.gridRange;return s.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new n({sheetRangeId:this.sheetRangeId,gridRange:s,sheetRangeType:this.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,sheetId:this.sheetId,padId:this.padId})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var s=this.gridRange;return s.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new n({sheetRangeId:this.sheetRangeId,gridRange:s,sheetRangeType:this.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,sheetId:this.sheetId,padId:this.padId})]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return this.sheetId,e.data.sheetId,[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return this.sheetId,e.data.sheetId,[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];if(t){var n=e.gridRange;if(this.gridRange.isCross(n)&&this.sheetRangeType===e.sheetRangeType)return[]}return[this]}},{key:"transformWithDeleteSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){return this.sheetId,e.sourceSheetId,[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],sheetRangeId:e[1],gridRange:m.deserialize(e[2]),sheetRangeType:e[3],padId:e[4]})}}]),n}(l.a);g.protoMap={0:{name:"sheetId",dataType:String},1:{name:"sheetRangeId",dataType:String},2:{name:"gridRange",dataType:m},3:{name:"sheetRangeType",dataType:Number},5:{name:"padId",dataType:String}},t.a=g},"../packages/mutation/src/sheet/DeleteSheetMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/sheet/BaseMultiSheetMutation.ts"),h=n("../packages/mutation/src/sheet/InsertSheetMutation.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=d.Sheet,m=I.SheetPropertiesDelta,f=I.NEW_SHEET_PROPERTIES_SLOT_OPERATION,g=function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.DELETE_SHEET_MUTATION,e)).sheetId=e.sheetId,r.sheetIndex=e.sheetIndex,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.sheetIndex]}},{key:"getAffectedSheets",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(){return{isValid:!0}}},{key:"transformWithInsertSheetMutation",value:function(e,t){if(this.sheetIndex>=e.sheetIndex&&t){var s=this.sheetIndex+1;return[new n({sheetId:this.sheetId,sheetIndex:s})]}return[this]}},{key:"transformWithMoveSheetMutation",value:function(e,t){var s;return e.fromIndex===this.sheetIndex&&t?(s=e.toIndex,[new n({sheetId:this.sheetId,sheetIndex:s})]):e.fromIndex<this.sheetIndex&&e.toIndex>this.sheetIndex&&t?(s=this.sheetIndex-1,[new n({sheetId:this.sheetId,sheetIndex:s})]):e.fromIndex>this.sheetIndex&&e.toIndex<=this.sheetIndex&&t?(s=this.sheetIndex+1,[new n({sheetId:this.sheetId,sheetIndex:s})]):[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){if(this.sheetIndex>e.sheetIndex){var s=this.sheetIndex-1;return[new n({sheetId:this.sheetId,sheetIndex:s})]}return t&&this.sheetIndex===e.sheetIndex?[]:[this]}},{key:"runOnSheet",value:function(e){e.sheetManager.deleteSheetBySheetId(this.sheetId)}},{key:"invert",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[new h.a({sheetId:this.sheetId,sheetIndex:this.sheetIndex,sheetType:t.getSheetType(),rowCount:t.getRowCount(),colCount:t.getColCount(),sheetDelta:new m({operation:f.INSERT_SHEET,delta:{name:t.getTitle(),rightToLeft:t.getIsRtl(),hideGridline:t.getHideGridlines(),frozenColCount:t.getFrozenColCount(),frozenRowCount:t.getFrozenRowCount(),hidden:t.getDisplayHidden()}})})]:[]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],sheetIndex:e[1]})}}]),n}(l.a);t.a=g},"../packages/mutation/src/sheet/DeleteSheetRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/mutation/src/MutationId.ts"),u=n("../packages/mutation/src/Mutation.ts"),l=n("../packages/mutation/src/sheet/DefineSheetRangeMutation.ts"),h=n("../packages/mutation/src/sheet/DeleteSheetRangeMutation.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,d.b.DELETE_SHEET_RANGE_MUTATION,e)).sheetId=e.sheetId,r.sheetRangeId=e.sheetRangeId,r.nonPersistingLocalChange=e.nonPersistingLocalChange||!1,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.sheetRangeId]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){e.sheetRangeManager.deleteSheetRange(this.sheetRangeId)}},{key:"invert",value:function(e){var t,n=e.sheetManager.getSheetBySheetId(this.sheetId),s=[];return null===n?s:(t=n.sheetRangeManager.getSheetRange(this.sheetRangeId))?(s.push(new l.a({sheetId:this.sheetId,sheetRangeId:this.sheetRangeId,gridRange:t.gridRange,sheetRangeType:t.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,padId:t.padId})),s):s}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithDeleteSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}}],[{key:"deserialize",value:function(e){return new h.a({sheetId:e[0],sheetRangeId:e[1]})}}]),n}(u.a);I.protoMap={0:{name:"sheetId",dataType:String},1:{name:"sheetRangeId",dataType:String}},t.a=I},"../packages/mutation/src/sheet/InsertSheetMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),i=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=n("../packages/model/src/index.ts"),l=n("../packages/mutation/src/MutationId.ts"),h=n("../packages/mutation/src/sheet/BaseMultiSheetMutation.ts"),c=n("../packages/mutation/src/sheet/DeleteSheetMutation.ts"),I=n("../packages/mutation/src/sheet/SetSheetPropertiesMutation.ts"),m=n("../packages/mutation/src/utils/sheetMutationUtil.ts");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(s.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(i.a)(this,n)}}var R=u.Sheet,x=R.SheetPropertiesDelta,b=R.sheetPropertiesDeltaUtils,y=R.NEW_SHEET_PROPERTIES_SLOT,k=R.NEW_SHEET_PROPERTIES_SLOT_OPERATION,O=function(e){Object(a.a)(n,e);var t=p(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,l.b.INSERT_SHEET_MUTATION,e)).sheetId=e.sheetId,s.sheetIndex=e.sheetIndex,s.sheetType=e.sheetType,s.rowCount=e.rowCount,s.colCount=e.colCount,s.sheetDelta=e.sheetDelta,s}return Object(o.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.sheetIndex,this.sheetType,this.sheetDelta.serialize(),this.rowCount,this.colCount]}},{key:"getAffectedSheets",value:function(e){var t=e.sheetManager.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(){return{isValid:!0}}},{key:"runOnSheet",value:function(e){var t=e.sheetManager.createSheet({id:this.sheetId,type:this.sheetType});t.setIndex(this.sheetIndex),b.mergeDeltaToSheetProperties(t.properties,this.sheetDelta),e.sheetManager.insertSheet(t,this.sheetIndex)}},{key:"transformWithInsertSheetMutation",value:function(e,t){var s,r=this,o=this.sheetIndex,a=[];return this.sheetDelta.deltas.forEach((function(i){e.sheetDelta.deltas.forEach((function(d){i.slotName===y.SLOT_NAME&&d.slotName===y.SLOT_NAME&&i.value===d.value&&(t?(s=Object(m.a)(r,e),r.sheetIndex>=e.sheetIndex&&(o=r.sheetIndex+1),a.push(new n(g(g({},r),{},{sheetIndex:o,sheetDelta:s})))):(s=Object(m.a)(e,r),e.sheetIndex>=r.sheetIndex&&(o=e.sheetIndex+1),a.push(new I.a(g(g({},e),{},{sheetIndex:o,sheetDelta:s})),r)))}))})),a.length?a:[this]}},{key:"transformWithMoveSheetMutation",value:function(e,t){var s;return e.fromIndex<this.sheetIndex&&e.toIndex>this.sheetIndex&&t?(s=this.sheetIndex-1,[new n({sheetId:this.sheetId,sheetIndex:s,sheetType:this.sheetType,sheetDelta:this.sheetDelta,rowCount:this.rowCount,colCount:this.colCount})]):e.fromIndex>this.sheetIndex&&e.toIndex<this.sheetIndex&&t?(s=this.sheetIndex+1,[new n({sheetId:this.sheetId,sheetIndex:s,sheetType:this.sheetType,sheetDelta:this.sheetDelta,rowCount:this.rowCount,colCount:this.colCount})]):[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){if(this.sheetIndex>e.sheetIndex){var s=this.sheetIndex-1;return[new n({sheetId:this.sheetId,sheetIndex:s,sheetType:this.sheetType,sheetDelta:this.sheetDelta,rowCount:this.rowCount,colCount:this.colCount})]}return[this]}},{key:"transformWithSetSheetPropertiesMutation",value:function(e,t){var s=this,r=[];return e.sheetDelta&&e.sheetDelta.deltas.forEach((function(o){s.sheetDelta.deltas.forEach((function(a){if(a.slotName===y.SLOT_NAME&&o.slotName===y.SLOT_NAME&&a.value===o.value)if(t){var i=Object(m.a)(s,e);r.push(new n(g(g({},s),{},{sheetDelta:i})))}else{var d="".concat(o.value,"_\u81ea\u52a8\u91cd\u547d\u540d").concat(e.sheetId);r.push(new I.a({sheetId:e.sheetId,sheetDelta:new x({operation:k.SET_PROPERTIES,delta:{name:d}})}),s)}}))})),r.length?r:[this]}},{key:"invert",value:function(){return[new c.a({sheetId:this.sheetId,sheetIndex:this.sheetIndex})]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],sheetIndex:e[1],sheetType:e[2],sheetDelta:x.deserialize(e[3]),rowCount:e[4],colCount:e[5]})}}]),n}(h.a);t.a=O},"../packages/mutation/src/sheet/MoveSheetMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/mutation/src/MutationId.ts");function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var l=function(e){Object(o.a)(n,e);var t=u(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,d.b.MOVE_SHEET_MUTATION,e)).fromIndex=e.fromIndex,r.toIndex=e.toIndex,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.fromIndex,this.toIndex]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return""}},{key:"check",value:function(){return{isValid:!0}}},{key:"transformWithInsertSheetMutation",value:function(e,t){var s;if(t){if(e.sheetIndex<=this.fromIndex&&this.fromIndex<this.toIndex||e.sheetIndex<=this.toIndex&&this.fromIndex>this.toIndex)return[new n({fromIndex:this.fromIndex+1,toIndex:s=this.toIndex+1})];if(e.sheetIndex<=this.toIndex&&e.sheetIndex>this.fromIndex)return s=this.toIndex+1,[new n({fromIndex:this.fromIndex,toIndex:s})];if(e.sheetIndex<this.fromIndex&&e.sheetIndex>this.toIndex)return[new n({fromIndex:this.fromIndex+1,toIndex:this.toIndex})]}return[this]}},{key:"transformWithMoveSheetMutation",value:function(e,t){return this.fromIndex===e.fromIndex&&this.toIndex!=e.toIndex?t?[new n({fromIndex:e.toIndex,toIndex:this.toIndex})]:[]:this.fromIndex===e.fromIndex&&this.toIndex===e.toIndex?[]:this.fromIndex<this.toIndex?e.fromIndex<e.toIndex?this.transformWithMoveSheetMutationScenes1(e):this.transformWithMoveSheetMutationScenes2(e):this.fromIndex>this.toIndex?e.fromIndex>e.toIndex?this.transformWithMoveSheetMutationScenes3(e):this.transformWithMoveSheetMutationScenes4(e):[this]}},{key:"transformWithMoveSheetMutationScenes1",value:function(e){var t;return e.toIndex<this.fromIndex||e.fromIndex>this.toIndex||this.fromIndex<e.fromIndex&&e.toIndex<this.toIndex?[this]:e.fromIndex<this.fromIndex&&this.toIndex<=e.toIndex?[new n({fromIndex:this.fromIndex-1,toIndex:t=this.toIndex-1})]:e.fromIndex<this.fromIndex&&this.fromIndex<e.toIndex&&e.toIndex<this.toIndex?[new n({fromIndex:this.fromIndex-1,toIndex:this.toIndex})]:this.fromIndex<e.fromIndex&&e.fromIndex<this.toIndex&&this.toIndex<=e.toIndex?(t=this.toIndex-1,[new n({fromIndex:this.fromIndex,toIndex:t})]):[this]}},{key:"transformWithMoveSheetMutationScenes2",value:function(e){var t;return e.fromIndex<this.fromIndex||e.toIndex>this.toIndex||this.fromIndex<e.toIndex&&e.fromIndex<this.toIndex?[this]:e.toIndex<=this.fromIndex&&this.toIndex<e.fromIndex?[new n({fromIndex:this.fromIndex+1,toIndex:t=this.toIndex+1})]:e.toIndex<this.fromIndex&&this.fromIndex<e.fromIndex&&e.fromIndex<this.fromIndex||this.fromIndex===e.toIndex&&this.toIndex===e.fromIndex?[new n({fromIndex:this.fromIndex+1,toIndex:this.toIndex})]:this.fromIndex<=e.toIndex&&e.toIndex<this.toIndex&&this.fromIndex<e.toIndex?(t=this.toIndex+1,[new n({fromIndex:this.fromIndex,toIndex:t})]):[this]}},{key:"transformWithMoveSheetMutationScenes3",value:function(e){var t;return e.toIndex>this.fromIndex||e.fromIndex<this.toIndex||this.toIndex<e.toIndex&&e.fromIndex<this.fromIndex?[this]:e.toIndex<=this.toIndex&&this.fromIndex<e.fromIndex?[new n({fromIndex:this.fromIndex+1,toIndex:t=this.toIndex+1})]:this.toIndex<e.toIndex&&e.toIndex<this.fromIndex&&this.fromIndex<=e.fromIndex?[new n({fromIndex:this.fromIndex+1,toIndex:this.toIndex})]:e.toIndex<=this.toIndex&&this.toIndex<e.fromIndex&&e.fromIndex<this.fromIndex?(t=this.toIndex+1,[new n({fromIndex:this.fromIndex,toIndex:t})]):[this]}},{key:"transformWithMoveSheetMutationScenes4",value:function(e){var t;return e.fromIndex>this.fromIndex||e.toIndex<this.toIndex||this.toIndex<e.fromIndex&&e.toIndex<this.fromIndex?[this]:e.fromIndex<this.toIndex&&this.fromIndex<e.toIndex?[new n({fromIndex:this.fromIndex-1,toIndex:t=this.toIndex-1})]:e.fromIndex<this.toIndex&&e.toIndex<this.fromIndex?(t=this.toIndex-1,[new n({fromIndex:this.fromIndex,toIndex:t})]):this.toIndex<e.fromIndex&&e.fromIndex<this.fromIndex&&this.fromIndex<=e.toIndex||this.fromIndex===e.toIndex&&this.toIndex===e.fromIndex?[new n({fromIndex:this.fromIndex-1,toIndex:this.toIndex})]:[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){var s;if(t){if(this.fromIndex===e.sheetIndex)return[];if(e.sheetIndex<this.fromIndex&&this.fromIndex<this.toIndex||e.sheetIndex<this.toIndex&&this.fromIndex>this.toIndex)return[new n({fromIndex:this.fromIndex-1,toIndex:s=this.toIndex-1})];if(e.sheetIndex<=this.toIndex&&e.sheetIndex>this.fromIndex)return s=this.toIndex-1,[new n({fromIndex:this.fromIndex,toIndex:s})];if(e.sheetIndex<this.fromIndex&&e.sheetIndex>=this.toIndex)return[new n({fromIndex:this.fromIndex-1,toIndex:this.toIndex})]}return[this]}},{key:"runOnSheet",value:function(e){e.sheetManager.moveSheet(this.fromIndex,this.toIndex)}},{key:"invert",value:function(){return[new n({fromIndex:this.toIndex,toIndex:this.fromIndex})]}}],[{key:"deserialize",value:function(e){return new n({fromIndex:e[0],toIndex:e[1]})}}]),n}(n("../packages/mutation/src/sheet/BaseMultiSheetMutation.ts").a);t.a=l},"../packages/mutation/src/sheet/SetSheetPropertiesMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.every.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.includes.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),i=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),u=n("../packages/model/src/index.ts"),l=n("../packages/mutation/src/MutationId.ts"),h=n("../packages/mutation/src/Mutation.ts"),c=n("../packages/mutation/src/SlotOperation.ts"),I=n("../packages/mutation/src/utils/sheetMutationUtil.ts");function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){Object(s.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(i.a)(this,n)}}var p=u.Sheet,R=p.SheetPropertiesDelta,x=p.NEW_SHEET_PROPERTIES_SLOT_OPERATION,b=p.OLD_SHEET_PROPERTIES_SLOT,y=p.NEW_SHEET_PROPERTIES_SLOT,k=p.sheetPropertiesDeltaUtils,O=u.Dimension.DIMENSION_TYPE,v=u.Range.DimensionRange,T=function(e){Object(a.a)(n,e);var t=g(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,l.b.SET_SHEET_PROPERTIES_MUTATION,e)).type=e.type,s.slotOperation=null!=e.slotOperation?e.slotOperation:c.a.SET_SLOT,s.value=e.value,s.sheetId=e.sheetId,s.sheetDelta=e.sheetDelta,s}return Object(o.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.type,,,this.sheetDelta?this.sheetDelta.serialize():null]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=[],n=e.sheetManager.getSheetBySheetId(this.sheetId);return n&&t.push(n),t}},{key:"runOnSheet",value:function(e){if(this.sheetDelta)k.mergeDeltaToSheetProperties(e.properties,this.sheetDelta);else if(this.type)switch(this.type){case b.SLOT_FROZEN_ROWS:e.setFrozenRowCount(this.value);break;case b.SLOT_FROZEN_COLUMNS:e.setFrozenColCount(this.value);break;case b.SLOT_HIDE_GRIDLINES:e.setHideGridlines(this.value);break;case b.SLOT_NAME:e.setTitle(this.value);break;case b.SLOT_NUMBER_OF_COLUMNS:e.setColCount(this.value);break;case b.SLOT_NUMBER_OF_ROWS:e.setRowCount(this.value)}}},{key:"invert",value:function(e){var t=[],s=e.sheetManager.getSheetBySheetId(this.sheetId);if(null===s)return t;if(!this.sheetDelta){switch(this.type){case b.SLOT_FROZEN_ROWS:t.push(new n({type:b.SLOT_FROZEN_ROWS,value:s.getFrozenRowCount(),sheetId:this.sheetId}));break;case b.SLOT_FROZEN_COLUMNS:t.push(new n({type:b.SLOT_FROZEN_COLUMNS,value:s.getFrozenColCount(),sheetId:this.sheetId}));break;case b.SLOT_HIDE_GRIDLINES:t.push(new n({type:b.SLOT_HIDE_GRIDLINES,value:s.getHideGridlines(),sheetId:this.sheetId}));break;case b.SLOT_NAME:t.push(new n({type:b.SLOT_NAME,value:s.getTitle(),sheetId:this.sheetId}))}return t}var r=this.getSetSheetPropertiesMutation(this.sheetDelta.deltas,s);return t.push(r),t}},{key:"getSetSheetPropertiesMutation",value:function(e,t){var s={};return e.forEach((function(e){switch(e.slotName){case y.SLOT_NAME:s.name=t.getTitle();break;case y.SLOT_RIGHT_TO_LEFT:s.rightToLeft=t.getIsRtl();break;case y.SLOT_ROW_COUNT:s.rowCount=t.getRowCount();break;case y.SLOT_COL_COUNT:s.colCount=t.getColCount();break;case y.SLOT_FROZEN_ROW_COUNT:s.frozenRowCount=t.properties.gridProperties.frozenRowCount;break;case y.SLOT_FROZEN_COL_COUNT:s.frozenColCount=t.properties.gridProperties.frozenColCount;break;case y.SLOT_HIDE_GRID_LINE:s.hideGridline=t.getHideGridlines();break;case y.SLOT_HIDE:s.hidden=t.getDisplayHidden();break;case y.SLOT_TAB_COLOR:s.tabColor=t.getTabColor().toHex()}})),new n({sheetId:this.sheetId,sheetDelta:new R({operation:x.SET_PROPERTIES,delta:s})})}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];if(this.sheetDelta){for(var s=this.sheetDelta.clone(),r=0,o=s.deltas.length;r<o;r++)if(s.deltas[r].slotName===y.SLOT_FROZEN_COL_COUNT&&e.type===O.COLUMNS){var a=s.deltas[r].value,i=new v(this.sheetId,a,a,O.COLUMNS);i.insertDimension({sheetId:e.sheetId,type:O.COLUMNS,index:e.index,amount:e.amount}),s.deltas[r].value=i.startIndex}else if(s.deltas[r].slotName===y.SLOT_FROZEN_ROW_COUNT&&e.type===O.ROWS){var d=s.deltas[r].value,u=new v(this.sheetId,d,d,O.ROWS);u.insertDimension({sheetId:e.sheetId,type:O.ROWS,index:e.index,amount:e.amount}),s.deltas[r].value=u.startIndex}return[new n({sheetDelta:s,sheetId:this.sheetId})]}var l=this.value;if(this.type===b.SLOT_FROZEN_COLUMNS&&e.type===O.COLUMNS){if(!(l>=e.index))return[this];var h=new v(this.sheetId,l,l,O.COLUMNS);h.insertDimension({sheetId:e.sheetId,type:O.COLUMNS,index:e.index,amount:e.amount}),l=h.startIndex}else{if(this.type!==b.SLOT_FROZEN_ROWS||e.type!==O.ROWS)return[this];if(!(l>=e.index))return[this];var c=new v(this.sheetId,l,l,O.ROWS);c.insertDimension({sheetId:e.sheetId,type:O.ROWS,index:e.index,amount:e.amount}),l=c.startIndex}return[new n({type:this.type,value:l,sheetId:this.sheetId})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];if(this.sheetDelta){for(var s=this.sheetDelta.clone(),r=0,o=s.deltas.length;r<o;r++)if(s.deltas[r].slotName===y.SLOT_FROZEN_COL_COUNT&&e.type===O.COLUMNS){var a=s.deltas[r].value,i=new v(this.sheetId,a,a,O.COLUMNS);i.deleteDimension({sheetId:e.sheetId,type:O.COLUMNS,index:e.index,amount:e.amount}),s.deltas[r].value=i.startIndex}else if(s.deltas[r].slotName===y.SLOT_FROZEN_ROW_COUNT&&e.type===O.ROWS){var d=s.deltas[r].value,u=new v(this.sheetId,d,d,O.ROWS);u.deleteDimension({sheetId:e.sheetId,type:O.ROWS,index:e.index,amount:e.amount}),s.deltas[r].value=u.startIndex}return[new n({sheetDelta:s,sheetId:this.sheetId})]}var l=this.value;if(this.type===b.SLOT_FROZEN_COLUMNS&&e.type===O.COLUMNS){var h=new v(this.sheetId,l,l,O.COLUMNS);h.deleteDimension({sheetId:e.sheetId,type:O.COLUMNS,index:e.index,amount:e.amount}),l=h.startIndex}else{if(this.type!==b.SLOT_FROZEN_ROWS||e.type!==O.ROWS)return[this];var c=new v(this.sheetId,l,l,O.ROWS);c.deleteDimension({sheetId:e.sheetId,type:O.ROWS,index:e.index,amount:e.amount}),l=c.startIndex}return[new n({type:this.type,value:l,sheetId:this.sheetId})]}},{key:"transformWithSetSheetPropertiesMutation",value:function(e,t){var s=[];if(this.sheetDelta)if(this.isConflict(e))for(var r=0;r<this.sheetDelta.deltas.length;r++)for(var o=this.sheetDelta.deltas[r],a=0;a<e.sheetDelta.deltas.length;a++){var i=e.sheetDelta.deltas[a];if(o.slotOperation===i.slotOperation)switch(o.slotName){case y.SLOT_NAME:if(e.sheetId===this.sheetId)t&&s.push(this);else if(t){var d=Object(I.a)(this,e);s.push(new n(f(f({},this),{},{sheetDelta:d})))}else{var u=Object(I.a)(e,this);s.push(this,new n(f(f({},e),{},{sheetDelta:u})))}break;default:e.sheetId===this.sheetId&&t&&s.push(this)}}else s.push(this);else(e.type!==this.type||t)&&s.push(this);return s}},{key:"isConflict",value:function(e){if(e.sheetDelta&&this.sheetDelta){var t=e.sheetDelta.deltas.map((function(e){return e.slotOperation})),n=this.sheetDelta.deltas.map((function(e){return e.slotOperation}));return t.every((function(e){return n.includes(e)}))}return!1}},{key:"transformWithInsertSheetMutation",value:function(e,t){var s=[];if(this.sheetDelta)for(var r=0;r<this.sheetDelta.deltas.length;r++)for(var o=this.sheetDelta.deltas[r],a=0;a<e.sheetDelta.deltas.length;a++){var i=e.sheetDelta.deltas[a];if(o.slotName===y.SLOT_NAME&&o.value===i.value)if(t){var d=Object(I.a)(this,e);s.push(new n(f(f({},this),{},{sheetDelta:d})))}else{var u="".concat(i.value,"_\u81ea\u52a8\u91cd\u547d\u540d").concat(e.sheetId);s.push(new n({sheetId:e.sheetId,sheetDelta:new R({operation:x.SET_PROPERTIES,delta:{name:u}})}),this)}}return s.length?s:[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],type:e[1],slotOperation:e[2],value:e[3],sheetDelta:e[4]?R.deserialize(e[4]):void 0})}}]),n}(h.a);T.protoMap={0:{name:"sheetId",dataType:String},1:{name:"type",dataType:Number},2:{name:"value",dataType:String},3:{name:"sheetDelta",dataType:R}},t.a=T},"../packages/mutation/src/sheet/UpdateAllSheetsMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/mutation/src/MutationId.ts");function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var l=function(e){Object(o.a)(n,e);var t=u(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,d.b.UPDATE_ALL_SHEETS_MUTATION,e)).sheetId=e.sheetId,r.data=e.data,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}]),n}(n("../packages/mutation/src/Mutation.ts").a);t.a=l},"../packages/mutation/src/sheet/UpdateSheetRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts");function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var c=d.Range,I=c.GridRange,m=c.SheetRange,f=function(e){Object(o.a)(n,e);var t=h(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.UPDATE_SHEET_RANGE_MUTATION,e)).sheetId=e.sheetId,r.sheetRangeId=e.sheetRangeId,r.gridRange=e.gridRange,r.sheetRangeType=e.sheetRangeType,r.nonPersistingLocalChange=e.nonPersistingLocalChange||!1,r.padId=e.padId,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.sheetId,this.sheetRangeId,this.gridRange.serialize(),this.sheetRangeType,this.padId]}},{key:"isNonPersistedLocalChange",value:function(){return this.nonPersistingLocalChange}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.sheetManager.getSheetBySheetId(this.gridRange.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){var t=this.gridRange.clone(),n=new m({sheetId:this.sheetId,gridRange:t,sheetRangeType:this.sheetRangeType,padId:this.padId});e.sheetRangeManager.updateSheetRange(this.sheetRangeId,n)}},{key:"invert",value:function(e){var t,s=e.sheetManager.getSheetBySheetId(this.sheetId),r=[];return null===s?r:(t=s.sheetRangeManager.getSheetRange(this.sheetRangeId))?(r.push(new n({sheetId:this.sheetId,sheetRangeId:this.sheetRangeId,gridRange:t.gridRange,sheetRangeType:this.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,padId:this.padId})),r):r}},{key:"transformWithInsertDimensionMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return this.sheetId,e.data.sheetId,[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return this.sheetId,e.data.sheetId,[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return this.sheetId!==e.sheetId?[this]:t?[]:[this]}},{key:"transformDefineSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformDeleteSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformUpdateSheetRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return this.sheetId,e.sheetId,[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){return this.sheetId,e.sourceSheetId,[this]}}],[{key:"deserialize",value:function(e){return new n({sheetId:e[0],sheetRangeId:e[1],gridRange:I.deserialize(e[2]),sheetRangeType:e[3],padId:e[4]})}}]),n}(l.a);f.protoMap={0:{name:"sheetId",dataType:String},1:{name:"sheetRangeId",dataType:String},2:{name:"gridRange",dataType:I},3:{name:"sheetRangeType",dataType:Number},5:{name:"padId",dataType:String}},t.a=f},"../packages/mutation/src/transform.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),r=n("../packages/mutation/src/config/version.ts");function o(e,t,n){var a,i,d,u,l,h,c,I,m,f=e;try{for(a=0,u=t.length;a<u;a++)if(h=[t[a]],c=[],0!==h.length){for(i=0,d=e.length;i<d;i++)l=e[i],h.length>1?(I=o([l],h,n),i<d-1&&(m=o(h,[l],!n))):1===h.length?(I=l.transform(h[0],n),l.version===r.a.MUTATION_VER_LOWEST_SUPPORT&&h[0].version===r.a.MUTATION_VER_LOWEST_SUPPORT&&I.forEach((function(e){e.version=r.a.MUTATION_VER_LOWEST_SUPPORT})),i<d-1&&(m=h[0].transform(l,!n),l.version===r.a.MUTATION_VER_LOWEST_SUPPORT&&h[0].version===r.a.MUTATION_VER_LOWEST_SUPPORT&&m.forEach((function(e){e.version=r.a.MUTATION_VER_LOWEST_SUPPORT})))):(I=[l],m=[]),i<d-1&&(h=m),c=[].concat(Object(s.a)(c),Object(s.a)(I));e=c}}catch(g){return console.error("transform two mutation array error: ",g),f}return f=e}},"../packages/mutation/src/utils/index.ts":function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return d}));n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");function s(e){return"[object Number]"===Object.prototype.toString.call(e)&&!isNaN(e)}function r(e,t){if(e===t)return!0;if("string"===typeof e||"number"===typeof e||"boolean"===typeof e)return e===(t=null==t?null:t);if((Array.isArray(e)||null==e)&&(Array.isArray(t)||null==t)){if(null==e||0===e.length)return null==t||0===t.length;if(null==t||e.length!==t.length)return!1;for(var n=0,s=e.length;n<s;n++)if(!r(e[n],t[n]))return!1;return!0}return null!=e&&"function"===typeof e.equals?e.equals(t):void 0}function o(e){return null==e?null:e}function a(e,t){return o(e)===o(t)}function i(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if(!Array.isArray(e[t]))return!1;return!0}return!1}function d(e){return"[object Array]"===Object.prototype.toString.call(e)}},"../packages/mutation/src/utils/sheetMutationUtil.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var s=n("../packages/model/src/index.ts").Sheet,r=s.SheetPropertiesDelta,o=s.NEW_SHEET_PROPERTIES_SLOT;function a(e,t){var n=e.sheetDelta&&e.sheetDelta.clone()||new r,s=t.sheetDelta&&t.sheetDelta.clone()||new r;return n.deltas.forEach((function(t){s.deltas.forEach((function(n){t.slotName===o.SLOT_NAME&&n.slotName===o.SLOT_NAME&&t.value===n.value&&(t.value="".concat(t.value,"_\u81ea\u52a8\u91cd\u547d\u540d").concat(e.sheetId))}))})),n}},"../packages/mutation/src/workbook/workbookRange/DefineWorkbookRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=d.WorkbookRange,m=I.WorkbookRangeDelta,f=I.WORKBOOK_RANGE_TYPE,g=I.ChartWorkbookRange,p=I.ProtectedRange,R=I.LinkedRange,x=d.Range.GridRange,b=(d.Dimension.DIMENSION_TYPE,function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.DEFINE_WORKBOOK_RANGE_MUTATION,e)).workbookRangeId=e.workbookRangeId,r.gridRange=e.gridRange,r.workbookRangeType=e.workbookRangeType,r.workbookRangePropertiesDelta=e.workbookRangePropertiesDelta,r.nonPersistingLocalChange=!!e.nonPersistingLocalChange,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.workbookRangeId,this.gridRange.serialize(),this.workbookRangeType,this.workbookRangePropertiesDelta.serialize()]}},{key:"clone",value:function(){return n.deserialize(this.serialize())}},{key:"getAffectedSheetId",value:function(){return"WORKBOOK"}},{key:"getAffectedSheets",value:function(){return[]}},{key:"isNonPersistedLocalChange",value:function(){return this.nonPersistingLocalChange}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){}},{key:"runOnWorkbook",value:function(e){var t=null;if(!e.sheetManager.getSheetBySheetId(this.gridRange.sheetId))return!0;switch(this.workbookRangeType){case f.PROTECTED_RANGE:this.workbookRangePropertiesDelta.getProtectionProperties()&&(t=new p({id:this.workbookRangeId,range:this.gridRange,type:this.workbookRangeType,properties:this.workbookRangePropertiesDelta.getProtectionProperties()}));break;case f.CHART:this.workbookRangePropertiesDelta.getEmbeddedObjectId()&&(t=new g({id:this.workbookRangeId,range:this.gridRange,type:this.workbookRangeType,embeddedObjectId:this.workbookRangePropertiesDelta.getEmbeddedObjectId()}));break;case f.LINKED_RANGE:t=new R({id:this.workbookRangeId,range:this.gridRange,type:this.workbookRangeType,properties:this.workbookRangePropertiesDelta.getLinkedRangeProperties()})}return t&&e.workbookRangeManager.addWorkbookRange(t),!0}},{key:"invert",value:function(e){return[new h.a({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType})]}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s=this.gridRange.clone();return s.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new n({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType,gridRange:s,workbookRangePropertiesDelta:this.workbookRangePropertiesDelta})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s=this.gridRange.clone();return s.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new n({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType,gridRange:s,workbookRangePropertiesDelta:this.workbookRangePropertiesDelta})]}},{key:"transformWithNewAddEmbeddedObjectMutation",value:function(e,t){return t||this.workbookRangePropertiesDelta.getEmbeddedObjectId()!==e.object.objectId?[this]:[]}},{key:"transformWithNewDeleteEmbeddedObjectMutation",value:function(e,t){return this.workbookRangePropertiesDelta.getEmbeddedObjectId()===e.objectId?[]:[this]}},{key:"transformWithNewUpdateEmbeddedObjectMutation",value:function(e,t){return t||this.workbookRangePropertiesDelta.getEmbeddedObjectId()!==e.object.objectId?[this]:[]}}],[{key:"deserialize",value:function(e){return new n({workbookRangeId:e[0],gridRange:x.deserialize(e[1]),workbookRangeType:e[2],workbookRangePropertiesDelta:m.deserialize(e[3]),nonPersistingLocalChange:e[4]})}}]),n}(l.a));b.protoMap={0:{name:"workbookRangeId",dataType:String},1:{name:"gridRange",dataType:x},2:{name:"workbookRangeType",dataType:Number},3:{name:"workbookRangePropertiesDelta",dataType:m},4:{name:"nonPersistingLocalChange",dataType:Boolean}},t.a=b},"../packages/mutation/src/workbook/workbookRange/DeleteWorkbookRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/mutation/src/workbook/workbookRange/DefineWorkbookRangeMutation.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=d.WorkbookRange,m=I.WORKBOOK_RANGE_TYPE,f=I.WorkbookRangeDelta,g=function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.DELETE_WORKBOOK_RANGE_MUTATION)).workbookRangeId=e.workbookRangeId,r.workbookRangeType=e.workbookRangeType,r.nonPersistingLocalChange=!!e.nonPersistingLocalChange,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.workbookRangeId,this.workbookRangeType]}},{key:"getAffectedSheetId",value:function(){return"WORKBOOK"}},{key:"getAffectedSheets",value:function(){return[]}},{key:"isNonPersistedLocalChange",value:function(){return this.nonPersistingLocalChange}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){}},{key:"runOnWorkbook",value:function(e){return e.workbookRangeManager.deleteWorkbookRange(this.workbookRangeId),!0}},{key:"invert",value:function(e){var t=[];switch(this.workbookRangeType){case m.PROTECTED_RANGE:var n=e.workbookRangeManager.getProtectedRangeById(this.workbookRangeId);if(n){var s=new f;s.setProtectionProperties(n.properties),t.push(new h.a({workbookRangeId:this.workbookRangeId,gridRange:n.range.clone(),workbookRangeType:this.workbookRangeType,workbookRangePropertiesDelta:s}))}break;case m.CHART:var r=e.workbookRangeManager.getChartWorkbookRangeById(this.workbookRangeId);if(r){var o=new f;o.setEmbeddedObjectId(r.embeddedObjectId),t.push(new h.a({workbookRangeId:this.workbookRangeId,gridRange:r.range.clone(),workbookRangeType:this.workbookRangeType,workbookRangePropertiesDelta:o}))}break;case m.LINKED_RANGE:var a=e.workbookRangeManager.getLinkedWorkbookRangeById(this.workbookRangeId);if(a){var i=new f,d=a.properties;d&&i.setLinkedRangeProperties(d),t.push(new h.a({workbookRangeId:this.workbookRangeId,gridRange:a.range.clone(),workbookRangeType:this.workbookRangeType,workbookRangePropertiesDelta:i}))}}return t}},{key:"transformWithDeleteWorkbookRangeMutation",value:function(e,t){return this.workbookRangeId===e.workbookRangeId&&t?[]:[this]}}],[{key:"deserialize",value:function(e){return new n({workbookRangeId:e[0],workbookRangeType:e[1],nonPersistingLocalChange:e[2]})}}]),n}(l.a);g.protoMap={0:{name:"workbookRangeId",dataType:String},1:{name:"workbookRangeType",dataType:Number},2:{name:"nonPersistingLocalChange",dataType:Boolean}},t.a=g},"../packages/mutation/src/workbook/workbookRange/UpdateWorkbookRangeMutation.ts":function(e,t,n){"use strict";n("../node_modules/core-js/modules/es.number.constructor.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.reflect.construct.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js");var s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),i=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),d=n("../packages/model/src/index.ts"),u=n("../packages/mutation/src/MutationId.ts"),l=n("../packages/mutation/src/Mutation.ts"),h=n("../packages/model/src/workbookRange/index.ts");function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,s=Object(i.a)(e);if(t){var r=Object(i.a)(this).constructor;n=Reflect.construct(s,arguments,r)}else n=s.apply(this,arguments);return Object(a.a)(this,n)}}var I=d.WorkbookRange,m=I.WorkbookRangeDelta,f=I.WORKBOOK_RANGE_TYPE,g=I.ChartWorkbookRange,p=I.ProtectedRange,R=d.Range.GridRange,x=(d.Dimension.DIMENSION_TYPE,function(e){Object(o.a)(n,e);var t=c(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,u.b.UPDATE_WORKBOOK_RANGE_MUTATION,e)).workbookRangeId=e.workbookRangeId,r.gridRange=e.gridRange,r.workbookRangeType=e.workbookRangeType,r.workbookRangePropertiesDelta=e.workbookRangePropertiesDelta,r.nonPersistingLocalChange=!!e.nonPersistingLocalChange,r}return Object(r.a)(n,[{key:"serialize",value:function(){return[this.workbookRangeId,this.gridRange.serialize(),this.workbookRangeType,this.workbookRangePropertiesDelta.serialize()]}},{key:"getAffectedSheetId",value:function(){return"WORKBOOK"}},{key:"getAffectedSheets",value:function(){return[]}},{key:"isNonPersistedLocalChange",value:function(){return this.nonPersistingLocalChange}},{key:"check",value:function(e){return{isValid:!0}}},{key:"runOnSheet",value:function(e){}},{key:"runOnWorkbook",value:function(e){var t=null;switch(this.workbookRangeType){case f.PROTECTED_RANGE:this.workbookRangePropertiesDelta.getProtectionProperties()&&(t=new p({id:this.workbookRangeId,range:this.gridRange.clone(),type:this.workbookRangeType,properties:this.workbookRangePropertiesDelta.getProtectionProperties()}));break;case f.CHART:this.workbookRangePropertiesDelta.getEmbeddedObjectId()&&(t=new g({id:this.workbookRangeId,range:this.gridRange.clone(),type:this.workbookRangeType,embeddedObjectId:this.workbookRangePropertiesDelta.getEmbeddedObjectId()}));break;case f.LINKED_RANGE:this.workbookRangePropertiesDelta.getLinkedRangeProperties()&&(t=new h.LinkedRange({id:this.workbookRangeId,range:this.gridRange.clone(),type:this.workbookRangeType,properties:this.workbookRangePropertiesDelta.getLinkedRangeProperties()}))}return t&&e.workbookRangeManager.updateWorkbookRange(this.workbookRangeId,t),!0}},{key:"invert",value:function(e){var t=[];switch(this.workbookRangeType){case f.PROTECTED_RANGE:var s=e.workbookRangeManager.getProtectedRangeById(this.workbookRangeId);if(s){var r=new m;r.setProtectionProperties(s.properties),t.push(new n({workbookRangeId:this.workbookRangeId,gridRange:s.range.clone(),workbookRangeType:this.workbookRangeType,workbookRangePropertiesDelta:r}))}break;case f.CHART:var o=e.workbookRangeManager.getChartWorkbookRangeById(this.workbookRangeId);if(o){var a=new m;a.setEmbeddedObjectId(o.embeddedObjectId),t.push(new n({workbookRangeId:this.workbookRangeId,gridRange:o.range.clone(),workbookRangeType:this.workbookRangeType,workbookRangePropertiesDelta:a}))}break;case f.LINKED_RANGE:var i=e.workbookRangeManager.getLinkedWorkbookRangeById(this.workbookRangeId);if(i){var d=new m;i.properties&&d.setLinkedRangeProperties(i.properties),t.push(new n({workbookRangeId:this.workbookRangeId,gridRange:i.range.clone(),workbookRangeType:this.workbookRangeType,workbookRangePropertiesDelta:d}))}}return t}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s=this.gridRange.clone();return s.insertDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new n({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType,gridRange:s,workbookRangePropertiesDelta:this.workbookRangePropertiesDelta})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){if(this.gridRange.sheetId!==e.sheetId)return[this];var s=this.gridRange.clone();return s.deleteDimension({sheetId:e.sheetId,type:e.type,index:e.index,amount:e.amount}),[new n({workbookRangeId:this.workbookRangeId,workbookRangeType:this.workbookRangeType,gridRange:s,workbookRangePropertiesDelta:this.workbookRangePropertiesDelta})]}},{key:"transformWithNewAddEmbeddedObjectMutation",value:function(e,t){return t||this.workbookRangePropertiesDelta.getEmbeddedObjectId()!==e.object.objectId?[this]:[]}},{key:"transformWithNewDeleteEmbeddedObjectMutation",value:function(e,t){return this.workbookRangePropertiesDelta.getEmbeddedObjectId()===e.objectId?[]:[this]}},{key:"transformWithNewUpdateEmbeddedObjectMutation",value:function(e,t){return t||this.workbookRangePropertiesDelta.getEmbeddedObjectId()!==e.object.objectId?[this]:[]}}],[{key:"deserialize",value:function(e){return new n({workbookRangeId:e[0],gridRange:R.deserialize(e[1]),workbookRangeType:e[2],workbookRangePropertiesDelta:m.deserialize(e[3]),nonPersistingLocalChange:e[4]})}}]),n}(l.a));x.protoMap={0:{name:"workbookRangeId",dataType:String},1:{name:"gridRange",dataType:R},2:{name:"workbookRangeType",dataType:Number},3:{name:"workbookRangePropertiesDelta",dataType:m},4:{name:"nonPersistingLocalChange",dataType:Boolean}},t.a=x}}]);
//# sourceMappingURL=pc-chunk_part2-6df17e0267.js.map