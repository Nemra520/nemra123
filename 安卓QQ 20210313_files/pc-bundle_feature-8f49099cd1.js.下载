(window.webpackJsonp=window.webpackJsonp||[]).push([["bundle_feature"],{"./src/core/feature/Feature.ts":function(e,t,r){"use strict";r.r(t);r("../node_modules/core-js/modules/es.array.iterator.js"),r("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("../node_modules/core-js/modules/es.object.to-string.js"),r("../node_modules/core-js/modules/es.promise.js"),r("../node_modules/core-js/modules/es.reflect.construct.js"),r("../node_modules/core-js/modules/es.regexp.to-string.js"),r("../node_modules/core-js/modules/es.string.iterator.js"),r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/regenerator-runtime/runtime.js");var n=r("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),a=r("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=r("../node_modules/@babel/runtime/helpers/esm/inherits.js"),o=r("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=r("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=r("../node_modules/@babel/runtime/helpers/esm/typeof.js"),l=r("../packages/services/src/dynamicLoader.ts"),p=r("./src/core/feature/copyPaste/copyPaste2.ui.ts"),h=r("./src/core/feature/formatPainter/formatPainter.ts"),f=r("../packages/services/src/extensions.ts");function d(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(o.a)(this,r)}}Object(f.b)(p.ICopyPaste,function(e){Object(i.a)(o,e);var t=d(o);function o(){return Object(a.a)(this,o),t.apply(this,arguments)}return Object(s.a)(o,[{key:"getModule",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(r.bind(null,"./src/core/feature/copyPaste/copyPaste2.ui.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),o}(l.a)),Object(f.b)(h.IFormatPainter,function(e){Object(i.a)(o,e);var t=d(o);function o(){return Object(a.a)(this,o),t.apply(this,arguments)}return Object(s.a)(o,[{key:"getModule",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(r.bind(null,"./src/core/feature/formatPainter/formatPainter.ts"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),o}(l.a));var m=r("./src/core/app/SpreadsheetApp.interface.ts"),y=r("../packages/services/src/dispose.ts");function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(u.a)(e);if(t){var a=Object(u.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(o.a)(this,r)}}var v=function(e,t,r,n){var a,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(c.a)(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(i=(s<3?a(i):s>3?a(t,r,i):a(t,r))||i);return s>3&&i&&Object.defineProperty(t,r,i),i},_=function(e,t){return function(r,n){t(r,n,e)}},g=function(e){Object(i.a)(o,e);var t=b(o);function o(e,r,n){var s;return Object(a.a)(this,o),(s=t.call(this)).app=e,s.copyPasteLoader=r,s.formatPainterLoader=n,s._register(Object(y.g)((function(){s.destroy()}),"destroyAllFeature")),s}return Object(s.a)(o,[{key:"destroy",value:function(){this._smartSelection=null,this._relateForm=null,this._formatPainter=null,this._smartSplit=null,this._copyPaste=null,this._CopyPasteCache=null,this._copyPasteBase=null,this._dataValidation=null,this._jankToast=null,this.quickFill=null,this._cellImage=null}},{key:"init",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this.getSmartSelection(),this.getRelateForm(),this.getFormatPainter(),this.getSmartSplit(),this.getCopyPaste(),this.getCopyPasteCache(),this.getCopyPasteBase(),this.getDataValidation(),this.getJankToast(),this.getCellImage()]));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCellImage",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._cellImage){e.next=2;break}return e.abrupt("return",this._cellImage);case 2:return e.next=4,r.e("bundle_feature_smart_selection").then(r.bind(null,"./src/core/feature/cellImage/index.ts"));case 4:return t=e.sent,this._cellImage=new t.default(this.app),e.abrupt("return",this._cellImage);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSmartSelection",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._smartSelection){e.next=2;break}return e.abrupt("return",this._smartSelection);case 2:return e.next=4,r.e("bundle_feature_smart_selection").then(r.bind(null,"./src/core/feature/smartSelection/smartSelection.ts"));case 4:return t=e.sent,this._smartSelection=t.default,e.abrupt("return",this._smartSelection);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRelateForm",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._relateForm){e.next=2;break}return e.abrupt("return",this._relateForm);case 2:return e.next=4,r.e("bundle_feature_relate_form").then(r.bind(null,"./src/core/feature/relateForm/index.ts"));case 4:return t=e.sent,this._relateForm=new t.default(this.app),e.abrupt("return",this._relateForm);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getQuickFill",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e("bundle_feature_quick_fill").then(r.bind(null,"./src/core/feature/quickFill/index.ts"));case 2:if(t=e.sent,!this.quickFill){e.next=5;break}return e.abrupt("return",this.quickFill);case 5:return this.quickFill=new t.default(this.app),e.abrupt("return",this.quickFill);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFormatPainter",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._formatPainter){e.next=2;break}return e.abrupt("return",this._formatPainter);case 2:return e.next=4,this.formatPainterLoader.getInstance();case 4:return this._formatPainter=e.sent,e.abrupt("return",this._formatPainter);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSmartSplit",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._smartSplit){e.next=2;break}return e.abrupt("return",this._smartSplit);case 2:return e.next=4,r.e("bundle_feature_smart_split").then(r.bind(null,"./src/core/feature/smartSplit/smartSplit.ts"));case 4:return t=e.sent,this._smartSplit=new t.default(this.app),e.abrupt("return",this._smartSplit);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCopyPaste",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._copyPaste){e.next=2;break}return e.abrupt("return",this._copyPaste);case 2:return t=this.app.view.canvas.inputManager.alloyRTE.input,e.next=5,this.copyPasteLoader.getInstance([t]);case 5:return this._copyPaste=e.sent,e.abrupt("return",this._copyPaste);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCopyPasteCache",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._CopyPasteCache){e.next=2;break}return e.abrupt("return",this._CopyPasteCache);case 2:return e.next=4,Promise.resolve().then(r.bind(null,"./src/core/feature/copyPaste/copyPasteCache.ts"));case 4:return t=e.sent,this._CopyPasteCache=t.default,e.abrupt("return",this._CopyPasteCache);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCopyPasteBase",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._copyPasteBase){e.next=2;break}return e.abrupt("return",this._copyPasteBase);case 2:return e.next=4,r.e("bundle_feature_copy_paste_base").then(r.bind(null,"./src/core/feature/copyPaste/index.ts"));case 4:return t=e.sent,this._copyPasteBase=t.default,e.abrupt("return",this._copyPasteBase);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDataValidation",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._dataValidation){e.next=2;break}return e.abrupt("return",this._dataValidation);case 2:return e.next=4,r.e("bundle_feature_data_validation").then(r.bind(null,"./src/core/feature/dataValidation/Index.ts"));case 4:return t=e.sent,this._dataValidation=t.default,e.abrupt("return",this._dataValidation);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getJankToast",value:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._jankToast){e.next=2;break}return e.abrupt("return",this._jankToast);case 2:return e.next=4,r.e("bundle_feature_jank_toast").then(r.bind(null,"./src/core/feature/jankToast/check.ts"));case 4:return t=e.sent,this._jankToast=t.default,e.abrupt("return",this._jankToast);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"smartSelection",get:function(){return this._smartSelection?this._smartSelection:(this.getSmartSelection(),null)}},{key:"relateForm",get:function(){return this._relateForm?this._relateForm:(this.getRelateForm(),null)}},{key:"formatPainter",get:function(){return this._formatPainter?this._formatPainter:(this.getFormatPainter(),null)}},{key:"smartSplit",get:function(){return this._smartSplit?this._smartSplit:(this.getSmartSplit(),null)}},{key:"copyPaste",get:function(){return this._copyPaste?this._copyPaste:(this.getCopyPaste(),null)}},{key:"CopyPasteCache",get:function(){return this._CopyPasteCache?this._CopyPasteCache:(this.getCopyPasteCache(),null)}},{key:"copyPasteBase",get:function(){return this._copyPasteBase?this._copyPasteBase:(this.getCopyPasteBase(),null)}},{key:"dataValidation",get:function(){return this._dataValidation?this._dataValidation:(this.getDataValidation(),null)}},{key:"jankToast",get:function(){return this._jankToast?this._jankToast:(this.getJankToast(),null)}}]),o}(y.a);g=v([_(0,m.a),_(1,p.ICopyPaste),_(2,h.IFormatPainter)],g);t.default=g},"./src/core/feature/formatPainter/formatPainter.ts":function(e,t,r){"use strict";r.r(t),r.d(t,"IFormatPainter",(function(){return p}));r("../node_modules/core-js/modules/es.array.concat.js"),r("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var n=r("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),a=r("../node_modules/@babel/runtime/helpers/esm/createClass.js"),s=r("../node_modules/@babel/runtime/helpers/esm/typeof.js"),i=r("./src/core/app/SpreadsheetApp.interface.ts"),o=r("../packages/services/src/instantiation.ts"),u=function(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"===typeof Reflect?"undefined":Object(s.a)(Reflect))&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o},c=function(e,t){return function(r,n){t(r,n,e)}},l=function(){function e(t){var r=this;Object(n.a)(this,e),this.app=t,this.mode="none",this.exitClickTime=0,this.hasInit=!1,this.handleClick=function(e){if(e.preventDefault(),r.status){var t=r.getSelection(),n=(new Date).getTime();return"single"===r.mode?(r.app.requestApi.formatPainterApply(),void r.exit()):"infinite"===r.mode&&n-r.exitClickTime<500&&t===r.lastSelect?(r.exit(),void(r.lastSelect="")):void("infinite"===r.mode&&(r.app.requestApi.formatPainterApply(),r.exitClickTime=n,r.lastSelect=t))}},this._handleKeydown=function(e){27===e.keyCode&&r.exit()},this.app=t,this.editDom=document.querySelector("#mainEditor")}return Object(a.a)(e,[{key:"init",value:function(){var e,t=null===(e=this.app)||void 0===e?void 0:e.view.canvas.inputManager;t&&t.emitter.on(t.EVENT.ENTER_INPUT,this.exit.bind(this)),document.body.addEventListener("keydown",this._handleKeydown)}},{key:"enter",value:function(e){var t,r,n;this.hasInit||(this.hasInit=!0,this.init()),this.mode=e;var a=this.app.view.getSelection().rangeSelections;if(a.length>1)return alert("\u683c\u5f0f\u5237\u4e0d\u652f\u6301\u591a\u9009\u533a");this.editDom.classList.add("format-now"),null===(t=this.app)||void 0===t||null===(r=t.view)||void 0===r||null===(n=r.canvas.copyFrame)||void 0===n||n.doCopy(a[0]),this.app.requestApi.formatPainterSetCache(a[0],this.app),this.editDom.addEventListener("touchend",this.handleClick),this.editDom.addEventListener("mouseup",this.handleClick),this.app.event.default.trigger("enter-format-painter",this.mode),this.status=!0}},{key:"exit",value:function(){var e,t,r;this.status&&(this.status=!1,this.mode="none",null===(e=this.app)||void 0===e||null===(t=e.view)||void 0===t||null===(r=t.canvas.copyFrame)||void 0===r||r.closeCopy(),this.app.requestApi.formatPainterClear(),this.editDom.classList.remove("format-now"),this.editDom.removeEventListener("touchend",this.handleClick),this.editDom.removeEventListener("mouseup",this.handleClick),this.app.event.default.trigger("exit-format-painter"))}},{key:"getSelection",value:function(){var e=this.app.view.canvas.normalSelectData.activeRow,t=this.app.view.canvas.normalSelectData.activeCol;return"".concat(t,"-").concat(e)}},{key:"getMode",value:function(){return this.mode}}]),e}();l=u([c(0,i.a)],l),t.default=l;var p=Object(o.c)("IFormatPainter")}}]);
//# sourceMappingURL=pc-bundle_feature-8f49099cd1.js.map