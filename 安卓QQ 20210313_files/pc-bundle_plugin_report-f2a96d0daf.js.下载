(window.webpackJsonp=window.webpackJsonp||[]).push([["bundle_plugin_report"],{"../node_modules/@tencent/aegis-web-sdk/lib/aegis.min.js":function(e,t,n){e.exports=function(){"use strict";function e(e){return(e=Array.isArray(e)?e:[e]).map((function(e,t){return Object.getOwnPropertyNames(e).map((function(n){return o(n)+"["+t+"]="+(void 0===e[n]?"":o(e[n]))})).join("&")})).join("&")+(e.length?"&count="+e.length:"")}var t,n=(i.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].callback===t)return n;return-1},i.prototype.on=function(e,t,n){if(void 0===n&&(n=0),this){var o=this.EventsList[e];return o||(this.EventsList[e]=[],o=this.EventsList[e]),-1!==this.indexOf(o,t)||(t={name:e,type:n||0,callback:t},o.push(t)),this}},i.prototype.one=function(e,t){this.on(e,t,1)},i.prototype.remove=function(e,t){if(this){var n=this.EventsList[e];if(!n)return null;if(t)return n.length&&(t=this.indexOf(n,t),n.splice(t,1)),this;try{delete this.EventsList[e]}catch(e){}return null}},i),o=function(e){try{return encodeURIComponent(decodeURIComponent(e))}catch(i){return e}};function i(){var e=this;this.emit=function(t,n){if(e){var o,i=e.EventsList[t];if(null!=i&&i.length){i=i.slice();for(var a=0;a<i.length;a++){o=i[a];try{var r=o.callback.apply(e,[n]);if(1===o.type&&e.remove(t,o.callback),!1===r)break}catch(t){throw t}}}return e}},this.EventsList={}}function a(e,n){return"number"==typeof e||"string"==typeof e?e:n?t.string:t.number}function r(e,t){return"string"==typeof e?e.split("?")[t?1:0]||"":e}function l(e){return/^https/.test(e)}function s(){return void 0!==window.performance&&"function"==typeof(e=window.Performance)&&/native code/.test(e.toString())&&"function"==typeof performance.clearResourceTimings&&"function"==typeof performance.getEntriesByType&&"function"==typeof performance.now;var e}function u(e){return p.some((function(t){return-1!==e.indexOf(t)}))}function c(e){try{return(JSON.stringify(e,(t=[],n=[],function(e,o){if(o instanceof Error)return"Error.message\u3010 "+o.message+" \u3011;  Error.stack\u3010 "+o.stack+" \u3011";if("object"==typeof o&&null!==o){var i=t.indexOf(o);if(-1!==i)return"[Circular "+n[i]+"]";t.push(o),n.push(e||"root")}return o}),4)||"undefined").replace(/"/gim,"")}catch(e){return"error happen when aegis stringify: \n "+e.message+" \n "+e.stack}var t,n}($=t=t||{})[$.number=-1]="number",$.string="";var d,_,p=["application/octet-stream","application/xhtml+xml","application/xml","application/pdf","application/pkcs12","application/javascript","application/ecmascript","application/vnd.mspowerpoint","application/ogg","text/html","text/css","text/javascript","image","audio","video"],E=["ret","retcode","code"],f=function(e,t){var n;try{"string"==typeof e&&(e=JSON.parse(e)),"function"==typeof(null===(n=null==t?void 0:t.ret)||void 0===n?void 0:n.join)&&(E=[].concat(null===(o=null==t?void 0:t.ret)||void 0===o?void 0:o.map((function(e){return e.toLowerCase()}))));var o=Object.getOwnPropertyNames(e).filter((function(e){return-1!==E.indexOf(e.toLowerCase())}));return o.length?""+e[o[0]]:"unknown"}catch(e){return"unknown"}},m=(h.prototype.sourceURL=function(){return this.data.responseURL},h.prototype.status=function(){return Number(this.data.status)},h.prototype.headers=function(){var e=this.data.getAllResponseHeaders().split("\n"),t={};return e.forEach((function(e){var n;e&&(e=(n=e.split(": "))[0],n=n[1].trim(),t[e]=n)})),t},h),T=(O.prototype.sourceURL=function(){return this.data.url},O.prototype.status=function(){return Number(this.data.status)},O.prototype.headers=function(){var e={};return this.data.headers.forEach((function(t,n){e[n]=t})),e},O);function O(e,t){this.type="fetch",this.data=e||{},this.data.response=t}function h(e){this.type="xhr",this.data=e}function v(e,t){return Array.isArray(e)?t(e.map((function(e){return{msg:"string"==typeof e.msg?e.msg:[].concat(e.msg).map(c).join(" "),level:e.level,trace:e.trace}}))):t({msg:"string"==typeof e.msg?e.msg:c(e.msg),level:e.level,trace:e.trace})}function b(){}(te=d=d||{}).INFO_ALL="-1",te.API_RESPONSE="1",te.INFO="2",te.ERROR="4",te.PROMISE_ERROR="8",te.AJAX_ERROR="16",te.SCRIPT_ERROR="32",te.IMAGE_ERROR="64",te.CSS_ERROR="128",te.CONSOLE_ERROR="256",te.MEDIA_ERROR="512",te.RET_ERROR="1024",te.REPORT="2048",(ne=_=_||{}).LOG="log",ne.SPEED="speed",ne.PERFORMANCE="performance",ne.OFFLINE="offline",ne.WHITE_LIST="whiteList",ne.VITALS="vitals",ne.PV="pv",ne.EVENT="event",ne.CUSTOM="custom",ne.SDK_ERROR="sdkError";var R=function(e,t){var n,o=[];return function(i,a){if(o.push(i),t&&o.length>=t)return a(o.splice(0,o.length)),void(n&&clearTimeout(n));n&&clearTimeout(n),n=setTimeout((function(){n=null,a(o.splice(0,o.length))}),e.delay||1e3)}},g=function(e){var t={};return function(n,o){var i;e.speedSample?Array.isArray(n)?(i=n.filter((function(e){var n=!t[e.url];return t[e.url]=!0,n}))).length&&o(i):(t[n.url]||o(n),t[n.url]=!0):o(n)}},S=function(e){if(!e||!e.reduce||!e.length)throw new TypeError("createPipeline need at least one function param");return 1===e.length?function(t,n){e[0](t,n||b)}:e.reduce((function(e,t){return function(n,o){return void 0===o&&(o=b),e(n,(function(e){return null==t?void 0:t(e,o)}))}}))},A=(D.prototype.init=function(e){this.setConfig(e);for(var t=0;t<D.installedPlugins.length;t++)try{D.installedPlugins[t].patch(this)}catch(e){this.sendSDKError(e)}this.lifeCycle.emit("onInited")},D.prototype.setConfig=function(e){Object.assign(this.config,e);var t=(i=this.config).id,n=i.uin,o=i.version,i=this.bean.id!==t||this.bean.uin!==n;return this.bean.id=t||"",this.bean.uin=n||"",o&&(this.bean.version=o),i&&this.lifeCycle.emit("onConfigChange",e),this.config},D.use=function(e){-1===D.installedPlugins.indexOf(e)&&e.aegisPlugin&&D.installedPlugins.push(e)},D.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.normalLogPipeline({msg:e,level:d.INFO})},D.prototype.infoAll=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.normalLogPipeline({msg:e,level:d.INFO_ALL})},D.prototype.report=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.normalLogPipeline({msg:e,level:d.REPORT})},D.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.normalLogPipeline({msg:e,level:d.ERROR})},D.prototype.speedLogPipeline=function(e){throw new Error('You need to override "speedLogPipeline" method')},D.prototype.reportPv=function(e){var t,n=this;e&&(t=""+Object.getOwnPropertyNames(this.bean).filter((function(e){return"id"!==e})).map((function(e){return e+"="+n.bean[e]})).join("&"),this.send({url:this.config.url+"/"+e+"?"+t,addBean:!1,type:_.PV}))},D.prototype.reportEvent=function(e){e&&this.eventPipeline(e)},D.prototype.reportTime=function(e,t){"string"==typeof e?"number"==typeof t?t<0||6e4<t?console.warn("reportTime: duration must between 0 and 60000"):this.submitCustomTime(e,t):console.warn("reportTime: second param must be number"):console.warn("reportTime: first param must be a string")},D.prototype.reportT=function(e){var t=e.name,n=e.duration,o=void 0===(i=e.ext1)?"":i,i=void 0===(a=e.ext2)?"":a,a=void 0===(a=e.ext3)?"":a;if(e=void 0===(e=e.from)?"":e,"string"==typeof t&&"number"==typeof n&&"string"==typeof o&&"string"==typeof i&&"string"==typeof a){if(!(n<0||6e4<n))return this.submitCustomTime(t,n,o,i,a,e);console.warn("reportTime: duration must between 0 and 60000")}else console.warn("reportTime: params error")},D.prototype.time=function(e){"string"==typeof e?this.timeMap[e]?console.warn("Timer "+e+" already exists"):this.timeMap[e]=Date.now():console.warn("time: first param must be a string")},D.prototype.timeEnd=function(e){"string"==typeof e?this.timeMap[e]?(this.submitCustomTime(e,Date.now()-this.timeMap[e]),delete this.timeMap[e]):console.warn("Timer "+e+" does not exist"):console.warn("timeEnd: first param must be a string")},D.prototype.submitCustomTime=function(e,t,n,o,i,a){this.customTimePipeline({name:e,duration:t,ext1:n||this.config.ext1,ext2:o||this.config.ext2,ext3:i||this.config.ext3,from:a||void 0})},D.prototype.extendBean=function(e,t){this.bean[e]=t},D.prototype.send=function(e,t,n){throw new Error('You need to override "send" method')},D.prototype.sendSDKError=function(e){this.send({url:"https://aegis.qq.com/collect?id=1085&msg[0]="+encodeURIComponent(c(e))+"&level[0]=2&from="+this.config.id+"&count=1&version="+this.config.id+"(1.25.11)",addBean:!1,method:"get",type:_.SDK_ERROR})},D.LOG_TYPE=d,D.installedPlugins=[],D),y=(C.prototype.patch=function(e){this.canUse(e)&&this.exist(e)&&(this.triggerInit(e),this.instances.push(e),this.triggerOnNewAegis(e))},C.prototype.walk=function(e){var t=this;this.instances.forEach((function(n){var o=t.canUse(n);o&&e(n,o)}))},C.prototype.canUse=function(e){return!(!(e=this.getConfig(e))||"object"!=typeof e)||!!e},C.prototype.getConfig=function(e){return e.config[this.name]},C.prototype.exist=function(e){return-1===this.instances.indexOf(e)},C.prototype.triggerInit=function(e){var t;this.inited||(this.inited=!0,null===(t=null===(t=this.option)||void 0===t?void 0:t.init)||void 0===t||t.call(this.option,this.getConfig(e)))},C.prototype.triggerOnNewAegis=function(e){var t;null===(t=null===(t=this.option)||void 0===t?void 0:t.onNewAegis)||void 0===t||t.call(this.option,e,this.getConfig(e))},C),I=new y({name:"aid",aid:"",init:function(){try{var e=window.localStorage.getItem("AEGIS_ID");e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),window.localStorage.setItem("AEGIS_ID",e)),this.aid=e}catch(e){}},onNewAegis:function(e){e.bean.aid=this.aid}}),N=(new y({name:"reportAssetSpeed"}),new y({name:"reportAssetSpeed",collectCur:0,ASSETS_INITIATOR_TYPE:["img","css","script","link","audio","video"],init:function(){var e=this;s()&&(this.collectSuccLog(),this.collectFailLog(),performance.onresourcetimingbufferfull=function(){e.collectCur=0,performance.clearResourceTimings()})},publish:function(e){this.$walk((function(t){t.speedLogPipeline(e)}))},collectSuccLog:function(){function e(e){for(var n=0,o=e.length;n<o;n++){var i=e[n];-1!==t.ASSETS_INITIATOR_TYPE.indexOf(i.initiatorType)&&-1===i.name.indexOf("cdn-go.cn/aegis/aegis-sdk")&&t.publish(t.generateLog(i))}}var t=this;"function"==typeof window.PerformanceObserver?(e(performance.getEntriesByType("resource")),new window.PerformanceObserver((function(t){e(t.getEntries())})).observe({entryTypes:["resource"]})):setInterval((function(){var n=performance.getEntriesByType("resource"),o=n.slice(t.collectCur);t.collectCur=n.length,e(o)}),3e3)},collectFailLog:function(){var e=this;window.document.addEventListener("error",(function(n){!n||(n=(null==(n=n.target||n.srcElement)?void 0:n.src)||(null==n?void 0:n.href))&&(n={url:r(n),status:400,method:"get",type:"static",isHttps:l(n),urlQuery:r(n,!0),x5ContentType:t.string,x5HttpStatusCode:t.number,x5ImgDecodeStatus:t.number,x5ErrorCode:t.number,x5LoadFromLocalCache:t.number,x5ContentLength:t.number,domainLookup:t.number,connectTime:t.number},e.publish(n))}),!0)},generateLog:function(e){return{url:r(e.name),method:"get",duration:Number(e.duration.toFixed(2)),status:200,type:"static",isHttps:l(e.name),urlQuery:r(e.name,!0),x5ContentType:a(e.x5ContentType,!0),x5HttpStatusCode:a(e.x5HttpStatusCode),x5ImgDecodeStatus:a(e.x5ImgDecodeStatus),x5ErrorCode:a(e.x5ErrorCode),x5LoadFromLocalCache:void 0===e.x5LoadFromLocalCache?t.number:0|e.x5LoadFromLocalCache,x5ContentLength:e.encodedBodySize||a(e.x5ContentLength),domainLookup:a(e.domainLookupEnd-e.domainLookupStart),connectTime:a(e.connectEnd-e.connectStart)}}})),V=function(e,t){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function C(e){this.aegisPlugin=!0,this.name="",this.instances=[],this.inited=!1,e.$walk=this.walk.bind(this),e.$getConfig=this.getConfig.bind(this),this.option=e,this.name=e.name}function D(t){var o,i,a,r,l=this;this.config={version:0,delay:1500,onError:!0,repeat:5,random:1,aid:!0,device:!0,pagePerformance:!0,webVitals:!0,speedSample:!0,url:"https://aegis.qq.com/collect",speedUrl:"https://aegis.qq.com/speed",customTimeUrl:"https://aegis.qq.com/speed/custom",whiteListUrl:"https://aegis.qq.com/aegis/whitelist",performanceUrl:"https://aegis.qq.com/speed/performance",webVitalsUrl:"https://aegis.qq.com/speed/webvitals",eventUrl:"https://aegis.qq.com/collect/events",listenOnerror:!0},this.isWhiteList=!1,this.lifeCycle=new n,this.bean={},this.normalLogPipeline=S([R(this.config,5),v,(a=this.config,r={},function(e,t){var n="number"==typeof a.repeat?a.repeat:5;if(0===n)return t(e);t(e.filter((function(e){return e.level!==d.ERROR&&e.level!==d.PROMISE_ERROR&&e.level!==d.AJAX_ERROR&&e.level!==d.SCRIPT_ERROR&&e.level!==d.IMAGE_ERROR&&e.level!==d.CSS_ERROR&&e.level!==d.MEDIA_ERROR||(r[e.msg]=r[e.msg]||0,r[e.msg]+=1,!(r[e.msg]>n))})))}),(o=this.lifeCycle.emit,i=this.config,function(e,t){var n=i.logCreated;return"function"!=typeof n?(o("beforeWrite",e),t(e)):(e=e.filter((function(e){return!1!==n(e)})),o("beforeWrite",e),t(e))}),function(e){var t,n=!1,o=!1,i=!1;e.lifeCycle.on("onConfigChange",(function(){t&&clearTimeout(t),t=setTimeout((function(){i||(i=!0,e.send({url:e.config.whiteListUrl||"",type:_.WHITE_LIST},(function(t){o=!0;try{0===(t=JSON.parse(t)||{}).retcode&&(n=t.result.is_in_white_list,e.isWhiteList=n);var i=e.config.onWhitelist;"function"==typeof i&&i(n)}catch(t){}}),(function(){o=!0})))}),e.config.uin?50:500)}));var a=[],r=!1;return function(e,t){!r&&e.some((function(e){return e.level===d.ERROR}))&&(r=!0),n||r?t(e.concat(a.splice(0)).map((function(e){return e.level===d.INFO_ALL&&(e.level=d.INFO),e}))):(e=e.filter((function(e){return e.level!==d.INFO&&e.level!==d.API_RESPONSE?(e.level===d.INFO_ALL&&(e.level=d.INFO),!0):(o||(a.push(e),200<=a.length&&(a.length=200)),!1)}))).length&&t(e)}}(this),function(e,t){var n=JSON.parse(JSON.stringify(e));l.lifeCycle.emit("beforeReport",n);var o=l.config.beforeReport;if((e="function"==typeof o?e.filter((function(e){return!1!==o(e)})):e).length)return t(e)},function(t){l.send({url:l.config.url||"",data:e(t),method:"post",contentType:"application/x-www-form-urlencoded",type:_.LOG},(function(){var e=l.config.onReport;"function"==typeof e&&t.forEach((function(t){e(t)}))}))}]),this.eventPipeline=S([R(this.config,5),function(e){l.send({url:l.config.eventUrl+"?"+e.map((function(e,t){return"event["+t+"]="+encodeURIComponent(e)})).join("&"),type:_.EVENT})}]),this.timeMap={},this.customTimePipeline=S([R(this.config,10),function(e){l.send({url:l.config.customTimeUrl+"?payload="+encodeURIComponent(JSON.stringify({custom:e})),type:_.CUSTOM})}])}var M=function(){return(M=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function j(e){var t,n;x.push(e),!k&&window.XMLHttpRequest&&(k=!0,t=window.XMLHttpRequest.prototype.send,n=window.XMLHttpRequest.prototype.open,window.XMLHttpRequest.prototype.open=function(){if(this.aegisMethod=arguments[0],this.aegisUrl=arguments[1],!this.sendByAegis)for(var e=0;e<x.length;e++){var t=x[e];try{"function"==typeof t.open&&t.open(this)}catch(e){}}return n.apply(this,arguments)},window.XMLHttpRequest.prototype.send=function(){if(!this.sendByAegis)for(var e=0;e<x.length;e++){var n=x[e];try{"function"==typeof n.send&&n.send(this,arguments[0])}catch(e){}}return t.apply(this,arguments)})}function P(e){var t;H.push(e),!F&&window.fetch&&(F=!0,t=window.fetch,window.fetch=function(e,n){void 0===n&&(n={});for(var o=0;o<H.length;o++){var i=H[o];try{"function"==typeof i.beforeFetch&&i.beforeFetch(e,n)}catch(e){}}var a=Date.now();return t(e,n).then((function(t){for(var o=0;o<H.length;o++){var i=H[o];try{"function"==typeof i.then&&i.then(t,Date.now()-a,e,n)}catch(t){}}return t})).catch((function(t){for(var o=0;o<H.length;o++){var i=H[o];try{"function"==typeof i.catch&&i.catch(t,Date.now()-a,e,n)}catch(t){}}throw t}))})}var w,L,U,k=!1,x=[],F=!1,H=[],B=(new y({name:"reportApiSpeed"}),new y({name:"reportApiSpeed",override:!1,onNewAegis:function(e,t){this.override||(this.override=!0,this.overrideFetch(e.config),this.overrideXhr(e.config))},overrideFetch:function(e){var n=this;P({then:function(o,i,a,s){var _,p,E,m={url:o.url,isHttps:l(o.url),method:(null==s?void 0:s.method)||"get",duration:i,type:"fetch",status:o.status};"fetch"!==(E="function"==typeof(null===(_=null==e?void 0:e.api)||void 0===_?void 0:_.resourceTypeHandler)?null===(p=null==e?void 0:e.api)||void 0===p?void 0:p.resourceTypeHandler(o.url):E)&&"static"!==E&&(p=o.headers?o.headers.get("content-type"):"",E=o.ok&&"string"==typeof p&&u(p)?"static":"fetch"),"fetch"===E?o.clone().text().then((function(t){var r,l,u,_,p="req url: "+a+" \n                                \nreq method: "+((null==s?void 0:s.method)||"get")+" \n                                \nreq param: "+c(null==s?void 0:s.body)+" \n                                \nres duration: "+i+" \n                                \nres status: "+o.status+" \n                                \nres data: "+t;n.publishNormalLog({msg:p,level:d.API_RESPONSE}),m.payload=new T(o,t),("function"==typeof(null===(r=null==e?void 0:e.api)||void 0===r?void 0:r.retCodeHandler)?(_=(u=e.api.retCodeHandler(t,o.url,o)).code,l=u.isErr,m.ret=_,l):(u=f(t,e.api),m.ret=u,t=(t=null===(l=e.api)||void 0===l?void 0:l.errCode)&&[].concat(t),_=(_=null===(l=e.api)||void 0===l?void 0:l.code)&&[].concat(_),t&&-1!==t.indexOf(u)||_&&-1===_.indexOf(u)||!t&&!_&&"0"!==u&&"unknown"!==u))&&n.publishNormalLog({msg:p,level:d.RET_ERROR})})):Object.assign(m,{type:"static",urlQuery:r(o.url,!0),x5ContentType:t.string,x5HttpStatusCode:t.number,x5ImgDecodeStatus:t.number,x5ErrorCode:t.number,x5LoadFromLocalCache:t.number,x5ContentLength:t.number,domainLookup:t.number,connectTime:t.number}),n.publishSpeed(m)},catch:function(e,t,o,i){t={url:o,isHttps:l(o),method:(null==i?void 0:i.method)||"get",duration:t,type:"fetch",status:600},n.publishSpeed(t)}})},overrideXhr:function(e){var n=this;j({send:function(o,i){var a=Date.now();o.addEventListener("loadend",(function(){var s,_=o.aegisUrl;if(_){var p,E,T=Date.now()-a,O={url:_,isHttps:l(_),status:o.status,method:o.aegisMethod||"get",type:"fetch",duration:T,payload:new m(o)};if("fetch"!==(E="function"==typeof(null===(s=null==e?void 0:e.api)||void 0===s?void 0:s.resourceTypeHandler)?null===(p=null==e?void 0:e.api)||void 0===p?void 0:p.resourceTypeHandler(_):E)&&"static"!==E&&(p=o.getResponseHeader("content-type"),E=400<=o.status||"string"!=typeof p||!u(p)?"fetch":"static"),"fetch"===E)try{var h,v,b,R,g="req url: "+_+" \n                                \nreq method: "+(o.aegisMethod||"get")+" \n                                \nreq param: "+c(i)+" \n                                \nres duration: "+T+" \n                                \nres status: "+o.status+" \n                                \nres data: "+c(o.response);n.publishNormalLog({msg:g,level:d.API_RESPONSE,trace:o.aegisTjgTrace}),("function"==typeof(null===(v=null==e?void 0:e.api)||void 0===v?void 0:v.retCodeHandler)?(R=(h=e.api.retCodeHandler(o.response,_,o)).code,b=h.isErr,O.ret=R,b):(v=f(o.response,e.api),O.ret=v,b=(b=null===(h=e.api)||void 0===h?void 0:h.errCode)&&[].concat(b),R=(R=null===(h=e.api)||void 0===h?void 0:h.code)&&[].concat(R),b&&-1!==b.indexOf(v)||R&&-1===R.indexOf(v)||!b&&!R&&"0"!==v&&"unknown"!==v))&&n.publishNormalLog({msg:g,level:d.RET_ERROR})}catch(s){O.ret="unknown"}else Object.assign(O,{type:"static",urlQuery:r(_,!0),x5ContentType:t.string,x5HttpStatusCode:t.number,x5ImgDecodeStatus:t.number,x5ErrorCode:t.number,x5LoadFromLocalCache:t.number,x5ContentLength:t.number,domainLookup:t.number,connectTime:t.number});n.publishSpeed(O)}}))}})},publishSpeed:function(e){var t=this;e.url=r(e.url),this.$walk((function(n){var o=t.$getConfig(n);"fetch"===e.type&&o&&"function"==typeof o.urlHandler?n.speedLogPipeline(M(M({},e),{url:encodeURIComponent(o.urlHandler(e.url,e.payload))})):n.speedLogPipeline(e)}))},publishNormalLog:function(e){this.$walk((function(t){t.normalLogPipeline(e)}))}}));function G(e){return{name:e,value:1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,delta:0,entries:[],id:"".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),isFinal:!1}}function Q(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}}function W(e){oe=!e.persisted}function K(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];ie||(addEventListener("pagehide",W),addEventListener("beforeunload",(function(){})),ie=!0),addEventListener("visibilitychange",(function(t){t=t.timeStamp,"hidden"===document.visibilityState&&e({timeStamp:t,isUnloading:oe})}),{capture:!0,once:t})}function q(e,t,n,o){var i;return function(){n&&t.isFinal&&n.disconnect(),0<=t.value&&(o||t.isFinal||"hidden"===document.visibilityState)&&(t.delta=t.value-(i||0),(t.delta||t.isFinal||void 0===i)&&(e(t),i=t.value))}}function Y(){return void 0===z&&(z="hidden"===document.visibilityState?0:1/0,K((function(e){return e=e.timeStamp,z=e}),!0)),{get timeStamp(){return z}}}function J(e){if(e.payload){var t={};return Object.keys(e).forEach((function(n){"payload"!==n&&(t[n]=e[n])})),t}return e}(ae=w=w||{})[ae.unknown=100]="unknown",ae[ae.wifi=1]="wifi",ae[ae.net2g=2]="net2g",ae[ae.net3g=3]="net3g",ae[ae.net4g=4]="net4g",ae[ae.net5g=5]="net5g",ae[ae.net6g=6]="net6g",(le=L=L||{})[le.android=1]="android",le[le.ios=2]="ios",le[le.windows=3]="windows",le[le.macos=4]="macos",le[le.linux=5]="linux",le[le.other=100]="other",(pe=U=U||{})[pe.oldX5=1]="oldX5",pe[pe.newX5=2]="newX5",pe[pe.other=3]="other";var X,z,Z,$=new y({name:"device",onNewAegis:function(e){e.extendBean("platform",this.getPlatform()),e.extendBean("x5Type",this.getX5Type()),e.extendBean("netType",w.unknown),this.refreshNetworkTypeToBean(e)},getPlatform:function(){var e={android:/\bAndroid\s*([^;]+)/,ios:/\b(iPad|iPhone|iPod)\b.*? OS ([\d_]+)/,windows:/\b(Windows NT)/,macos:/\b(Mac OS)/,linux:/\b(Linux)/i},t=Object.keys(e).find((function(t){return e[t].test(navigator.userAgent)}));return t?L[t]:L.other},getX5Type:function(){var e,t=U.other;return 0<=navigator.userAgent.toLowerCase().indexOf("tbs")?null!=(e=navigator.userAgent.match(/tbs\/([\d.]+)/i))&&e[1]&&36541<=parseInt(e[1],10)?U.newX5:U.oldX5:t},refreshNetworkTypeToBean:function(e){var t=this,n=e.config;("function"==typeof n.getNetworkType?n.getNetworkType:ee)((function(n){w[n]||(n=w.unknown),e.extendBean("netType",n),t.NetworkRefreshTimer=setTimeout((function(){t.refreshNetworkTypeToBean(e),clearTimeout(t.NetworkRefreshTimer)}),1e4)}))}}),ee=function(e){var t="",n=navigator.userAgent.match(/NetType\/(\w+)/);n?t=n[1]:navigator.connection&&(t=navigator.connection.effectiveType||navigator.connection.type),e((t=t=t||"unknown",0<=(t=String(t).toLowerCase()).indexOf("4g")?w.net4g:0<=t.indexOf("wifi")?w.wifi:0<=t.indexOf("5g")?w.net5g:0<=t.indexOf("6g")?w.net6g:0<=t.indexOf("3g")?w.net3g:0<=t.indexOf("2g")?w.net2g:w.unknown))},te=(new y({name:"onError"}),new y({name:"onError",init:function(){this.startListen()},startListen:function(){var e=this,t=window.onerror;window.onerror=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];e.publishErrorLog({msg:(c(n[0])||"")+" @ ("+(c(n[1])||"")+":"+(n[2]||0)+":"+(n[3]||0)+")",level:d.ERROR}),null==t||t.call.apply(t,function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],r=0,l=a.length;r<l;r++,i++)o[i]=a[r];return o}([window],n))},window.addEventListener("unhandledrejection",(function(t){t=t&&c(t.reason),e.publishErrorLog({msg:"PROMISE_ERROR: "+t,level:d.PROMISE_ERROR})})),window.document.addEventListener("error",(function(t){if(t&&t.target&&t.srcElement){t=(n=t.target||t.srcElement).src||n.href;var n=n.tagName;if("string"==typeof t&&-1===(null==t?void 0:t.indexOf("aegis.qq.com"))&&n){var o={msg:n+" load fail: "+t,level:d.INFO};switch(n.toLowerCase()){case"script":o.level=d.SCRIPT_ERROR;break;case"link":o.level=d.CSS_ERROR;break;case"img":o.level=d.IMAGE_ERROR;break;case"audio":case"video":o.level=d.MEDIA_ERROR;break;default:return}e.publishErrorLog(o)}}}),!0);var n=this;j({send:function(e,t){e.addEventListener("loadend",(function(){var e="";this.aegisTimeout?e="timeout":this.status<=0?e="failed":400<=this.status&&(e="error"),e&&n.publishErrorLog({msg:"AJAX_ERROR: request "+e+". status: "+this.status+". \n \n                    url: "+this.aegisUrl+". \n \n                    method: "+this.aegisMethod+". \n\n                    request body: "+c(t)+".",level:d.AJAX_ERROR})})),e.addEventListener("timeout",(function(){e.aegisTimeout=!0}))}})},publishErrorLog:function(e){this.$walk((function(t){t.normalLogPipeline(e)}))}})),ne=(new y({name:"pagePerformance"}),new y({name:"pagePerformance",onNewAegis:function(e){var t=this;if(s())if(X)this.publish(X,e);else try{this.getFirstScreenTiming(e,(function(n){var o,i=performance.timing;i&&((o=i.loadEventStart-i.domInteractive)<0&&(o=1070),X={dnsLookup:i.domainLookupEnd-i.domainLookupStart,tcp:i.connectEnd-i.connectStart,ssl:0===i.secureConnectionStart?0:i.requestStart-i.secureConnectionStart,ttfb:i.responseStart-i.requestStart,contentDownload:i.responseEnd-i.responseStart,domParse:i.domInteractive-i.domLoading,resourceDownload:o,firstScreenTiming:Math.floor(n)},t.publish(X,e))}))}catch(e){}},publish:function(e,t){var n,o=[];for(n in e)o.push(n+"="+e[n]);var i=this.$getConfig(t),a=-1===t.config.performanceUrl.indexOf("?")?"?":"&";"function"==typeof i.urlHandler?t.send({url:t.config.performanceUrl+a+o.join("&")+"&from="+(encodeURIComponent(i.urlHandler())||window.location.href),beanFilter:["from"],type:_.PERFORMANCE}):t.send({url:t.config.performanceUrl+a+o.join("&"),type:_.PERFORMANCE})},getFirstScreenTiming:function(e,t){var n=["script","style","link","br"],o=[],i=this,a=new MutationObserver((function(e){var t={roots:[],rootsDomNum:[],time:performance.now()};e.forEach((function(e){e&&e.addedNodes&&e.addedNodes.forEach&&e.addedNodes.forEach((function(e){1!==e.nodeType||-1!==n.indexOf(e.nodeName.toLocaleLowerCase())||i.isEleInArray(e,t.roots)||e.hasAttribute("AEGIS-IGNORE-FIRST-SCREEN-TIMING")||(t.roots.push(e),t.rootsDomNum.push(i.walkAndCount(e)||0))}))})),t.roots.length&&o.push(t)}));a.observe(document,{childList:!0,subtree:!0}),setTimeout((function(){a.disconnect();var n=0,r=0,l=!1;o.forEach((function(t){for(var o=0;o<t.roots.length;o++)t.rootsDomNum[o]>n&&i.isInFirstScreen(t.roots[o])&&(n=t.rootsDomNum[o],r=t.time,e.firstScreenInfo={element:t.roots[o],timing:r})}));for(var s,u=document.querySelectorAll(".fp-check"),c=[],d=0;d<u.length;d++)"img"===u[d].tagName.toLowerCase()&&""!==u[d].src?c.push(u[d].src):(s=window.getComputedStyle(u[d]),(s=/url\(['"](.+)['"]\)/gi.exec(s.backgroundImage))&&2===s.length&&c.push(s[1]));var _=0;window.performance.getEntriesByType("resource").some((function(e){return c.some((function(t,n){return t===e.name&&(e.responseEnd>_&&(_=e.responseEnd),(e.fetchStart<r||e.startTime<r)&&e.responseEnd>r&&(l=!0,r=e.responseEnd),c.splice(n,1),!0)})),0===c.length})),0===r&&(r=_),null==t||t(l?r:r+25)}),3e3)},isEleInArray:function(e,t){return!(!e||e===document.documentElement)&&(-1!==t.indexOf(e)||this.isEleInArray(e.parentElement,t))},isInFirstScreen:function(e){if(!e||"function"!=typeof e.getBoundingClientRect)return!1;var t=e.getBoundingClientRect(),n=window.innerHeight;return e=window.innerWidth,0<=t.left&&t.left<e&&0<=t.top&&t.top<n},walkAndCount:function(e){var t=0;if(e&&1===e.nodeType){t+=1;var n=e.children;if(null!=n&&n.length)for(var o=0;o<n.length;o++)t+=this.walkAndCount(n[o])}return t}})),oe=!1,ie=!1,ae=(new y({name:"webVitals"}),new y({name:"webVitals",onNewAegis:function(e){if(s())try{!function(e,t){function n(e){var t=e.startTime;t<a.timeStamp?(i.value=t,i.entries.push(e)):i.isFinal=!0,o()}t=1<arguments.length&&void 0!==t&&t;var o,i=G("LCP"),a=Y(),r=Q("largest-contentful-paint",n);r&&(o=q(e,i,r,t),t=function(){i.isFinal||(r.takeRecords().map(n),i.isFinal=!0,o())},(Z=Z||new Promise((function(e){return["scroll","keydown","pointerdown"].map((function(t){addEventListener(t,e,{once:!0,passive:!0,capture:!0})}))}))).then(t),K(t,!0))}(this.publish.bind(this,e)),n=this.publish.bind(this,e),o=G("FID"),i=Y(),a=Q("first-input",t),r=q(n,o,a),a?K((function(){a.takeRecords().map(t),a.disconnect()}),!0):window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&window.perfMetrics.onFirstInputDelay((function(e,t){t.timeStamp<i.timeStamp&&(o.value=e,o.isFinal=!0,o.entries=[{entryType:"first-input",name:t.type,target:t.target,cancelable:t.cancelable,startTime:t.timeStamp,processingStart:t.timeStamp+e}],r())})),function(e,t){function n(e){e.hadRecentInput||(i.value+=e.value,i.entries.push(e),o())}t=1<arguments.length&&void 0!==t&&t;var o,i=G("CLS",0),a=Q("layout-shift",n);a&&(o=q(e,i,a,t),K((function(e){e=e.isUnloading,a.takeRecords().map(n),e&&(i.isFinal=!0),o()})))}(this.publish.bind(this,e))}catch(e){}function t(e){e.startTime<i.timeStamp&&(o.value=e.processingStart-e.startTime,o.entries.push(e),o.isFinal=!0,r())}var n,o,i,a,r},publish:function(e,t){var n,o=t.name,i=t.value,a={LCP:-1,FID:-1,CLS:-1},r=[];for(n in a)r.push(n+"="+(n===o?i:a[n]));t=-1===e.config.performanceUrl.indexOf("?")?"?":"&",e.send({url:e.config.webVitalsUrl+t+r.join("&"),type:_.VITALS})}})),re=(new y({name:"tjg"}),!1),le=new y({name:"tjg",onNewAegis:function(e){this.setTjgHeader(e)},setTjgHeader:function(e){re||(re=!0,this.overrideFetch(e),this.overrideXHR(e))},overrideFetch:function(e){var t=this;P({beforeFetch:function(n,o){t.isSameOrigin(n)&&(o.headers?o.headers instanceof Headers&&o.headers.append("X-Tjg-Json-Span-Context",t.getTjgHeaderValue(e)):o.headers=new Headers({"X-Tjg-Json-Span-Context":t.getTjgHeaderValue(e)}))}})},overrideXHR:function(e){var t=this;j({send:function(n,o){var i;t.isSameOrigin(n.aegisUrl)&&(i=t.getTjgHeaderValue(e),n.aegisTjgTrace=i,n.setRequestHeader("X-Tjg-Json-Span-Context",i))}})},getTjgHeaderValue:function(e){return window.btoa&&window.btoa(JSON.stringify({ids:{trace_id:{high:this.rand53(),low:this.rand53()},span_id:this.rand53(),parent_id:0,flag:2},baggages:{aegis_session_id:e.sessionID}}))},rand53:function(){return parseInt(new Array(53).fill(1).map((function(){return.5<Math.random()?1:0})).join(""),2)},isSameOrigin:function(e){var t=this,n=!1;if(this.$walk((function(e){!0===t.$getConfig(e).crossOrigin&&(n=!0)})),n)return!0;var o=document.createElement("a");return o.href=e,location.origin===o.origin}}),se=function(e,t){var n,o={fetch:[],static:[]},i=new FormData;return Array.isArray(e)?e.forEach((function(e){var t=J(e);o[e.type].push(t)})):(n=J(e),o[e.type].push(n)),i.append("payload",JSON.stringify(M({duration:o},t))),i};Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o){o=Object(o);for(var i=Object.keys(Object(o)),a=0,r=i.length;a<r;a++){var l=i[a],s=Object.getOwnPropertyDescriptor(o,l);null!=s&&s.enumerable&&(t[l]=o[l])}}}return t}});var ue,ce,de=0,_e=(V(ce=Ee,pe=ue=A),ce.prototype=null===pe?Object.create(pe):(fe.prototype=pe.prototype,new fe),Ee.prototype.getBean=function(e){var t=this;return void 0===e&&(e=[]),""+Object.getOwnPropertyNames(this.bean).filter((function(t){return-1===e.indexOf(t)})).map((function(e){return e+"="+t.bean[e]})).join("&")},Ee.prototype.send=function(e,t,n){var o=this;if(e&&"string"==typeof e.url&&""!==e.url&&this.bean.id)if(this.requesting)this.requestQueue.push({options:e,success:t,fail:n});else{this.requesting=!0;var i=e.url;!1!==e.addBean&&(i=i+(-1===i.indexOf("?")?"?":"&")+this.getBean(e.beanFilter)),e.url=i;var a=e.method||"get";if(!(e=(i=this.config.onBeforeRequest)?i(e,this):e)||!e.url)return console.error("Please handle the parameters reasonably, options.url is necessary");var r=new XMLHttpRequest;r.sendByAegis=!0,r.addEventListener("readystatechange",(function(){var e;4===r.readyState&&(o.requesting=!1,(e=o.requestQueue.shift())&&o.send(e.options,e.success,e.fail),400<=r.status?null==n||n(r.response):null==t||t(r.response))})),"get"===a.toLocaleLowerCase()?(r.open("get",function(e,t){if("string"!=typeof e)return"";if("object"==typeof t&&t){var n=Object.getOwnPropertyNames(t).map((function(e){var n=t[e];return e+"="+("string"==typeof n?encodeURIComponent(n):encodeURIComponent(JSON.stringify(n)))})).join("&").replace(/eval/gi,"evaI");return e+(-1===e.indexOf("?")?"?":"&")+n}return e}(e.url,e.data)),r.send()):(r.open("post",e.url),e.contentType&&r.setRequestHeader("Content-Type",e.contentType),"string"==typeof e.data&&(e.data=e.data.replace(/eval/gi,"evaI")),r.send(e.data))}},Ee.useAsyncPlugin=function(e,t){var n,o=void 0===(n=(t=void 0===t?{}:t).exportsConstructor)?"aegis-plugin-"+de:n,i=void 0===(n=t.onAegisInit)?function(){}:n,a=void 0===(t=t.onAegisInitAndPluginLoaded)?function(){}:t;if(de+=1,"string"!=typeof e)throw new TypeError("useAsyncPlugin first param must be string");if("function"!=typeof i||"function"!=typeof a)throw new TypeError("onAegisInit and onAegisInitAndPluginLoaded must be function");this.use(new y({name:"asyncPlugin",onNewAegis:function(t){try{i(t),Ee.asyncPlugin[e]?a(t,window[Ee.asyncPlugin[e]]):(n=e,r=o,l=function(n){n||(Ee.asyncPlugin[e]=o,n=window[o],a(t,n))},s=document.createElement("script"),u=document.head,"function"==typeof r&&(l=r,r=""),s.src=n,s.setAttribute("name",r),s.name=r,s.setAttribute("crossorigin","anonymous"),s.crossorigin="anonymous",s.async=!0,s.onreadystatechange=function(){s.readyState&&"loaded"!==s.readyState&&"complete"!==s.readyState||("function"==typeof l&&l(!1),setTimeout((function(){u.contains(s)&&u.removeChild(s)})))},s.onload=s.onreadystatechange,s.onerror=function(){"function"==typeof l&&l(!0),setTimeout((function(){u.contains(s)&&u.removeChild(s)}))},u.appendChild(s))}catch(n){console.error(n)}var n,r,l,s,u}}))},Ee.prototype.uploadLogs=function(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.lifeCycle.emit("uploadLogs",e,t)},Ee.__version__="1.25.11",Ee.sessionID="session-"+Date.now(),Ee.asyncPlugin={},Ee.urls={aegisCollect:"https://aegis.qq.com/collect",flog:"https://cdn-go.cn/vasdev/web_webpersistance_v2/v1.5.4/flog.core.min.js",shadowLog:""},Ee),pe=(new y({name:"offlineLog"}),A=new y({name:"offlineLog",onNewAegis:function(t){var n=_e.urls.flog,o=t.config,i=[],a=null,r=function(e){i=i.concat(e)},l=function(e,t){a={conds:e=void 0===e?{}:e,params:t=void 0===t?{}:t}};_e.useAsyncPlugin(n,{exportsConstructor:"Flog",onAegisInit:function(e){e.lifeCycle.on("beforeWrite",r),e.lifeCycle.on("uploadLogs",l)},onAegisInitAndPluginLoaded:function(t,n){var s=void 0===(p=o.dbConfig)?{}:p,u=void 0===(E=o.url)?_e.urls.aegisCollect:E,p=void 0===(f=o.offlineLogExp)?3:f,E=o.id,f=o.uin;t.lifeCycle.remove("beforeWrite",r),t.lifeCycle.remove("uploadLogs",l);var m=Object.assign({lookupUrl:u+"/offlineAuto?id="+E+"&uin="+f,preservedDay:p,id:E,uin:f},s,{sessionId:_e.sessionID});try{var T=new n(m);i.forEach((function(e){T.add(M(M({},e),{level:d.INFO_ALL?d.INFO:e.level}))})),t.lifeCycle.on("beforeWrite",(function(e){(e=void 0===e?[]:e).forEach((function(e){T.add(M(M({},e),{level:d.INFO_ALL?d.INFO:e.level}))}))})),t.lifeCycle.on("uploadLogs",(function(e,t){void 0===e&&(e={}),void 0===t&&(t={}),T.uploadLogs(Object.assign({id:o.id,uin:o.uin},e),t)})),t.lifeCycle.on("onConfigChange",(function(e){T.setConfig(e)})),T.on("PERREVENT",(function(n){t.send({type:_.OFFLINE,data:e({msg:c(n),level:d.INFO}),contentType:"application/x-www-form-urlencoded",method:"post",addBean:!1,url:o.url+"?id=893&sessionId="+_e.sessionID+"&uin="+o.uin+"&from="+o.id+"&count=1&version=1.25.11"})})),a&&(t.lifeCycle.emit("uploadLogs",a.conds,a.params),a=null),t.flog=T}catch(t){}}})}}),new y({name:"spa"}),new y({name:"spa",init:function(){history.pushState=this.wr("pushState")||history.pushState,history.replaceState=this.wr("replaceState")||history.replaceState,this._firedUrl=location.href,this.sendPv=this.sendPv.bind(this),this.onPageChange()},onPageChange:function(){window.addEventListener("replaceState",this.sendPv),window.addEventListener("pushState",this.sendPv),window.addEventListener("popstate",this.sendPv)},wr:function(e){var t=history[e];return!("function"!=typeof t||!/native code/.test(t.toString()))&&function(){var n=t.apply(this,arguments),o=new Event(e);return window.dispatchEvent(o),n}},sendPv:function(){var e=this;setTimeout((function(){var t=location.href;t!==e._firedUrl&&(e.$walk((function(e){e.send({url:e.config.whiteListUrl+"?from="+encodeURIComponent(t),beanFilter:["from"],type:_.WHITE_LIST})})),e._firedUrl=t)}),0)}}));function Ee(e){var t,n=ue.call(this,e)||this;n.requestQueue=[],n.requesting=!1,n.speedLogPipeline=S([g(n.config),R(n.config),(t=n,function(e,n){ee((function(o){t.extendBean("netType",o),n(e)}))}),function(e,t){n.lifeCycle.emit("beforeReportSpeed",e);var o=n.config.beforeReportSpeed;if((e="function"==typeof o?e.filter((function(e){var t=!1!==o(e);return"fetch"===e.type&&void 0===e.ret&&e.payload&&(e.ret=f(e.payload.data.response,n.config.api)),t})):e).length)return t(e)},function(e){n.send({type:_.SPEED,url:""+n.config.speedUrl,method:"post",data:se(e,n.bean)})}]),e.asyncPlugin=!0;try{e.uin=e.uin||parseInt((document.cookie.match(/\buin=\D+(\d*)/)||[])[1],10)||parseInt((document.cookie.match(/\bilive_uin=\D*(\d+)/)||[])[1],10)||"",n.init(e),n.extendBean("sessionId",Ee.sessionID),n.extendBean("from",encodeURIComponent(e.pageUrl||location.href)),n.extendBean("referer",encodeURIComponent(document.referrer||""))}catch(e){console.warn(e),n.sendSDKError(e)}return n}function fe(){this.constructor=ce}return new y({name:"ie"}),_e.use(te),_e.use(B),_e.use(N),_e.use(ne),_e.use(ae),_e.use(I),_e.use(le),_e.use($),_e.use(A),_e.use(pe),_e}()},"../node_modules/@tencent/doc-visibilitychange/dist/tabkit.js":function(e,t,n){(function(t){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}({3:function(e,t,n){"use strict";n.r(t);var o,i=function(){function e(e){this.taskId=this.getRandomId(),this.taskFunction=e}return e.prototype.exec=function(){this.taskFunction()},e.prototype.getRandomId=function(){return Date.now().toString(32)+Math.random().toString(32).substring(2)},e}();void 0!==document.hidden?o="visibilitychange":void 0!==document.msHidden?o="msvisibilitychange":void 0!==document.webkitHidden&&(o="webkitvisibilitychange");var a,r,l,s=new(function(){function e(){var e=this;this.visibleTasks=[],this.hiddenTasks=[],this.destroyTasks=[],document.addEventListener(o,(function(){"hidden"===document.visibilityState&&e.hiddenTasks.forEach((function(e){return e.exec()})),"visible"===document.visibilityState&&e.visibleTasks.forEach((function(e){return e.exec()}))}))}return e.prototype.registerOnVisible=function(e){var t=new i(e);return this.visibleTasks.push(t),t.taskId},e.prototype.registerOnHidden=function(e){var t=new i(e);return this.hiddenTasks.push(t),t.taskId},e.prototype.registerOnDestory=function(e){var t=new i(e);return this.destroyTasks.push(t),t.taskId},e.prototype.destroy=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){e.destroyTasks.find((function(e){return e.taskId===t})).exec()}))},e.prototype.clear=function(){this.visibleTasks.length=0,this.hiddenTasks.length=0,this.destroyTasks.length=0},e}());!function(e){e.TabCountChange="TabCountChange",e.SuspendTab="SuspendTab"}(a||(a={})),function(e){e.Active="active",e.Inactive="inactive"}(r||(r={})),function(e){e.ReactivateTab="reactivate_tab",e.SuspendTab="suspend_tab",e.ReportOnly="report_only"}(l||(l={}));var u=/^tabStatus/,c=function(){function e(e){var t=this;this.suspendTimer=0,this.updateTimer=0,this.tabCount=1,this.disabledTime=36e4,this.tabCountLimit=0,this.handleStorageChange=function(){var e=t.getTabCount();e!==t.tabCount&&(t.listener.get(a.TabCountChange).forEach((function(e){return e()})),t.updateTabCount(e))},this.handleUnload=function(){localStorage.removeItem("tabStatus_"+t.id),t.destroy()},this.handleVisibilityChange=function(){if("visible"===document.visibilityState){clearTimeout(t.suspendTimer);var e=Date.now();t.report(l.ReactivateTab,e),t.updateCurTabStatus({activeTime:e,leaveTime:e,suspended:!1}),t.checkStatus()}else e=Date.now(),t.updateCurTabStatus({leaveTime:e}),clearTimeout(t.beatTimer)},this.options=e,this.count=this.getTabCount()||0,this.beatTimer=0,this.tabCountLimit=e.tabCountLimit||50,this.suspendTabTimeLimit=e.suspendTabTimeLimit||216e5,this.id=e.docId+"_"+this.getUniqId(),this.listener=new Map,this.log=e.log,this.handleLoad(),this.initEvent()}return Object.defineProperty(e.prototype,"defaultReportOptions",{get:function(){return{tab_count:this.getTabCount(),tab_limit:this.tabCountLimit,time_limit:this.suspendTabTimeLimit}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reportReactivateTimeLimit",{get:function(){return Math.floor(.8*this.suspendTabTimeLimit)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"beatTime",{get:function(){return Math.min(3e5,Math.max(this.suspendTabTimeLimit/10,1e4))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logOptions",{get:function(){return{tab_count:this.getTabCount()}},enumerable:!1,configurable:!0}),e.prototype.getTabStatus=function(e){var t=localStorage.getItem("tabStatus_"+e);if(t)return JSON.parse(t)},e.prototype.setTabStatus=function(e,t){localStorage.setItem("tabStatus_"+e,JSON.stringify(t))},e.prototype.setTabCountLimit=function(e){this.tabCountLimit=e},e.prototype.checkStatus=function(){var e=this;clearInterval(this.beatTimer),this.beatTimer=setInterval((function(){var t=e.getAllTabStatus(),n=Object.keys(t),o=Date.now();n.forEach((function(n){var i=t[n];(!i||o-i>e.disabledTime)&&localStorage.removeItem(n)}))}),this.beatTime)},e.prototype.getCurTabStatus=function(){return this.getTabStatus(this.id)},e.prototype.getAllTabStatus=function(){var e={};return Object.keys(localStorage).forEach((function(t){u.test(t)&&(e[t]=t)})),e},e.prototype.getTabCount=function(){var e=0;return Object.keys(localStorage).forEach((function(t){u.test(t)&&(e+=1)})),e},e.prototype.addListener=function(e,t){var n=this.listener.get(e);n||(n=[],this.listener.set(e,n)),n.push(t)},e.prototype.removeListener=function(e,t){if(this.listener.has(e)){var n=this.listener.get(e),o=n.indexOf(t);-1!==o&&n.splice(o,1)}},e.prototype.destroy=function(){this.listener.clear(),clearTimeout(this.beatTimer),clearTimeout(this.updateTimer),document.removeEventListener("visibilitychange",this.handleVisibilityChange),window.removeEventListener("beforeunload",this.handleUnload),window.removeEventListener("storage",this.handleStorageChange)},e.prototype.initEvent=function(){document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("beforeunload",this.handleUnload)},e.prototype.handleLoad=function(){var e=Date.now();this.updateCurTabStatus({activeTime:e,leaveTime:e}),this.heartbeat(),"visible"===document.visibilityState&&this.checkStatus(),this.report(l.ReportOnly,Date.now())},e.prototype.getUniqId=function(){return""+~~(1e9*Math.random())},e.prototype.getLogData=function(e,t){return Object.assign({action:e,status:"visible"===document.visibilityState?r.Active:r.Inactive,inactive_duration:Math.floor(t/1e3),tabinfo:this.getCurTabStatus()},this.defaultReportOptions)},e.prototype.updateTabCount=function(e){this.tabCount=e},e.prototype.suspend=function(){var e=this.listener.get(a.SuspendTab),t=this.options.canLeavePage;t?(t(),this.report(l.ReportOnly,Date.now()),this.handleUnload()):this.report(l.SuspendTab,Date.now()),e&&e.forEach((function(e){return e()})),this.updateCurTabStatus({suspended:!0})},e.prototype.updateCurTabStatus=function(e){var t=this.getTabStatus(this.id)||{};e.activeTime&&(t.activeTime=e.activeTime),e.leaveTime&&(t.leaveTime=e.leaveTime),e.suspended?e.suspended&&(t.suspended=!0):delete t.suspended,(t.activeTime||t.leaveTime)&&this.setTabStatus(this.id,t)},e.prototype.suspendTab=function(){var e,t=this;if("visible"!==document.visibilityState){var n=this.getAllTabStatus(),o=Object.keys(n);if(!(o.length-this.tabCountLimit<=0)){var i=this.id,a=null===(e=n[i])||void 0===e?void 0:e.leaveTime;if(!(Date.now()-a<this.suspendTabTimeLimit)){var r=!0;o.forEach((function(e){var o;if(e!==t.id){var i=n[e].leaveTime;if(i){var l=null===(o=n[e])||void 0===o?void 0:o.suspended;i<a&&l&&(r=!1)}}})),r&&(this.suspendTimer=setTimeout((function(){t.suspend()})))}}}},e.prototype.report=function(e,t){var n=this.getTabStatus(this.id);if(n){var o=n.leaveTime;if(o){var i=t-o;if(e===l.ReactivateTab&&o<this.reportReactivateTimeLimit)return;var a=this.getLogData(e,i);this.log(e,a)}}},e.prototype.heartbeat=function(){var e=this;this.updateTimer=setInterval((function(){e.updateCurTabStatus({activeTime:Date.now()}),e.getTabCount()>e.tabCountLimit&&e.suspendTab()}),this.beatTime)},e}(),d={visibilitychange:s,tabManager:new(function(){function e(e){var t=this;this.option=e,this.strategies=[],this.onMaxTab=function(){t.strategies.forEach((function(e){return e.release()}))}}return e.prototype.addStrategy=function(e){this.strategies.push(e)},e.prototype.start=function(e){this.init(e),this.tabStatusManager.addListener(a.SuspendTab,this.onMaxTab)},e.prototype.stop=function(){this.tabStatusManager&&this.tabStatusManager.removeListener(a.SuspendTab,this.onMaxTab)},e.prototype.init=function(e){var t=e.log||function(){};this.tabStatusManager||(this.tabStatusManager=new c(Object.assign({tabCountLimit:10,suspendTabTimeLimit:3e5,docId:e.docId,log:t},this.option)))},e}())};t.default=d}}).default}).call(this,n("../node_modules/webpack/buildin/global.js"))},"../node_modules/@tencent/jank-sdk/lib/default.json":function(e){e.exports=JSON.parse('{"HeartbeatConfig":{"jankLimit":1000,"TriggerLimit":10,"StopOnPageHidden":true},"PageActiveConfig":{"Limit":180000}}')},"../node_modules/@tencent/jank-sdk/lib/index.js":function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return T}));var o,i,a=n("../node_modules/@tencent/jank-sdk/lib/default.json"),r=function(){function e(){this._listeners={}}return e.prototype._hasEventListener=function(e,t){return void 0!==this._listeners[e]&&this._listeners[e].indexOf(t)>-1},e.prototype.addEventListener=function(e,t){this._hasEventListener(e,t)||(void 0===this._listeners[e]&&(this._listeners[e]=[]),this._listeners[e].push(t))},e.prototype.removeEventListener=function(e,t){if(this._hasEventListener(e,t)){var n=this._listeners[e].indexOf(t);this._listeners[e].splice(n,1)}},e.prototype.dispatchEvent=function(e,t){if(void 0!==this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},e}(),l=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=function(e){function t(t){var n=e.call(this)||this;return n._handleVisibilityChange=function(){var e=document[o];"hidden"===e?n.stop():n.start(),n.dispatchEvent("pageVisiableChange",e)},n._tick=function(){n._timeoutTimer=null;var e=Date.now()-n._preHeartBeatTime;e>n._app.config.HeartbeatConfig.jankLimit?(n._triggerTimes++,n.dispatchEvent("jank",e)):n.dispatchEvent("heart",e),null===n._timeoutTimer&&n._checkNextTick()},n._app=t,n._status="uninit",n._preHeartBeatTime=0,n._timeoutTimer=null,n._triggerTimes=0,n}return l(t,e),t.prototype._init=function(){if(this._app.config.HeartbeatConfig.StopOnPageHidden){if("undefined"!==typeof document.hidden)i="visibilitychange",o="visibilityState";else if("undefined"!==typeof document.mozHidden)i="mozvisibilitychange",o="mozVisibilityState";else if("undefined"!==typeof document.msHidden)i="msvisibilitychange",o="msVisibilityState";else{if("undefined"===typeof document.webkitHidden)return;i="webkitvisibilitychange",o="webkitVisibilityState"}document.addEventListener(i,this._handleVisibilityChange)}},t.prototype._checkNextTick=function(){0!==this._app.config.HeartbeatConfig.TriggerLimit&&this._triggerTimes>=this._app.config.HeartbeatConfig.TriggerLimit?this._status="finish":(this._preHeartBeatTime=Date.now(),this._timeoutTimer=globalThis.requestAnimationFrame(this._tick))},t.prototype.start=function(){this._app.config.HeartbeatConfig.StopOnPageHidden&&document.hidden||("uninit"===this._status&&this._init(),"finish"!==this._status&&"run"!==this._status&&(this._timeoutTimer?console.warn("[jank] timeout exist"):(this._status="run",this._checkNextTick())))},t.prototype.stop=function(){"finish"!==this._status&&"stop"!==this._status&&(clearTimeout(this._timeoutTimer),this._timeoutTimer=null,this._status="stop")},t}(r),u=navigator.userAgent.toLowerCase(),c="pc"===(/(android)/.test(u)?"android":/(iphone|ipad|ipod)/.test(u)?"ios":"pc"),d=function(){function e(e){var t=this;this._timer=0,this._lastActive=0,this._check=function(){c?document.body.addEventListener("mousemove",t._handle):document.body.addEventListener("touchstart",t._handle)},this._handle=function(){c?document.body.removeEventListener("mousemove",t._handle):document.body.removeEventListener("touchstart",t._handle),t.start()},this._app=e,this._timeInterval=this._app.config.PageActiveConfig.Limit}return e.prototype.start=function(){this._lastActive=Date.now(),this._timer=setTimeout(this._check,this._timeInterval)},e.prototype.stop=function(){clearTimeout(this._timer)},e.prototype.lastActive=function(){return this._lastActive},e}(),_=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();var p=new(function(e){function t(){var t=e.call(this)||this;return t._queue=[],t._taskStack=[],t._count=0,t}return _(t,e),t.prototype._runTask=function(){this.dispatchEvent("runTask")},t.prototype._overTask=function(){this._queue.push(this._parse()),this._taskStack=[],this._count=0,this._queue.length>5&&(this._queue=this._queue.slice(-5)),this.dispatchEvent("overTask")},t.prototype._parse=function(){for(var e,t=[],n=[],o=0;o<this._taskStack.length;o++)if((e=this._taskStack[o]).sub=[],void 0===t[0]||t[0].id!==e.id||t[0].type===e.type)(t[0]?t[0].sub:n).push(e),t.unshift(e);else{var i=t.shift();i.time=e.end-i.start,i.start=i.start,delete i.type}return n},Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"task",{get:function(){return this._queue[this._queue.length-1]},enumerable:!0,configurable:!0}),t.prototype.start=function(e){0===this._count&&this._runTask(),this._count++,this._taskStack.push({id:e,start:Date.now(),type:0})},t.prototype.end=function(e){this._taskStack.push({id:e,end:Date.now(),type:1}),this._count--,0===this._count&&this._overTask()},t.prototype.clear=function(){0===this._count?this._queue.length=0:console.warn("\u5806\u6808\u8bb0\u5f55\u6267\u884c\u8fc7\u7a0b\u4e2d\u65e0\u6cd5\u6e05\u9664")},t}(r));var E=function(e){return function(t,n,o){!function(e,t,n,o){var i;try{if(i=e.toString().match(/^(class|function)\s(\w+)[\(\s]/),"[object Array]"!==Object.prototype.toString.apply(i))return console.warn("proxy function error",i),o}catch(r){return console.warn("proxy function error",r),o}var a=i[2];if("string"!==typeof a)return o;e.prototype[n+"-decorators"]=o.value,o.value=function(){p.start(a+"-"+n);var t=e.prototype[n+"-decorators"].apply(this,arguments);return p.end(a+"-"+n),t}}(e,0,n,o)}};var f,m,T=function(e,t){if(!t){var n=void 0;try{if(n=e.toString().match(/^(function)\s(\w+)[\(\s]/),"[object Array]"!==Object.prototype.toString.apply(n))return console.warn("proxy function error"),e}catch(o){return console.warn("proxy function error",o),e}if(null===n)return e;t=n[2]}return"string"!==typeof t?e:function(){p.start(""+t);var n=e.apply(this,arguments);return p.end(""+t),n}};!function(e){e.REGISTER="jank_register",e.HEARTBEAT="jank_heartbeat",e.ASK_AMOUNT="jank_ask_amount",e.UNREGISTER="jank_unregister"}(f||(f={})),function(e){e.CONFIRM="jank_confirm",e.HEARTBEAT="jank_heartbeat",e.REPLY_AMOUNT="jank_reply_amount"}(m||(m={}));var O,h=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(e){e[e.UNINIT=0]="UNINIT",e[e.RUNNING=1]="RUNNING",e[e.FINISH=2]="FINISH"}(O||(O={}));var v=function(e){function t(){var t=e.call(this)||this;return t._status=O.UNINIT,t._controller=null,t._resolve=null,t._reject=null,t._handleMessage=function(e){var n=e.data;switch(n.type){case m.CONFIRM:break;case m.HEARTBEAT:t._heartbeat();break;case m.REPLY_AMOUNT:t._replyAmount(n.data);break;default:console.error("unknown response message in tabs amount")}},t._handleBeforeunload=function(){t._unregister()},t}return h(t,e),t.prototype._sendMessage=function(e){this._controller&&this._controller.postMessage&&this._controller.postMessage(e)},t.prototype._replyAmount=function(e){void 0===e&&this._reject("unknown error"),0===e.retcode?this._resolve(e.result):this._reject(e.result),this._resolve=null,this._reject=null},t.prototype._register=function(){this._sendMessage({type:f.REGISTER})},t.prototype._unregister=function(){this._sendMessage({type:f.UNREGISTER})},t.prototype._heartbeat=function(){this._sendMessage({type:f.HEARTBEAT})},t.prototype._askAmount=function(){this._sendMessage({type:f.ASK_AMOUNT})},t.prototype._addEventListener=function(){navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",this._handleMessage),window.addEventListener("beforeunload",this._handleBeforeunload)},t.prototype.start=function(){this._status==O.UNINIT?navigator.serviceWorker?navigator.serviceWorker.controller?(this._controller=navigator.serviceWorker.controller,this._status=O.RUNNING,this._register(),this._addEventListener()):console.error("please register service by business code"):console.error("can't use service-worker in this client"):console.error("only can start tabs amount once")},t.prototype.end=function(){this._status=O.FINISH,this._unregister()},t.prototype.amount=function(){var e=this;return null!==this._resolve||null!==this._reject?Promise.reject("repeat request"):(this._askAmount(),new Promise((function(t,n){e._resolve=t,e._reject=n})))},t}(r),b=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),R=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return t.HeartbeatConfig&&Object.assign(a.HeartbeatConfig,t.HeartbeatConfig),t.PageActiveConfig&&Object.assign(a.PageActiveConfig,t.PageActiveConfig),n._config=Object.assign(a,t),n._initHeartbeatMonitor(),n._initPageActiveMonitor(),n._initTabsAmountMonitor(),n._traceStack=p,n}return b(t,e),t.prototype._initHeartbeatMonitor=function(){this._heartbeatMonitor=new s(this)},t.prototype._initPageActiveMonitor=function(){this._pageActiveMonitor=new d(this)},t.prototype._initTabsAmountMonitor=function(){this._tabsAmountMonitor=new v},Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"heartbeatMonitor",{get:function(){return this._heartbeatMonitor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageActiveMonitor",{get:function(){return this._pageActiveMonitor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tabsAmountMonitor",{get:function(){return this._tabsAmountMonitor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"traceStack",{get:function(){return this._traceStack},enumerable:!0,configurable:!0}),t}(r);t.a=R},"./src/core/behavior/index.ts":function(e,t,n){"use strict";var o,i=n("../packages/mutation/src/api.ts"),a=n("../packages/mutation/src/MutationId.ts"),r=n("../packages/mutation/src/MutationOperationType.ts"),l=n("../packages/mutation/src/dimension/SetDimensionPropertiesMutation.ts"),s=n("../packages/mutation/src/cell/SetRangeMutation.ts"),u=n("../packages/mutation/src/cell/SetCellPropertiesMutation.ts");!function(e){e[e.ReverseOrder=0]="ReverseOrder",e[e.PositiveSequence=1]="PositiveSequence"}(o||(o={}));var c,d,_,p,E=o,f=n("./src/core/behavior/request/workbook/filterUtils/searchCloseDataArea.ts"),m=n("./src/core/behavior/request/Type.ts");(p=c||(c={})).MutationBehavior=i.a,(_=p.Mutation||(p.Mutation={})).MUTATION_ID=a.b,_.MUTATION_OPERATION_TYPE=r.a,_.SetRangeMutation=s.a,_.SetCellPropertiesMutation=u.a,(p.Request||(p.Request={})).REQUEST_ID=m.a,(d=p.Interface||(p.Interface={})).ReorderType=E,d.DIMENSION_PROPERTIES_SLOT=l.a,(p.Utils||(p.Utils={})).searchCloseDataArea=f.a;t.a=c},"./src/core/behavior/request/Type.ts":function(e,t,n){"use strict";var o;!function(e){e[e.INSERT_DIMENSION_REQUEST=0]="INSERT_DIMENSION_REQUEST",e[e.DELETE_DIMENSION_REQUEST=1]="DELETE_DIMENSION_REQUEST",e[e.MOVE_DIMENSION_REQUEST=2]="MOVE_DIMENSION_REQUEST",e[e.SET_DIMENSION_SIZE_REQUEST=3]="SET_DIMENSION_SIZE_REQUEST",e[e.SET_DIMENSION_HIDE_REQUEST=4]="SET_DIMENSION_HIDE_REQUEST",e[e.SET_DIMENSION_SHOW_REQUEST=5]="SET_DIMENSION_SHOW_REQUEST",e[e.ADD_IMAGE_REQUEST=6]="ADD_IMAGE_REQUEST",e[e.DELETE_IMAGE_REQUEST=7]="DELETE_IMAGE_REQUEST",e[e.UPDATE_IMAGE_REQUEST=8]="UPDATE_IMAGE_REQUEST",e[e.MERGE_CELLS_REQUEST=9]="MERGE_CELLS_REQUEST",e[e.UNMERGE_CELLS_REQUEST=10]="UNMERGE_CELLS_REQUEST",e[e.SET_SHEETS_REQUEST=11]="SET_SHEETS_REQUEST",e[e.SET_FORMAT_REQUEST=12]="SET_FORMAT_REQUEST",e[e.REORDER_RANGE_REQUEST=13]="REORDER_RANGE_REQUEST",e[e.FREEZE_REQUEST=14]="FREEZE_REQUEST",e[e.SET_SINGLE_VALUE_REQUEST=15]="SET_SINGLE_VALUE_REQUEST",e[e.SET_BORDERS_REQUEST=16]="SET_BORDERS_REQUEST",e[e.COPY_PASTE_REQUEST=17]="COPY_PASTE_REQUEST",e[e.CUT_PASTE_REQUEST=18]="CUT_PASTE_REQUEST",e[e.PASTE_DATA_REQUEST=19]="PASTE_DATA_REQUEST",e[e.CLEAR_FORMAT_REQUEST=20]="CLEAR_FORMAT_REQUEST",e[e.REPLACE_ALL_REQUEST=21]="REPLACE_ALL_REQUEST",e[e.SET_LINK_REQUEST=22]="SET_LINK_REQUEST",e[e.CLEAR_LINK_REQUEST=23]="CLEAR_LINK_REQUEST",e[e.CLEAR_RANGE_REQUEST=24]="CLEAR_RANGE_REQUEST",e[e.SET_NUMBER_FORMAT_REQUEST=25]="SET_NUMBER_FORMAT_REQUEST",e[e.ADJUST_DECIMALS_REQUEST=26]="ADJUST_DECIMALS_REQUEST",e[e.AUTO_FILL_REQUEST=27]="AUTO_FILL_REQUEST",e[e.SET_BASIC_FILTER_REQUEST=28]="SET_BASIC_FILTER_REQUEST",e[e.CLEAR_BASIC_FILTER_REQUEST=29]="CLEAR_BASIC_FILTER_REQUEST",e[e.EXPAND_DIMENSION_REQUEST=30]="EXPAND_DIMENSION_REQUEST",e[e.UPDATE_FILTER_CRITERIA_REQUEST=31]="UPDATE_FILTER_CRITERIA_REQUEST",e[e.SET_RANGE_VALUE_REQUEST=32]="SET_RANGE_VALUE_REQUEST",e[e.MULTI_REQUEST=33]="MULTI_REQUEST",e[e.CLEAR_COMMENT_REQUEST=34]="CLEAR_COMMENT_REQUEST",e[e.UPDATE_COMMENT_REQUEST=35]="UPDATE_COMMENT_REQUEST",e[e.DEFINE_COMMENT_RANGE_REQUEST=36]="DEFINE_COMMENT_RANGE_REQUEST",e[e.DELETE_COMMENT_RANGE_REQUEST=37]="DELETE_COMMENT_RANGE_REQUEST",e[e.SET_DIMENSION_FORMDATA_REQUEST=38]="SET_DIMENSION_FORMDATA_REQUEST",e[e.SET_DATA_VALIDATION_REQUEST=39]="SET_DATA_VALIDATION_REQUEST",e[e.REORDER_FILTER_REQUEST=40]="REORDER_FILTER_REQUEST",e[e.SET_HIDE_GRIDLINES_REQUEST=41]="SET_HIDE_GRIDLINES_REQUEST",e[e.ADD_CONDITIONAL_FORMAT_REQUEST=42]="ADD_CONDITIONAL_FORMAT_REQUEST",e[e.UPDATE_CONDITIONAL_FORMAT_REQUEST=43]="UPDATE_CONDITIONAL_FORMAT_REQUEST",e[e.DELETE_CONDITIONAL_FORMAT_REQUEST=44]="DELETE_CONDITIONAL_FORMAT_REQUEST",e[e.INSERT_SHEET_REQUEST=45]="INSERT_SHEET_REQUEST",e[e.DELETE_SHEET_REQUEST=46]="DELETE_SHEET_REQUEST",e[e.MOVE_SHEET_REQUEST=47]="MOVE_SHEET_REQUEST",e[e.HIDE_SHEET_REQUEST=48]="HIDE_SHEET_REQUEST",e[e.RENAME_SHEET_REQUEST=50]="RENAME_SHEET_REQUEST",e[e.COPY_SHEET_REQUEST=51]="COPY_SHEET_REQUEST",e[e.ADD_PROTECTED_RANGE_REQUEST=52]="ADD_PROTECTED_RANGE_REQUEST",e[e.UPDATE_PROTECTED_RANGE_REQUEST=53]="UPDATE_PROTECTED_RANGE_REQUEST",e[e.DELETE_PROTECTED_RANGE_REQUEST=54]="DELETE_PROTECTED_RANGE_REQUEST",e[e.ADD_EMBEDDED_OBJECT=55]="ADD_EMBEDDED_OBJECT",e[e.UPDATE_EMBEDDED_OBJECT=56]="UPDATE_EMBEDDED_OBJECT",e[e.DELETE_EMBEDDED_OBJECT=57]="DELETE_EMBEDDED_OBJECT",e[e.MOVE_EMBEDDED_OBJECT_TO_SHEET=58]="MOVE_EMBEDDED_OBJECT_TO_SHEET",e[e.SWITCH_FILTER_SYNC_REQUEST=59]="SWITCH_FILTER_SYNC_REQUEST",e[e.SET_IGNORED_ERROR_FLAGS=60]="SET_IGNORED_ERROR_FLAGS",e[e.ADD_LINKED_RANGE_REQUEST=61]="ADD_LINKED_RANGE_REQUEST",e[e.SET_HYPERLINK_RUNS_REQUEST=62]="SET_HYPERLINK_RUNS_REQUEST",e[e.SET_METADATA=63]="SET_METADATA",e[e.SET_REF_IDS=64]="SET_REF_IDS"}(o||(o={})),t.a=o},"./src/external/report/alloyreport.ts":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return M})),n.d(t,"g",(function(){return b})),n.d(t,"d",(function(){return C})),n.d(t,"b",(function(){return h})),n.d(t,"f",(function(){return D})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return A}));n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js");var o,i=n("../node_modules/@tencent/tencent-doc-report/lib/index.browser.js"),a=n("./src/core/app/sheetSize.ts"),r=n("./src/external/report/raven.ts"),l=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(l),u=n("../packages/common-utils/src/cookie.ts"),c=n("../packages/common-utils/src/url.ts"),d=n("../node_modules/@tencent/doc-visibilitychange/dist/tabkit.js"),_=n.n(d),p=n("./src/base/util/timer.ts"),E=n("./src/base/config/version.ts"),f=!1,m=Object(u.getCookie)("dev_route_id"),T=Object(c.getQuery)("devMode");function O(){return s.a.isMobilePhone||s.a.isAndroidPad?s.a.isAndroid?o.ANDROID:o.IOS:o.PC}m||T||(f=!0),function(e){e.PC="PC",e.ANDROID="Android",e.IOS="IOS"}(o||(o={}));var h,v={CheckMutationError:6,RunMutationError:6,afterMutationRunError:6};function b(e){var t=e.message,n=e.error,o=e.errorType;if(void 0!==v[o]){if(v[o]<=0)return;v[o]=v[o]-1}if(f){t||(t="no_message");try{n||((n=new Error).name="dataLost",n.message="{".concat(JSON.stringify(t),"\n}"))}catch(i){}null===r.a||void 0===r.a||r.a.captureException(n,{level:"error",logger:"info-report",tags:{ErrorType:o,networkVersion:"new"},sampleReport:!1})}}!function(e){e[e.IMPORTANT=0]="IMPORTANT",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO"}(h||(h={}));var R={level:"l",moduleValue:"m",actionValue:"a",ver5Value:"v5",obj3Value:"o3",detail:"d",baseVersion:"bv",activeSheetId:"asi",memory:"mem"},g=[{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"1",count:10},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"2",count:10},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"4",count:10},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"5",count:5},{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"6",count:5},{moduleValue:"messageCenter",actionValue:"commitingQueueBlock",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"-1",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"0",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"1",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"2",count:5},{moduleValue:"mutation",actionValue:"runMutation_1",ver5Value:"3",count:5},{moduleValue:"mutation",actionValue:"afterMutationRunDataChange",ver5Value:"1",count:5},{moduleValue:"mutation",actionValue:"afterMutationRun",ver5Value:"1",count:5},{moduleValue:"indexeddb",actionValue:"getDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"clearDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"deleteDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"updateDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"setDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"changeDataKeyCatchError",count:2},{moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"0",count:0},{moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"0",count:0},{moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"0",count:0},{moduleValue:"mutationQueue",actionValue:"maxSize",count:5},{moduleValue:"mutationQueue",actionValue:"completeTimeout",count:5}],S={applyBehaviorAmount:0,commitMutationAmount:0,sendUserChangeAmount:0,acceptCommitAmount:0};function A(e){e.level;var t,n,o,i,a,r,l=e.moduleValue,s=e.actionValue;"applyBehavior"!==l||"local"!==s&&"undo"!==s&&"redo"!==s?"mutation"===l&&"commitMutation"===s?S.commitMutationAmount+=1:"messageCenter"!==l||"sendOfflineUserChange"!==s&&"sendUserChange"!==s?"messageCenter"!==l||"acceptCommit"!==s&&"acceptOfflineCommit"!==s||(S.acceptCommitAmount+=1):S.sendUserChangeAmount+=1:S.applyBehaviorAmount+=1;var u=(null===(t=window.SpreadsheetApp)||void 0===t||null===(n=t.messageCenter)||void 0===n?void 0:n.currentVersion)||-1,c=(null===(o=window.SpreadsheetApp)||void 0===o||null===(i=o.spreadsheet)||void 0===i?void 0:i.activeSheetId)||"unknown";e.baseVersion=u,e.activeSheetId=c,null===(a=window.log)||void 0===a||null===(r=a.info)||void 0===r||r.call(a,D(e))}var y=null;function I(){y=p.a.wait(1e4).run((function(){var e=S,t=e.applyBehaviorAmount,n=e.commitMutationAmount,o=e.sendUserChangeAmount,r=e.acceptCommitAmount;if(0!==t||0!==n||0!==o||0!==r){var l=Object(a.a)(window.SpreadsheetApp.spreadsheet.activeSheetId),s={opername:"excel_dataflow",module:"datalost",action:"datalost",ver3:JSON.stringify(l),ver5:t,ver6:n,ver7:o,ver8:r};null===i.tdwSingle||void 0===i.tdwSingle||Object(i.tdwSingle)(s,["user_mac","id"]),S={applyBehaviorAmount:0,commitMutationAmount:0,sendUserChangeAmount:0,acceptCommitAmount:0}}I()}))}function N(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.moduleValue,o=e.actionValue,i=e.ver5Value,a="".concat(n,"_").concat(o);return void 0===i||t||(a+="_".concat(i)),a}f&&I(),_.a.visibilitychange.registerOnVisible(I),_.a.visibilitychange.registerOnHidden((function(){p.a.erase(y),y=null}));var V=function(){var e={};return g.forEach((function(t){var n=t.moduleValue,o=t.actionValue,i=t.ver5Value,a=t.count,r=N({level:-1,moduleValue:n,actionValue:o,ver5Value:i});e[r]=a})),e}();function C(t){try{var n,a,r,l,s,u,c=t.level,d=t.moduleValue,_=t.actionValue,p=t.ver5Value,m=(t.detail,t.obj3Value),T=N(t);if(function(e,t){if(void 0!==V[e]){if(V[e]<=0)return!0;V[e]=V[e]-1}else{var n=N(t,!0);if(void 0!==V[n]){if(V[n]<=0)return!0;V[n]=V[n]-1}}return!1}(T,t))return;var v,b=null===(n=window.SpreadsheetApp)||void 0===n||null===(a=n.messageCenter)||void 0===a?void 0:a.currentVersion,R=void 0===b?-1:b,g=(null===(r=window.SpreadsheetApp)||void 0===r||null===(l=r.spreadsheet)||void 0===l?void 0:l.activeSheetId)||"unknown",S=window.__globalReleaseVersion||"unknown";if(t.baseVersion=R,t.activeSheetId=g,null===(s=window.log)||void 0===s||null===(u=s.info)||void 0===u||u.call(s,D(t)),!f)return;if(c===h.IMPORTANT||c===h.DEBUG&&O()===o.PC){var A={opername:"excel_dataflow",module:d||"unknown_dataflow_module",action:_||"unknown_action",obj3:m,ver3:g,ver5:p,ver6:R,ver7:E.a.CODE_VER,ver8:S,ver9:JSON.stringify({container:e.isContainer?1:0,offline_package:e.__isOfflinePkg?1:0})};null===i.tdwSingle||void 0===i.tdwSingle||Object(i.tdwSingle)(A,["user_mac","id"])}if(c===h.DEBUG||c===h.IMPORTANT&&"0"!==p)null===(v=window.log)||void 0===v||v.report(T,{query:{sessionId:window.log.var.sessionId}})}catch(I){var y;console.warn(I),null===(y=window.log)||void 0===y||y.warn("dataFlowReport",I.message)}}function D(e){var t="";if(e)if(Array.isArray(e))e.forEach((function(e){if(t+="#",e)try{t+=JSON.stringify(e)}catch(n){t+="JSON.stringify error."}}));else try{var n={};Object.keys(e).forEach((function(t){n[R[t]||t]=e[t]})),t+=JSON.stringify(n)}catch(o){t+="JSON.stringify error."}return t}var M;O();M=window.AlloyReport?window.AlloyReport:i.AlloyReport,"1"===Object(c.getQuery)("alloy_report_close")&&(window.isCloseAlloyReport=!0)}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/report/handler/index.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l}));var o=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("./src/external/report/alloyreport.ts"),a=n("./src/base/config/report.ts"),r=Object(o.a)({},a.CONFIG.MUTATION_JANK_NUMBER_FORMAT,(function(){return Object(i.d)({level:i.b.DEBUG,moduleValue:"mutation",actionValue:"numberFormatJank"})})),l={SHEETS_BAR_JANK_SWITCH_SHEET:function(){return Object(i.d)({level:i.b.DEBUG,moduleValue:"sheetbar",actionValue:"switchSheetJank"})}}},"./src/external/report/index.ts":function(e,t,n){"use strict";n.r(t);var o=n("./src/base/index.ts"),i=n("../node_modules/@tencent/tencent-doc-report/lib/index.browser.js"),a=n("./src/external/report/run.ts"),r=n("../packages/common-utils/src/cookie.ts"),l=n("../node_modules/@tencent/aegis-web-sdk/lib/aegis.min.js"),s=n.n(l),u=function(){},c=n("./src/external/report/speed.ts"),d=n("./src/external/report/jank/Jank.ts"),_=n("../node_modules/@tencent/jank-sdk/lib/index.js");t.default={run:a.a,CONFIG:o.a.config.report.CONFIG,speed:c.a,tam:function(){try{return new s.a({id:"904",uin:Object(r.getCookie)("uid")||"10000",version:window.__globalReleaseVersion,reportApiSpeed:!1,reportAssetSpeed:!1})}catch(e){return console.error(e),{reportTime:u,reportEvent:u,reportT:u}}}(),jank:new d.a,tdwReport:Object(_.c)(i.tdw,"tdwReport"),tdwSingleReport:Object(_.c)(i.tdwSingle,"tdwSingleReport"),monitor:i.AlloyReport.monitor,huatuo:i.AlloyReport.huatuo,retcode:i.AlloyReport.retcode}},"./src/external/report/jank/Jank.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.includes.js");var o=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),i=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../node_modules/@tencent/jank-sdk/lib/index.js"),r=n("./src/external/report/alloyreport.ts"),l=n("./src/external/report/jank/utils.ts"),s=n("./src/external/report/jank/monitor.ts"),u=n("./src/external/report/jank/config.json"),c=n("./src/core/app/sheetSize.ts"),d=n("../packages/report/src/index.ts"),_=n("../node_modules/@tencent/tencent-doc-report/lib/index.browser.js"),p=n("./src/base/config/report.ts"),E=!1,f=10,m=1,T=function(){function t(){var e=this;Object(o.a)(this,t),this._stack=[],this._status=l.b.CLOSE,this._jankKey="",this._isJankKeyLocked=!1,this._reportedTimes=0,this._jankKeysForProactiveReport=[p.CONFIG.SHEETS_BAR_JANK_SWITCH_SHEET,p.CONFIG.MUTATION_JANK_NUMBER_FORMAT],this._handleHeart=function(t){e._stack=[],e._isJankKeyLocked=!1,e.log(l.c),e._stop===l.d.WAIT&&(e._stop=l.d.RUN)},this._handleJank=function(t){e._reportedTimes=e._reportedTimes+1,e._report(t)&&t>6e3&&m&&(Object(l.e)(),m-=1),e._stop===l.d.WAIT&&(e._stop=l.d.RUN),e.closeMonitor(),e._reportedTimes>=10&&e.startMonitor()},this._handlePageVisiableChange=function(t){"hidden"===t?e.closeMonitor():e.restartReport()},this._handleOverTask=function(){var t=e._sdk.traceStack.task;if(t[0]&&t[0].time>1e3){f-=1;try{window.log&&window.log.error("[\u5361\u987f]",JSON.stringify(t[0]))}catch(n){}Object(l.f)("excel_jank_trace","trace",t[0].id,t[0].time),f<=0&&e._sdk.traceStack.removeEventListener("overTask",e._handleOverTask)}},this._sdk=new a.a(u),this._sdk.heartbeatMonitor.addEventListener("jank",this._handleJank),this._sdk.heartbeatMonitor.addEventListener("heart",this._handleHeart),this._sdk.heartbeatMonitor.addEventListener("pageVisiableChange",this._handlePageVisiableChange),this._sdk.traceStack.addEventListener("overTask",this._handleOverTask)}return Object(i.a)(t,[{key:"log",value:function(e){if(this._status===l.b.MONITOR){this._stack.length>500&&this._stack.shift();var t=window.SpreadsheetApp&&window.SpreadsheetApp.messageCenter&&window.SpreadsheetApp.messageCenter.currentVersion||-1,n=window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet&&window.SpreadsheetApp.spreadsheet.getActiveSheetId()||"unknown";e.baseVersion=t,e.activeSheetId=n,this._stack.push({jankLogOptions:e,time:(new Date).getTime()}),this._isJankKeyLocked||(e.lockJankKey?(this._jankKey="".concat(e.moduleValue,"_").concat(e.actionValue),this._isJankKeyLocked=!0):this._jankKey="".concat(e.moduleValue,"_").concat(e.actionValue))}}},{key:"startMonitor",value:function(){this._reportedTimes>=10||(this._status=l.b.MONITOR,this._stack=[],this._isJankKeyLocked=!1,this.log(l.c),this._sdk.heartbeatMonitor.start(),this._sdk.pageActiveMonitor.start())}},{key:"closeMonitor",value:function(){this._sdk.heartbeatMonitor.stop(),this._sdk.pageActiveMonitor.stop(),this._stack=[],this._status=l.b.CLOSE,this._isJankKeyLocked=!1}},{key:"stopReport",value:function(){this._stop=l.d.STOP}},{key:"restartReport",value:function(){this._stop=l.d.WAIT}},{key:"_report",value:function(e){return!!window.AlloyReport&&(!!r.e&&(this._jankKeysForProactiveReport.includes(this._jankKey)&&this._reportToWeblog(),this.reportStuttersToTAM(e),this._handleMonitor(e),Date.now()-this._sdk.pageActiveMonitor.lastActive()>1e5?(window.AlloyReport.monitor(s.b),!0):(this._reportMonitorByTime(e),this._reportMonitorByKey(),this._stop!=l.d.RUN?(e<1e4?d.b.monitor(34026365):d.b.monitor(34026364),!0):window.SpreadsheetApp.sheetStatus.canEdit?"page_refresh"!==this._jankKey&&(E||(E=!0,this._reportTDW(e)),!0):(e<1e4?d.b.monitor(34026367):d.b.monitor(34026366),!0))))}},{key:"_reportToWeblog",value:function(){d.b.run(this._jankKey)}},{key:"_reportMonitorByTime",value:function(e){e>=2e3&&e<3e3&&d.b.monitor(s.c[2]),e>=3e3&&e<4e3&&d.b.monitor(s.c[3]),e>=4e3&&e<5e3&&d.b.monitor(s.c[4]),e>=5e3&&e<6e3&&d.b.monitor(s.c[5]),e>=6e3&&e<7e3&&d.b.monitor(s.c[6]),e>=7e3&&e<8e3&&d.b.monitor(s.c[7]),e>=8e3&&e<9e3&&d.b.monitor(s.c[8]),e>=9e3&&e<1e4&&d.b.monitor(s.c[9]),e>=1e3&&d.b.monitor(s.c[10])}},{key:"_reportMonitorByKey",value:function(){this._jankKey&&s.a[this._jankKey]?d.b.monitor(s.a[this._jankKey]):d.b.monitor(34206107)}},{key:"_reportTDW",value:function(e){var t={opername:"excel_crash_".concat("4"),module:"crash",obj3:e,ver5:this._jankKey};t.action=e>1e3&&e<=1e4?"crash_default":"crash_stutters";var n=Object(c.a)(window.SpreadsheetApp.spreadsheet.activeSheetId);return t.ver3=JSON.stringify(n),d.b.tdwSingleReport(t),d.b.monitor(34813221),!0}},{key:"reportStuttersToTAM",value:function(t){if(t>1e3){var n=Object(c.a)(e.SpreadsheetApp.spreadsheet.getActiveSheetId());d.b.tam.reportT({name:"stutters_cost",duration:t,ext1:JSON.stringify(n),ext2:JSON.stringify({container:e.isContainer?1:0,offline_package:e.__isOfflinePkg?1:0}),ext3:"".concat(Object(_.getSource1)())})}}},{key:"_handleMonitor",value:function(e){if(this._status===l.b.MONITOR)try{var t,n;this.log({moduleValue:"jank",actionValue:"heartbeat",level:l.a.ERROR}),window.log&&window.log.info("\u5361\u987f\u65e5\u5fd7\u5f00\u59cb_".concat("V2","============"));var o=this._calcJankPosition();window.log&&window.log.info("\u5361\u987f\u65e5\u5fd7\u7ed3\u675f================="),o||(o=this._stack[this._stack.length-2]);var i=(null===(t=o)||void 0===t?void 0:t.jankLogOptions.moduleValue)||"unknown_module",a=(null===(n=o)||void 0===n?void 0:n.jankLogOptions.actionValue)||"unknown_action";this._isJankKeyLocked||(this._jankKey="".concat(i,"_").concat(a)),window.log&&window.log.info("\u5361\u987f\uff0c",this._jankKey,e),this._jankKey,Object(l.f)("excel_jank_type",i,a,e),window.log&&window.log.report("jank_".concat("V2","_").concat(this._jankKey),{query:{sessionId:window.log.var.sessionId}})}catch(r){console.error("jank report error",r)}}},{key:"_calcJankPosition",value:function(){for(var e,t=this._stack,n=0;n<t.length;n++){var o=t[n],i=t[n+1];if(o.jankLogOptions.level===l.a.ERROR?window.log&&window.log.error(new Date(o.time)+Object(r.f)(o.jankLogOptions)):window.log&&window.log.info(new Date(o.time)+Object(r.f)(o.jankLogOptions)),n===t.length-1)break;i.time-o.time>1e3&&(e=o)}return e}}]),t}();t.a=T}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/report/jank/config.json":function(e){e.exports=JSON.parse('{"HeartbeatConfig":{"jankLimit":1000,"TriggerLimit":10,"StopOnPageHidden":true},"PageActiveConfig":{"Limit":80000}}')},"./src/external/report/jank/monitor.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i}));var o,i,a=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),r=n.n(a),l={permission_click:34206089,share_click:34206090,smartSplit_calc:34206079,record_enter:34206073,search_traverse:34206078,fullScreen_click:34206091,sheetbar_addSheet:34206084,sheetbar_removeSheet:34206085,keyframeMutation_copySheet:34206077,sheetbar_switchSheet:34206074,sheetbar_moveSheet:34206086,applyMutation_undo:34206083,applyMutation_redo:34206082,applyMutation_local_0:34206032,applyMutation_local_1:34206033,applyMutation_local_2:34206034,applyMutation_local_3:34206035,applyMutation_local_4:34206036,applyMutation_local_5:34206037,applyMutation_local_6:34206038,applyMutation_local_7:34206039,applyMutation_local_8:34206040,applyMutation_local_9:34206041,applyMutation_local_10:34206042,applyMutation_local_11:34206043,applyMutation_local_12:34206044,applyMutation_local_13:34206045,applyMutation_local_14:34206046,applyMutation_local_15:34206047,applyMutation_local_16:34206048,applyMutation_local_17:34206049,applyMutation_local_18:34206050,applyMutation_local_19:34206051,applyMutation_local_20:34206052,applyMutation_local_21:34206053,applyMutation_local_22:34206054,applyMutation_local_23:34206055,applyMutation_local_24:34206056,applyMutation_local_25:34206057,applyMutation_local_26:34206058,applyMutation_local_27:34206059,applyMutation_local_28:34206060,applyMutation_local_29:34206061,applyMutation_local_30:34206062,applyMutation_local_31:34206063,applyMutation_local_32:34206064,applyMutation_local_33:34206065,applyMutation_local_34:34206066,applyMutation_local_35:34206067,applyMutation_local_36:34206068,applyMutation_local_37:34206069,applyMutation_local_38:34206070,applyMutation_local_39:34206071,keyframe_export:34206072,keyframe_createKeyframe:34206080,keyframeMutation_switchRecordSheet:34206075,copy_analysis:34206076,quickOpen_init:34206093,quickOpen_snapshot:34206094,view_collaborator:34206088,view_scale:34206087,view_resize:34206092,unknown_module_unknown_action:34206106,jank_heartbeat:34206133,"applyMutation_collab_-1":34206191,applyMutation_collab_0:34206151,applyMutation_collab_1:34206152,applyMutation_collab_2:34206153,applyMutation_collab_3:34206154,applyMutation_collab_4:34206155,applyMutation_collab_5:34206156,applyMutation_collab_6:34206157,applyMutation_collab_7:34206158,applyMutation_collab_8:34206159,applyMutation_collab_9:34206160,applyMutation_collab_10:34206161,applyMutation_collab_11:34206162,applyMutation_collab_12:34206163,applyMutation_collab_13:34206164,applyMutation_collab_14:34206165,applyMutation_collab_15:34206166,applyMutation_collab_16:34206167,applyMutation_collab_17:34206168,applyMutation_collab_18:34206169,applyMutation_collab_19:34206170,applyMutation_collab_20:34206171,applyMutation_collab_21:34206172,applyMutation_collab_22:34206173,applyMutation_collab_23:34206174,applyMutation_collab_24:34206175,applyMutation_collab_25:34206176,applyMutation_collab_26:34206177,applyMutation_collab_27:34206178,applyMutation_collab_28:34206179,applyMutation_collab_29:34206180,applyMutation_collab_30:34206181,applyMutation_collab_31:34206182,applyMutation_collab_32:34206183,applyMutation_collab_33:34206184,applyMutation_collab_34:34206185,applyMutation_collab_35:34206186,applyMutation_collab_36:34206187,applyMutation_collab_37:34206188,applyMutation_collab_38:34206189,applyMutation_collab_39:34206190,messageOfflineStore_apply:34206135,messageOfflineStore_followAndApply:34206136,messageCenter_fetchAndApplyCollabNewChanges:34206206,page_refresh:34206195},s={2:35357765,3:33580565,4:33580566,5:33581294,6:33581295,7:33581296,8:33581297,9:33581298,10:33580569},u={2:35357755,3:33580552,4:33580553,5:33580554,6:33580555,7:33580556,8:33580557,9:33580558,10:33580559},c={2:35357768,3:33580573,4:33580574,5:33580575,6:33580576,7:33580577,8:33580578,9:33580579,10:33580580},d=34462711,_=34462712,p=34462713,E=34462710,f=34462784;o=r.a.isIOS?s:r.a.isAndroid?u:c,i=r.a.isMac?d:r.a.isMobilePhone||r.a.isAndroidPad?_:r.a.isIPad?p:r.a.isPC?E:f},"./src/external/report/jank/utils.ts":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return E})),n.d(t,"e",(function(){return f}));n("../node_modules/core-js/modules/es.object.assign.js");var o,i,a,r=n("../node_modules/@tencent/dui/lib/components/Snackbar/index.js"),l=n.n(r),s=n("../node_modules/@tencent/tencent_doc_open_url/dist/index.js"),u=n("./src/core/app/sheetSize.ts"),c=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),d=n.n(c),_=n("../packages/report/src/index.ts");!function(e){e.REPORT="report",e.MONITOR="monitor",e.CLOSE="close"}(o||(o={})),function(e){e[e.STOP=0]="STOP",e[e.WAIT=1]="WAIT",e[e.RUN=2]="RUN"}(i||(i={})),function(e){e.ERROR="error"}(a||(a={}));var p={moduleValue:"jank",actionValue:"heartbeat"};function E(e,t,n,o){var i={opername:e,module:t,action:n,obj3:o,ver3:Object(u.a)(window.SpreadsheetApp.spreadsheet.activeSheetId).isLarge};_.b.tdwSingleReport(i)}function f(){var e;_.b.monitor(34861173);var t={message:"\u4e3a\u4e86\u6709\u66f4\u597d\u7684\u4f53\u9a8c\uff0c\u5efa\u8bae\u5173\u95ed\u4e0d\u5e38\u7528\u7684\u8f6f\u4ef6\u6216\u7f51\u9875\u3002",style:{zIndex:10003},autoClose:!0,closable:!1,duration:5e3};d.a.isPCTencentDocsClient?d.a.isTencentDocsAppVersionAboveOrEqual("1")||(t.message="\u4e3a\u4e86\u6709\u66f4\u597d\u7684\u4f53\u9a8c\uff0c\u63a8\u8350\u66f4\u65b0\u5230\u6700\u65b0\u7248\u817e\u8baf\u6587\u6863\u5ba2\u6237\u7aef\u3002",Object.assign(t,{action:"\u7acb\u5373\u4e0b\u8f7d",onClickAction:function(){Object(s.tencentDocOpenUrl)("https://".concat(location.host,"/download.html"),"_blank")}})):d.a.isChromeVersionAboveOrEqual("79")||(t.message="\u4e3a\u4e86\u6709\u66f4\u597d\u7684\u4f53\u9a8c\uff0c\u63a8\u8350\u4f7f\u7528\u6700\u65b0\u7248Chrome\u6d4f\u89c8\u5668\u3002"),null===(e=l.a.show)||void 0===e||e.call(l.a,t)}},"./src/external/report/raven.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o=window.Raven},"./src/external/report/run.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.array.map.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.regexp.to-string.js"),n("../node_modules/core-js/modules/es.string.starts-with.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),i=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=n("./src/core/behavior/index.ts"),r=n("../node_modules/@tencent/tencent-doc-report/lib/index.browser.js"),l=n("./src/external/report/alloyreport.ts"),s=n("./src/core/data/configService/spreadConfig.ts"),u=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),c=n.n(u),d=n("../packages/common-utils/src/url.ts"),_=n("../packages/common-utils/src/cookie.ts"),p=n("./src/base/config/report.ts"),E=n("./src/external/report/handler/index.ts");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(){return c.a.isMobilePhone||c.a.isAndroidPad?c.a.isAndroid?"Android":"IOS":"PC"}var O=m(m(m({},E.a),E.b),{},{CHECK_MUTATION_ERROR:function(e,t,n){var o=Object(p.getTdwObj3Value)(p.TDW_MODULE.MUTATION,e);Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:"".concat(p.TDW_ACTION.CHECK_MUTATION,"_").concat(p.TDW_VER5_VALUE.CHECK_MUTATION_ERROR),obj3Value:o,ver5Value:String(e.operationType),detail:[n,e,t,null===t||void 0===t?void 0:t.stack]}),Object(l.g)({errorType:p.SENTRY_ERROR_TYPE.CHECK_MUTATION_ERROR,message:[n,e],error:t})},CHECK_MUTATION_RESULT_ERROR:function(e,t){var n,o=Object(p.getTdwObj3Value)(p.TDW_MODULE.MUTATION,e);switch(e.operationType){case a.a.Mutation.MUTATION_OPERATION_TYPE.HISTORY:n=p.MONITOR_POINTS.CHECK_HISTORY_MUTATION_FAIL_MAP[e.id];break;case a.a.Mutation.MUTATION_OPERATION_TYPE.LOCAL:n=p.MONITOR_POINTS.CHECK_LOCAL_MUTATION_FAIL_MAP[e.id];break;case a.a.Mutation.MUTATION_OPERATION_TYPE.UNDO:n=p.MONITOR_POINTS.CHECK_UNDO_MUTATION_FAIL_MAP[e.id];break;case a.a.Mutation.MUTATION_OPERATION_TYPE.REDO:n=p.MONITOR_POINTS.CHECK_REDO_MUTATION_FAIL_MAP[e.id];break;case a.a.Mutation.MUTATION_OPERATION_TYPE.COLLAB:n=p.MONITOR_POINTS.CHECK_COLLAB_MUTATION_FAIL_MAP[e.id];break;default:n=35308327}l.a.monitor(n),l.a.monitor(p.MONITOR_POINTS.CHECK_MUTATION_FAIL_MAP[e.operationType]);var i,r="".concat(p.TDW_ACTION.CHECK_MUTATION,"-").concat(e.operationType);i=e.operationType===a.a.Mutation.MUTATION_OPERATION_TYPE.HISTORY?void 0!==e.id?e.id.toString():"-1":void 0!==e.parentRequestId?e.parentRequestId.toString():"-1",Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:r,obj3Value:o,ver5Value:i,detail:[t,e]}),e.operationType!==a.a.Mutation.MUTATION_OPERATION_TYPE.HISTORY&&Object(l.g)({errorType:p.SENTRY_ERROR_TYPE.CHECK_MUTATION_ERROR,message:[t,e]})},MERGE_GRID_RANGE_ERROR:function(e){l.a.monitor(p.MONITOR_POINTS.MERGE_GRID_RANGE_ERROR),Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.OPERATION,actionValue:p.TDW_ACTION.MERGE_GRID_RANGE_ERROR,detail:e})},RUN_MUTATION_ERROR:function(e,t){var n=Object(p.getTdwObj3Value)(p.TDW_MODULE.MUTATION,t);if(null===e||void 0===e?void 0:e.message.startsWith("ApiCheckError")){var o=l.b.DEBUG,i=t.operationType===a.a.Mutation.MUTATION_OPERATION_TYPE.HISTORY&&-1!==e.message.indexOf("\u5408\u5e76\u5355\u5143\u683c\u5df2\u7ecf\u5b58\u5728");i&&(o=l.b.INFO),i||l.a.monitor(p.MONITOR_POINTS.CHECK_MUTATION_FAIL_MAP[t.operationType]),Object(l.d)({level:o,moduleValue:p.TDW_MODULE.MUTATION,actionValue:"".concat(p.TDW_ACTION.CHECK_MUTATION,"_").concat(p.TDW_VER5_VALUE.CHECK_MUTATION_FAIL),obj3Value:n,ver5Value:String(t.operationType),detail:[t,e,null===e||void 0===e?void 0:e.stack]}),i||t.operationType!==a.a.Mutation.MUTATION_OPERATION_TYPE.HISTORY&&Object(l.g)({errorType:p.SENTRY_ERROR_TYPE.CHECK_MUTATION_ERROR,message:t,error:e})}else l.a.monitor(p.MONITOR_POINTS.RUN_MUTATION_ERROR_MAP[t.operationType]),Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:"".concat(p.TDW_ACTION.RUN_MUTATION,"_").concat(p.TDW_VER5_VALUE.RUN_MUTATION_ERROR),obj3Value:n,ver5Value:String(t.operationType),detail:[t,e,null===e||void 0===e?void 0:e.stack]}),t.operationType!==a.a.Mutation.MUTATION_OPERATION_TYPE.HISTORY&&Object(l.g)({errorType:p.SENTRY_ERROR_TYPE.RUN_MUTATION_ERROR,message:t,error:e})},AFTER_MUTATION_RUN_CATCH_ERROR:function(e,t){var n=Object(p.getTdwObj3Value)(p.TDW_MODULE.MUTATION,t);l.a.monitor(33660169),Object(l.g)({errorType:"afterMutationRunError",error:e}),Object(l.d)({level:l.b.DEBUG,moduleValue:"mutation",actionValue:"afterMutationRun",obj3Value:n,ver5Value:"1",detail:[t]})},AFTER_MUTATION_RUN_DATA_CHANGE_CATCH_ERROR:function(e,t){var n=Object(p.getTdwObj3Value)(p.TDW_MODULE.MUTATION,t);l.a.monitor(33660170),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"mutation",actionValue:"afterMutationRunDataChange",obj3Value:n,ver5Value:"1",detail:[t,null===e||void 0===e?void 0:e.stack]})},COMMIT_EMPTY_MUTATION:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"mutation",actionValue:"commitEmptyMutation",detail:e})},DO_BEHAVIOR_AFTER_SHUTDOWN:function(){l.a.monitor(34280469),Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"doBehaviorAfterShutDown",ver5Value:"1"})},COMMIT_MUTATION_CATCH_ERROR:function(e,t){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"mutation",actionValue:"commitMutation",ver5Value:"1",detail:e}),Object(l.g)({errorType:"SerializeMutationError",error:t})},COMMIT_MUTATION:function(e){l.a.monitor(33659447),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"mutation",actionValue:"commitMutation",ver5Value:"2",detail:e})},CACHE_DATA_FLOW_COMMIT_MUTATION:function(e){l.a.monitor(33637651),Object(l.c)({level:l.b.IMPORTANT,moduleValue:"mutation",actionValue:"commitMutation",ver5Value:"0",detail:e})},PAGE_LOAD:function(e){l.a.monitor(33631971),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"init",actionValue:"pageLoaded",ver5Value:e})},DUPLICATE_SHEET_ID:function(e){l.a.monitor(33955439),Object(l.d)({level:l.b.DEBUG,moduleValue:"init",actionValue:"duplicateSheetId",ver5Value:"1",detail:e})},SERIALIZE_MUTATION:function(e,t){l.a.monitor(33611128),Object(l.g)({errorType:"serializeMutationError",error:t}),Object(l.d)({level:l.b.DEBUG,moduleValue:"mutation",actionValue:"serializeMutation",ver5Value:"1",detail:e})},GET_COLLAB_MUTATIONS:function(e){l.a.monitor(33614885),Object(l.d)({level:l.b.DEBUG,moduleValue:"mutation",actionValue:"getCollabMutations",ver5Value:"1",detail:e})},CREATE_ZIPKETFRAME:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"keyframe",actionValue:"createZipKeyframe",ver5Value:"1",detail:e})},APPLY_NEW_CHANGES_ERROR:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"applyNewChangesError",detail:e})},LOAD_REQUEST:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"loadRequest",actionValue:"local",detail:e})},APPLY_BEHAVIOR_ERROR:function(e,t){console.error(t),Object(l.g)({errorType:"loadRequestError",message:"loadRequestError",error:t}),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"1",detail:e})},APPLY_BEHAVIOR_CATCH_SCRIPT_ERROR:function(e,t,n){console.error(t),Object(l.g)({errorType:"applyBehaviorScriptError",message:t.message,error:t}),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"applyBehaviorScriptError",actionValue:n,ver5Value:"1",detail:e})},APPLY_BEHAVIOR_NOT_LOADED:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"2",detail:e})},APPLY_BEHAVIOR_LEVEL_INFO:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"3",detail:e})},APPLY_BEHAVIOR_LEVEL_IMPORTANT:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"4";Object(l.d)({level:l.b.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:t,detail:e})},APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR:function(){l.a.monitor(33686607)},REQUEST_SIZE_OVER_LIMIT:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"applyLocal",actionValue:"requestSizeOverLimit",detail:e})},FOLLOW_REQUEST_MUTATIONS:function(e){l.a.monitor(33641617),Object(l.d)({level:l.b.DEBUG,moduleValue:"mutation",actionValue:"followRequestMutations",ver5Value:"1",detail:e})},DESERIALIZE_MUTATION_FAIL:function(e){l.a.monitor(p.MONITOR_POINTS.DESERIALIZE_MUTATION_FAIL),Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:p.TDW_ACTION.DESERIALIZE_MUTATION_FAIL,ver5Value:p.TDW_VER5_VALUE.DESERIALIZE_MUTATION_FAIL,detail:e})},DESERIALIZE_MUTATION_FAIL_OLD:function(e){l.a.monitor(p.MONITOR_POINTS.DESERIALIZE_MUTATION_FAIL_OLD),Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:p.TDW_ACTION.DESERIALIZE_MUTATION_FAIL,ver5Value:p.TDW_VER5_VALUE.DESERIALIZE_MUTATION_FAIL_OLD,detail:e})},DESERIALIZE_MUTATION_CATCH_ERROR:function(e,t){console.error("Deserialize mutation error: ",e,t),l.a.monitor(p.MONITOR_POINTS.DESERIALIZE_MUTATION_ERROR),Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:p.TDW_ACTION.DESERIALIZE_MUTATION_ERROR,ver5Value:p.TDW_VER5_VALUE.DESERIALIZE_MUTATION_ERROR,detail:e}),Object(l.g)({errorType:p.SENTRY_ERROR_TYPE.DESERIALIZE_MUTATION_ERROR,message:e,error:t})},DESERIALIZE_MUTATION_CATCH_ERROR_OLD:function(e,t){l.a.monitor(p.MONITOR_POINTS.DESERIALIZE_MUTATION_ERROR_OLD),Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:p.TDW_ACTION.DESERIALIZE_MUTATION_ERROR,ver5Value:p.TDW_VER5_VALUE.DESERIALIZE_MUTATION_ERROR_OLD,detail:e}),Object(l.g)({errorType:p.SENTRY_ERROR_TYPE.DESERIALIZE_MUTATION_ERROR_OLD,message:e,error:t})},PASTE_DATA_GENERATE_MUTATION_1:function(){Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:p.TDW_ACTION.PASTE_DATA_GENERATE_MUTATION,ver5Value:p.TDW_VER5_VALUE.PASTE_DATA_GENERATE_MUTATION_INSERT_ERROR_NO_OPTION,detail:["no opt"]})},PASTE_DATA_GENERATE_MUTATION_2:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:p.TDW_ACTION.PASTE_DATA_GENERATE_MUTATION,ver5Value:p.TDW_VER5_VALUE.PASTE_DATA_GENERATE_MUTATION_INSERT_ERROR_NO_EXPANSION,detail:e})},PASTE_DATA_GENERATE_MUTATION_3:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:p.TDW_MODULE.MUTATION,actionValue:p.TDW_ACTION.PASTE_DATA_GENERATE_MUTATION,ver5Value:p.TDW_VER5_VALUE.PASTE_DATA_GENERATE_MUTATION_SETRANGE_ERROR_NO_GRIDRANGE,detail:e})},DO_KEYFRAME_CATCH_ERROR_1:function(t,n){!e.isCloseAlloyReport&&l.a.monitor(33614378),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframeError1",ver5Value:"1",detail:t}),Object(l.g)({errorType:"doKeyframeErrorVersion3",error:n})},DO_KEYFRAME_CATCH_ERROR_2:function(t){!e.isCloseAlloyReport&&l.a.monitor(33614380),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframeError2",ver5Value:"2",detail:t})},DO_KEYFRAME_CATCH_ERROR_3:function(t){!e.isCloseAlloyReport&&l.a.monitor(33614379),!e.isCloseAlloyReport&&l.a.monitor(33955111),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframeError3",ver5Value:"3",detail:[t,null===t||void 0===t?void 0:t.stack]}),Object(l.g)({errorType:"doKeyframeErrorNoVersion",error:t})},DO_KEYFRAME:function(e){l.a.monitor(33637702),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframe0",ver5Value:"0",detail:e})},DO_MUTATIONS:function(e){l.a.monitor(33614886),Object(l.d)({level:l.b.DEBUG,moduleValue:"mutation",actionValue:"doMutations",ver5Value:"1"}),Object(l.g)({errorType:"doMutationsError",message:e})},ZIP_KEYFRAME:function(){l.a.monitor(34364018),Object(l.d)({level:l.b.DEBUG,moduleValue:"keyframe",actionValue:"zip",ver5Value:"1"})},ZIP_KEYFRAME_CATCH_ERROR:function(e){l.a.monitor(34364008),Object(l.d)({level:l.b.DEBUG,moduleValue:"keyframe",actionValue:"zip",ver5Value:"2",detail:e})},COPY_PASTE:function(){Object(l.d)({level:l.b.INFO,moduleValue:"copyPaste",actionValue:"onPaste"})},CHOOSE_FORMAT_ERROR:function(e,t){console.warn(t),l.a.monitor(3437448),Object(l.d)({level:l.b.DEBUG,moduleValue:"numberFormat",actionValue:"chooseFormatError",detail:e})},PARSE_FORMAT_ERROR:function(e,t){console.warn(t),l.a.monitor(3437447),Object(l.d)({level:l.b.DEBUG,moduleValue:"numberFormat",actionValue:"parseFormatError",detail:e})},RETRY_SENDMESSAGE:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"retrySendMessage",detail:e})},MOVE_MESSAGEINFO_COMMITING_QUEUE:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"moveMessageIntoCommitingQueue",detail:e})},RETRY_COMMIT:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"retryCommit",detail:e})},SEND_USERCHANGE:function(e,t,n){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:t,ver5Value:"1",obj3Value:String(n),detail:e})},SEND_USERCHANGE_1:function(e,t,n){l.a.monitor(33639350),Object(l.c)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:t,ver5Value:"0",obj3Value:String(n),detail:e})},ACCEPT_COMMIT:function(e){l.a.monitor(33639758),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:"acceptCommit",ver5Value:"1",detail:e})},HANDLE_COMMIT_ERROR:function(e,t,n,i){var a={101:33612294,102:33612295,103:33612296,104:33612297,105:33612298,106:33612299,1e4:33612314,10001:33612323,4e4:33612311,40001:33612312,40002:33612315,40003:33612316,40005:33612317,40006:33712774,40020:33612313,40021:33612318,40022:33612319,40023:33612320,40024:33688491,40025:33688492,40026:33688493,40027:33713210,40028:33688494,40029:34872598,40030:34872599,40034:34786084,40035:34642726,40036:34846274,40037:34884339,40100:34872600,40203:i?35183586:35183585,41001:33612321,41002:33612322,60007:33612290,60018:33612308,60019:33612309,60020:33612310,60002:33612280,60003:33612286,60004:33612281,60005:33612282,60008:33612287,60011:33612283,60013:33612284,60014:33612285,60015:33612291,60016:33612288,60017:33612289,60021:33631110,60022:33631111};a[t]?(l.a.monitor(a[t]),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleCommitError",ver5Value:t.toString(),detail:[].concat(Object(o.a)(e),[t.toString(),n,i])})):(l.a.monitor(33698546),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleCommitError",ver5Value:"unKnownError",detail:[].concat(Object(o.a)(e),[t.toString(),n])}))},HANDLE_TASK_DUPLICATE:function(e){l.a.monitor(33612330),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleTaskDuplicate",detail:e})},TASK_DUPLICATE_VERSION_TOO_LOW:function(e){l.a.monitor(34884808),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleTaskDuplicateVersionTooLow",detail:e})},HANDLE_NEW_CHANGES:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"handleNewChanges",detail:e})},COMMITING_QUEUE_BLOCK:function(e){l.a.monitor(33714439),Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"commitingQueueBlock",detail:e})},APPLY_NEWCHANGES_VERROR:function(e,t){var n={collab:"1",missing:"2"};n[t]&&Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:n[t],detail:e});var o={collab:33685595,missing:33685596};o[t]&&l.a.monitor(o[t])},DUPLICATE_MESSAGE:function(e){l.a.monitor(33629759),Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"DuplicateMessage",detail:e})},APPLY_NEWCHANGES_CATCH_ERROR:function(e){l.a.monitor(33612332),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:"applyNewChanges",ver5Value:"1",detail:e})},APPLY_NEWCHANGES:function(e){l.a.monitor(33638469),Object(l.d)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:"applyNewChanges",ver5Value:"0",detail:e})},APPLY_NEWCHANGES_VERROR2:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"4",detail:e}),l.a.monitor(33707992)},APPLY_NEWCHANGES_VERROR5:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"5",detail:e}),l.a.monitor(33707990)},APPLY_NEWCHANGES_VERROR6:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"6",detail:e}),l.a.monitor(33707991)},SWITCH_CHANEL_STATUS:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"switchChanelStatus",detail:e})},HANDLE_FETCH_RESULT:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"handleFetchResult",detail:e})},FETCH_USERCHANGES_ERROR:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"fetchUserChangesError",detail:e}),l.a.monitor(33633746)},FETCH_AND_APPLY_MISSCHANGES:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"fetchAndApplyMisschanges",detail:e})},EMPTY_KEYFRAME_BY_AUTOEXPAND:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"emptyKeyframeByAutoExpand",detail:e})},ADD_USER_CHANGE:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"addUserChange",detail:e})},CLEAR_OFFLINE_DATA_SIZE:function(e,t){Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"clearOfflineStoreSize",ver5Value:"".concat(e),detail:t})},UPDATE_BASEVERSION:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"updateBaseVersion",detail:e})},UPDATE_BASEVERSION_ERROR:function(e){l.a.monitor(34860419),Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"updateBaseVersionError",detail:e})},ACCEPT_COMMIT_2:function(e,t){l.a.monitor(33639756),Object(l.c)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:t,ver5Value:"0",detail:e})},FETCH_USERCHANGE_ARGUMENT:function(e){l.a.monitor(33612380),Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"fetchUserChangesArgument",ver5Value:"1",detail:e})},FETCH_USERCHANGES:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"fetchUserChanges",detail:e})},FETCH_USERCHANGES_3:function(e){l.a.monitor(33612438),Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"fetchUserChanges",ver5Value:"1",detail:e})},INIT_DATA_ERROR:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"userchange",actionValue:"initDataError",ver5Value:"1",detail:e})},STORE_DATA_ERROR:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"userchange",actionValue:"storeDataError",ver5Value:"1",detail:e})},NOT_SUPPORT_INDEXEDDB:function(e){l.a.monitor(33639031),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"notSupportIndexedDB",detail:["indexedDB is no supported."]})},OPEN_INDEXED_DB_FAIL:function(e,t){var n=t.message,o=t.name,i=t.stack;Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"openIndexedDB",ver5Value:e,detail:["indexedDB open failed.",n,o,i]})},UPDATE_INDEXED_DB:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"updateIndexedDB",detail:e})},STORE_UNVALIABLE_WHEN_SET:function(e){l.a.monitor(33624016),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"storeUnvaliableWhenSet",detail:e})},INDEXDB_SET_VALUE:function(e){l.a.monitor(33624019),Object(l.d)({level:l.b.INFO,moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"0",detail:e})},INDEXDB_SET_VALUE_ONERROR:function(e){l.a.monitor(33624017),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"1",detail:e})},CHANGE_DATAKEY:function(e){l.a.monitor(33692488),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"changeDataKey",detail:e})},STORE_UNVALIABLE_WHEN_UPDATE:function(e){l.a.monitor(33624030),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"storeUnvaliableWhenUpdate",detail:e})},INDEXEDDB_UPDATE_VALUE:function(e){l.a.monitor(33648382),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"2",detail:e})},INDEXEDDB_UPDATE_VALUE_2:function(e){l.a.monitor(33624031),Object(l.d)({level:l.b.INFO,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"0",detail:e})},INDEXEDDB_UPDATE_VALUE_3:function(e){l.a.monitor(33624032),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"1",detail:e})},INDEXEDDB_UPDATE_VALUE_4:function(e){l.a.monitor(33624033),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"3",detail:e})},DELETE_DATA_ERROR:function(e){l.a.monitor(33624034),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"deleteDataError",detail:e})},DELETE_VALUE:function(e){l.a.monitor(33624036),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"1",detail:e})},DELETE_VALUE_2:function(e){l.a.monitor(33624035),Object(l.d)({level:l.b.INFO,moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"0",detail:e})},CLEAR_DATA_ERROR:function(e){l.a.monitor(33624037),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"clearDataError",detail:e})},CLEAR_DATA:function(e){l.a.monitor(33624039),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"clearData",ver5Value:"1",detail:e})},CLEAR_DATA_2:function(e){l.a.monitor(33624038),Object(l.d)({level:l.b.INFO,moduleValue:"indexeddb",actionValue:"clearData",ver5Value:"0",detail:e})},GET_DATA_ERROR:function(e){l.a.monitor(33624047),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"getDataError",detail:e})},GET_DATA:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"getData",ver5Value:"2",detail:e})},GET_DATA_ERROR_2:function(e){l.a.monitor(33624049),Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"getData",ver5Value:"1",detail:e})},GET_DATA_SUCC:function(e){l.a.monitor(33624048),Object(l.d)({level:l.b.INFO,moduleValue:"indexeddb",actionValue:"getData",ver5Value:"0",detail:e})},NETWORK_ERROR:function(){l.a.monitor(33612270),Object(l.d)({level:l.b.DEBUG,moduleValue:"socket",actionValue:"networkError",ver5Value:"90sNoSocket"})},WEBSOCKET_CLOSE:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"socket",actionValue:"close",ver5Value:"1",detail:e})},LONG_TIME_HIDDEN_1:function(){l.a.monitor(34813929),Object(l.d)({level:l.b.DEBUG,moduleValue:"socket",actionValue:"roomstatechange",ver5Value:"LONG_TIME_HIDDEN_1"})},LONG_TIME_HIDDEN_2:function(){l.a.monitor(34813930),Object(l.d)({level:l.b.DEBUG,moduleValue:"socket",actionValue:"roomstatechange",ver5Value:"LONG_TIME_HIDDEN_2"})},ACCEPT_MESSAGE:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"socket",actionValue:"message",detail:e})},ROOM_STATE_CHANGE:function(e,t){Object(l.d)({level:l.b.INFO,moduleValue:"socket",actionValue:"roomstatechange",ver5Value:t.valueOf(),detail:e})},HANDLE_SHUTDOWN:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"socket",actionValue:"handleShutDown",ver5Value:e})},RELOAD_TIP:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"reloadTip",ver5Value:e,detail:[e]})},RELOAD_TIP_DEBUG:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"messageCenter",actionValue:"reloadTip",ver5Value:e,detail:[e]})},SWITCH_SHEET_IN_PREVIEW:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"sheetbar",actionValue:"switchSheetInPreview",detail:e})},PREVIEW_SERVER_SHEET_DATA:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"sheetbar",actionValue:"previewServerSheetData",detail:e})},PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"sheetbar",actionValue:"previewServerSheetDataOnResponse",detail:e})},SWITCH_SHEET_ON_SUCCESS:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"sheetbar",actionValue:"switchSheetOnSuccess",ver5Value:"1",detail:e})},SWITCH_SHEET_ON_FAIL:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"sheetbar",actionValue:"switchSheetOnFail",ver5Value:"1",detail:e})},DUPLICATE_SHEET_ID_2:function(e){l.a.monitor(33955440),Object(l.d)({level:l.b.DEBUG,moduleValue:"sheetsbar",actionValue:"duplicateSheetId",ver5Value:"1",detail:e})},DUPLICATE_SHEET_ID_3:function(e){l.a.monitor(34098881),Object(l.d)({level:l.b.DEBUG,moduleValue:"sheetsbar",actionValue:"duplicateSheetId",ver5Value:"2",detail:e})},FETCH_DATA_ERROR:function(e){l.a.monitor(33701460),Object(l.d)({level:l.b.INFO,moduleValue:"fullMember",actionValue:"fetchDataError",ver5Value:"1",detail:e})},FETCH_DATA_ERROR_2:function(e,t,n){var o={1e5:33711861,100002:33711862,100003:33711863,200105:33711864,200200:33711865,200011:33715032};t&&o[n]?l.a.monitor(o[n]):l.a.monitor(33711866),Object(l.d)({level:l.b.INFO,moduleValue:"fullMember",actionValue:"fetchDataError",ver5Value:"2",detail:e})},K2S_CONVERTER:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"fullMember",actionValue:"k2sConverter",detail:e})},OFFLINE_DATABASE_ERROR:function(e){l.a.monitor(34924089),Object(l.d)({level:l.b.DEBUG,moduleValue:"offlineEdit",actionValue:"offlineDatabaseError",detail:e})},INIT_OFFLINE_STORE_ERROR:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"indexeddb",actionValue:"initOfflineStore",ver5Value:"1",detail:e})},GET_OFFLINE_DATA:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"getOfflineData",ver5Value:"OfflineData",detail:e})},CHANGEDATAKEY_CATCH_ERROR:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"indexeddb",actionValue:"changeDataKeyCatchError",ver5Value:"1",detail:e}),l.a.monitor(33782646)},SETDATA_CATCH_ERROR:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"indexeddb",actionValue:"setDataCatchError",ver5Value:"1",detail:e}),l.a.monitor(33782647)},UPDATEDATA_CATCH_ERROR:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"indexeddb",actionValue:"updateDataCatchError",ver5Value:"1",detail:e}),l.a.monitor(33782648)},DELETEDATA_CATCH_ERROR:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"indexeddb",actionValue:"deleteDataCatchError",ver5Value:"1",detail:e}),l.a.monitor(33782654)},CLEARDATA_CATCH_ERROR:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"indexeddb",actionValue:"clearDataCatchError",ver5Value:"1",detail:e}),l.a.monitor(33782655)},GETDATA_CATCH_ERROR:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"indexeddb",actionValue:"getDataCatchError",ver5Value:"1",detail:e}),l.a.monitor(33782678)},SWITCH_SHEET_SERVER_FAIL:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"switchSheet",actionValue:"serverFail",detail:e}),l.a.monitor(33701441)},SWITCH_SHEET_FRONT_FAIL:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"switchSheet",actionValue:"frontFail",detail:e}),l.a.monitor(33701442)},PARSE_KEYFRAME_ERROR:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"keyframe",actionValue:"parse",ver5Value:"1",detail:e}),l.a.monitor(33639871)},UNZIP_KEYFRAME_ERROR:function(e,t){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"keyframe",actionValue:"unzip",ver5Value:"1",detail:e}),l.a.monitor(33639872),Object(l.g)({errorType:"keyframeUnzipError",error:t})},PARSE_KEYFRAME_ERROR_2:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"keyframe",actionValue:"parse",ver5Value:"1",detail:e}),l.a.monitor(33639871)},UNZIP_KEYFRAME:function(e,t){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"keyframe",actionValue:"unzip",ver5Value:"1",detail:e}),l.a.monitor(33639872),Object(l.g)({errorType:"keyframeUnzipError",error:t})},MESSAGECENTER_DATA_ERROR_TIP:function(e,t){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"dataErrorTip",ver5Value:t,detail:e})},NET_OFFLINE_ERROR_TIP:function(){Object(l.d)({level:l.b.INFO,moduleValue:"messageCenter",actionValue:"netOfflineErrorTip"}),l.a.monitor(33697418)},MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT:function(e,t){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"messageCenter",actionValue:e,ver5Value:t})},APPLY_BEHAVIOR_UNDO:function(e){Object(l.c)({level:l.b.IMPORTANT,moduleValue:"applyBehavior",actionValue:"undo",ver5Value:"0",detail:e})},APPLY_BEHAVIOR_REDO:function(e){Object(l.c)({level:l.b.IMPORTANT,moduleValue:"applyBehavior",actionValue:"redo",ver5Value:"0",detail:e})},APPLY_BEHAVIOR_LOCAL:function(e){Object(l.c)({level:l.b.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"0",detail:e})},CREATE_WORKER_ERROR:function(e){Object(l.g)({error:e,errorType:"web-worker",message:"\u521b\u5efaworker\u5931\u8d25"})},UPDATE_SMART_SELECTION_ERROR:function(e,t){Object(l.g)({errorType:"UpdateSmartSelectionError",message:e,error:t})},INVERT_MUTATION_ERROR:function(e,t){Object(l.g)({errorType:"InvertMutationError",message:e,error:t})},FILL_DRAG:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_drag"})},FILL_SERIES:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_series"})},FILL_COPY:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_copy"})},FILL_OPTION:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option"})},FILL_OPTION_COPY:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option_copy"})},FILL_OPTION_SERIES:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option_series"})},FILL_FORMAT:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_format"})},FILL_WITHOUT_FORMAT:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_without_format"})},MOBILE_FILL_SERIES:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill_mobile",action:"mobile_fill_series"})},MOBILE_FILL_COP:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill_mobile",action:"mobile_fill_copy"})},CLK_FILL_SUCCESS:function(){Object(r.tdw)({module:"doc_excel_editor",opername:"excel_fill_mobile",action:"clk_fill_success"})},SWITCH_SHEET_SUCC:function(e){l.a.monitor({success:{PC:33556930,Android:33557619,IOS:33557620},fail:{PC:33560365,Android:33560689,IOS:33560690}}[e][c.a.isMobilePhone||c.a.isAndroidPad?c.a.isAndroid?"Android":"IOS":"PC"])},REPORT_FOR_PLATFORM:function(e){!function(e){var t=T();e[t]&&l.a.monitor(e[t])}(e)},REPORT_FILES_TIMES:function(){var e=function(){if(!performance||!performance.getEntries)return null;var e;try{e=performance.getEntries()}catch(n){return null}var t=[];return e.map((function(e){e.name&&e.duration&&(-1===e.name.indexOf("js/spread-sheet")&&-1===e.name.indexOf("js/bundle-vendors")&&-1===e.name.indexOf("js/bundle-core")&&-1===e.name.indexOf("js/core-sheet")||t.push({name:e.name,duration:e.duration}))})),t}();Object(r.tdw)({opername:"excel_performance",module:"files",action:"load_time",obj1:JSON.stringify(e)})},REPORT_FOR_QUICK_LOOK:function(e){var t;t="success"===e?{PC:33986901,Mobile:33986902,IOS:33986903,Android:33986904,All:33986900}:{PC:33987060,Mobile:33987061,IOS:33987062,Android:33987063,All:33987059};try{var n;c.a.isMobilePhone||c.a.isAndroidPad?(n="Mobile",l.a.monitor(t[n]),c.a.isAndroid?n="Android":c.a.isIOS&&(n="IOS")):n="PC",l.a.monitor(t[n]),l.a.monitor(t.All),"success"===e?Object(r.tdw)({opername:"doc_core",module:"visit",action:"quick_look_succ"}):Object(r.tdw)({opername:"doc_core",module:"visit",action:"quick_look_fail"})}catch(o){console.error(o)}},SHEET_STATUS_REPORT:function(e){if(e){e.getBasicFilter()&&Object(r.tdw)({opername:"doc_excel_editor",module:"excel_filter",action:"excel_contain_filter"});var t=e.mergeManager.mergeList,n=!1,o=[];if(t.forEach((function(e){0===e.startRowIndex&&(n=!0),o.push([e.startRowIndex,e.startColIndex])})),n&&Object(r.tdw)({opername:"doc_excel_editor",module:"excel_merge",action:"top_row_merge"}),o.length>0){var i=0,a=0,l=0,s=0,u=0,c=0;o.forEach((function(t){var n=t[0],o=t[1],r=e.data.rowData[n]&&e.data.rowData[n].values[o];if(r){var d=r.getUserEnteredFormat();if(d){var _=d.getHorizontalAlign(),p=d.getVerticalAlign();_&&"left"!==_||(i+=1),"center"===_&&(a+=1),"right"===_&&(l+=1),"top"===p&&(s+=1),p&&"middle"!==p||(u+=1),"bottom"===p&&(c+=1)}}})),Object(r.tdw)({opername:"doc_excel_editor",module:"excel_merge",action:"merge_align",ver5:"h_align_left:".concat(i,",h_align_center:").concat(a,",h_align_right:").concat(l,",v_align_top:").concat(s,",v_align_middle:").concat(u,",v_align_bottom:").concat(c)})}var d=e.properties.gridProperties;if(d){var _=d.frozenColCount,p=d.frozenRowCount;1===_&&Object(r.tdw)({opername:"doc_excel_editor",module:"excel_freeze",action:"include_first_column_freeze"}),1===p&&Object(r.tdw)({opername:"doc_excel_editor",module:"excel_freeze",action:"include_first_row_freeze"}),(p>1||_>1)&&Object(r.tdw)({opername:"doc_excel_editor",module:"excel_freeze",action:"include_freeze_range"})}}},REPORT_FOR_QL_PV:function(){var e=l.a.monitor;try{var t,n={PC:34024799,Mobile:34024802,IOS:34024801,Android:34024800,All:34024798};c.a.isMobilePhone||c.a.isAndroidPad?(e(n[t="Mobile"]),c.a.isAndroid?t="Android":c.a.isIOS&&(t="IOS")):t="PC",e(n[t]),e(n.All);var o=Object(d.getQuery)("tdsourcetag");o||(o=localStorage.getItem("tdsourcetag")),o&&(Object(_.setCookie)("adtag",o),localStorage.setItem("tdsourcetag",o)),Object(r.tdw)({opername:"doc_core",module:"visit",action:"detail_page_quicklook",source3:o||""})}catch(i){e(3410984)}},REPORT_FOR_SSR:function(){if(e.ssrReport){var t=l.a.monitor;try{var n,o={PC:35298637,Mobile:35298652,IOS:35298639,Android:35298638,All:35298651};c.a.isMobilePhone||c.a.isAndroidPad?(t(o[n="Mobile"]),c.a.isAndroid?n="Android":c.a.isIOS&&(n="IOS")):n="PC",t(o[n]),t(o.All),Object(r.tdw)({opername:"doc_core",module:"visit",action:"detail_page_jsonp"})}catch(i){console.error(i),t(3410984)}}},REPORT_FOR_JSONP:function(){var e=l.a.monitor;try{var t,n={PC:35404917,Mobile:35404918,IOS:35404919,Android:35404920,All:35404921};c.a.isMobilePhone||c.a.isAndroidPad?(e(n[t="Mobile"]),c.a.isAndroid?t="Android":c.a.isIOS&&(t="IOS")):t="PC",e(n[t]),e(n.All),Object(r.tdw)({opername:"doc_core",module:"visit",action:"detail_page_jsonp"})}catch(o){console.error(o),e(3410984)}},REPORT_FOR_PV:function(){var e=l.a.monitor;try{var t,n={sheet:{PC:3410973,Mobile:3410974,IOS:3410975,Android:3410976,All:3410982},All:3410983},o=n.sheet;c.a.isMobilePhone||c.a.isAndroidPad?(e(o[t="Mobile"]),c.a.isAndroid?t="Android":c.a.isIOS&&(t="IOS")):t="PC",e(o[t]),e(o.All),e(n.All),s.a.getConfig("isPreview")&&Object(r.tdw)({opername:"doc_pcview",module:"open",action:"pre_req"}),Object(r.tdw)({opername:"doc_core",module:"visit",action:"detail_page",ver5:window.__globalReleaseVersion,ver10:s.a.getConfig("isPreview")?"qqpreview":""},{immediate:!0}),e(33635051),e(33635108)}catch(i){e(3410984)}},RESET_DEFAULT_TDW_DATA:function(){Object(r.resetDefaultTdwData)()},INVER_MUTATION_ERROR:function(e,t){Object(l.g)({errorType:"InvertMutationError",message:e,error:t})},PARSE_PUSH_MESSAGE_ERROR:function(e){Object(l.d)({level:l.b.DEBUG,moduleValue:"socket",actionValue:"parsePushMessageError",ver5Value:"1",detail:e})},MUTATION_QUEUE_MAX_SIZE:function(e){l.a.monitor(33906029),Object(l.d)({level:l.b.DEBUG,moduleValue:"mutationQueue",actionValue:"maxSize",detail:e})},MUTATION_QUEUE_COMPLETE_TIMEOUT:function(e){l.a.monitor(33906250),Object(l.d)({level:l.b.DEBUG,moduleValue:"mutationQueue",actionValue:"completeTimeout",detail:e})},LOADER:function(e,t){Object(l.d)({level:l.b.INFO,moduleValue:"loader",actionValue:e,detail:t})},PAUSE_LOADER:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"loader",actionValue:"pause",detail:e})},WORK_LOADER:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"loader",actionValue:"work",detail:e})},SERVER_LOADER_FETCH_OPEN_DOC:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"serverLoader",actionValue:"fetchOpenDoc",detail:e})},SERVER_LOADER_OPEN_DOC_RESPONSE:function(e){Object(l.d)({level:l.b.INFO,moduleValue:"serverLoader",actionValue:"openDocResponse",detail:e})},SERVER_LOADER_HANDLE_OPEN_DOC_RESPONSE:function(e,t){Object(l.d)({level:l.b.INFO,moduleValue:"serverLoader",actionValue:e,detail:t})},SERVER_LOADER_OPEN_DOC_ORIGIN_TYPE:function(e,t){Object(l.d)({level:l.b.INFO,moduleValue:"serverLoader",actionValue:e,detail:t})},VIEW_ERROR_INPUT:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"viewInput",actionValue:"viewUserEnterCatchError",detail:e})},VIEW_GET_DIMENSION_OVERFLOW:function(e){Object(l.d)({level:l.b.IMPORTANT,moduleValue:"viewAreaData",actionValue:"viewGetDimensionOverflow",detail:e})},LOAD_ERROR:function(e,t){Object(l.d)({level:l.b.DEBUG,moduleValue:"switchSheet",actionValue:e,detail:t})},LOAD_OFFLINE_VERSION_DATA_NULL:function(){l.a.monitor(35260568)},LOAD_OFFLINE_VERSION_DATA_INVALID:function(){l.a.monitor(35260545)}});t.a=function(e){if(O[e]){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];O[e].apply(O,n)}}}).call(this,n("../node_modules/webpack/buildin/global.js"))},"./src/external/report/speed.ts":function(e,t,n){"use strict";(function(e){n("../node_modules/core-js/modules/es.symbol.js"),n("../node_modules/core-js/modules/es.array.concat.js"),n("../node_modules/core-js/modules/es.array.filter.js"),n("../node_modules/core-js/modules/es.array.for-each.js"),n("../node_modules/core-js/modules/es.array.index-of.js"),n("../node_modules/core-js/modules/es.array.iterator.js"),n("../node_modules/core-js/modules/es.function.name.js"),n("../node_modules/core-js/modules/es.map.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),n("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js"),n("../node_modules/core-js/modules/es.object.keys.js"),n("../node_modules/core-js/modules/es.object.to-string.js"),n("../node_modules/core-js/modules/es.string.iterator.js"),n("../node_modules/core-js/modules/esnext.map.delete-all.js"),n("../node_modules/core-js/modules/esnext.map.every.js"),n("../node_modules/core-js/modules/esnext.map.filter.js"),n("../node_modules/core-js/modules/esnext.map.find.js"),n("../node_modules/core-js/modules/esnext.map.find-key.js"),n("../node_modules/core-js/modules/esnext.map.includes.js"),n("../node_modules/core-js/modules/esnext.map.key-of.js"),n("../node_modules/core-js/modules/esnext.map.map-keys.js"),n("../node_modules/core-js/modules/esnext.map.map-values.js"),n("../node_modules/core-js/modules/esnext.map.merge.js"),n("../node_modules/core-js/modules/esnext.map.reduce.js"),n("../node_modules/core-js/modules/esnext.map.some.js"),n("../node_modules/core-js/modules/esnext.map.update.js"),n("../node_modules/core-js/modules/web.dom-collections.for-each.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=n("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),i=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),l=n("../node_modules/@tencent/docs-user-agent/dist/index.js"),s=n.n(l),u=n("../packages/common-utils/src/url.ts"),c=n("../packages/report/src/index.ts"),d=n("./src/base/config/report.ts"),_=n("./src/core/app/sheetSize.ts"),p=n("./src/base/report/flowlog.js"),E=n("../node_modules/@tencent/tencent-doc-report/lib/index.browser.js");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(){function t(){var n=this;Object(a.a)(this,t),this.pagePerformanceReport=function(){var t=e.SpreadsheetApp;n.pagePerformanceReportFlag||t.lifeCycle!==t.EVENT.PAGE_LOAD_FINISHED||(n.pagePerformanceReportFlag=!0,n.prepareSpeedReportData(),n.doSpeedReport(),n.nativeOpenPageReport(),e.history.replaceState({},"",Object(u.removeURLParameters)(e.location.href,["createTS","templateId","csid"])))},this.destroy=function(){n.init()},this.init(),this.initListeners()}return Object(r.a)(t,[{key:"init",value:function(){var t=e.performance||e.webkitPerformance||e.msPerformance||{};this.timing=t.timing,this.performanceData=e.performanceData||{},this.speedReportData=new Map,this.pagePerformanceReportFlag=!1}},{key:"initListeners",value:function(){var t=e.SpreadsheetApp;t.emitter.on(t.EVENT.PAGE_LOAD_FINISHED,this.pagePerformanceReport),t.emitter.on(t.EVENT.START_DESTROY,this.destroy)}},{key:"hasDonePagePerformanceReport",value:function(){return this.pagePerformanceReportFlag}},{key:"prepareSpeedReportData",value:function(){var t,n=this.timing,o=this.performanceData,a=this.speedReportData,r=o.startPoint||n.requestStart;if(a.set(d.SPEED_REPORT_POINTS.NAVIGATION_TO_FETCH,n.fetchStart-n.navigationStart),a.set(d.SPEED_REPORT_POINTS.DNS,n.domainLookupEnd-n.domainLookupStart),a.set(d.SPEED_REPORT_POINTS.CONNECT,n.connectEnd-n.connectStart),a.set(d.SPEED_REPORT_POINTS.HTML_TTFB,n.responseStart-r),a.set(d.SPEED_REPORT_POINTS.HTML_LOAD,n.responseEnd-n.responseStart),a.set(d.SPEED_REPORT_POINTS.WHITESCREEN,e.isContainer?0:o.jsStartRun-r),a.set(d.SPEED_REPORT_POINTS.SYNC_JS_RUN,n.domContentLoadedEventEnd-o.jsStartRun),a.set(d.SPEED_REPORT_POINTS.DOM_CONTENT_LOAD,n.domContentLoadedEventEnd-r),e.ssrReport&&e.ssrRenderEnd?(a.set(d.SPEED_REPORT_POINTS.FIRST_SCREEN_SSR,e.ssrRenderEnd-r),a.set(d.SPEED_REPORT_POINTS.FIRST_SCREEN,e.ssrRenderEnd-r)):(a.set(d.SPEED_REPORT_POINTS.FIRST_SCREEN_NO_SSR,o.afterFirstRender-r),a.set(d.SPEED_REPORT_POINTS.FIRST_SCREEN,o.afterFirstRender-r)),a.set(d.SPEED_REPORT_POINTS.INTERACTABLE,o.interactable-r),a.set(d.SPEED_REPORT_POINTS.AFTER_ALL_RENDER,o.afterAllRender-r),e.performance&&e.performance.getEntriesByType)for(var l=performance.getEntriesByType("resource"),s=0,u=l.length;s<u;s++){var c=l[s];0===c.name.indexOf("https://".concat(e.location.host,"/dop-api/opendoc"))&&(a.set(d.SPEED_REPORT_POINTS.LOAD_CGI_DATA_TIME,c.responseEnd-c.fetchStart),a.set(d.SPEED_REPORT_POINTS.LOAD_CGI_DATA_SERVER_COST_TIME,c.responseStart-c.connectEnd))}e.speedData=(t={},Object(i.a)(t,d.SPEED_REPORT_POINTS.WHITESCREEN,a.get(d.SPEED_REPORT_POINTS.WHITESCREEN)),Object(i.a)(t,d.SPEED_REPORT_POINTS.FIRST_SCREEN,a.get(d.SPEED_REPORT_POINTS.FIRST_SCREEN)),Object(i.a)(t,d.SPEED_REPORT_POINTS.INTERACTABLE,a.get(d.SPEED_REPORT_POINTS.INTERACTABLE)),t)}},{key:"doSpeedReport",value:function(){var t=this,n=Object(_.a)(e.SpreadsheetApp.spreadsheet.getActiveSheetId()),o="".concat(Object(E.getSource1)()),i=JSON.stringify(n),a=JSON.stringify({container:e.isContainer?1:0,offline_package:e.__isOfflinePkg?1:0});if(c.b.tdwReport({opername:"quality_doc",module:"excel_detail",action:"open_time_cost",ver5:this.speedReportData.get(d.SPEED_REPORT_POINTS.WHITESCREEN)||0,ver6:this.speedReportData.get(d.SPEED_REPORT_POINTS.FIRST_SCREEN)||0,ver7:this.speedReportData.get(d.SPEED_REPORT_POINTS.INTERACTABLE)||0,ver8:i,ver9:a}),s.a.isMiniProgram){var r=+Object(u.getQuery)("miniapp_ts");r&&c.b.tdwReport({opername:"miniapp_performance",module:"detail",action:"navagationStart",ver5:this.timing.navigationStart-r})}this.speedReportData.forEach((function(e,n){if(c.b.tdwReport({opername:"excel_performance",module:"start",action:n,ver5:e,ver8:i,ver9:a}),c.b.tam.reportT({name:n,duration:e,ext1:i,ext2:a,ext3:o}),d.SPEED_REPORT_LOG[n]){var r="".concat(d.SPEED_REPORT_LOG[n],": ").concat(e);p.a.info(r),console.warn("%c".concat(r),"color: green; font-size: 14px;")}t.speedReportData.delete(n)}))}},{key:"runReport",value:function(t,n,o,i){var a=o-n,r=this.speedReportData.get(t)||0;if(this.speedReportData.set(t,r+a),!i){var l=Object(_.a)(e.SpreadsheetApp.spreadsheet.getActiveSheetId()),s=this.speedReportData.get(t)||0,u="".concat(Object(E.getSource1)()),f=JSON.stringify(l),m=JSON.stringify({container:e.isContainer?1:0,offline_package:e.__isOfflinePkg?1:0});if(c.b.tdwReport({opername:"excel_performance",module:"start",action:t,ver5:s,ver8:f,ver9:m}),c.b.tam.reportT({name:t,duration:s,ext1:f,ext2:m,ext3:u}),d.SPEED_REPORT_LOG[t]){var T="".concat(d.SPEED_REPORT_LOG[t],": ").concat(s);p.a.info(T),console.warn("%c".concat(T),"color: green; font-size: 14px;")}this.speedReportData.delete(t)}}},{key:"nativeOpenPageReport",value:function(){var t=this,n=Object(u.getQuery)("createTS"),i=Object(u.getQuery)("templateId"),a=Object(u.getQuery)("csid"),r=e.isContainer?this.performanceData.startPoint:this.timing.requestStart;if(n)this.doOpenPageReport({isCreate:!0,clickTime:+n,templateId:i,appStatus:{},metrics:{}});else if(a){var l;null===(l=e.mqq)||void 0===l||l.invoke("docx","getMetric",{csid:a},(function(n){if(n&&n.data){var l=n.data,s=l.doc_item_click_timestamp,u=l.doc_loadurl_timestamp,c=Object(o.a)(l,["doc_item_click_timestamp","doc_loadurl_timestamp"]),d=u-s,_=r-u;t.doOpenPageReport({isCreate:!1,clickTime:s,templateId:i,appStatus:{clickToLoadCost:d,loadToStartCost:_},metrics:c})}else{var p;null===(p=e.log)||void 0===p||p.error("getMetric for ".concat(a," failed."),n)}}))}}},{key:"doOpenPageReport",value:function(t){var n=JSON.stringify(m({clickToEditCost:this.performanceData.interactable-t.clickTime,clickToShowCost:this.performanceData.afterFirstRender-t.clickTime},t.appStatus||{})),o=t.isCreate?"1":"0",i=JSON.stringify(m({container:e.isContainer?1:0,offline_package:e.__isOfflinePkg?1:0},t.metrics)),a={opername:"doc_core",module:"open",action:"open_web",obj3:n,ver5:o,ver6:t.templateId,ver9:i};c.b.tdwReport(a)}}]),t}();t.a=new T}).call(this,n("../node_modules/webpack/buildin/global.js"))}}]);
//# sourceMappingURL=pc-bundle_plugin_report-f2a96d0daf.js.map